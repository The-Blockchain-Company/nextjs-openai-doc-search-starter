> ![](vertopal_465415c1b298463ba932b756b3983353/media/image1.png){width="2.2228193350831145in"
> height="0.6673950131233596in"}
>
> **Payment Card Industry (PCI)**

Mobile Payments on COTS

> **Security and Test Requirements**
>
> **Version 1.0.1**

#### February 2023

> **Document Changes**

+--------+-------+----------------------------------------------------+
| > **   | > *   | > **Description**                                  |
| Date** | *Vers |                                                    |
|        | ion** |                                                    |
+========+=======+====================================================+
| > Nov  | > 1.0 | Initial public release                             |
| > 2022 |       |                                                    |
+--------+-------+----------------------------------------------------+
| > Jan  | >     | Errata release                                     |
| > 2023 | 1.0.1 |                                                    |
|        |       | Various typographical errors fixed                 |
|        |       |                                                    |
|        |       | Included missing 'not' into requirement 1D-4.3 to  |
|        |       | align with intent and testing instruction          |
|        |       |                                                    |
|        |       | Updated Applicability Matrix (Table 2) to align    |
|        |       | with Domain 4 scoping statements including A&M     |
|        |       | Service Providers                                  |
+--------+-------+----------------------------------------------------+
|        |       |                                                    |
+--------+-------+----------------------------------------------------+

> **Table of Contents**

[Introduction 8](#introduction)

[Roles and Responsibilities 9](#roles-and-responsibilities)

[Glossary/Terminology 11](#glossaryterminology)

[Scope of Mobile Payments on COTS Standard
20](#scope-of-mobile-payments-on-cots-standard)

[Mobile Payments on COTS---Payment Acceptance Channels and Cardholder
Verification Methods
21](#mobile-payments-on-cotspayment-acceptance-channels-and-cardholder-verification-methods)

[Mobile Payments on COTS---Security Model
22](#mobile-payments-on-cotssecurity-model)

[MPoC SDKs and MPoC Applications 24](#mpoc-sdks-and-mpoc-applications)

[MPoC SDK Types and MPoC Application Implementations
25](#mpoc-sdk-types-and-mpoc-application-implementations)

[MPoC Domain and Section Applicability
28](#mpoc-domain-and-section-applicability)

[Example MPoC Implementations 33](#example-mpoc-implementations)

[Monolithic MPoC Solution Examples
33](#monolithic-mpoc-solution-examples)

[MPoC Solution implementing a single MPoC Software Product with an
Attestation and Monitoring Service
34](#mpoc-solution-implementing-a-single-mpoc-software-product-with-an-attestation-and-monitoring-service)

[MPoC Solution Implemented by MPoC Software Vendor
35](#mpoc-solution-implemented-by-mpoc-software-vendor)

[MPoC Solution Implementing Multiple MPoC Software Products with
Multiple Attestation and Monitoring Services
35](#mpoc-solution-implementing-multiple-mpoc-software-products-with-multiple-attestation-and-monitoring-services)

[Relationship between This Standard and Other PCI Standards
36](#relationship-between-this-standard-and-other-pci-standards)

[Relationship between This Standard and PCI DSS
36](#relationship-between-this-standard-and-pci-dss)

[Relationship between This Standard and PCI PTS POI Standard
37](#relationship-between-this-standard-and-pci-pts-poi-standard)

[Use of PCI PTS SCRP Devices 37](#use-of-pci-pts-scrp-devices)

[Use of Non-PTS Approved MSR 37](#use-of-non-pts-approved-msr)

[Relationship between This Standard and PCI SSC Software Standards
37](#relationship-between-this-standard-and-pci-ssc-software-standards)

[Relationship between This Standard and PCI PIN Standard
38](#relationship-between-this-standard-and-pci-pin-standard)

[Relationship between This Standard and PCI SPoC Standard and PCI CPoC
Standard
38](#relationship-between-this-standard-and-pci-spoc-standard-and-pci-cpoc-standard)

[Security Requirements for Mobile Payments on COTS Solution
39](#security-requirements-for-mobile-payments-on-cots-solution)

[Objective-Based Approach to Requirements
39](#objective-based-approach-to-requirements)

[Requirement Frequency 39](#requirement-frequency)

[Requirements Structure 41](#requirements-structure)

[Testing Methods 41](#testing-methods)

[Security Objective and Assets 43](#security-objective-and-assets)

[Domain 1: MPoC Software Core Requirements
45](#domain-1-mpoc-software-core-requirements)

[Module 1A: CORE 46](#module-1a-core)

[1A-1 Secure Software Requirements
46](#a-1-secure-software-requirements)

[1A-2 Random Numbers 50](#a-2-random-numbers)

[1A-3 Acceptable Cryptography 56](#a-3-acceptable-cryptography)

[1A-4 Key Management Design 59](#a-4-key-management-design)

[1A-5 Secure Channels 65](#_bookmark53)

[1A-6 Third-Party APIs 69](#a-6-third-party-apis)

[Module 1B: MPoC SDK Software Protection
71](#module-1b-mpoc-sdk-software-protection)

[1B-1 Software Security Mechanisms
71](#b-1-software-security-mechanisms)

[1B-2 Software-Protected Cryptography
80](#b-2-software-protected-cryptography)

[Module 1C: Attestation and Monitoring Software
85](#module-1c-attestation-and-monitoring-software)

[1C-1 Coverage 86](#c-1-coverage)

[1C-2 Measurements/Detection 90](#c-2-measurementsdetection)

[1C-3 Response 92](#c-3-response)

[1C-4 Anti-Tampering 96](#c-4-anti-tampering)

[1C-5 A&M Integration Guidance 99](#c-5-am-integration-guidance)

[Module 1D: Secure Entry and Processing of Account Data
101](#module-1d-secure-entry-and-processing-of-account-data)

[1D-1 Account Data Entry and Encryption
101](#d-1-account-data-entry-and-encryption)

[1D-2 Use of PCI PTS POI-approved Devices
106](#d-2-use-of-pci-pts-poi-approved-devices)

[1D-3 Magnetic Stripe Data 108](#d-3-magnetic-stripe-data)

[1D-4 COTS-Native NFC Interface 110](#d-4-cots-native-nfc-interface)

[1D-5 Manual Entry 112](#d-5-manual-entry)

[Module 1E: PIN Entry on COTS Device
114](#module-1e-pin-entry-on-cots-device)

[1E-1 COTS-native PIN Entry 114](#e-1-cots-native-pin-entry)

[Module 1F: Offline Payment Transactions
118](#module-1f-offline-payment-transactions)

[1F-1 Offline Payment Transactions
119](#f-1-offline-payment-transactions)

[1F-2 Offline Monitoring 122](#f-2-offline-monitoring)

[Module 1G: MPoC Software Security Guidance
124](#module-1g-mpoc-software-security-guidance)

[1G-1 Security Guidance 124](#g-1-security-guidance)

[Domain 2: MPoC Application Integration
128](#domain-2-mpoc-application-integration)

[Module 2A: MPoC Software Integration
128](#module-2a-mpoc-software-integration)

[2A-1 Secure MPoC SDK Integration and Usage
128](#a-1-secure-mpoc-sdk-integration-and-usage)

[Module 2B: MPoC Application Security
132](#module-2b-mpoc-application-security)

[2B-1 MPoC Application Security 132](#b-1-mpoc-application-security)

[Domain 3: Attestation and Monitoring
134](#domain-3-attestation-and-monitoring)

[Module 3A: MPoC Software Security Guidance Compliance
134](#module-3a-mpoc-software-security-guidance-compliance)

[3A-1 Deployment and Configuration of Back-end Systems
134](#a-1-deployment-and-configuration-of-back-end-systems)

[Module 3B: Baseline 136](#module-3b-baseline)

[3B-1 COTS Platform Baseline and Vulnerability Management
136](#b-1-cots-platform-baseline-and-vulnerability-management)

[Module 3C: Attestation and Monitoring
140](#module-3c-attestation-and-monitoring)

[3C-1 Attestation and Monitoring Policy
140](#c-1-attestation-and-monitoring-policy)

[3C-2 Monitoring 142](#c-2-monitoring)

[Module 3D: Operational Security 145](#module-3d-operational-security)

[3D-1 Operational Management 145](#d-1-operational-management)

[Domain 4: MPoC Software Management
147](#domain-4-mpoc-software-management)

[Module 4A: Software Management 147](#module-4a-software-management)

[4A-1 COTS Software Distribution and Updates
147](#a-1-cots-software-distribution-and-updates)

[4A-2 Key Management Operations 153](#a-2-key-management-operations)

[4A-3 Penetration Testing and Vulnerability Management
158](#a-3-penetration-testing-and-vulnerability-management)

[Domain 5: MPoC Solution 160](#domain-5-mpoc-solution)

[Module 5A: Third Party Management
161](#module-5a-third-party-management)

[5A-1 Merchant Identification and Communication
161](#a-1-merchant-identification-and-communication)

[5A-2 Support for Multiple Entities in the Solution
163](#a-2-support-for-multiple-entities-in-the-solution)

[5A-3 Security of Back-end Systems
164](#a-3-security-of-back-end-systems)

[Appendix A Back-end Environment Security Requirements
166](#appendix-a-back-end-environment-security-requirements)

1.  [Maintain Security Policies for All Personnel
    167](#maintain-security-policies-for-all-personnel)

2.  [Secure Network Connectivity 172](#secure-network-connectivity)

3.  [Develop and Maintain Secure Systems
    175](#develop-and-maintain-secure-systems)

4.  [Vulnerability Management 178](#vulnerability-management)

5.  [Managing Access 181](#managing-access)

6.  [Physical Security 185](#physical-security)

7.  [Incident Response Preparedness
    186](#incident-response-preparedness)

[Appendix B Attack Costing Framework
189](#appendix-b-attack-costing-framework)

[Differences between Hardware and Software Tampering
189](#differences-between-hardware-and-software-tampering)

[Considerations for Attack Cost Calculations
191](#considerations-for-attack-cost-calculations)

[Identification and Exploitation Stages
191](#identification-and-exploitation-stages)

[Scalability Rating Factor 191](#scalability-rating-factor)

[Remediation and Pre-remediation 192](#remediation-and-pre-remediation)

[Approach to Attack Calculations 192](#approach-to-attack-calculations)

[Rating Procedure 193](#rating-procedure)

[Attack Time 196](#attack-time)

[Attacker Expertise 196](#attacker-expertise)

[Scalability 197](#scalability)

[Knowledge of the A&M Back-end Systems
199](#knowledge-of-the-am-back-end-systems)

[Equipment 200](#equipment)

[COTS Device Access and Remote Attacks
200](#cots-device-access-and-remote-attacks)

[Summary Attack Rating Table 202](#summary-attack-rating-table)

[Discussion of Ratings with Examples
203](#discussion-of-ratings-with-examples)

[Example of a Weak Solution 204](#example-of-a-weak-solution)

[Example of a Strong Solution - Scalable and non-Scalable Examples
206](#example-of-a-strong-solution---scalable-and-non-scalable-examples)

[Use and Abuse of Legitimate Functionality Provided by OS
207](#use-and-abuse-of-legitimate-functionality-provided-by-os)

[Detailed Examples 210](#detailed-examples)

[Example of Attack on a Platform - Full Attack - Remote Attack on
Platform
210](#example-of-attack-on-a-platform---full-attack---remote-attack-on-platform)

[Example - Full Attack - Perform Fake Payments
212](#example---full-attack---perform-fake-payments)

[Appendix C Minimum and Equivalent Key Sizes and Strengths for Approved
Algorithms
215](#appendix-c-minimum-and-equivalent-key-sizes-and-strengths-for-approved-algorithms)

[Equivalent Key Sizes 215](#equivalent-key-sizes)

[Hash Algorithms 217](#hash-algorithms)

[Random Number Generators 217](#random-number-generators)

[Prime Number Generators 217](#prime-number-generators)

[Appendix D Secure Software Lifecycle Requirements
218](#appendix-d-secure-software-lifecycle-requirements)

[Leveraging PCI Secure SLC Standard for Appendix D Security Requirements
218](#leveraging-pci-secure-slc-standard-for-appendix-d-security-requirements)

1.  [Software Security Governance 219](#software-security-governance)

2.  [Secure Software Engineering 229](#secure-software-engineering)

3.  [Secure Software and Data Management
    238](#secure-software-and-data-management)

4.  [Security Communications 242](#security-communications)

[Appendix E MSR Security Requirements
246](#appendix-e-msr-security-requirements)

[MSR Validation and Testing Requirements
246](#msr-validation-and-testing-requirements)

1.  [Account Data Input 246](#account-data-input)

2.  [No Account Data Storage 247](#no-account-data-storage)

3.  [Account Data Processing 247](#account-data-processing)

4.  [Firmware Updates 247](#firmware-updates)

5.  [Protection of Sensitive Services
    248](#protection-of-sensitive-services)

6.  [Sensitive Service Limits 248](#sensitive-service-limits)

7.  [Key Management 248](#key-management)

8.  [Encryption Mechanism 249](#encryption-mechanism)

9.  [Remote Access 249](#remote-access)

10. [Output of Cleartext Account Data
    249](#output-of-cleartext-account-data)

11. [Surrogate PAN Values 250](#surrogate-pan-values)

12. [Communications and Interfaces 250](#communications-and-interfaces)

13. [Lifecycle Security Requirements
    250](#lifecycle-security-requirements)

[Appendix F Configuration and Use of the STS Tool
251](#appendix-f-configuration-and-use-of-the-sts-tool)

# Introduction

> This document, the *PCI Mobile Payments on COTS* (MPoC) standard
> (hereinafter referred to as the "MPoC Standard" or "standard"),
> defines security requirements, test requirements, and guidance for
> entities involved in the development, deployment, and operation of
> merchant operated mobile payment acceptance solutions that use COTS
> devices.
>
> Solutions that do not use COTS devices, use devices that are intended
> for integration into another product, or solutions that are intended
> for use by the cardholder themselves using their own COTS device, are
> not considered by this standard. Similarly, MPoC does not consider or
> allow for solutions that are to be deployed into an environment that
> is not merchant attended.
>
> The security requirements described in this document provide a
> security framework to protect the confidentiality and integrity of
> sensitive payment information captured and processed in MPoC
> Solutions. The test requirements outlined in this document provide
> details of the testing processes performed by the evaluation
> laboratories as part of the validation testing of the solutions.
>
> The MPoC standard allows for an optional modular approach to the
> development of a mobile payment solution. An MPoC Solution is
> considered a monolithic solution if the MPoC Solution does not use or
> integrate any other listed MPoC Products, and instead is assessed as a
> complete implementation. Alternatively, an MPoC Solution may be
> considered a composite solution if it does use and/or integrate one or
> more listed MPoC Products. The following bullets provided below
> outline the different types of MPoC Product that are supported by this
> standard for separate validation and listing:

-   **MPoC Software:** All software that implements the base
    functionality required by the MPoC Solution, including the
    functionality for accepting account data (optionally including the
    cardholder PIN) on COTS devices. The MPoC Software must implement at
    least one form of COTS-native account data entry, either COTS-native
    NFC or COTS-native PIN entry. The MPoC Software scope also includes
    the attestation components, back-end functionality, and any APIs
    offered. The backend may optionally also include the payment
    processing environment and functionality.

> MPoC Software may rely on hardware functions or systems, such as those
> provided by the COTS platform(s) or back-end HSMs. MPoC Software that
> is separately validated and listed on the PCI SSC website is
> considered an MPoC Software Product.

-   **Attestation and Monitoring Service:** The operation of the
    attestation and monitoring functionality of a listed MPoC Software
    Product. An Attestation and Monitoring Service cannot be used by an
    MPoC Solution that is not using an MPoC Software Product supported
    by that Attestation and Monitoring Service.

-   **MPoC Solution:** The set of components and processes that supports
    mobile payment acceptance and protection of account data on a COTS
    device. At a minimum, the solution includes the MPoC Application,
    attestation system, and the back-end systems and environments that
    perform attestation, monitoring, and payment processing.

> The requirements in this standard are organized in five Domains. The
> first two Domains cover the technical and development aspects of the
> software of the MPoC product (the MPoC Software, or equivalent
> functionality in as implemented in a monolithic MPoC Solution (Domain
> 1)),
>
> and the MPoC Application (Domain 2). The last three Domains cover the
> operational aspects of the MPoC Software, Attestation and Monitoring
> Service, and MPoC Solution.

-   **Domain 1: MPoC Software Core Requirements:** The security and test
    requirements that apply specifically to the MPoC Software and MPoC
    Software lifecycle processes. The core Module in this Domain
    includes security requirements such as secure software and secure
    software lifecycle processes, integrity protection, sensitive
    information protection, and secure channels. This Domain includes
    optional Modules and Sections that are applicable only to MPoC
    Software supporting the relevant payment acceptance or cardholder
    verification methods (such as COTS-native NFC, or COTS-native PIN
    entry).

-   **Domain 2: MPoC Application Integration**: The security
    requirements and test procedures that apply to MPoC Applications,
    including those that integrate previously assessed MPoC Software.
    The requirements in this Domain include the secure integration and
    usage of the MPoC Software, and the security of the complete MPoC
    Application.

-   **Domain 3: Attestation and Monitoring**: The security requirements
    and test procedures that apply specifically to a service provider
    operating the back-end attestation and monitoring environment(s).
    This service provider is responsible for maintaining the COTS
    platform baseline, interpreting and responding to data collected
    from the COTS platforms, and the security of attestation and
    monitoring environment.

-   **Domain 4: MPoC Software Management**: The security requirements
    for the operational management of software products and the
    management of cryptographic keys and encryption systems used in the
    MPoC Solution. This includes the security requirements for signing
    and distribution MPoC Software and MPoC Applications, and the key
    management for these software products as well as back-end systems.
    The MPoC Software Management Domain may apply to more than one
    entity within an MPoC Solution.

-   **Domain 5: MPoC Solution**: The security requirements and test
    procedures that apply to MPoC Solution providers who are responsible
    for managing the interaction between all parties in an MPoC
    Solution, and the security of any MPoC specific decryption or
    (payment) switching environments. The MPoC Solution provider is also
    responsible for ensuring that any associated MPoC Applications,
    which are not already listed as part of an MPoC Software Product,
    meet the requirements of this standard and are included as part of
    their MPoC listing.

## Roles and Responsibilities

> There are several stakeholders involved in maintaining and managing
> PCI standards. The following describes the high-level roles and
> responsibilities as they relate to the PCI Mobile Payments on COTS
> standard.

-   **PCI SSC** --- PCI SSC maintains various PCI standards, supporting
    programs, and related documentation. In relation to this standard,
    PCI SSC:

    -   Maintains the Mobile Payments on COTS Security and Test
        > Requirements (this document).

    -   Maintains supporting documentation including reporting
        templates, attestation forms, technical frequently asked
        questions (FAQs), and guidance to assist entities implementing
        and assessing to the standard.

    -   Reviews and monitors Evaluation Reports and related change
        submissions submitted to PCI SSC by PCI Recognized Laboratories
        for completeness and competency with baseline quality, security,
        and security testing standards.

    -   Maintains engagement with the industry security evaluation
        stakeholders to ensure that the evolving threat landscape is
        effectively addressed during the evaluation work.

    -   Maintains the list of approved PCI-recognized labs qualified to
        perform evaluations using this standard, on the PCI SSC website.

    -   Maintains a quality assurance program for PCI-recognized labs.

-   **Participating Payment Brands** --- The participating payment
    brands develop and enforce their respective programs related to
    compliance with PCI standards including, but not limited to:

    -   Requirements, mandates, and deadlines for compliance to PCI
        > standards.

    -   Which organizations are required to comply with PCI standards.

-   **PCI-Recognized Laboratories** --- PCI-recognized laboratories are
    responsible for maintaining the required knowledge, expertise, and
    equipment necessary to execute all test activities, and to perform
    the required evaluation and generate an evaluation report
    documenting the results. Not all PCI-recognized laboratories are
    qualified to perform evaluations using this standard. For further
    information, please consult the *Mobile Payment on COTS Program
    Guide*.

-   **EMVCo** --- EMVCo is the global technical body owned by American
    Express, Discover, JCB, MasterCard, UnionPay, and Visa that
    facilitates the worldwide interoperability and acceptance of secure
    payment transactions by managing and evolving the EMV Specifications
    and related testing processes. Adoption of EMV Specifications and
    associated approval and certification processes promotes a unified
    international payments framework, which supports an advancing range
    of payment methods, technologies, and acceptance environments.

> Additionally, the following entities are identified for the purpose of
> this standard:

-   **MPoC Software vendor** --- The MPoC Software vendor is an optional
    entity developing, distributing, and supporting the MPoC Software.
    An MPoC Software vendor is responsible for ensuring that the MPoC
    Software they develop meets the requirements outlined in *[Domain
    1:](#domain-1-mpoc-software-core-requirements) [MPoC Software Core
    Requirements](#domain-1-mpoc-software-core-requirements)*.

-   **Attestation and monitoring service provider** --- These optional
    entities are involved in the deployment and operation of the
    attestation and monitoring component of the MPoC Software within a
    back-end environment. The entity operating the attestation and
    monitoring (A&M) service is responsible for ensuring that all
    requirements outlined in *[Domain
    3:](#domain-3-attestation-and-monitoring) [Attestation and
    Monitoring](#domain-3-attestation-and-monitoring)* are met.

-   **MPoC Solution provider** --- An MPoC Solution provider is the
    entity that has overall responsibility for the implementation and
    management of an MPoC Solution. The MPoC Solution provider is
    responsible for ensuring that all requirements are met,

> including any requirements fulfilled by other organizations on behalf
> of the MPoC Solution provider (e.g., attestation and monitoring
> service providers). In addition, MPoC Solution providers are
> responsible for ensuring that any MPoC Applications are securely
> integrated with the MPoC Software, and are securely distributed to
> merchants.

## Glossary/Terminology

> In addition to terms defined in the *PCI DSS Glossary, Abbreviations
> and Acronyms*^1^, *Software-based PIN Entry on COTS (SPoC) Security
> Requirements*, the terms/acronyms listed in [Table
> 1](#table-1-glossary-of-terms) are used throughout this document.

##### Table 1: Glossary of Terms

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > Account   | Account data consists of cardholder data and/or        |
| > data      | sensitive authentication data. See *[Cardholder        |
|             | data](#_bookmark5)* and *[Sensitive](#_bookmark14)*    |
|             | [*authentication data*.](#_bookmark14)                 |
+-------------+--------------------------------------------------------+
| > AES       | Abbreviation for "Advanced Encryption Standard." Block |
|             | cipher used in symmetric key cryptography adopted by   |
|             | NIST in November 2001 as FIPS PUB 197 (or FIPS 197).   |
+-------------+--------------------------------------------------------+
| > Assets    | Assets are elements of the MPoC Solution that are      |
|             | security-sensitive or are used to provide security to  |
|             | other security-sensitive elements. Examples of assets  |
|             | include sensitive assets such as account data,         |
|             | cardholder PINs, and cryptographic keys.               |
|             |                                                        |
|             | Software may also be considered an asset if the        |
|             | correct operation of that software is required to      |
|             | provide security protection to other assets.           |
|             |                                                        |
|             | See also [*Sensitive assets*](#_bookmark15).           |
+-------------+--------------------------------------------------------+
| > []{       | Also known as public key cryptography, asymmetric      |
| #_bookmark4 | cryptosystems are based on the intractability of       |
| > .anchor   | certain mathematical problems. A cryptographic         |
| }Asymmetric | technique that uses two related transformations, a     |
| >           | public transformation (defined by the public key) and  |
|  encryption | a private transformation (defined by the private key). |
|             | The two transformations have the property that, given  |
|             | the public transformation, it is not computationally   |
|             | feasible to derive the private transformation.         |
+-------------+--------------------------------------------------------+
| >           | The act of attestation in this standard is the         |
| Attestation | interaction between a verifier (possibly server-based) |
|             | and a prover (possibly client- based) to determine the |
|             | current security state/behavior of the prover based on |
|             | measurements requests and thresholds implemented by    |
|             | the prover.                                            |
+-------------+--------------------------------------------------------+
| >           | An element of the solution that performs attestation   |
| Attestation | processing.                                            |
| > component |                                                        |
+-------------+--------------------------------------------------------+

> ^1^
> *https://[www.pcisecuritystandards.org/pci_security/glossary](http://www.pcisecuritystandards.org/pci_security/glossary)*

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| >           | The set of components that perform attestation         |
| Attestation | processing for the MPoC Solution. The implementation   |
| > system    | may be shared across different execution environments, |
|             | which provides a level of validation and assurance of  |
|             | the execution environment in which the MPoC            |
|             | Application executes, providing a level of             |
|             | software-based tamper detection and response.          |
|             |                                                        |
|             | Its components include the MPoC Application            |
|             | attestation component and the back-end attestation     |
|             | component. The latter works in close association with  |
|             | the back-end monitoring system*.*                      |
+-------------+--------------------------------------------------------+
| >           | The combination of the Attestation System and the      |
| Attestation | Monitoring System.                                     |
| > and       |                                                        |
| >           |                                                        |
|  monitoring |                                                        |
| > system    |                                                        |
| >           |                                                        |
| > (also A&M |                                                        |
| > system)   |                                                        |
+-------------+--------------------------------------------------------+
| >           | An entity that has integrated the back-end attestation |
| Attestation | and monitoring component of an MPoC Software Product,  |
| > &         | and is providing the operational service of that       |
| >           | component as part of a listed MPoC Attestation and     |
|  Monitoring | Monitoring Service Product.                            |
| > Service   |                                                        |
| > provider  |                                                        |
| >           |                                                        |
| > (also A&M |                                                        |
| > Service   |                                                        |
| > provider) |                                                        |
+-------------+--------------------------------------------------------+
| >           | The software used to implement the attestation and     |
| Attestation | monitoring functions. Attestation and Monitoring       |
| > and       | software is a required part of any MPoC Software       |
| >           | Product.                                               |
|  monitoring |                                                        |
| > software  |                                                        |
| >           |                                                        |
| > (also A&M |                                                        |
| > software) |                                                        |
+-------------+--------------------------------------------------------+
| > Back-end  | The set of systems providing the server-side           |
| > systems   | functionality of the MPoC Solution. This includes      |
|             | monitoring, attestation and (optional) payment and PIN |
|             | processing functions.                                  |
+-------------+--------------------------------------------------------+
| > []{       | At a minimum, cardholder data consists of the full     |
| #_bookmark5 | PAN. Cardholder data may also appear in the form of    |
| > .anchor   | the full PAN plus any of the following: cardholder     |
| }Cardholder | name, expiration date and/or service code.             |
| > data      |                                                        |
|             | See *[Sensitive authentication data](#_bookmark14)*    |
|             | for additional data elements that might be transmitted |
|             | or processed (but not stored) as part of a payment     |
|             | transaction.                                           |
+-------------+--------------------------------------------------------+
| >           | The people, processes and technology that store,       |
|  Cardholder | process, or transmit cardholder data or sensitive      |
| > data      | authentication data.                                   |
| >           |                                                        |
| environment |                                                        |
| > (CDE)     |                                                        |
+-------------+--------------------------------------------------------+
| > Cleartext | Intelligible data that has meaning and can be read or  |
|             | acted upon without the application of decryption. Also |
|             | known as plaintext.                                    |
+-------------+--------------------------------------------------------+
| > []{       | A general-purpose mobile computing device (e.g.,       |
| #_bookmark6 | smartphone or tablet) that is not designed solely for  |
| > .anchor   | the purposes of payment acceptance.                    |
| }Commercial |                                                        |
| > of        |                                                        |
| f-the-shelf |                                                        |
| > (COTS)    |                                                        |
| > device    |                                                        |
| >           |                                                        |
| > (also     |                                                        |
| > COTS      |                                                        |
| > device)   |                                                        |
+-------------+--------------------------------------------------------+
| >           | Software that processes contactless transactions. The  |
| Contactless | kernel is selected by the MPoC Application based on    |
| > kernel    | the characteristics of the transaction and the payment |
|             | instrument (e.g., credit card) supporting the          |
|             | contactless transactions. The kernel contains          |
+-------------+--------------------------------------------------------+

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
|             | interface routines, security and control functions,    |
|             | and logic to manage a set of commands and responses to |
|             | retrieve the necessary data from the payment           |
|             | instrument to complete a transaction.^2^               |
+-------------+--------------------------------------------------------+
| >           | The subsystem in the COTS device that is part of the   |
| COTS-native | COTS platform used to access data, including account   |
| > NFC       | data, read from contactless cards or other payment     |
|             | instruments. The main physical components are the NFC  |
|             | antenna and the NFC controller.                        |
+-------------+--------------------------------------------------------+
| > COTS      | The hardware and operating systems (OS) of the COTS    |
| > platform  | device.                                                |
+-------------+--------------------------------------------------------+
| > COTS      | A measurable configuration reference point of the COTS |
| > platform  | device attributes and COTS operating systems (OS) on   |
| > baseline  | which the MPoC Application may be executed. The COTS   |
|             | platform baseline is used for periodic comparative     |
|             | analysis by the back-end attestation system to         |
|             | determine changes that would impact the overall        |
|             | security of the COTS device to continue to process     |
|             | transactions.                                          |
+-------------+--------------------------------------------------------+
| > Cr        | All materials involved in the implementation of a      |
| yptographic | cryptographic algorithm or process including keys,     |
| > material  | entropy seeds, nonces, and lookup tables involved in   |
|             | the execution of the algorithm, etc.                   |
+-------------+--------------------------------------------------------+
| > De        | A deterministic algorithm to generate a sequence of    |
| terministic | numbers with little or no discernible pattern in the   |
| > Random    | numbers, except for broad statistical properties. Also |
| > Number    | referred to as Pseudo Random Number Generator (PRNG).  |
| > Generator |                                                        |
| > (DRNG)    | See [*Random Number Generator (RNG)*.](#_bookmark11)   |
+-------------+--------------------------------------------------------+
| > Dual      | Process of using two or more separate entities         |
| > control   | (usually persons) operating in concert to protect      |
|             | sensitive functions or information. Both entities are  |
|             | equally responsible for the physical protection of     |
|             | materials involved in vulnerable transactions. No      |
|             | single person is permitted to access or use the        |
|             | materials (e.g., the cryptographic key). For manual    |
|             | key generation, conveyance, loading, storage, and      |
|             | retrieval, dual control requires dividing knowledge of |
|             | the key among the entities. See [*Split                |
|             | knowledge*.](#_bookmark16)                             |
+-------------+--------------------------------------------------------+
| > Elliptic  | An approach to public-key cryptography based on        |
| > curve     | elliptic curves over finite fields.                    |
| > c         |                                                        |
| ryptography |                                                        |
| > (ECC)     |                                                        |
+-------------+--------------------------------------------------------+
| > EMVÂ®      | A payment standard that implements cryptographic       |
|             | authentication, published by EMVCo.                    |
+-------------+--------------------------------------------------------+
| > EMVCo     | A privately owned corporation. The current members of  |
|             | EMVCo are JCB International, American Express,         |
|             | Mastercard, China UnionPay, Discover Financial and     |
|             | Visa Inc.                                              |
+-------------+--------------------------------------------------------+
| >           | Process of converting information into an              |
|  Encryption | unintelligible form except to holders of a specific    |
|             | cryptographic key. Use of encryption protects          |
|             | information between the encryption process and the     |
|             | decryption process (the inverse of encryption) against |
|             | unauthorized disclosure.                               |
+-------------+--------------------------------------------------------+

> ^2^ EMVCo [(*https://www.emvco.com/*](https://www.emvco.com/))

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > Entity    | The term entity is used to represent MPoC Software     |
|             | vendors, service providers, and MPoC Solution          |
|             | providers, as applicable, that are undergoing the      |
|             | review.                                                |
+-------------+--------------------------------------------------------+
| >           | The systems and processes supporting one or more       |
| Environment | functionalities of the solution---such as the IT       |
|             | environment hosting the back-end monitoring system.    |
+-------------+--------------------------------------------------------+
| > Execution | The set of hardware and software on which a program is |
| >           | executed. This may be provided through hardware alone, |
| environment | include a combination of hardware and software         |
|             | elements, or be virtualized and implemented in         |
|             | software such that the execution environment can be    |
|             | similarly executed on different hardware platforms.    |
|             |                                                        |
|             | See [*Rich execution environment                       |
|             | (REE)*](#_bookmark12), [*Trusted execution environment |
|             | (TEE)*Trusted execution environment                    |
|             | (TEE)*,*](#_bookmark18) and                            |
|             |                                                        |
|             | [*Secure element (SE)*.](#_bookmark13)                 |
+-------------+--------------------------------------------------------+
| > Hash      | A method to protect data that converts data into a     |
|             | fixed-length message digest. A hash is a one-way       |
|             | (mathematical) function in which a non-secret          |
|             | algorithm takes any arbitrary length message as input  |
|             | and produces a fixed length output (usually called a   |
|             | "hash code" or "message digest"). Hash functions are   |
|             | required to have the following properties:             |
|             |                                                        |
|             | -   It is computationally infeasible to determine the  |
|             |     original input given only the hash code,           |
|             |                                                        |
|             | -   It is computationally infeasible to find two       |
|             |     inputs that give the same hash code.               |
+-------------+--------------------------------------------------------+
| > []{       | A code that is produced using hash algorithms rather   |
| #_bookmark7 | than a symmetric cryptographic algorithm. Defined in   |
| > .anchor   | FIPS 198-1. See [*message authentication code          |
| }Hash-based | (MAC)*.](#_bookmark9)                                  |
| > message   |                                                        |
| > aut       |                                                        |
| hentication |                                                        |
| > code      |                                                        |
| > (HMAC)    |                                                        |
+-------------+--------------------------------------------------------+
| > Integrity | Ensuring consistency of data; in particular,           |
|             | preventing unauthorized and undetected creation,       |
|             | alteration, or destruction of data.                    |
+-------------+--------------------------------------------------------+
| > Key block | A format for storage and transmission of symmetric     |
|             | cryptographic keys that embeds metadata about the key  |
|             | type and use, as well as providing cryptographic       |
|             | authentication across the encrypted key and this       |
|             | metadata to ensure that the key and its purpose cannot |
|             | be altered.                                            |
+-------------+--------------------------------------------------------+
| > []{       | A value used to identify a key without directly        |
| #_bookmark8 | revealing any bits of the actual key itself. Also      |
| >           | known as key verification check.                       |
| .anchor}Key |                                                        |
| > check     |                                                        |
| > value     |                                                        |
| > (KCV)     |                                                        |
+-------------+--------------------------------------------------------+
| > Key       | Creation of a cryptographic key either from a Random   |
| >           | Number Generator (RNG) or through a one-way process    |
|  generation | utilizing another cryptographic key.                   |
+-------------+--------------------------------------------------------+
| > Key       | The activities involving the handling of cryptographic |
| >           | keys and other related security parameters (e.g.,      |
|  management | initialization vectors, counters) during the entire    |
|             | life cycle of the keys, including their generation,    |
|             | storage, distribution, loading and use, deletion,      |
|             | destruction, and archiving.                            |
+-------------+--------------------------------------------------------+
| > Key       | See [*Key check value (KCV)*.](#_bookmark8)            |
| > v         |                                                        |
| erification |                                                        |
| > checks    |                                                        |
| > (KVC)     |                                                        |
+-------------+--------------------------------------------------------+
| > Key       | A process by which a cryptographic key is protected in |
| > wrapping  | integrity, confidentiality, or both by the generation  |
|             | of a key block to encapsulate (encrypt) the            |
|             | cryptographic key material for transport or storage.   |
+-------------+--------------------------------------------------------+

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > Magnetic  | A device that is used to read magnetic stripe cards.   |
| > stripe    | See also [*Non-PTS approved MSR*.](#_bookmark10)       |
| > reader    |                                                        |
| > (MSR)     |                                                        |
+-------------+--------------------------------------------------------+
| > Mandatory | Access control by which the operating systems (OS)     |
| > access    | constrains the ability of a process or thread to       |
| > control   | access or perform an operation on objects or targets   |
|             | such as files, directories, TCP/UDP ports, shared      |
|             | memory segments, IO devices, etc., through an          |
|             | authorization rule enforced by the operating systems   |
|             | (OS) kernel.                                           |
+-------------+--------------------------------------------------------+
| > Man-in    | An attack method where a malicious third party         |
| -the-middle | interposes between two other communicating parties and |
| > (MITM     | modifies the data sent between them.                   |
| > attack)   |                                                        |
| > attack    |                                                        |
+-------------+--------------------------------------------------------+
| > Mercha    | A deployment of a payment acceptance device or         |
| nt-attended | solution is merchant-attended where there is a         |
|             | merchant or merchant agent who is able to assist with, |
|             | or provide oversight of, the payment process.          |
+-------------+--------------------------------------------------------+
| > []{       | In cryptography, a small piece of information used to  |
| #_bookmark9 | authenticate a message. See [*Hash-based message       |
| > .anc      | authentication code (HMAC)*](#_bookmark7).             |
| hor}Message |                                                        |
| > aut       |                                                        |
| hentication |                                                        |
| > code      |                                                        |
| > (MAC)     |                                                        |
+-------------+--------------------------------------------------------+
| > Mobile    | In the context of this Standard, see [*Commercial      |
| > device    | off-the-shelf (COTS) device*.](#_bookmark6)            |
+-------------+--------------------------------------------------------+
| > Mobile    | A system for the administration of mobile devices such |
| > Device    | as smartphones, tablets, computers, laptops, and       |
| >           | desktop computers. MDM solutions may be implemented in |
|  Management | an MPoC Solution for the purposes of the secure        |
| > (MDM)     | distribution of MPoC Applications.                     |
+-------------+--------------------------------------------------------+
| > M-of-N    | An M-of-N scheme is a key component or key share       |
|             | allocation scheme, where m is the number of shares or  |
|             | components necessary to form the key, and n is the     |
|             | number of the total set of shares or components        |
|             | related to the key. Management of the shares or        |
|             | components should be sufficient to ensure that no      |
|             | subgroup of less than m persons can gain access to     |
|             | enough of the components to form the key.              |
+-------------+--------------------------------------------------------+
| >           | An MPoC Solution that is implemented without use of    |
|  Monolithic | any other listed MPoC Products (such as an MPoC        |
| > Solution  | Software Product or Attestation and Monitoring Service |
|             | provider).                                             |
+-------------+--------------------------------------------------------+
| > Mobile    | All software that implements the base functionality    |
| > Payments  | required by the Mobile Payments on COTS solution,      |
| > on COTS   | including the MPoC SDK functionality for accepting     |
| > (MPoC)    | account data and PIN entry on COTS devices (where PIN  |
| > Software  | entry is supported), API, attestation components, and  |
| >           | back-end functionality. The MPoC Software may also     |
| > (also     | include the back-end payment processing environment or |
| > MPoC      | functions.                                             |
| > Software) |                                                        |
+-------------+--------------------------------------------------------+
| > MPoC      | The Entity that is responsible for the development and |
| > Software  | maintenance of the MPoC Software.                      |
| > vendor    |                                                        |
+-------------+--------------------------------------------------------+
| > Mobile    | The set of all COTS-based software deployed as part of |
| > Payments  | the MPoC Solution that supports mobile payment         |
| > on COTS   | acceptance, A&M functionality, and protection of       |
| > (MPoC)    | account data on a COTS device. An MPoC Application may |
| >           | optionally integrate the MPoC SDK portion of a listed  |
| Application | MPoC Software product, and/or be part of an MPoC       |
| >           | Software Product.                                      |
| > (also     |                                                        |
| > MPoC      |                                                        |
| > A         |                                                        |
| pplication) |                                                        |
+-------------+--------------------------------------------------------+
| > Mobile    | The set of components and processes that supports      |
| > Payments  | mobile payment acceptance and protection of account    |
| > on COTS   | data on a COTS device. At a minimum, the solution      |
| > (MPoC)    | includes the MPoC Application, attestation system, and |
| > Solution  | the back-end systems and                               |
+-------------+--------------------------------------------------------+

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > (also     | environments that perform attestation and monitoring.  |
| > MPoC      | An MPoC Solution must implement the acceptance of      |
| > Solution) | chip-based payment cards (contact and/or contactless), |
|             | in addition to any other payment acceptance types that |
|             | it may support.                                        |
+-------------+--------------------------------------------------------+
| > Mobile    | The subset of MPoC Software, that implements required  |
| > Payments  | functionality for the payment acceptance and           |
| > on COTS   | attestation on the COTS device, and secure             |
| > (MPoC)    | communication with the back-end systems.               |
| > SDK       |                                                        |
| >           |                                                        |
| > (also     |                                                        |
| > MPoC SDK) |                                                        |
+-------------+--------------------------------------------------------+
| > MPoC      | An entity developing, distributing, and supporting the |
| > Software  | MPoC Software.                                         |
| > vendor    |                                                        |
+-------------+--------------------------------------------------------+
| > MPoC      | An entity that develops, manages, and/or deploys MPoC  |
| > Solution  | Solutions.                                             |
| > provider  |                                                        |
+-------------+--------------------------------------------------------+
| > MPoC      | The MPoC Software as validated and listed on the PCI   |
| > Software  | SSC website.                                           |
| > Product   |                                                        |
+-------------+--------------------------------------------------------+
| >           | Monitors and provisions security controls to detect,   |
|  Monitoring | alert, and mitigate suspected or actual threats and    |
| > system    | attacks against the MPoC Solution.                     |
+-------------+--------------------------------------------------------+
| > Non-de    | A Random Number Generator that has access to an        |
| terministic | entropy source and (when working properly) produces    |
| > random    | output numbers (or bit strings) that have full         |
| > number    | entropy. Contrast with a Deterministic Random Number   |
| > generator | Generator (DRNG).                                      |
| > (NRNG)    |                                                        |
+-------------+--------------------------------------------------------+
| > []{#      | An MSR that has been validated against the             |
| _bookmark10 | requirements in Appendix F of this standard.           |
| > .anc      |                                                        |
| hor}Non-PTS |                                                        |
| > approved  |                                                        |
| > MSR       |                                                        |
+-------------+--------------------------------------------------------+
| >           | Protection applied to a process or data through        |
| Obfuscation | increasing the complexity of interpreting that data.   |
|             | For the purposes of this standard, obfuscation refers  |
|             | to code obfuscation where computational processes have |
|             | been applied to increase the complexity of a code set  |
|             | to reduce the ability to reverse-engineer that code.   |
|             | Determination of an acceptable level for obfuscation   |
|             | may involve assessment against the attack costing      |
|             | methodology of this standard.                          |
+-------------+--------------------------------------------------------+
| > Offline   | In an offline EMV transaction, the card and terminal   |
| > payment   | communicate and use issuer-defined risk parameters     |
| >           | that are set in the card to determine whether the      |
| transaction | transaction can be authorized. Offline transactions    |
|             | are used when terminals do not have online             |
|             | connectivity (e.g., at a ticket kiosk) or in countries |
|             | where telecommunications costs are high.               |
+-------------+--------------------------------------------------------+
| > Operating | System software that manages the underlying hardware   |
| > system    | and software resources and provides common services    |
| > (OS)      | for programs. Common OSs used in a COTS environment    |
|             | include, but are not limited to, Android and iOS       |
|             | implementations.                                       |
+-------------+--------------------------------------------------------+
| > OS store  | A digital distribution service operated by the COTS OS |
|             | vendor or by the COTS device manufacturer used to      |
|             | distribute the MPoC Application.                       |
+-------------+--------------------------------------------------------+
| >           | Communication using a means independent of the primary |
| Out-of-band | communications means.                                  |
+-------------+--------------------------------------------------------+
| > Payment   | Back-end environment in which account data transferred |
| -processing | from the MPoC Software is decrypted and/or processed.  |
| >           |                                                        |
| environment |                                                        |
+-------------+--------------------------------------------------------+
| > PCI DSS   | The Data Security Standard published and maintained by |
|             | the Payment Card Industry Security Standards Council.  |
|             | PCI DSS provides a baseline of technical and           |
|             | operational requirements designed to protect account   |
|             | data.                                                  |
+-------------+--------------------------------------------------------+

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > Perfect   | Also known as "Forward Secrecy." A protocol has        |
| > forward   | Perfect Forward Secrecy if a compromise of long-term   |
| > secrecy   | keys does not also compromise past session keys.       |
+-------------+--------------------------------------------------------+
| >           | The specific form of protection required for an asset, |
|  Protection | including one or more of confidentiality, integrity,   |
| > types     | and authentication.                                    |
+-------------+--------------------------------------------------------+
| > Private   | A cryptographic key used with a public-key             |
| > key       | cryptographic algorithm that is uniquely associated    |
|             | with an entity and is not made public.                 |
|             |                                                        |
|             | In the case of an asymmetric signature system, the     |
|             | private key defines the signature transformation. In   |
|             | the case of an asymmetric encipherment system, the     |
|             | private key defines the decipherment transformation.   |
+-------------+--------------------------------------------------------+
| > P         | The process of ensuring that a specific instance of a  |
| rovisioning | system has the correct settings and unique data to     |
| > /         | enable its operation.                                  |
| > pers      |                                                        |
| onalization |                                                        |
+-------------+--------------------------------------------------------+
| > Public    | A cryptographic key used with a public-key             |
| > key       | cryptographic algorithm that is uniquely associated    |
|             | with an entity and may be made public.                 |
|             |                                                        |
|             | In the case of an asymmetric signature system, the     |
|             | public key defines the verification transformation. In |
|             | the case of an asymmetric encipherment system, the     |
|             | public key defines the encipherment transformation. A  |
|             | key that is "publicly known" is not necessarily        |
|             | globally available. The key may only be available to   |
|             | all members of a pre-specified group.                  |
+-------------+--------------------------------------------------------+
| > Public    | See [*asymmetric encryption*](#_bookmark4).            |
| > key       |                                                        |
| > c         |                                                        |
| ryptography |                                                        |
+-------------+--------------------------------------------------------+
| > PIN       | Back-end environment in which cardholder PINs are      |
| -processing | processed or translated for further processing.        |
| >           |                                                        |
| environment |                                                        |
+-------------+--------------------------------------------------------+
| > []{#      | The process of generating values with a high level of  |
| _bookmark11 | entropy and that satisfy various qualifications, using |
| > .an       | cryptographic and hardware-based "noise" mechanisms.   |
| chor}Random | This results in a value in a set that has equal        |
| > Number    | probability of being selected from the total           |
| > Generator | population of possibilities, hence unpredictable.      |
| > (RNG)     |                                                        |
+-------------+--------------------------------------------------------+
| > Replay    | A replay attack (also known as playback attack) is a   |
| > attack    | form of network attack in which a valid data           |
|             | transmission is maliciously or fraudulently repeated   |
|             | or delayed.                                            |
+-------------+--------------------------------------------------------+
| > []{#      | Refers to an execution environment where COTS device   |
| _bookmark12 | resources are shared by OS applications.               |
| > .         |                                                        |
| anchor}Rich |                                                        |
| > execution |                                                        |
| >           |                                                        |
| environment |                                                        |
| > (REE)     |                                                        |
+-------------+--------------------------------------------------------+
| > RSA       | Algorithm for public-key encryption described in 1977  |
|             | by Ron Rivest, Adi Shamir, and Len Adleman at          |
|             | Massachusetts Institute of Technology (MIT); letters   |
|             | RSA are the initials of their surnames.                |
+-------------+--------------------------------------------------------+
| > Secure    | See [*trusted boot*](#_bookmark17).                    |
| > boot      |                                                        |
+-------------+--------------------------------------------------------+
| > Secure    | A physical card reader that has been assessed          |
| > Card      | compliant to the PCI PTS SCRP Approval Class and is    |
| > Reader -- | listed on the PTS listing website.                     |
| > PIN       |                                                        |
| > (SCRP)    |                                                        |
+-------------+--------------------------------------------------------+
| > Secure    | A physically or logically protected connection between |
| > channel   | two points.                                            |
+-------------+--------------------------------------------------------+

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > Secure    | A physically and logically protected hardware device   |
| > cr        | that provides a secure set of cryptographic services.  |
| yptographic | It includes the set of hardware, firmware, software,   |
| > device    | or some combination thereof that implements            |
| > (SCD)     | cryptographic logic, cryptographic processes, or both, |
|             | including cryptographic algorithms. Examples include   |
|             | ANSI X9.24 part 1 and ISO 13491.                       |
+-------------+--------------------------------------------------------+
| > []{#      | A tamper-resistant platform (typically a one-chip      |
| _bookmark13 | secure microcontroller) capable of hosting             |
| > .an       | applications and their confidential and cryptographic  |
| chor}Secure | data (e.g., key management) securely.                  |
| > element   |                                                        |
| > (SE)      |                                                        |
+-------------+--------------------------------------------------------+
| > Secure    | Requirements within the PCI PTS POI Standard,          |
| > reading   | detailing testing for devices that protect account     |
| > and       | data.                                                  |
| > exchange  |                                                        |
| > of data   |                                                        |
| > (SRED)    |                                                        |
+-------------+--------------------------------------------------------+
| > Security  | Within a COTS device, a security processor is a        |
| > processor | separate processor or co-processor with its own        |
|             | dedicated memory running separate OS, applications and |
|             | data on these processors are not accessible by the     |
|             | COTS device's main OS.                                 |
+-------------+--------------------------------------------------------+
| > []{#      | Security-related information used to authenticate      |
| _bookmark14 | cardholders and/or authorize payment card              |
| > .ancho    | transactions. This information includes, but is not    |
| r}Sensitive | limited to, card validation verification codes/values, |
| > aut       | full track data (from magnetic stripe or equivalent on |
| hentication | a chip), PINs, and PIN blocks.                         |
| > data      |                                                        |
+-------------+--------------------------------------------------------+
| > []{#      | For the purposes of this standard, security assets     |
| _bookmark15 | include assets that require protection by, or be used  |
| > .ancho    | to provide protection to, the MPoC Solution (e.g.,     |
| r}Sensitive | cryptographic keys, or account data).                  |
| > assets    |                                                        |
+-------------+--------------------------------------------------------+
| > Sensitive | A sensitive service is any service that may affect the |
| > services  | security of the overall system, as well as those       |
|             | functions that affect underlying processes that        |
|             | support the protection of assets---e.g., cryptographic |
|             | keys and account data. Common examples are key         |
|             | management, modification, or update of attestation     |
|             | services, or remote component of contactless kernels   |
|             | (or other remote processing components) and            |
|             | cryptographic signing of assets to allow their         |
|             | authenticity to be verified.                           |
+-------------+--------------------------------------------------------+
| > Service   | An entity responsible for deployment, operation, and   |
| > provider  | management of the back-end monitoring; attestation;    |
|             | PIN processing; and account data processing            |
|             | environments.                                          |
+-------------+--------------------------------------------------------+
| > Software  | Methods and implementations used to protect against    |
| -protection | the reverse-engineering and modification of software,  |
| >           | including, but not limited to, hooking, rooting,       |
|  mechanisms | emulation or debugging detection, verification, and    |
|             | validation of software.                                |
+-------------+--------------------------------------------------------+
| > Softwar   | A method used to obfuscate the execution of a          |
| e-protected | cryptographic algorithm in software, including the     |
| > c         | protection of the cryptographic key, with the goal of  |
| ryptography | making determination of the key value computationally  |
|             | complex.                                               |
+-------------+--------------------------------------------------------+
| > []{#      | A condition under which two or more entities           |
| _bookmark16 | separately have key components or key shares that      |
| > .a        | individually convey no knowledge of the resultant      |
| nchor}Split | cryptographic key. The information needed to perform a |
| > knowledge | process such as key formation is split among two or    |
|             | more people. No individual has enough information to   |
|             | gain knowledge of any part of the actual key that is   |
|             | formed.                                                |
+-------------+--------------------------------------------------------+
| > Symmetric | Same symmetric key that is used for encryption is also |
| > key       | used for decryption. Also known as "secret key."       |
+-------------+--------------------------------------------------------+
| > Tamper    | A characteristic that provides evidence that an attack |
| > detection | has been attempted.                                    |
+-------------+--------------------------------------------------------+

+-------------+--------------------------------------------------------+
| > **Term**  | > **Definition**                                       |
+=============+========================================================+
| > Tamper    | A characteristic that provides passive protection      |
| > resistant | against an attack.                                     |
+-------------+--------------------------------------------------------+
| > Tamper    | A characteristic that provides an active response to   |
| >           | the detection of an attack, thereby preventing a       |
|  responsive | successful attack.                                     |
+-------------+--------------------------------------------------------+
| > []{#      | Also known as Verified Boot and Secure Boot. A         |
| _bookmark17 | cryptographic process where the bootloader verifies    |
| > .anc      | the integrity of all components (e.g., kernel objects) |
| hor}Trusted | loaded during the OS startup process, but prior to     |
| > boot      | loading.                                               |
+-------------+--------------------------------------------------------+
| > []{#      | A trusted execution environment provides               |
| _bookmark18 | hardware-based security features such as isolated      |
| > .anc      | execution environment for Trusted Applications. It     |
| hor}Trusted | isolates sensitive assets and code from the Rich       |
| > execution | Execution Environment (REE).                           |
| >           |                                                        |
| environment |                                                        |
| > (TEE)     |                                                        |
+-------------+--------------------------------------------------------+
| >           | A deployment of a payment acceptance device or         |
|  Unattended | solution is unattended where there is no merchant or   |
| >           | merchant agent who is able to assist with, or provide  |
| > (also not | oversight of, the payment process.                     |
| > merchan   |                                                        |
| t-attended) |                                                        |
+-------------+--------------------------------------------------------+
| > User      | The set of the human-machine interfaces that allows    |
| > interface | for interaction between a person and a computerized    |
| > (UI)      | system.                                                |
+-------------+--------------------------------------------------------+
| > vTEE      | A virtualized trusted execution environment (TEE) that |
|             | provides logical security features to isolate the      |
|             | execution environment for Trusted Applications. A type |
|             | of software-protection mechanism.                      |
+-------------+--------------------------------------------------------+
| > White-box | A type of software-protected cryptography.             |
| > c         |                                                        |
| ryptography |                                                        |
+-------------+--------------------------------------------------------+

# Scope of Mobile Payments on COTS Standard

> In traditional merchant-facing card-based payment scenarios, account
> data (e.g., PAN, PIN, etc.) is entered into a device specifically
> designed for protecting this data, such as a PCI PTS POI approved PIN
> entry device (PED). The payment industry recognizes PEDs that have
> been independently tested and comply with detailed security
> requirements developed by PCI to ensure the confidentiality,
> integrity, and availability of the PIN data. Traditional PEDs rely on
> hardware protections as the primary mechanisms to ensure the security
> of PIN data within the device. Merchants use traditional PEDs to
> support cardholder PIN acceptance.

##### Figure 1: Traditional PIN Acceptance Solution Overview

![](vertopal_465415c1b298463ba932b756b3983353/media/image3.png){width="3.3458606736657917in"
height="2.9248950131233595in"}

> Mobile payment acceptance enables the processing of payment
> transactions (e.g., using a smartphone or tablet that performs the
> functions of an electronic point-of-sale terminal). These solutions
> rely on a combination of mechanisms and security controls including,
> but not limited to, COTS device hardware, application software, and
> independent management and oversight of the entire process to ensure
> the security of the transaction and the cardholder verification data.
>
> ***Note:** MPoC Solutions are intended for a merchant-attended
> environment only.*

## Mobile Payments on COTS---Payment Acceptance Channels and Cardholder Verification Methods

> This standard is designed to allow mobile payment solutions to support
> multiple payment-acceptance channels and cardholder verification
> methods. For example, one solution could support a COTS-native NFC
> interface without PIN entry, while another solution could be designed
> to support COTS-native-NFC interfaces for contactless card entry with
> PIN, as well as also supporting PCI PTS SCRP devices.
>
> [Figure
> 2](#figure-2-mobile-payments-on-cots-solution-showing-various-cvm-and-account-data-acceptance-options)
> shows the functional model of the solution that uses a software MPoC
> Application, with the option of additional hardware in the form of PCI
> PTS SCRP or Magnetic Stripe Reader (non-PTS approved MSR), for
> protecting account data.
>
> This standard defines the requirements for assessment to validate
> candidate MPoC Products prior to it being listed on the PCI SSC
> website. For details on compliance programs outlining the use of
> listed MPoC Products, please refer to the relevant payment card
> brands.

##### Figure 2: Mobile Payments on COTS Solution Showing Various CVM and Account Data Acceptance Options

![](vertopal_465415c1b298463ba932b756b3983353/media/image4.png){width="7.766416229221347in"
height="3.3235411198600175in"}

> The standard currently supports the following payment acceptance
> channels:

-   COTS-native NFC interface

-   PCI PTS SCRP devices for contact, contactless, and MSR-based
    transactions

-   Non-PTS approved MSR devices validated through the MSR appendix of
    this standard

-   Manually entered account data and cardholder verification methods

-   COTS-native PIN entry

-   No CVM

-   CDCVM

> Support for any of the payment acceptance channels and/or CVMs
> described above is optional -- the only requirement is that an MPoC
> Solution, or MPoC Software Product, must support chip-based payments
> and at least one COTS-native method of entry. As examples, an MPoC
> Solution may support COTS-native NFC and COTS-native PIN entry on the
> same device, it may support COTS-native NFC without PIN, or it may
> support account data entry through external readers only with
> COTS-native PIN.
>
> However, an MPoC Solution (or MPoC Software Product) may not support
> only MSR or manual entry-based payments, or methods of account data
> entry performed exclusively through a PCI PTS SCRP, without any
> COTS-native account data entry methods. Individual transactions are
> exempt from this requirement; any individual transaction may be MSR
> based, or exclusively use a PCI PTS SCRP -- as long as the overall
> MPoC Solution (or MPoC Software Product if that is the MPoC Product
> under assessment) supports at least one COTS-native account data entry
> method.
>
> Where the MPoC Software supports any of the above methods it must meet
> and be validated to the applicable security requirements described in
> the optional Modules in *[Domain
> 1:](#domain-1-mpoc-software-core-requirements) [MPoC Software Core
> Requirements](#domain-1-mpoc-software-core-requirements)*.

## Mobile Payments on COTS---Security Model

> The security model of an MPoC Solution relies in large part (but not
> entirely) on mechanisms that support attestation and monitoring (to
> ensure the security mechanisms are intact and operational), detection
> (to notify when anomalies are present), and response (controls to
> alert and take action). The online nature of COTS devices provides
> opportunities to extend these capabilities to back-end monitoring
> systems.
>
> In addition, COTS devices that have specialized hardware-based
> security mechanisms, such as secure element (SE) or trusted execution
> environment, may use these mechanisms for secure storage or processing
> of cryptographic material or account data, or for functions supporting
> the attestation of the COTS device.
>
> There are, however, individual components of a software solution where
> there is limited control (e.g., the underlying COTS platform). Because
> these are COTS devices, there is an assumption that these components
> (e.g., COTS OS, configuration of hardware components of a phone, etc.)
> are unknown or untrusted. It must be assumed that an attacker has full
> access to the software that executes on any unknown or untrusted
> platform where that "software" may be a binary executable, interpreted
> bytecode, etc., as it is loaded onto the platform. Therefore, it
>
> is important for the MPoC Software to provide inherent protections
> that complicate reverse engineering and tampering of the code
> execution flow on the COTS platforms to which it is deployed. This may
> include, but is not limited to, protections using obfuscation of the
> code, internal integrity checks for code and processing flows,
> encryption of code segments, etc.
>
> The architecture of an MPoC Solution relies on the following
> components that combine to provide for protection, attestation,
> detection, and response controls:

-   A COTS device that is operated by the merchant to run the MPoC
    Application. The COTS device may have a TEE or secure element
    built-in, but this is not a requirement.

-   MPoC Application that resides on the COTS device and:

    -   Collects and passes attestation data about any attached hardware
        systems (such as a PCI PTS SCRP or non-PTS approved MSR), COTS
        platform, and MPoC Application to the attestation and monitoring
        back-end systems.

    -   Contains software protection mechanisms to maintain its own
        integrity against attack.

    -   Securely communicates account data (and other sensitive assets
        such as cardholder PINs, where these are supported and used) to
        back-end systems.

    -   (Optional) a secure UI for entry of account data entry methods
        (such as PIN, PAN, or security codes), and encryption of this
        data.

    -   (Optional) a secure method for the entry and encryption of the
        account data acquired through COTS-native NFC read.

-   Set of back-end systems that perform functions for the MPoC Solution
    such as:

    -   Attestation and monitoring systems process attestation data from
        the MPoC Application and enforce pre-established security
        policies as well as provision security controls to detect,
        alert, and mitigate suspected or actual threats and attacks
        against the PCI PTS SCRP, MPoC Application, and the COTS
        device*.*

    -   Processing environment that receives encrypted account data,
        cardholder data and, if applicable, cardholder verification
        method (e.g., PIN data from the PCI PTS SCRP).

-   (Optional) PCI PTS SCRP or non-PTS approved MSR device that supports
    the solution. The PCI PTS SCRP is SRED-enabled and connected to the
    COTS device. The PCI PTS SCRP optionally provides:

    -   Protection of account data

    -   Translation of PIN data for forward processing

    -   Secure random seeding and signing

# MPoC SDKs and MPoC Applications

> All software within an MPoC Software product, or software within a
> monolithic MPoC Solution that provides for the security of MPoC assets
> such as account data or cryptographic keys, must be assessed to
> *[Domain 1:](#domain-1-mpoc-software-core-requirements) [MPoC Software
> Core Requirements.](#domain-1-mpoc-software-core-requirements)* This
> includes any applicable optional Modules corresponding with the
> supported payment acceptance channels and cardholder verification
> methods (such as COTS-native PIN entry, or COTS-native NFC).
>
> The MPoC Software is considered as two separate parts -- the MPoC SDK
> (intended for integration into an MPoC Application) or complete MPoC
> Application itself, and the back-end software including the MPoC
> Attestation and Monitoring software. The MPoC SDK or MPoC Application
> execute on the COTS platform, although they may include remote
> execution components (such as a remote kernel).
>
> Any MPoC Application may optionally support APIs that accept
> non-sensitive payment initiation data, such as an amount, from another
> "calling" application or function. This allows for an MPoC Solution to
> provide for payment initiation from applications outside of the scope
> of MPoC validation and listing -- by providing an API through which an
> MPoC Application may receive non-sensitive payment initiation and
> response data (such as amount).
>
> Therefore, there are three types of COTS software considered in an
> MPoC Solution:

1.  The MPoC SDK, which is designed to be integrated into an MPoC
    Application.

2.  The MPoC Application itself, which may or may not integrate an MPoC
    SDK.

3.  A \'calling application,' which can interface to APIs exposed by the
    MPoC Application to initiate payment acceptance (not in scope of
    MPoC assessment).

> For any MPoC SDK, the following methods of integrating a set of
> pre-developed software as a component of an MPoC Solution have been
> considered in the creation of this standard:

-   Software that is designed and implemented as an entirely separate
    MPoC Application from a "calling application" executed in a
    completely separated execution environment (e.g., SE/TEE).

-   Software that is an entirely separate MPoC Application executed in
    the same runtime environment as a calling application, invoked
    through OS APIs (e.g., Intent on Android) by that calling
    application.

-   Software that is integrated into the MPoC Application as a
    pre-compiled code (e.g., library).

-   Software that is integrated into the MPoC Application as source
    code, which is compiled with the MPoC Application (this is not a
    permitted implementation for an MPoC Software product).

> Due to the risk of modification of the MPoC Software, this standard
> does not allow for an MPoC SDK that is distributed and integrated as
> source code.
>
> ***Note:** An MPoC Application may integrate up to two MPoC SDKs.*

## MPoC SDK Types and MPoC Application Implementations

> An MPoC SDK, where one exists, may be implemented as one of two types:

-   An Isolated MPoC SDK

> An Isolated MPoC SDK must provide for sufficient isolation of its
> memory space and be validated during the laboratory assessment that
> cleartext sensitive assets, such as account data or cryptographic
> keys, are not accessible by an MPoC Application that integrates that
> SDK.

-   A non-Isolated MPoC SDK

> A non-Isolated MPoC SDK is an MPoC SDK that is unable to be validated
> to provide sufficient isolation to the cleartext sensitive assets from
> the MPoC Application.
>
> In each case, the validation of "sufficient isolation" is based on the
> laboratory assessment and costing framework outlined in the MPoC
> standard. Assets that are already sufficiently protected, e.g.,
> through the use of cryptography or truncation (for PANs), are not
> considered in the determination of an Isolated or non-Isolated SDK.
>
> In all cases, an Isolated MPoC SDK cannot allow for sensitive
> cleartext data to be exposed to the MPoC Application, even if that
> functionality is optional or provided by some back-end function
> related to the MPoC Software. This is because the goal of an Isolated
> MPoC SDK is to prevent access to the sensitive assets -- regardless of
> if this access is intended or not -- so that even if the MPoC
> Application is compromised, the sensitive assets remain secure. There
> can be no APIs or methods exposed that would allow for that
> compromised MPoC Application to gain access to those sensitive assets
> in cleartext.
>
> Based on these two types of MPoC SDK, the MPoC standard additionally
> supports the implementation of MPoC Applications in three different
> ways:

1.  Monolithic MPoC Applications that do not integrate an MPoC SDK from
    a listed MPoC Software Product.

> These types of MPoC Applications must be assessed to all relevant
> Domain 1 requirements (only requirements covering account data entry
> methods supported by the MPoC Application are assessed). Monolithic
> MPoC Applications are assessed to Section 2B of the MPoC standard.

2.  MPoC Applications that integrate a non-Isolating MPoC SDK.

> These types of MPoC Applications integrate an MPoC SDK, from a listed
> MPoC Software Product, that has not been validated to provide memory
> and cleartext asset isolation. MPoC Applications that integrate a
> non-Isolating MPoC SDK must be assessed to all requirements of Domain
> 2 of the MPoC standard.

3.  MPoC Applications that correctly integrate Isolating MPoC SDKs only.

> These types of MPoC Applications integrate an MPoC SDK, from a listed
> MPoC Software Product, that has been validated to provide memory and
> cleartext asset isolation. MPoC Applications that correctly integrate
> only Isolating MPoC SDKs may be assessed to the Section 2A
> requirements of Domain 2 of the MPoC standard only.
>
> If the MPoC Application does not correctly integrate an Isolating MPoC
> SDK, or the MPoC Application bypasses, modifies, or supplements the
> payment and/or security features of the Isolating MPoC SDK, then the
> MPoC Application must also be validated against the requirements of
> Section 2B of Domain 2.
>
> An MPoC Application is permitted to integrate up to two MPoC SDKs
> (although this is a not a requirement, and integration of one or no
> MPoC SDKs is also permitted). An MPoC Application that integrates a
> non-Isolating MPoC SDK is always assessed against all requirements of
> Domain 2. Therefore, an MPoC Application that integrates two MPoC
> SDKs, where one is an Isolating SDK and one is a non-Isolating SDK, is
> required to be assessed against all requirements of Domain 2 even
> though one of the MPoC SDKs it integrates is an Isolating SDK.
>
> A monolithic MPoC Application, or MPoC SDK of either type, may be
> implemented in part or whole outside the REE of the COTS device, e.g.,
> as a "trustlet" executed within a TEE, which provides for the GUI and
> other interfaces necessary to provide the required account data
> inputs.
>
> An MPoC Application may be included as part of an MPoC Software
> Product as well as part of an MPoC Solution. For example, an MPoC
> Software product may be listed as providing an Isolating MPoC SDK, a
> non-Isolating MPoC SDK, and/or a complete MPoC Application (which may
> itself integrate an MPoC SDK from the same MPoC Software Product).
>
> MPoC Applications that access account data are to be assessed against
> the requirements of Domain 1, regardless of if they integrate an MPoC
> SDK (or either type) or not.
>
> An Isolated SDK may share some assets or configurations with the
> integrating MPoC Application, such as permissions with determine
> access to underlying COTS Platform systems, as long as those shared
> assets/configurations do not expose cleartext sensitive assets. For
> example, permission to access a hardware-backed keystore that contains
> encryption keys used to protect the sensitive assets could be shared
> between an Isolating MPoC SDK and the integrating MPoC Application, as
> long as those keys could not be used for decryption (as this would
> allow a compromised MPoC Application to remove the protection provided
> by the encryption processes).
>
> [Figure 3](#figure-3-examples-of-mpoc-application-implementations)
> illustrates the different types of MPoC Application and MPoC SDK.

##### Figure 3: Examples of MPoC Application Implementations

![](vertopal_465415c1b298463ba932b756b3983353/media/image5.png){width="7.538957786526685in"
height="3.8072911198600177in"}

# MPoC Domain and Section Applicability

> An MPoC Solution may involve up to three types of Entities -- an MPoC
> Solution provider, an MPoC Software vendor, and an MPoC Attestation
> and Monitoring Service provider. The MPoC requirements applicable to
> each are illustrated below. An MPoC Solution that includes no other
> listed MPoC Products is always considered a monolithic MPoC Solution.
>
> The MPoC standard allows for an entity to take on more than one role
> in an MPoC Solution. For example, an MPoC Software vendor may choose
> to also take the role of an MPoC Solution provider while outsourcing
> the A&M operation to an MPoC Attestation and Monitoring Service
> provider. In this case, the MPoC Solution may consist of an MPoC
> Application that exposes payment APIs for other applications to call,
> rather than an MPoC SDK to be integrated into new MPoC Applications
> (although this would also be possible).
>
> In another example, an MPoC Software vendor may take the role of an
> A&M Service provider themselves, operating their back-end software for
> different MPoC Solution providers. Other possible combinations also
> exist. However, in all cases, the requirements that apply to that role
> will apply to any entity taking on that role. Only validated MPoC
> Solutions are permitted to be deployed for payment acceptance -- it is
> not acceptable to have an MPoC Software Product performing payment
> acceptance without integration into an MPoC Solution, even if that
> MPoC Software Product is listed and includes an MPoC Application.
>
> A monolithic MPoC Solution does not use any other listed MPoC
> Products, and therefore must always use a monolithic MPoC Application,
> and an internally developed and operated Attestation and Monitoring
> system. If an entity wants to create an MPoC Solution with MPoC
> Applications that integrate an MPoC SDK, and/or that uses an
> outsourced Attestation and Monitoring Service, that MPoC Solution must
> be based on a listed MPoC Software Product.
>
> When reviewing the table below, consideration to the divide between
> the development and operational Domains of the MPoC standard is
> important. For example, MPoC Software is required to provide both an
> MPoC SDK component and/or MPoC Application (that executes on the COTS
> platform) and a back-end A&M component. The assessment of the
> technical and development aspects of these MPoC Software components is
> performed in Domain 1. However, the operational aspects of using these
> MPoC Software components is assessed in Domain 3 and 4.

##### Table 2: MPoC Requirements Applicability Matrix

+--------------------------+---------+--------+-------+------+------+
| > **MPoC Solution        |         |        |       |      |      |
| > Provider**             |         |        |       |      |      |
+==========================+=========+========+=======+======+======+
| > **MPoC Software Core   | > **Mon | > *    | > **  | >    | >    |
| > Requirements**         | olithic | *Using | Using | **MP |  **A |
|                          | > MPoC  | >      | > L   | oC** | &M** |
|                          | > Sol   | Listed | isted | >    | >    |
|                          | ution** | > MPoC | > M   | > ** | > *  |
|                          |         | > Soft | PoC** | Soft | *Ser |
|                          |         | ware** | >     | ware | vice |
|                          |         |        | >     | >    | > Pr |
|                          |         |        | **Sof | Vend | ovid |
|                          |         |        | tware | or** | er** |
|                          |         |        | > and |      |      |
|                          |         |        | > A&M |      |      |
|                          |         |        | >     |      |      |
|                          |         |        |  Serv |      |      |
|                          |         |        | ice** |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Domain 1: Module 1A: |         |        |       |      |      |
| > CORE**                 |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1A-1 Secure Software   | ï¼       |        |       | ï¼    |      |
| > Requirements           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1A-2 Random Numbers    | ï¼       |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > 1A-3 Acceptable        | ï¼       |        |       | ï¼    |      |
| > Cryptography           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1A-4 Key Management    | ï¼       |        |       | ï¼    |      |
| > Design                 |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1A-5 Secure Channels   | ï¼       |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > 1A-6 Third-Party APIs  | ï¼       |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 1B: MPoC SDK  |         |        |       |      |      |
| > Software Protection**  |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1B-1 Software Security | ï¼       |        |       | ï¼    |      |
| > Mechanisms             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1B-2                   | ï¼       |        |       | ï¼    |      |
| > Software-Protected     |         |        |       |      |      |
| > Cryptography           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 1C:           |         |        |       |      |      |
| > Attestation and        |         |        |       |      |      |
| > Monitoring Software**  |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1C-1 Coverage          | ï¼       |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > 1C-2                   | ï¼       |        |       | ï¼    |      |
| > Measurements/Detection |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1C-3 Response          | ï¼       |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > 1C-4 Anti-Tampering    | ï¼       |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > 1C-5 A&M Integration   |         |        |       | ï¼    |      |
| > Guidance               |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+

+--------------------------+---------+--------+-------+------+------+
| > **MPoC Solution        |         |        |       |      |      |
| > Provider**             |         |        |       |      |      |
+==========================+=========+========+=======+======+======+
| > **MPoC Software Core   | > **Mon | > *    | > **  | >    | >    |
| > Requirements**         | olithic | *Using | Using | **MP |  **A |
|                          | > MPoC  | >      | > L   | oC** | &M** |
|                          | > Sol   | Listed | isted | >    | >    |
|                          | ution** | > MPoC | > M   | > ** | > *  |
|                          |         | > Soft | PoC** | Soft | *Ser |
|                          |         | ware** | >     | ware | vice |
|                          |         |        | >     | >    | > Pr |
|                          |         |        | **Sof | Vend | ovid |
|                          |         |        | tware | or** | er** |
|                          |         |        | > and |      |      |
|                          |         |        | > A&M |      |      |
|                          |         |        | >     |      |      |
|                          |         |        |  Serv |      |      |
|                          |         |        | ice** |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 1D: Secure    |         |        |       |      |      |
| > Entry and Processing   |         |        |       |      |      |
| > of Account Data**      |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1D-1 Account Data      | > ï¼     |        |       | ï¼    |      |
| > Entry and Encryption   |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1D-2 Use of PCI PTS    | > 1     |        |       | 1    |      |
| > POI-approved Devices   |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1D-3 Magnetic Stripe   | > 1     |        |       | 1    |      |
| > Data                   |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1D-4 COTS-native NFC   | > 2     |        |       | 2    |      |
| > Interface              |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1D-5 Manual Entry      | > 1     |        |       | 1    |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 1E: PIN Entry |         |        |       |      |      |
| > on COTS Device**       |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1E-1 COTS-native PIN   | > 2     |        |       | 2    |      |
| > Entry                  |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 1F: Offline   |         |        |       |      |      |
| > Payment Transactions** |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1F-1 Offline Payment   | > 1     |        |       | 1    |      |
| > Transactions           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1F-2 Offline           | > 1     |        |       | 1    |      |
| > Monitoring             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 1G: MPoC      |         |        |       |      |      |
| > Software Security      |         |        |       |      |      |
| > Guidance**             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 1G-1 Security Guidance | > 3     |        |       | ï¼    |      |
+--------------------------+---------+--------+-------+------+------+
| > **Domain 2: MPoC       |         |        |       |      |      |
| > Application            |         |        |       |      |      |
| > Integration Module 2A: |         |        |       |      |      |
| > MPoC Software          |         |        |       |      |      |
| > Integration**          |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 2A-1 Secure MPoC SDK   | > 3     | > ï¼    | ï¼     |      |      |
| > Integration and Usage  |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 2B: MPoC      |         |        |       |      |      |
| > Application security** |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 2B-1 MPoC Application  | > ï¼     | > 4    | 4     |      |      |
| > Security               |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+

+--------------------------+---------+--------+-------+------+------+
| > **MPoC Solution        |         |        |       |      |      |
| > Provider**             |         |        |       |      |      |
+==========================+=========+========+=======+======+======+
| > **MPoC Software Core   | > **Mon | > *    | > **  | >    | >    |
| > Requirements**         | olithic | *Using | Using | **MP |  **A |
|                          | > MPoC  | >      | > L   | oC** | &M** |
|                          | > Sol   | Listed | isted | >    | >    |
|                          | ution** | > MPoC | > M   | > ** | > *  |
|                          |         | > Soft | PoC** | Soft | *Ser |
|                          |         | ware** | >     | ware | vice |
|                          |         |        | >     | >    | > Pr |
|                          |         |        | **Sof | Vend | ovid |
|                          |         |        | tware | or** | er** |
|                          |         |        | > and |      |      |
|                          |         |        | > A&M |      |      |
|                          |         |        | >     |      |      |
|                          |         |        |  Serv |      |      |
|                          |         |        | ice** |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Domain 3:            |         |        |       |      |      |
| > Attestation and        |         |        |       |      |      |
| > Monitoring**           |         |        |       |      |      |
| >                        |         |        |       |      |      |
| > **Module 3A: MPoC      |         |        |       |      |      |
| > Software               |         |        |       |      |      |
| > Implementation Guide   |         |        |       |      |      |
| > Compliance**           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 3A-1 Deployment &      |         | ï¼      |       |      | ï¼    |
| > Config of Back-end     |         |        |       |      |      |
| > Systems                |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 3B:           |         |        |       |      |      |
| > Baseline**             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 3B-1 COTS Platform     | ï¼       | ï¼      |       |      | ï¼    |
| > Baseline &             |         |        |       |      |      |
| > Vulnerability          |         |        |       |      |      |
| > Management             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Module 3C:           |         |        |       |      |      |
| > Attestation and        |         |        |       |      |      |
| > Monitoring**           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 3C-1 Attestation and   | ï¼       | ï¼      |       |      | ï¼    |
| > Monitoring Policy      |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 3C-2 Monitoring        | ï¼       | ï¼      |       |      | ï¼    |
+--------------------------+---------+--------+-------+------+------+
| > **Module 3D:           |         |        |       |      |      |
| > Operational Security** |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 3D-1 Operational       | ï¼       | ï¼      |       |      | ï¼    |
| > Management             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Domain 4: MPoC       |         |        |       |      |      |
| > Software Management    |         |        |       |      |      |
| > Module 4A: Software    |         |        |       |      |      |
| > Management**           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 4A-1 COTS Software     | ï¼       | ï¼      | ï¼     | 5    |      |
| > Distribution and       |         |        |       |      |      |
| > Updates                |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 4A-2 Key Management    | ï¼       |        | ï¼     | 6    | ï¼    |
| > Operations             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 4A-3 Penetration       | ï¼       | ï¼      | ï¼     |      | ï¼    |
| > Testing and            |         |        |       |      |      |
| > Vulnerability          |         |        |       |      |      |
| > Management             |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+

+--------------------------+---------+--------+-------+------+------+
| > **MPoC Solution        |         |        |       |      |      |
| > Provider**             |         |        |       |      |      |
+==========================+=========+========+=======+======+======+
| > **MPoC Software Core   | > **Mon | > *    | > **  | >    | >    |
| > Requirements**         | olithic | *Using | Using | **MP |  **A |
|                          | > MPoC  | >      | > L   | oC** | &M** |
|                          | > Sol   | Listed | isted | >    | >    |
|                          | ution** | > MPoC | > M   | > ** | > *  |
|                          |         | > Soft | PoC** | Soft | *Ser |
|                          |         | ware** | >     | ware | vice |
|                          |         |        | >     | >    | > Pr |
|                          |         |        | **Sof | Vend | ovid |
|                          |         |        | tware | or** | er** |
|                          |         |        | > and |      |      |
|                          |         |        | > A&M |      |      |
|                          |         |        | >     |      |      |
|                          |         |        |  Serv |      |      |
|                          |         |        | ice** |      |      |
+--------------------------+---------+--------+-------+------+------+
| > **Domain 5: MPoC       |         |        |       |      |      |
| > Solution**             |         |        |       |      |      |
| >                        |         |        |       |      |      |
| > **Module 5A: Third     |         |        |       |      |      |
| > Party Management**     |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 5A-1 Merchant          | ï¼       | ï¼      | ï¼     |      |      |
| > Identification and     |         |        |       |      |      |
| > Communication          |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 5A-2 Support for       | ï¼       | ï¼      | ï¼     |      |      |
| > Multiple Entities in   |         |        |       |      |      |
| > the Solution           |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+
| > 5A-3 Security of       | ï¼       | ï¼      | ï¼     |      |      |
| > Back-end Systems       |         |        |       |      |      |
+--------------------------+---------+--------+-------+------+------+

> **Notes:**
>
> 1,2 These requirements are to be assessed for MPoC Products that
> support these methods of account data presentment and processing.

2.  An MPoC Solution or MPoC Software Product must implement one or both
    of COTS-native NFC or COTS-native PIN entry.

3.  This Module is only applicable if MPoC Applications integrating an
    MPoC SDK are supported.

4.  This Module is only applicable to MPoC Applications that integrate a
    non-Isolating MPoC SDK, or that are found to not correctly integrate
    an Isolating MPoC SDK.

5.  This Section only applies to an MPoC Software vendor when an aspect
    of the MPoC Software product is directly distributed to merchants or
    end users.

6.  This Section only applies to an MPoC Software vendor when the MPoC
    Software vendor performs ongoing key management operations, such as
    updates to software protected cryptography.

# Example MPoC Implementations

> This section provides some examples of how an MPoC Solution may be
> realized. The examples provided are non-exhaustive, and other types of
> implementations -- with different combinations of listed MPoC Products
> and MPoC Applications -- may be possible.

## Monolithic MPoC Solution Examples

> A monolithic MPoC Solution is defined by the fact that it does not
> integrate or use any other listed MPoC Products. A monolithic MPoC
> Solution may include or use external card readers, such as a PCI PTS
> SCRP or non-PTS approved MSR. Monolithic MPoC Solutions are assessed
> to all Domains of the MPoC Standard, although some
> Modules/Sections/requirements may not apply where these are scoped
> solely for the integration or assessment of different MPoC Product or
> account data entry types. Refer to Section: [MPoC Domain and
> Section](#mpoc-domain-and-section-applicability)
> [Applicability](#mpoc-domain-and-section-applicability) above for
> details on the specific Modules and Sections that may apply.
>
> A monolithic MPoC Solution may implement multiple MPoC Applications,
> each with different account data entry methods and CVM support. For
> example, a monolithic MPoC Solution may have four MPoC Applications,
> split across two different operating systems. For each operating
> system there may be one MPoC Application that supports COTS-native NFC
> (with optional PIN as CVM), and one MPoC Application that supports
> card reading through a PCI PTS SCRP (with optional PIN as CVM).
>
> Alternatively, this example MPoC Solution may support only two MPoC
> Applications -- with a single MPoC Application on each supported OS
> providing for both PCI PTS SCRP and COTS-native NFC reading (both with
> optional PIN as CVM).
>
> In all cases, a monolithic MPoC Solution will develop its own MPoC
> Applications and implement its own Attestation and Monitoring systems
> to support the MPoC Application(s) it deploys.

## MPoC Solution implementing a single MPoC Software Product with an Attestation and Monitoring Service

> An MPoC Solution that integrates or uses one or more listed MPoC
> Products is no longer considered a monolithic MPoC Solution. In this
> example, an MPoC Solution integrates a single MPoC Software Product --
> integrating the MPoC SDK into one or more MPoC Applications -- and (in
> this example) also relies on the use of a listed Attestation and
> Monitoring Service provider who supports the same MPoC Software
> Product that includes the MPoC SDK that is used.
>
> In this example, the MPoC SDK being integrated supports an external
> non-PTS approved MSR and COTS-native NFC (with optional PIN support
> for the contactless payment channel). The MPoC Solution is deploying
> two MPoC Applications - one of the MPoC Applications implements both
> payment acceptance channels supported by the SDK (COTS-native NFC and
> non-PTS approved MSR), and one implements only the COTS-native NFC
> (with optional PIN) functions of the MPoC SDK.
>
> In this case, the MPoC Solution would not be assessed against Domain 1
> or Domain 3, as it is not implementing its own software or attestation
> and monitoring systems as part of the core of the MPoC Solution (if
> the MPoC Solution were to implement its own attestation and monitoring
> systems, based on the MPoC Software Product used, Domain 3 assessment
> would be included). The MPoC Applications would be assessed against
> Domain 2, either Module 2A only (if the MPoC SDK is an Isolating SDK
> and is found to be correctly implemented), or both Modules 2A and 2B
> (if the MPoC SDK is non-Isolating). The MPoC Solution will also be
> assessed against the requirements of Domain 4 and 5 of the MPoC
> Standard.
>
> The MPoC Software Product will have been assessed to Domain 1, and the
> Attestation and Monitoring Service to Domain 3, prior to listing of
> those MPoC Products.
>
> Some requirements of Domain 4 may also have been assessed against the
> MPoC Software vendor and the Attestation and Monitoring Service
> provider, e.g., in the case the Entity manages their own
> software-protected cryptography implementation (with associated key
> management requirements). However, even if this is the case, key
> management requirements would remain in scope for the MPoC Solution as
> well (e.g., as they relate the management of PIN keys).
>
> An MPoC Solution that integrates an MPoC Software Product may still
> implement monolithic MPoC Applications, but any such monolithic MPoC
> Application must be supported by its own Attestation and Monitoring
> systems (as the Attestation and Monitoring component of a listed MPoC
> Software Product will only support the MPoC SDK that is part of that
> MPoC Software Product). In such cases, the MPoC Solution will be
> assessed to Domain 1 and Domain 3 so that the security of the
> monolithic MPoC Application and attestation and monitoring systems can
> be validated.

## MPoC Solution Implemented by MPoC Software Vendor

> An MPoC Software vendor may choose to implement their own MPoC
> Solution, potentially as a completely monolithic MPoC Solution, or
> based on their separately listed MPoC Software Product and MPoC
> Attestation and Monitoring Service. Assessment in this example would
> follow the examples given above, for either a monolithic MPoC
> Solution, or for an MPoC Solution implementing a single MPoC Software
> Product and Attestation and Monitoring Service.

## MPoC Solution Implementing Multiple MPoC Software Products with Multiple Attestation and Monitoring Services

> In another example, an MPoC Solution may integrate multiple MPoC
> Software Products, in conjunction with one or more Attestation and
> Monitoring Services. In this example, the MPoC Solution integrates two
> MPoC Software Products; one of these supports only COTS-native NFC
> entry (with optional PIN for CVM) on a specific COTS OS (designed
> herein as OS(a)), and the other supports external reading of account
> data (using a PCI PTS SCRP) on two COTS OS's (the previously designed
> OS(a) and another COTS OS designed OS(b)) in addition to COTS-native
> NFC reading on OS(b) (both with optional PIN CVM).
>
> The example MPoC Solution deploys two MPoC Applications. The MPoC
> Application deployed on OS(b) integrates a single MPoC SDK. The MPoC
> Application deployed on OS(a) integrates two MPoC SDKs, one MPoC SDK
> to support COTS-native NFC (with optional PIN CVM) and the other MPoC
> SDK to support reading through the PCI PTS SCRP (with optional PIN
> CVM).
>
> The COTS-native PIN entry is separately managed by each MPoC SDK, as
> the PIN (or other sensitive assets) cannot be passed outside of the
> MPoC SDK boundary. Although this may lead to a different user
> experience for PIN entry for the MPoC Application deployed on OS(a),
> COTS-native PIN entry for any transaction must always be managed by
> the MPoC SDK that is used to read the payment card for that
> transaction.
>
> In this example MPoC Solution is not assessed to Domain 1 or Domain 3,
> as it relies on the MPoC Software that it integrates and does not
> implement any monolithic MPoC Applications. Each MPoC Application is
> assessed to Domain 2, with the MPoC Application that targets OS(s)
> being assessed with respect to both of the MPoC SDKs it integrates.
>
> In the case where an MPoC Solution is integrating more than two MPoC
> Software Products, the use of more than two MPoC SDKs within any one
> MPoC Application is not permitted.

# Relationship between This Standard and Other PCI Standards

> Various security requirements in this standard are based on elements
> of, or share similarities with, other PCI standards, as follows:

-   COTS device, attestation, and monitoring security controls to
    protect the security of payment transactions on COTS devices are
    consistent with PCI Software-Based PIN Entry on COTS (SPoC) and PCI
    Contactless Payments on COTS (CPoC).

-   POI devices are approved per PCI PIN Transaction Security (PTS)
    Point of Interaction (POI) requirements.

-   HSMs in the back-end environment used for PIN and account-data
    decryption, and related cryptographic-key operations require
    validation to PCI PTS HSM or FIPS 140-2, or 140-3, Level 3 (or 4).

-   Software used in the solution and software lifecycle practices are
    developed using best practices consistent with the PCI Software
    Security Framework (SSF).

-   The back-end payment-processing environment is required to be PCI
    DSS compliant.

-   The back-end PIN-processing environment is required to be PCI PIN
    Security compliant.

-   The security requirements for back-end attestation and monitoring
    environment are developed from PCI DSS DESV (where the back-end
    attestation and monitoring systems are sufficiently isolated from
    any account data processing).

## Relationship between This Standard and PCI DSS

> There is an independent relationship between this standard and PCI
> DSS. A back-end attestation and monitoring environment could be part
> of a cardholder data environment (CDE) or be completely separate from
> any CDE. If a back-end attestation and monitoring environment contains
> account data, it is subject to PCI DSS DESV in accordance with payment
> brand compliance programs.
>
> If an entity has already applied PCI DSS to protect its back-end
> attestation and monitoring environment as part of its CDE, the entity
> may be able to leverage the results of its PCI DSS assessment to meet
> the security requirements in this standard. For details, refer to
> [*Appendix A*.](#_bookmark102)

## Relationship between This Standard and PCI PTS POI Standard

> The PCI PTS POI standard supports the use of secure hardware and Point
> of Interaction (POI) devices within the payment ecosystem. The use of
> PTS POI devices in the solution to store, process, or transmit account
> data prevents exposure of sensitive assets on COTS devices and
> facilitates the principle of strong isolation of PIN and PAN. For more
> information about the PCI PTS POI, including applicability to
> different types of hardware, refer to the PCI PTS POI Program Guide at
> [*www.pcisecuritystandards.org*](http://www.pcisecuritystandards.org/).

### Use of PCI PTS SCRP Devices

> A PCI PTS SCRP used with an MPoC Solution must be an approved PCI PTS
> device that is listed on the PCI SSC Approved Device website with an
> SCRP Approval Class. This class of devices may optionally support
> contact magnetic stripe reading functionality. When included with an
> MPoC Solution, a PCI PTS SCRP may be used for any method of card data
> presentment that it supports, including for the acceptance of
> contactless payment cards. A PCI PTS SCRP may also be included when a
> COTS-native presentment method is used in place of one supported by
> the PCI PTS SCRP (e.g., a PCI PTS SCRP that supports contactless cards
> could be used with an MPoC Solution that uses COTS-native NFC
> acceptance instead).

### Use of Non-PTS Approved MSR

> When non-PTS approved MSR is supported by the solution, the tester
> must validate the standalone non-PTS approved MSR device against
> specific requirements in *[Appendix F: MSR Security
> Requirements](#appendix-e-msr-security-requirements)* that focuses on
> encryption of account data on the non-PTS approved MSR device.

## Relationship between This Standard and PCI SSC Software Standards

> PCI SSC supports the use of secure payment software within entities'
> cardholder data environments via the PCI Security Software Framework
> (SSF). The SSF consists of the Secure Software Standard and the Secure
> Software Lifecycle (Secure SLC) Standard. Software that is PCI SSC
> validated and listed provides assurance that the software has been
> developed using secure practices and has met a defined set of security
> requirements. Entities that develop their own software are encouraged
> to refer to PCI SSC's security software standards and consider the
> requirements therein as best practices to use in their development
> environments. Secure payment software implemented in a PCI
> DSS-compliant environment will help to minimize the potential for
> security breaches leading to compromises of account data and the
> damaging fraud resulting from these breaches.
>
> The MPoC standard requires developers of MPoC Software (or the
> software components of a monolithic MPoC Solution) are assessed
> against the requirements of the PCI Secure SLC standard. It is not a
> requirement that these entities are listed on the PCI website as
> meeting these requirements.

## Relationship between This Standard and PCI PIN Standard

> MPoC Solutions may be used for the acceptance of cardholder PINs. The
> security of the key management and cryptographic processes used to
> handle customer PINs are covered by the PCI PIN standard, and
> therefore this standard requires compliance to the PCI PIN
> requirements for any back-end systems involved in PIN processing.
> Requirement 1 of the PCI PIN standard outlines a need to have all PIN
> acceptance devices approved to PCI PTS and does not need to be
> assessed as compliant for the MPoC implementation.

## Relationship between This Standard and PCI SPoC Standard and PCI CPoC Standard

> The MPoC standard incorporates and builds upon many of the concepts
> and requirements founded in the PCI SPoC and PCI CPoC standards.
> However, the MPoC standard does not supersede or replace these other
> mobile standards. For details of any migration path from an existing
> SPoC or CPoC Solution to the listing of an MPoC Solution, refer to the
> MPoC Program Guide.

# Security Requirements for Mobile Payments on COTS Solution

## Objective-Based Approach to Requirements

> The security and test requirements of this standard address known
> attack scenarios at the time when the standard was published. Any
> entity responsible for some component of an overall MPoC Solution has
> ongoing responsibility to proactively perform risk assessments to
> identify potential security flaws in transaction scenarios that were
> introduced by changes in technology or by the identification of new
> threats and vulnerabilities.
>
> For an objective-based approach to be successful, entities are
> expected to possess a robust risk-management practice as an integral
> part of their "business-as-usual" operational process. While this
> approach provides the entities with the flexibility to implement
> security controls based on identified risk, the entity needs to be
> able to demonstrate how the implemented controls are supported by the
> results of its risk-identification and risk-management practices.
> Without a robust risk-management practice and evidence to support
> risk-based decision making, adherence to the requirements in this
> standard may be difficult to validate.
>
> If security requirements do not define a specific level, rigor, or
> frequency for periodic or recurring activities (e.g., the maximum
> period in which an entity is required to release a security update to
> fix a known vulnerability), the entity may define the level of rigor
> or frequency that is appropriate. The rigor and frequency defined by
> the entity must be supported by documented risk assessments and the
> resultant risk- management decisions. The entity is expected to be
> able to demonstrate that its implementation provides ongoing assurance
> that the security controls or security activities are effective and
> meet all applicable requirements.

## Requirement Frequency

> Certain security and test requirements have been established with
> specific timeframes for activities that must be performed consistently
> via a regularly scheduled and repeatable process. The intent is that
> the activity is performed at an interval as close to that timeframe as
> possible without exceeding it. The entity has the discretion to
> perform an activity more often than specified (e.g., performing an
> activity monthly where the security requirement specifies it be
> performed every three months).

##### Table 3. Security Requirement Timeframes

+--------------+-------------------------------------------------------+
| > **         | > **Descriptions and Examples**                       |
| Timeframes** |                                                       |
+==============+=======================================================+
| > Daily      | Every day of the year (not only on business days).    |
+--------------+-------------------------------------------------------+
| > Weekly     | At least once every seven days.                       |
+--------------+-------------------------------------------------------+
| > Monthly    | At least once every 30 to 31 days, or on the n^th^    |
|              | day of the month.                                     |
+--------------+-------------------------------------------------------+
| > Every      | At least once every 90 to 92 days, or on the n^th^    |
| > three      | day of each third month.                              |
| > months     |                                                       |
| > (          |                                                       |
| "quarterly") |                                                       |
+--------------+-------------------------------------------------------+
| > Every six  | At least once every 180 to 184 days, or on the n^th^  |
| > months     | day of each sixth month.                              |
+--------------+-------------------------------------------------------+
| > Every 12   | At least once every 365 (or 366 for leap years) days  |
| > months     | or on the same date every year.                       |
| >            |                                                       |
| ("annually") |                                                       |
+--------------+-------------------------------------------------------+
| >            | Frequency of occurrence is at the discretion of the   |
| Periodically | entity and is documented and supported by the risk    |
|              | assessment. The entity must demonstrate that the      |
|              | frequency is appropriate for the activity to be       |
|              | effective and to meet the intent of the requirement.  |
+--------------+-------------------------------------------------------+
| >            | Without delay. In real time or near real time.        |
|  Immediately |                                                       |
+--------------+-------------------------------------------------------+
| > Promptly   | As soon as reasonably possible.                       |
+--------------+-------------------------------------------------------+
| >            | There are certain requirements for which performance  |
|  Significant | is specified upon a significant change in the MPoC    |
| > change     | Software, backend, or the solution. While what        |
|              | constitutes a significant change is highly dependent  |
|              | on the configuration of a given environment,          |
|              | supported COTS OSs and COTS devices, MPoC Software    |
|              | architecture, etc., each of the following activities, |
|              | at a minimum, has potential impacts on the security   |
|              | of the solution and must be considered as a           |
|              | significant change in the context of related          |
|              | requirements:                                         |
|              |                                                       |
|              | -   Changes to hardware-based or software-based       |
|              |     security control to protect cryptographic         |
|              |     materials                                         |
|              |                                                       |
|              | -   Any changes to the underlying supporting          |
|              |     infrastructure of the solution (including, but    |
|              |     not limited to, changes to attestation, and       |
|              |     monitoring system)                                |
|              |                                                       |
|              | -   Any changes to third-party vendors/service        |
|              |     providers or services provided that support the   |
|              |     solution or meet security requirements on behalf  |
|              |     of the MPoC Solution provider (e.g.,              |
|              |     identification of security vulnerabilities in an  |
|              |     unsupported OS)                                   |
+--------------+-------------------------------------------------------+

> For other requirements, where the standard does not define a minimum
> frequency for recurring activities but instead allows for the
> requirement to be met "periodically," the entity is expected to define
> the frequency as appropriate for its business.

## Requirements Structure

> The security requirements defined within this standard are presented
> in the following format:

-   **Security Objective**. Identifies the high-level security objective
    that the entity is required to meet. Security objectives are broadly
    stated to enable entities flexibility in determining the best
    methods to achieve the stated security objective. However, it is
    expected that the entity produces clear and unambiguous evidence to
    show that the chosen methods are appropriate, sufficient, and
    properly implemented to satisfy the security objective. Below the
    security objective, additional information has been provided to help
    both entities and laboratories understand the intent behind the
    security objective.

-   **Security Requirements**. Specific security controls or activities
    that must be implemented by the entity to support the overarching
    security objective.

-   **Test Requirements**. Describe the expected testing activities to
    be performed by the laboratory to validate whether an entity has met
    a particular security requirement. The test requirements are
    intended to provide both the entity and the laboratory with a common
    understanding of the assessment activities to be performed. The
    specific methods and items examined, and the personnel interviewed,
    are required to be appropriate for the security objective and
    associated requirements being assessed and for each entity's
    particular implementation.

-   **Guidance**. Additional information to help entities and
    laboratories understand the intent of each requirement. The guidance
    may also include best practices that should be considered as well as
    examples of controls or methods that, when properly implemented, may
    meet the intent of the requirement. This guidance is not intended to
    preclude other methods that an entity may use to meet a requirement,
    nor does it replace or extend the requirements to which it refers.

## Testing Methods

> Entities are expected to produce evidence that they have satisfied the
> security requirements defined in this document. The test requirements
> for each security requirement describe the activities to be performed
> by the tester to demonstrate that the entity has met that security
> requirement. Where the tester finds it necessary to develop
> alternative tests, they must provide appropriate justification for
> their use. Test requirements typically include the following
> activities:

-   **Examination**. The tester critically evaluates evidence. Common
    examples of evidence include software design and architecture
    documents (electronic or physical), source code, configuration, and
    metadata files, bug tracking data, and other output from
    software-development systems, and security-testing results. The
    choice of which evidence may be used to meet an examination
    requirement is deliberately left open for the tester to determine.
    However, it is a requirement of this standard that the source code
    of the MPoC Software and MPoC Application is made available for
    review as part of the assessment. It is not acceptable for an
    evaluation report to be provided where no source code was examined
    or used in the process of performing the testing.

> Where this standard uses the term "document," this is not required to
> be a formal physical document. Other types of managing information may
> be acceptable if they contain the required information and have the
> required utility of purpose.

-   **Testing**. The tester evaluates the solution code or the operation
    of the solution software using a variety of security-testing tools
    and techniques. Examples of such tools and techniques include the
    use of automated static analysis security testing (SAST), dynamic
    analysis security testing (DAST), interactive application security
    testing (IAST), and software composition analysis (SCA) tools.
    Manual techniques, such as manual code reviews, penetration testing,
    side-channel attacks, fault injection, and memory scraping, may need
    to also be considered.

-   **Observation**. The tester watches an action or views something in
    the environment. Examples of observation subjects include personnel
    performing tasks or processes, software or system components
    performing a function or responding to input, system
    configurations/settings, environmental conditions, and physical
    controls. Observation may include the performance of "tests," so
    that the output of those tests may be observed, potentially under
    changing conditions as the input is manipulated by the tester or
    other systems.

> An "observation" test process generally differs from a "testing" test
> process in that it involves some aspect of the normal operation of the
> system under test rather than testing of some subsystem or
> subfunction. For example, a process involving validation of
> protections against Man-in-the-Middle attacks through manipulation of
> a TLS connection from a functioning system would be "observation."
> Side-channel analysis of the cryptography implement during the TLS
> process would be performed as part of "testing."

-   **Interview**. The tester converses with individual personnel. The
    purpose of interviews includes determining how an activity is
    performed, whether an activity is performed as defined, and whether
    personnel have particular knowledge or understanding of applicable
    policies, processes, responsibilities, and concepts.

-   **Document**. The tester provides details or information in the
    evaluation report, which may be used in the same or subsequent
    testing requirements.

> The test requirements provide both entities and testers with a common
> understanding of the validation activities to be performed. The
> specific items or processes to be examined or observed and personnel
> to be interviewed are required to be appropriate for the security
> requirement being validated and for each entity's structure,
> operations and business practices. For example, it is expected that
> not every item of information will be contained in a formal document,
> and not every interview will be conducted in person. It is at the
> discretion of the tester to determine the appropriateness or adequacy
> of the evidence provided by the entity to support each security
> requirement. Where bullets are specified in a security requirement or
> test requirement, each bullet is expected to be tested as part of the
> validation.
>
> When documenting the assessment results, the tester identifies the
> testing activities performed and the result of each activity. While it
> is expected that the tester will perform all the test requirements for
> each security requirement, it may also be possible for a security
> requirement to be validated using different or additional testing
> methods. In such cases, the tester is expected to document why
> alternative testing methods were used that differed from those
> identified in this document, and how those methods provided at least
> the same level of assurance as the documented testing methods. Where
> terms such as "periodic," "appropriate," and "reasonable" are used in
> the test requirement, it is the entity's responsibility to define and
> defend its decisions regarding the frequency, robustness, and maturity
> of the implemented controls or processes.

## Security Objective and Assets

> This standard sets forward various security control objectives for the
> purposes of protecting assets. Within the context of this standard,
> assets are elements of the MPoC Solution that are security sensitive
> or are used to provide security to other security-sensitive elements.
> Examples of assets include data such as account data, cardholder PINs,
> certificates, and cryptographic keys. Software may also be considered
> an asset if the correct operation of that software is required to
> provide security protection to other data assets.
>
> Sensitive assets are a sub-set of the asset class that require
> confidentiality protections.
>
> The specific assets used in a solution are expected to be unique to
> how that solution operates, and therefore a comprehensive list is
> required to be developed as part of the evaluation of any MPoC
> Solution.
>
> The security controls required to protect payment information depend
> on the type of payment acceptance channels and cardholder verification
> methods supported by the MPoC Software. All MPoC Software is required
> to meet the security objective, requirements, and test requirements in
> the Core Module. The objective of these security requirements is to
> ensure the integrity of the COTS device, and to reasonably ensure that
> the solutions provide adequate security mechanisms, controls, and
> mitigations to protect the cardholder's account data and other assets
> such as cryptographic keys. These requirements assist with protection
> from unauthorized disclosure, modification, or misuse by restricting
> the available attack surface and making it cost prohibitive to attack.
>
> It is recognized that an attacker may have other objectives, such as
> self-promotion or nation-state attack, and may expend more resources
> to circumvent established controls than is warranted by the direct
> financial rewards.
>
> For the COTS platform components, the objective of these security
> requirements is to provide reasonable assurance that these components
> are kept up to date and have not been tampered with.
>
> The following table provides examples of MPoC Software assets and
> lists the protection required. This protection may be confidentiality
> (C), integrity (I), and integrity with the addition of auditability
> and authentication (I+). This table does not purport to be an
> exhaustive list of all sensitive assets that may be stored or
> processed by an MPoC Solution. assets not identified in this table may
> exist and may require protection.

##### Table 4: Examples of MPoC Software Assets

+----------+---------------------------------------------------+-------+
| > **Data | > **Description**                                 | > **  |
| >        |                                                   | Prote |
|  Element |                                                   | ction |
| > Type** |                                                   | > T   |
|          |                                                   | ype** |
+==========+===================================================+=======+
| >        | > Account data consists of cardholder data and/or | C & I |
|  Account | > sensitive authentication data.                  |       |
| > data   |                                                   |       |
+----------+---------------------------------------------------+-------+
| > Ca     | > Method used to verify the identity and intent   | C &   |
| rdholder | > of the cardholder performing the transaction.   | I+    |
| > Veri   | > Examples include PIN or signature. Use of a CVM |       |
| fication | > is not mandated by this standard and some       |       |
| > Method | > transactions may use no CVM.                    |       |
| > (CVM)  |                                                   |       |
+----------+---------------------------------------------------+-------+
| > Att    | > Information collected from the COTS device for  | C &   |
| estation | > the purposes of validating it is in an          | I+    |
| > Data   | > uncompromised and secure state, suitable for    |       |
|          | > performing MPoC transactions.                   |       |
+----------+---------------------------------------------------+-------+
| > Con    | > Includes split contactless kernel               | > I+  |
| tactless | > implementations.                                |       |
| > Kernel |                                                   |       |
+----------+---------------------------------------------------+-------+
| > Crypt  | > Cryptographic keys and related parameters       | C &   |
| ographic | > (static and ephemeral) used to protect other    | I+    |
| >        | > sensitive assets such as account data, PINs,    |       |
| Material | > etc., as well as establish secure channel and   |       |
|          | > signing attestation data. Note: Public          |       |
|          | > cryptographic keys do not need Confidentiality  |       |
|          | > protection.                                     |       |
+----------+---------------------------------------------------+-------+
| > MPoC   | > A compiled software or a library distributed    | > I+  |
| >        | > for use with the MPoC Application.              |       |
| Software |                                                   |       |
| > SDK    |                                                   |       |
+----------+---------------------------------------------------+-------+
| > MPoC   | > The source code of the MPoC Software used as    | C &   |
| >        | > part of the overall MPoC Solution. Includes     | I+    |
| Software | > code that may be present on the COTS device, as |       |
| > Source | > well as code that may be used on the back-end   |       |
| > Code   | > systems. MPoC Software source code may be       |       |
|          | > present                                         |       |
+----------+---------------------------------------------------+-------+
| > SCRP   | > Cryptographically authenticatable token used to | C &   |
| > En     | > enable transaction processing on a PCI PTS      | I+    |
| ablement | > SCRP.                                           |       |
| > Token  |                                                   |       |
+----------+---------------------------------------------------+-------+
| > Pro    | > Upon installation, MPoC Applications must be    | C &   |
| visionin | > provisioned with secret data, to bind the MPoC  | I+    |
| g/secret | > Software to the COTS platform, and              |       |
| > identi | > cryptographic keys to secure the sensitive      |       |
| fication | > assets they process. This assets class is not   |       |
| > data   | > intended to include merchant ID data used for   |       |
|          | > transaction processing or other non-secret      |       |
|          | > data.                                           |       |
+----------+---------------------------------------------------+-------+

# Domain 1: MPoC Software Core Requirements

> The security requirements in this Domain apply to the individual
> components and processes that make up the MPoC Software or the
> equivalent areas of software provided by an MPoC Solution where a
> separately listed MPoC Software is not used. Wherever the terms MPoC
> Software or MPoC SDK are used within this Domain, requirements apply
> equally to the equivalent areas of an MPoC Solution that does not use
> listed MPoC Software.
>
> The functional requirements of the MPoC Software can be further
> organized into the following components assessed under this Domain:

-   A software application or a library that implements payment
    acceptance and optional supported cardholder verification methods
    and/or may influence the security of payment data processing on the
    COTS device (the MPoC SDK or a monolithic MPoC Application). This
    software may be executed, in part or as a whole, on the COTS device
    itself or executed remotely and rendered on the COTS device through
    other means.

-   The back-end attestation and monitoring systems that cannot be
    entirely (logically) accessed from the merchant environment and that
    must be capable of being regularly/rapidly updated to respond to new
    threats and to apply changes or updates to the solutions.

-   An optional API provided by the MPoC SDK that allows other
    third-party developers to interface with the MPoC Solution.

-   All contactless kernels used in the MPoC Software, regardless of
    their implementation within MPoC SDK, residing on the COTS device or
    implemented as a remote component of a contactless kernel (e.g.,
    cloud-based).

> Optional Modules within Domain 1 include additional security
> objectives to protect sensitive assets associated with specific
> payment- acceptance channels and cardholder verification methods such
> as following:

-   **PIN Entry on COTS device.** Includes security requirements to
    ensure the integrity of the PIN entry process on the COTS device.
    These requirements apply only to MPoC Software that supports PIN
    CVM.

-   **Offline Payment Transactions.** Includes requirements to ensure
    that support for Offline Payment processing is performed securely.

-   **Secure Entry and Processing of Account Data.** Although not an
    optional Module, this includes optional Sections that provides
    security requirements for account data entry methods, such as
    COTS-native NFC, manual account data entry, or to ensure secure
    pairing with a PCI PTS SCRP, or non-PTS-approved MSR.

> It is expected that the attestation system monitoring systems will
> integrate both local and remote features to allow for the
> identification of new types of attacks, rapid response, and deployment
> of updated mitigations against such threats. When MPoC Software relies
> on COTS hardware-based security controls or features, such as SE or
> TEE, these must be included in the scope of evaluation and evaluated
> against the applicable security requirement in this Domain.
>
> The test requirements of Domain 1 apply to the software used in
> monolithic MPoC Solutions, as well as software that is designed for
> submission and listing as a separate MPoC Software Product.

## Module 1A: CORE

> These requirements are applicable to the MPoC Software. This includes
> the software executed on the COTS device, any Trusted Applications
> (TA) used, and the back-end systems software (processing, monitoring,
> and attestation).

### 1A-1 Secure Software Requirements

> Software is to be developed and maintained according to a defined
> software-security development and lifecycle process. Software
> developers require knowledge to address software vulnerabilities and
> emerging risks.
>
> Development of secure software requires knowledge of common attack
> techniques and vulnerabilities. These vulnerabilities can change over
> time; therefore, a continuous process to inform software developers
> about these changes is vital. It is not sufficient to confirm that the
> developers have been provided with documentation, books, and/or
> training on secure software development. There needs to be auditable
> confirmation that developers have knowledge of common vulnerabilities
> in the language and environment in which they develop software.
>
> To facilitate reliable and accurate payment transactions, the systems
> and software used as part of the payment-transaction flow must be
> designed, developed, and maintained in a way that protects the
> integrity of payment transactions and the confidentiality of all
> sensitive assets stored, processed, or transmitted in association with
> payment transactions.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Vulnerabilities |                       |                          |
| > in software     |                       |                          |
| > that may pose a |                       |                          |
| > security risk   |                       |                          |
| > to MPoC         |                       |                          |
| > Software and    |                       |                          |
| > A&M back-end    |                       |                          |
| > assets are      |                       |                          |
| > prevented.      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-1.1** MPoC | **1A-1.1.a** When the | The MPoC Software needs  |
| > Software must   | software is developed | to be developed and      |
| > be either:      | by a PCI Secure       | maintained in accordance |
|                   | SLC-approved software | with secure coding       |
| -   Developed by  | vendor, the tester    | standards and industry   |
|     a PCI Secure  | must confirm through  | best practices to reduce |
|     Software      | examination that the  | the risk of              |
|     Lifecycle     | entity is listed on   | vulnerabilities being    |
|     (SLC)         | the PCI website and   | introduced that result   |
|     Qualified     | it is valid at the    | from poor coding         |
|     Software      | time of evaluation    | techniques.              |
|     Vendor, or    | (e.g., the listing    |                          |
|                   | has not expired).     | Knowledge of industry    |
| -   Comply with   |                       | software development     |
|     all           |                       | standards and best       |
|     requirements  |                       | practices provides       |
|     in *[Appendix |                       | information on current   |
|     D: Software   |                       | exploits and trends.     |
|     Security](#   |                       |                          |
| appendix-d-secure |                       | PCI SSC publishes        |
| -software-lifecyc |                       | additional guidance,     |
| le-requirements)* |                       | from time to time, on    |
|     [*Lifecycle   |                       | best practice for the    |
|                   |                       | assessment of            |
|  Requirements*.]( |                       | environments and         |
| #appendix-d-secur |                       | processes. This guidance |
| e-software-lifecy |                       | may allow for some       |
| cle-requirements) |                       | aspects of an            |
|                   |                       | assessments to be        |
|                   |                       | performed remotely.      |
+-------------------+-----------------------+--------------------------+
|                   | **1A-1.1.b** When the |                          |
|                   | software is not       |                          |
|                   | developed by a PCI    |                          |
|                   | Secure SLC-approved   |                          |
|                   | software vendor, the  |                          |
|                   | tester must confirm   |                          |
|                   | through examination,  |                          |
|                   | observation, and      |                          |
|                   | interview that the    |                          |
|                   | requirements in       |                          |
|                   | *[Appendix D:         |                          |
|                   | Software Security     |                          |
|                   | Lifecycle](#appendix  |                          |
|                   | -d-secure-software-li |                          |
|                   | fecycle-requirements) |                          |
|                   | [Req                  |                          |
|                   | uirements](#appendix- |                          |
|                   | d-secure-software-lif |                          |
|                   | ecycle-requirements)* |                          |
|                   | are met.              |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-1.2** A    | **1A-1.2.a** The      | Penetration testing and  |
| > public          | tester must confirm   | vulnerability management |
| > securi          | through examination   | processes are expected   |
| ty-flaw-reporting | that a                | to be part of the MPoC   |
| > program must be | vu                    | Software vendor's secure |
| > implemented to  | lnerability-reporting | software lifecycle       |
| > encourage the   | program exists for    | process. This            |
| > finding and     | the system, and there | requirement confirms the |
| > reporting of    | is evidence of        | scope and efficacy of    |
| >                 | accepting and         | the penetration testing  |
|  vulnerabilities. | remediating security  | as it is applied to the  |
|                   | vulnerabilities found | MPoC Software            |
|                   | through this program. | specifically.            |
|                   |                       |                          |
|                   |                       | Penetration tests need   |
|                   |                       | to be performed by       |
|                   |                       | suitably skilled         |
|                   |                       | resources and may be     |
|                   |                       | performed by resources   |
|                   |                       | internal to the MPoC     |
|                   |                       | Solution provider if     |
|                   |                       | such resources exist.    |
|                   |                       | When penetration testing |
|                   |                       | is performed by internal |
|                   |                       | resources, the people    |
|                   |                       | performing the testing   |
|                   |                       | need to be separate from |
|                   |                       | those who have been      |
|                   |                       | involved in the          |
|                   |                       | development of the MPoC  |
|                   |                       | Software. Skills         |
|                   |                       | expected from the        |
|                   |                       | resources used for       |
|                   |                       | penetration testing      |
|                   |                       | include:                 |
|                   |                       |                          |
|                   |                       | -   An understanding of  |
|                   |                       |     EMV protocols and    |
|                   |                       |     payment processing.  |
|                   |                       |                          |
|                   |                       | -   Skills and           |
|                   |                       |     experience with      |
|                   |                       |     mobile security and  |
|                   |                       |     communications       |
|                   |                       |     protocols.           |
|                   |                       |                          |
|                   |                       | -   A clear history of   |
|                   |                       |     penetration testing  |
|                   |                       |     experience.          |
|                   |                       |                          |
|                   |                       | Results from annual      |
|                   |                       | penetration testing may  |
|                   |                       | not exist for newly      |
|                   |                       | developed MPoC Software  |
|                   |                       | products, but need to be |
|                   |                       | provided for any review  |
|                   |                       | performed after the      |
|                   |                       | first year of            |
|                   |                       | validation. However, an  |
|                   |                       | initial penetration      |
|                   |                       | testing report is        |
|                   |                       | required to be available |
|                   |                       | prior to the listing of  |
|                   |                       | the MPoC Software or the |
|                   |                       | MPoC Solution (for       |
|                   |                       | monolithic solutions).   |
|                   |                       |                          |
|                   |                       | Penetration testing may  |
|                   |                       | be performed by the same |
|                   |                       | entity that performs the |
|                   |                       | MPoC evaluation;         |
|                   |                       | however, the MPoC        |
|                   |                       | evaluation itself cannot |
|                   |                       | be considered a          |
|                   |                       | penetration test to meet |
|                   |                       | this requirement. A      |
|                   |                       | separate testing and     |
|                   |                       | reporting process must   |
|                   |                       | be implemented for this  |
|                   |                       | penetration test.        |
|                   |                       |                          |
|                   |                       | This may require that    |
|                   |                       | the target of the        |
|                   |                       | penetration test (such   |
|                   |                       | as an MPoC Software      |
|                   |                       | product) is provided     |
|                   |                       | with a test harness to   |
|                   |                       | facilitate the operation |
|                   |                       | of the software during   |
|                   |                       | the penetration testing. |
|                   |                       |                          |
|                   |                       | Any vulnerabilities      |
|                   |                       | identified in            |
|                   |                       | penetration testing must |
|                   |                       | be considered during     |
|                   |                       | attack costings.         |
+-------------------+-----------------------+--------------------------+
|                   | **1A-1.2.b** For any  |                          |
|                   | vulnerabilities have  |                          |
|                   | been reported through |                          |
|                   | the security flaw     |                          |
|                   | reporting program the |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that any such         |                          |
|                   | vulnerabilities are   |                          |
|                   | processed through the |                          |
|                   | vendor                |                          |
|                   | risk-and-update       |                          |
|                   | process and patched   |                          |
|                   | accordingly.          |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-1.3** A    | **1A-1.3.a** The      |                          |
| > penetration     | tester must confirm   |                          |
| > test must be    | through examination   |                          |
| > performed on    | that a penetration    |                          |
| > the MPoC        | test has been         |                          |
| > Software prior  | performed on the MPoC |                          |
| > to initial      | Software prior to     |                          |
| > assessment and  | initial assessment    |                          |
| > at least once   | and at least annually |                          |
| > per year        | thereafter.           |                          |
| > thereafter.     |                       |                          |
|                   | Penetration testing   |                          |
|                   | reports must be       |                          |
|                   | examined to confirm   |                          |
|                   | that the scope covers |                          |
|                   | all aspects of the    |                          |
|                   | MPoC Software,        |                          |
|                   | including all types   |                          |
|                   | of platforms          |                          |
|                   | supported, and that   |                          |
|                   | vulnerabilities found |                          |
|                   | during the            |                          |
|                   | penetration testing   |                          |
|                   | have been remediated  |                          |
|                   | or are mitigated      |                          |
|                   | through other         |                          |
|                   | protections provided  |                          |
|                   | by the solution.      |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-1.4** The  | **1A-1.4.a** Where an | Security controls to     |
| > MPoC Software   | existing validation   | protect the integrity    |
| > A&M component   | and listing of the    | and the confidentiality  |
| > must meet the   | MPoC Software A&M     | of the sensitive assets  |
| > security        | component to the PCI  | stored, processed, or    |
| > requirements    | Secure Software       | transmitted by the MPoC  |
| > described in    | Standard exists, the  | Software are vital for   |
| > PCI Secure      | tester must confirm   | any MPoC Solution.       |
| > Software        | through examination   |                          |
| > Standard.       | and observation that  | There is no              |
|                   | the assessment scope  | one-size-fits-all method |
|                   | and listing are       | to software security. As |
|                   | correct, complete,    | a result, entities need  |
|                   | and current. The      | flexibility to determine |
|                   | tester must cite the  | the software security    |
|                   | listing number and    | controls and features    |
|                   | version from the PCI  | most appropriate to      |
|                   | website listing.      | address their specific   |
|                   |                       | business and software    |
|                   |                       | risks. As such, it is    |
|                   |                       | required that entities   |
|                   |                       | possess a robust risk-   |
|                   |                       | management practice as   |
|                   |                       | an integral part of      |
|                   |                       | their business-as-usual  |
|                   |                       | operational processes    |
|                   |                       | and be able to           |
|                   |                       | demonstrate how the      |
|                   |                       | implemented security     |
|                   |                       | controls are supported   |
|                   |                       | by the results of their  |
|                   |                       | risk-management          |
|                   |                       | practices.               |
|                   |                       |                          |
|                   |                       | The MPoC Software may    |
|                   |                       | implement some software  |
|                   |                       | that is not directly     |
|                   |                       | under the control of the |
|                   |                       | MPoC Software developer. |
|                   |                       | In such circumstances,   |
|                   |                       | the source code may not  |
|                   |                       | be available for         |
|                   |                       | examination. The tester  |
|                   |                       | is expected to use other |
|                   |                       | methods to confirm that  |
|                   |                       | security requirements    |
|                   |                       | are met by this          |
|                   |                       | software.                |
|                   |                       |                          |
|                   |                       | It is expected that not  |
|                   |                       | all requirements of the  |
|                   |                       | PCI Secure Software      |
|                   |                       | Standard will be in      |
|                   |                       | scope for an assessment  |
|                   |                       | of MPoC Software. The    |
|                   |                       | tester is expected to    |
|                   |                       | leverage their           |
|                   |                       | understanding of the     |
|                   |                       | software to scope the    |
|                   |                       | relevant requirements as |
|                   |                       | applicable for the       |
|                   |                       | current assessment.      |
|                   |                       |                          |
|                   |                       | Depending on the assets  |
|                   |                       | handled by the MPoC      |
|                   |                       | Software (e.g., account  |
|                   |                       | data) and the underlying |
|                   |                       | technologies (e.g.,      |
|                   |                       | Internet technologies,   |
|                   |                       | protocols, and           |
|                   |                       | languages), additional   |
|                   |                       | modules outlined in the  |
|                   |                       | PCI Secure Software      |
|                   |                       | Standard may be          |
|                   |                       | applicable. For example, |
|                   |                       | Module A of the PCI      |
|                   |                       | Secure Software Standard |
|                   |                       | covers the requirements  |
|                   |                       | for software providing   |
|                   |                       | protection to account    |
|                   |                       | data.                    |
+-------------------+-----------------------+--------------------------+
|                   | **1A-1.4.b** Where an |                          |
|                   | existing validation   |                          |
|                   | and listing of the    |                          |
|                   | MPoC Software A&M     |                          |
|                   | component to the PCI  |                          |
|                   | Secure Software       |                          |
|                   | Standard does not     |                          |
|                   | exist, the tester     |                          |
|                   | must confirm through  |                          |
|                   | examination, testing, |                          |
|                   | observation, and      |                          |
|                   | interview that the    |                          |
|                   | MPoC Software A&M     |                          |
|                   | component developed   |                          |
|                   | by the entity meets   |                          |
|                   | the security test     |                          |
|                   | requirements outlined |                          |
|                   | in the PCI Secure     |                          |
|                   | Software Standard,    |                          |
|                   | including applicable  |                          |
|                   | modules of that       |                          |
|                   | standard.             |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-1.5** The  | **1A-1.5.a** The      | The MPoC standard is     |
| > MPoC Software   | tester must confirm   | intended for use with    |
| > must implement  | through examination   | solutions that use       |
| > chip-based      | and observation that  | COTS-native interfaces   |
| > payment         | the MPoC Software     | for the acceptance of    |
| > acceptance      | implements at a       | chip- based payment      |
| > utilizing the   | minimum (both of the  | transactions, or         |
| > COTS platform   | following):           | cardholder verification  |
| > for the entry   |                       | methods (such as a PIN). |
| > of at least one | -   Payment           | Solutions that rely      |
| > form of account |     acceptance for at | entirely on non-COTS     |
| > data.           |     least one of      | devices, such as a PCI   |
|                   |     either contact or | PTS device, for the      |
|                   |     contactless chip  | acceptance of account    |
|                   |     (through COTS-    | data, and do not provide |
|                   |     native            | for any COTS-native      |
|                   |     interfaces, or    | acceptance of account    |
|                   |     through use of an | data or PIN data, are    |
|                   |     external PCI PTS  | not intended for         |
|                   |     SCRP).            | assessment under this    |
|                   |                       | standard.                |
|                   | -   COTS-native       |                          |
|                   |     interfaces for    | For example, solutions   |
|                   |     the input at      | that support only        |
|                   |     least one of      | magnetic stripe cards,   |
|                   |     either            | only manual PAN entry,   |
|                   |     contactless chip, | or only uses the COTS    |
|                   |     or cardholder     | device as a              |
|                   |     PIN.              | communication system for |
|                   |                       | an attached PCI PTS      |
|                   |                       | device that performs the |
|                   |                       | acceptance of card and   |
|                   |                       | PIN, are not able to be  |
|                   |                       | considered for           |
|                   |                       | validation and listing   |
|                   |                       | under the PCI MPoC       |
|                   |                       | standard.                |
|                   |                       |                          |
|                   |                       | Magnetic stripe card and |
|                   |                       | manual PAN entry         |
|                   |                       | transactions may be      |
|                   |                       | supported as optional    |
|                   |                       | payment channels with    |
|                   |                       | solutions that meet this |
|                   |                       | requirement to support   |
|                   |                       | chip- based              |
|                   |                       | transactions.            |
+-------------------+-----------------------+--------------------------+

### 1A-2 Random Numbers

> Random numbers are relied upon by many security processes and secure
> communications methods. Generation of random numbers with insufficient
> entropy has been the cause of many high-profile vulnerabilities. This
> makes the quality of the random numbers generated by the MPoC solution
> vital. Random numbers are to be generated using a process that ensures
> sufficient entropy (e.g., as defined in *NIST SP800-22*) and lack of
> statistical correlation.
>
> Any random numbers used for security purposes must be generated using
> a secure method, such as a DRNG seeded from a value that comes from a
> trusted source. A COTS device that has a TEE or SE evaluated as a
> random number generation source directly can be used as a source of
> entropy. Otherwise, a DRNG must be used, seeded from an external
> trusted source such as a PCI PTS SCRP or a back-end system such as an
> HSM, in addition to entropy from the COTS device itself. Combining
> these different entropy sources ensures that even if one is
> compromised it does not automatically invalidate the security of the
> random number generation process as a whole.
>
> This applies to all components and parts of the MPoC Software where
> random numbers are required to be generated for security functions.
> Random numbers that are not relied upon directly for security of the
> account data or attestation data, such as random values used in TLS
> sessions where the data being transmitted is otherwise protected using
> application-level cryptography, are exempt from this Section.
>
> The MPoC SDK should maintain an entropy "pool" that is updated
> regularly from the trusted source and other sources on the COTS
> platform. This pool data is sensitive and should be protected.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Random numbers  |                       |                          |
| > are             |                       |                          |
| > sufficiently    |                       |                          |
| > unpredictable.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-2.1**      | **1A-2.1.a** The      | This requirement applies |
| > Software        | tester must confirm   | to all MPoC Software     |
| > development     | through examination   | regardless of where it   |
| > documentation   | that the              | is executed (i.e., this  |
| > must provide    | software-development  | requirement applies to   |
| > details about   | processes and         | both back-end and MPoC   |
| > how the MPoC    | practices used, with  | SDK software).           |
| > Software        | respect to the        |                          |
| > generates       | generation of random  | Random number generation |
| > secure random   | numbers, include the  | often sets the security  |
| > numbers, as     | required information  | baseline upon which      |
| > required, on    | and are consistent    | other security controls  |
| > all deployed    | with the tester's     | rely. This may include   |
| > platforms.      | understanding of the  | the generation of        |
|                   | MPoC Software.        | padding data for use in  |
|                   |                       | certificates, key        |
|                   | Information           | bundles, and EMV flows   |
|                   | maintained for random | as well as the           |
|                   | number generation     | generation of            |
|                   | method must include   | cryptographic keys.      |
|                   | at a minimum:         |                          |
|                   |                       | Random generator attacks |
|                   | -   The generation    | by malicious users       |
|                   |     and origin of     | exploit weak random      |
|                   |     random numbers.   | number implementations   |
|                   |                       | and have been the cause  |
|                   | -   The expected      | of several high-profile  |
|                   |     entropy of any    | vulnerabilities.         |
|                   |     seed values used. | Therefore, the quality   |
|                   |                       | of the random numbers    |
|                   | -   The seeding       | generated by the         |
|                   |     period.           | solution is vital.       |
|                   |                       |                          |
|                   | -   Details of any    | The information is       |
|                   |     DRNG algorithms   | required to cover all    |
|                   |     implemented.      | uses of random numbers,  |
|                   |                       | including, at a minimum, |
|                   |                       | the entropy sources for  |
|                   |                       | the attestation system   |
|                   |                       | and key-generation       |
|                   |                       | processes.               |
|                   |                       |                          |
|                   |                       | The information provided |
|                   |                       | needs to inform the use  |
|                   |                       | of all random number     |
|                   |                       | generation methods       |
|                   |                       | within the software. The |
|                   |                       | remaining requirements   |
|                   |                       | in this Section describe |
|                   |                       | the testing required to  |
|                   |                       | validate that the        |
|                   |                       | implementation is        |
|                   |                       | produced in line with    |
|                   |                       | the rules of the         |
|                   |                       | software- development    |
|                   |                       | process.                 |
|                   |                       |                          |
|                   |                       | Entropy supplied by any  |
|                   |                       | random number generation |
|                   |                       | system should be         |
|                   |                       | sufficient for the use   |
|                   |                       | cases to which it is     |
|                   |                       | applied. For example, a  |
|                   |                       | random number used to    |
|                   |                       | generate a new key       |
|                   |                       | should provide entropy   |
|                   |                       | at least equal to that   |
|                   |                       | key value. For details   |
|                   |                       | on minimum cryptographic |
|                   |                       | key strengths and other  |
|                   |                       | items of cryptography,   |
|                   |                       | refer to [*Appendix      |
|                   |                       | C*.](#_bookmark134)      |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-2.2** The  | **1A-2.2.a** The      | This requirement applies |
| > MPoC Software   | tester must confirm   | to all MPoC Software     |
| > must use an     | through examination   | regardless of where it   |
| > assessed source | that, where the       | is executed (i.e., this  |
| > for the         | security of assets    | requirement applies to   |
| > generation of   | requires the use of   | both back-end and MPoC   |
| > random numbers  | random numbers, an    | SDK software).           |
| > where the       | assessed Random       |                          |
| > security of     | Number Generator      | Examples of situations   |
| > assets requires | (RNG) is used.        | where random numbers may |
| > the use of      |                       | be required to secure    |
| > random numbers. |                       | account data include the |
|                   |                       | generation of            |
|                   |                       | cryptographic keys,      |
|                   |                       | padding prior to         |
|                   |                       | encryption of account or |
|                   |                       | PIN data, or security    |
|                   |                       | controls such as         |
|                   |                       | attestation functions.   |
|                   |                       | The EMV Unpredictable    |
|                   |                       | Number (UN) used by a    |
|                   |                       | payment kernel is not    |
|                   |                       | included in the scope of |
|                   |                       | this requirement.        |
|                   |                       | However, where a payment |
|                   |                       | kernel requires entropy  |
|                   |                       | for other security       |
|                   |                       | purposes, these random   |
|                   |                       | numbers are in scope of  |
|                   |                       | this requirement.        |
|                   |                       |                          |
|                   |                       | It is required that      |
|                   |                       | account data and         |
|                   |                       | attestation data are     |
|                   |                       | protected with           |
|                   |                       | cryptographic controls.  |
|                   |                       | Such controls often      |
|                   |                       | depend on the quality of |
|                   |                       | random numbers to        |
|                   |                       | maintain the designed    |
|                   |                       | security levels.         |
|                   |                       |                          |
|                   |                       | The Random Number        |
|                   |                       | Generator (RNG) used by  |
|                   |                       | the MPoC Software is     |
|                   |                       | required to be tested    |
|                   |                       | for fitness of purpose   |
|                   |                       | against                  |
|                   |                       | industry-recognized test |
|                   |                       | suites such as NIST      |
|                   |                       | SP800-22 or AIS 31.      |
|                   |                       |                          |
|                   |                       | A trusted execution      |
|                   |                       | environment or secure    |
|                   |                       | element that has an      |
|                   |                       | existing assessment      |
|                   |                       | confirming its           |
|                   |                       | suitability for the      |
|                   |                       | generation of            |
|                   |                       | cryptographically strong |
|                   |                       | random numbers may be    |
|                   |                       | used where present in    |
|                   |                       | supported platforms.     |
|                   |                       | Where such random number |
|                   |                       | generation hardware is   |
|                   |                       | not present or cannot be |
|                   |                       | relied upon to be        |
|                   |                       | present on all supported |
|                   |                       | platforms, a software    |
|                   |                       | DRNG is required.        |
|                   |                       |                          |
|                   |                       | Previous assessments     |
|                   |                       | that can be used to      |
|                   |                       | validate the suitability |
|                   |                       | of a trusted execution   |
|                   |                       | environment/secure       |
|                   |                       | element include common   |
|                   |                       | criteria, EMVCo, and     |
|                   |                       | other industry standard  |
|                   |                       | assessments.             |
+-------------------+-----------------------+--------------------------+
|                   | **1A-2.2.b** The      |                          |
|                   | tester must confirm,  |                          |
|                   | through testing       |                          |
|                   | against               |                          |
|                   | industry-recognized   |                          |
|                   | test suites such as   |                          |
|                   | NIST SP800-22 or      |                          |
|                   | AIS-31, that any      |                          |
|                   | Random Number         |                          |
|                   | Generator (RNG)s used |                          |
|                   | for security services |                          |
|                   | are fit for this      |                          |
|                   | purpose.              |                          |
|                   |                       |                          |
|                   | ***Note:** For        |                          |
|                   | configuration and use |                          |
|                   | of the NIST SP800- 22 |                          |
|                   | STS tool, refer to    |                          |
|                   | Appendix F.*          |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-2.3** When | **1A-2.3.a** The      | DRNG algorithms used by  |
| > not using a     | tester must confirm   | the MPoC SDK are         |
| > hardware based  | through examination   | required to be secure    |
| > true Random     | that, where a         | algorithms and known     |
| > Number          | hardware based true   | international standards  |
| > Generator       | Random Number         | suitable for             |
| > (RNG), the MPoC | Generator (RNG) is    | cryptography use as      |
| > SDK must        | not directly used,    | specified in *[Appendix  |
| > implement its   | the MPoC SDK          | C:](#appendix-c          |
| > own secure DRNG | implements its own    | -minimum-and-equivalent- |
| > based on        | DRNG based on         | key-sizes-and-strengths- |
| > industry        | well-known            | for-approved-algorithms) |
| > standards.      | international and     | [Minimum and Equivalent  |
|                   | industry- standard    | Key Sizes and Strengths  |
|                   | algorithms suitable   | for](#appendix-c-        |
|                   | for cryptography use. | minimum-and-equivalent-k |
|                   |                       | ey-sizes-and-strengths-f |
|                   |                       | or-approved-algorithms)* |
|                   |                       | [*Approved               |
|                   |                       | A                        |
|                   |                       | lgorithms*.](#appendix-c |
|                   |                       | -minimum-and-equivalent- |
|                   |                       | key-sizes-and-strengths- |
|                   |                       | for-approved-algorithms) |
|                   |                       |                          |
|                   |                       | Homegrown algorithms do  |
|                   |                       | not provide enough       |
|                   |                       | assurance on the quality |
|                   |                       | of the random numbers    |
|                   |                       | provided or the security |
|                   |                       | of the algorithm. It is  |
|                   |                       | expected that the        |
|                   |                       | algorithms used by the   |
|                   |                       | MPoC SDK use             |
|                   |                       | international and        |
|                   |                       | industry- standard       |
|                   |                       | algorithms (e.g., NIST   |
|                   |                       | SP 800-90A).             |
+-------------------+-----------------------+--------------------------+
| > **1A-2.4**      | **1A-2.4.a** The      | A DRNG is by definition  |
| > DRNGs used by   | tester must confirm   | deterministic -- given   |
| > the MPoC SDK    | through examination   | the same input, it will  |
| > must be         | that, for each DRNG   | produce the same output. |
| > regularly       | used in the MPoC      | Therefore, it is         |
| > (re)seeded with | Software:             | important that the input |
| > unpredictable   |                       | to a DRNG -- the "seed"  |
| > values of       | -   The seeds have    | -- is sufficiently       |
| > sufficient      |     appropriate       | unpredictable.           |
| > entropy, which  |     entropy (at least |                          |
| > are protected   |     equal to the      | To ensure that a         |
| > for             |     strength of any   | compromise of a DRNG     |
| > confidentiality |     random value they | state during operation   |
| > and integrity.  |     are required to   | does not result in the   |
|                   |     produce).         | compromise of all        |
|                   |                       | further values output    |
|                   | -   The seeds are     | from that DRNG, the DRNG |
|                   |     derived from      | is required to be        |
|                   |     trusted sources.  | regularly reseeded.      |
|                   |                       |                          |
|                   | -   The seeds are     | Random seed values       |
|                   |     protected against | transmitted from         |
|                   |     disclosure.       | external systems may be  |
|                   |                       | protected using the      |
|                   | -   The seeds are     | secure channel           |
|                   |     protected against | implemented for that     |
|                   |     tampering.        | connection.              |
|                   |                       |                          |
|                   | -   The MPoC Software |                          |
|                   |     implements        |                          |
|                   |     protections       |                          |
|                   |     against tampering |                          |
|                   |     of the DRNG and   |                          |
|                   |     its seeding       |                          |
|                   |     process.          |                          |
|                   |                       |                          |
|                   | -   The DRNG is       |                          |
|                   |     seeded at least   |                          |
|                   |     each time the     |                          |
|                   |     MPoC Software     |                          |
|                   |     launches, and     |                          |
|                   |     reseeded after    |                          |
|                   |     every 24 hours of |                          |
|                   |     continuous        |                          |
|                   |     operation.        |                          |
|                   |                       |                          |
|                   | -   The DRNG seeding  |                          |
|                   |     process is        |                          |
|                   |     performed if the  |                          |
|                   |     integrity and     |                          |
|                   |     confidentiality   |                          |
|                   |     of the DRNG state |                          |
|                   |     cannot be         |                          |
|                   |     ensured, such as  |                          |
|                   |     upon launch or    |                          |
|                   |     return from a     |                          |
|                   |     halted state.     |                          |
|                   |                       |                          |
|                   | -   In all cases, the |                          |
|                   |     DRNG is reseeded  |                          |
|                   |     after 24 hours    |                          |
|                   |     has elapsed since |                          |
|                   |     the last seeding  |                          |
|                   |     process.          |                          |
|                   |                       |                          |
|                   | ***Note:** This       |                          |
|                   | requirement only      |                          |
|                   | applies to systems    |                          |
|                   | using a DRNG assessed |                          |
|                   | under requirement     |                          |
|                   | 1A-2.3.*              |                          |
|                   |                       |                          |
|                   | ***Note:** [Appendix  |                          |
|                   | C](#_bookmark134)     |                          |
|                   | outlines the          |                          |
|                   | requirements for      |                          |
|                   | minimum entropy of    |                          |
|                   | cryptographic keys.*  |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-2.5** The  | **1A-2.5.a** The      | The DRNG used by the     |
| > DRNG used by    | tester must confirm   | MPoC SDK can use         |
| > the MPoC SDK    | through examination   | different sources of     |
| > must use more   | that the DRNG seeding | entropy to obtain its    |
| > than one source | process includes      | seed (e.g., one HSM and  |
| > of entropy to   | random data from a    | the COTS platform Random |
| > obtain its      | trusted external      | Number Generator (RNG)). |
| > seed. Entropy   | source, such as a PCI | This increases the       |
| > sources must    | PTS SCRP or back-end  | effort needed to         |
| > include at      | HSM, in addition to   | compromise the DRNG used |
| > least one       | one from the COTS     | by the MPoC SDK.         |
| > external        | device.               |                          |
| > trusted source, |                       | The back-end random data |
| > as well as a    | ***Note:** This       | can be obtained from the |
| > source from the | requirement only      | back-end HSM. The random |
| > COTS device.    | applies to systems    | data taken from the COTS |
|                   | using a DRNG assessed | device can be obtained   |
|                   | under requirement     | from one of the COTS     |
|                   | 1A-2.3.*              | platform Random Number   |
|                   |                       | Generator (RNG) sources  |
|                   |                       | (OS, TEE, SE) or from    |
|                   |                       | another method of        |
|                   |                       | collecting unpredictable |
|                   |                       | data. By using these two |
|                   |                       | sets of (re)seed data    |
|                   |                       | from different systems   |
|                   |                       | (COTS device, and        |
|                   |                       | external) it provides    |
|                   |                       | confidence that the      |
|                   |                       | entropy sources used are |
|                   |                       | independent.             |
|                   |                       |                          |
|                   |                       | Where HSMs are used, the |
|                   |                       | compliance and testing   |
|                   |                       | requirements for these   |
|                   |                       | are covered in the       |
|                   |                       | operational Domains of   |
|                   |                       | this standard, in        |
|                   |                       | requirements 4A-2.x.     |
|                   |                       |                          |
|                   |                       | Requirement 4A-2.2       |
|                   |                       | specifies that HSMs used |
|                   |                       | in the back-end systems  |
|                   |                       | are required to be       |
|                   |                       | compliant to FIPS140-2   |
|                   |                       | level 3 (or above) or    |
|                   |                       | PCI HSM.                 |
|                   |                       |                          |
|                   |                       | The need for an external |
|                   |                       | entropy source does not  |
|                   |                       | apply if the COTS        |
|                   |                       | platform provides a      |
|                   |                       | suitable hardware RNG,   |
|                   |                       | such as through an SE or |
|                   |                       | TEE, which is used by    |
|                   |                       | the MPoC SDK. Note that  |
|                   |                       | this applies only if a   |
|                   |                       | hardware RNG is          |
|                   |                       | provided, not to DRNGs,  |
|                   |                       | which are the focus of   |
|                   |                       | this requirement.        |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-2.6** The  | **1A-2.6.a** The      | When reseeding the DRNG, |
| > reseeding       | tester confirms       | the new seed is required |
| > method used by  | through examination   | to add to the entropy of |
| > the MPoC SDK    | that the method to    | the DRNG and not be used |
| > must add        | reseed the algorithm  | to re- instantiate the   |
| > entropy to the  | is secure and the     | DRNG to a previous or    |
| > DRNG state      | entropy used to       | known state. This helps  |
| > instead of      | reseed does not       | to mitigate the risk     |
| > replacing the   | completely determine  | that a compromised       |
| > existing        | the future states of  | future seed can be used  |
| > entropy.        | the DRNG (i.e.,       | to completely determine  |
|                   | entropy is added to   | the output of the DRNG.  |
|                   | the state of the DRNG |                          |
|                   | instead of            | Adding to the entropy of |
|                   | re-instantiating the  | the DRNG, rather than    |
|                   | DRNG).                | implanting another       |
|                   |                       | seeding process to       |
|                   |                       | restart the DRNG,        |
|                   |                       | ensures that any         |
|                   |                       | attacker who has         |
|                   |                       | compromised the current  |
|                   |                       | entropy values is not    |
|                   |                       | able to determine the    |
|                   |                       | output of the DRNG       |
|                   |                       | unless they have         |
|                   |                       | captured all entropy     |
|                   |                       | seeding values. This     |
|                   |                       | mitigates attacks        |
|                   |                       | against externally       |
|                   |                       | supplied entropy, such   |
|                   |                       | as that supplied by a    |
|                   |                       | PCI PTS SCRP or HSM.     |
|                   |                       |                          |
|                   |                       | Some implementations may |
|                   |                       | prevent the reseeding of |
|                   |                       | the platform Random      |
|                   |                       | Number Generator (RNG).  |
|                   |                       | In such cases, either a  |
|                   |                       | separate Random Number   |
|                   |                       | Generator (RNG) will     |
|                   |                       | need to be used or       |
|                   |                       | methods other than       |
|                   |                       | reseeding will be        |
|                   |                       | required to ensure       |
|                   |                       | sufficient entropy for   |
|                   |                       | the platform Random      |
|                   |                       | Number Generator (RNG).  |
|                   |                       |                          |
|                   |                       | Reseeding is not         |
|                   |                       | required for systems     |
|                   |                       | that use hardware based  |
|                   |                       | true Random Number       |
|                   |                       | Generator (RNG)s, such   |
|                   |                       | as secure elements or    |
|                   |                       | trusted execution        |
|                   |                       | environment assessed to  |
|                   |                       | provide such functions.  |
+-------------------+-----------------------+--------------------------+
|                   | **1A-2.6.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the method used  |                          |
|                   | to combine the        |                          |
|                   | collected entropy     |                          |
|                   | inputs into a single  |                          |
|                   | seed for the DRNG     |                          |
|                   | maintains the entropy |                          |
|                   | of each seed, such as |                          |
|                   | by XORing each seed   |                          |
|                   | value into a single   |                          |
|                   | entropy pool.         |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1A-2.6.c** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that any entropy pool |                          |
|                   | maintained for the    |                          |
|                   | DRNG implements       |                          |
|                   | methods to protect    |                          |
|                   | the integrity and     |                          |
|                   | confidentiality of    |                          |
|                   | that pool.            |                          |
|                   |                       |                          |
|                   | ***Note:** This       |                          |
|                   | requirement only      |                          |
|                   | applies to systems    |                          |
|                   | using a DRNG assessed |                          |
|                   | under requirement     |                          |
|                   | 1A-2.3.*              |                          |
+-------------------+-----------------------+--------------------------+

### 1A-3 Acceptable Cryptography

> Cryptography is an important factor to ensure confidentiality and
> integrity of data and processes that support the MPoC Solution.
> Therefore, it is important that only industry-recognized standard
> cryptographic algorithms and modes of operation be the basis for any
> security services used in the MPoC Solution.
>
> Sensitive assets are required be encrypted on the COTS device for
> transporting to other components of the MPoC Solution using
> cryptographic algorithms and modes of operation known to provide
> suitable levels of security.
>
> All cryptographic keys are required to be used for a single specific
> purpose. For example, a key used to encrypt account data is not
> permitted to also be used to protect the integrity of the
> tamper-detection data.
>
> This requirement does not apply to cryptographic methods applied by
> the PCI PTS SCRP for onward processing by the payment processing
> environment (e.g., PIN block translation functions performed by the
> PCI PTS SCRP, which have been previously assessed to PCI PTS POI
> standard).

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| >                 |                       |                          |
| Industry-standard |                       |                          |
| > and accepted    |                       |                          |
| > cryptography is |                       |                          |
| > used to protect |                       |                          |
| > sensitive       |                       |                          |
| > assets.         |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-3.1**      | **1A-3.1.a** The      | Information that         |
| > Sof             | tester must confirm   | identifies cryptographic |
| tware-development | through examination   | operations used in the   |
| > documentation   | that the required     | solution helps ensure    |
| > must provide    | information is        | that these controls and  |
| > details about   | present and matches   | their use are            |
| > acceptable      | the design of the     | appropriately understood |
| > cryptographic   | solution.             | prior to testing. It     |
| > processes and   |                       | also helps to identify   |
| > operations to   | Documentation must    | areas where cryptography |
| > be used for     | include, but not be   | may increase the         |
| > security        | limited to, the       | solution's security      |
| > services.       | following:            | protection.              |
|                   |                       |                          |
|                   | -   The cryptographic | This software            |
|                   |     algorithms and    | development              |
|                   |     key sizes that    | documentation provides   |
|                   |     must be used for  | guidance and outlines    |
|                   |     security          | the necessary controls   |
|                   |     services. These   | and features for the     |
|                   |     must be compliant | development of the       |
|                   |     with *[Appendix C | solution. Therefore,     |
|                   |     Minimum           | references to            |
|                   |                       | cryptographic algorithms |
|                   |   and](#_bookmark134) | or key lengths need to   |
|                   |     [Equivalent Key   | be in line with other    |
|                   |     Sizes and         | testing requirements     |
|                   |     Strengths         | (e.g., minimum           |
|                   |                       | acceptable algorithm     |
|                   |   for](#_bookmark134) | types and key lengths).  |
|                   |     [Approved         |                          |
|                   |     Algori            | The remaining            |
|                   | thms](#_bookmark134)* | requirements in this     |
|                   |     when used for     | Section describe the     |
|                   |     security-         | testing required to      |
|                   |     sensitive         | validate that the        |
|                   |     service.          | implementation is        |
|                   |                       | produced in line with    |
|                   | -   Key-generation or | the rules of the         |
|                   |     key-agreement     | software- development    |
|                   |     processes.        | process.                 |
|                   |                       |                          |
|                   | -   Description of    |                          |
|                   |     cryptographic key |                          |
|                   |     protection        |                          |
|                   |     mechanisms.       |                          |
|                   |                       |                          |
|                   | -   Key derivation    |                          |
|                   |     functions used,   |                          |
|                   |     including any key |                          |
|                   |     check value,      |                          |
|                   |     check values, or  |                          |
|                   |     other derivation  |                          |
|                   |     functions.        |                          |
|                   |                       |                          |
|                   | -   Modes of          |                          |
|                   |     operation.        |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-3.2** All  | **1A-3.2.a** The      | To withstand attacks,    |
| > cryptographic   | tester must confirm   | the solution is required |
| > processes,      | through examination   | to use the most robust   |
| > including hash  | that the              | and current encryption   |
| > functions, used | cryptographic         | algorithms and key       |
| > to provide      | algorithms and the    | sizes. Legacy algorithms |
| > security to the | key sizes comply with | may have known           |
| > solution must   | *[Appendix C Minimum  | weaknesses and provide   |
| > adhere to       | and](#_bookmark134)   | security levels that are |
| > *[Appendix C    | [Equivalent Key Sizes | unsuitable given current |
| > Minimum and     | and Strengths for     | and projected computing  |
| > Equivalent      | Appr                  | power.                   |
| > Ke              | oved](#_bookmark134)* |                          |
| y](#_bookmark134) | [*Algorit             | Use of recognized        |
| > [Sizes and      | hms*.](#_bookmark134) | cryptographic methods    |
| > Strengths for   |                       | ensures that the         |
| > Approved        |                       | solution adheres to      |
| ](#_bookmark134)* |                       | industry-tested and      |
| > [*Algorithms*   |                       | accepted algorithms and  |
| .](#_bookmark134) |                       | appropriate key lengths  |
|                   |                       | that deliver effective   |
|                   |                       | key strength and proper  |
|                   |                       | key-management           |
|                   |                       | practices. Proprietary   |
|                   |                       | or "home-grown"          |
|                   |                       | algorithms do not        |
|                   |                       | provide this assurance   |
|                   |                       | and are not permitted.   |
|                   |                       |                          |
|                   |                       | Hash functions are used  |
|                   |                       | to provide integrity and |
|                   |                       | support authenticity     |
|                   |                       | controls over data. They |
|                   |                       | may be used on their own |
|                   |                       | or in combination with   |
|                   |                       | other cryptographic      |
|                   |                       | controls.                |
+-------------------+-----------------------+--------------------------+
| > **1A-3.3**      | **1A-3.3.a** The      | Certificates are often   |
| > Public keys     | tester must confirm   | used to exchange public  |
| > used by the     | through examination   | keys. Verification of    |
| > MPoC Software   | and observation that  | certificate signatures   |
| > must be         | the public keys used  | can be used to           |
| > protected for   | in the MPoC Software  | authenticate the public  |
| > integrity and   | are protected for     | key and meta data. This  |
| > authenticity    | authenticity and      | is normally guaranteed   |
| > and be          | integrity.            | by verifying the         |
| > authenticated   |                       | complete certificate     |
| > before use of   |                       | chain up to the          |
| > the             |                       | certificate authority.   |
| > certificate.    |                       |                          |
|                   |                       | However, in the case of  |
|                   |                       | MPoC Software, some      |
|                   |                       | certificates may be      |
|                   |                       | signed by the MPoC       |
|                   |                       | Solution provider and    |
|                   |                       | not by an established    |
|                   |                       | CA. These certificates   |
|                   |                       | can be authenticated by  |
|                   |                       | using application        |
|                   |                       | package signature as the |
|                   |                       | root of trust protecting |
|                   |                       | the application-embedded |
|                   |                       | certificate(s) against   |
|                   |                       | tampering.               |
|                   |                       |                          |
|                   |                       | For certificates used by |
|                   |                       | the MPoC Software that   |
|                   |                       | are signed by the MPoC   |
|                   |                       | Solution provider, a     |
|                   |                       | self-signed certificate  |
|                   |                       | embedded in the signed   |
|                   |                       | MPoC Software package    |
|                   |                       | may be used to validate  |
|                   |                       | other certificates.      |
|                   |                       |                          |
|                   |                       | Requirements for the     |
|                   |                       | security of signing      |
|                   |                       | operations performed by  |
|                   |                       | the MPoC Solution        |
|                   |                       | provider can be found in |
|                   |                       | Domain 4 of this         |
|                   |                       | standard.                |
+-------------------+-----------------------+--------------------------+
|                   | **1A-3.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | the public keys used  |                          |
|                   | in the MPoC Software  |                          |
|                   | are authenticated     |                          |
|                   | prior to use.         |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-3.4** Each | **1A-3.4.a** The      | The MPoC Software is     |
| > key must have a | tester must confirm   | required to prevent the  |
| > single unique   | through examination   | use of a single key for  |
| > purpose, and no | that the              | more than one purpose    |
| > keys may be     | cryptographic keys    | (e.g., signing and       |
| > used for        | used in the MPoC      | encrypting data, or      |
| > multiple        | Software are not used | using a key encrypting   |
| > purposes.       | for multiple          | key to encrypt PANs).    |
|                   | purposes,             | This helps to reduce the |
|                   | specifically noting   | impact of the compromise |
|                   | the findings for the  | of any one key.          |
|                   | PIN and (other)       |                          |
|                   | account data keys.    | The disclosure of a      |
|                   |                       | secret or private key    |
|                   |                       | needs to be prevented    |
|                   |                       | from compromising data   |
|                   |                       | not intended to be       |
|                   |                       | protected by that key    |
|                   |                       | (e.g., so the compromise |
|                   |                       | of a key that protects   |
|                   |                       | card data cannot expose  |
|                   |                       | PIN data).               |
|                   |                       |                          |
|                   |                       | Keys used in             |
|                   |                       | industry-standard        |
|                   |                       | protocols, such as TLS,  |
|                   |                       | are not included in this |
|                   |                       | requirement.             |
|                   |                       |                          |
|                   |                       | A key that exists higher |
|                   |                       | in the hierarchy can be  |
|                   |                       | used to generate or      |
|                   |                       | derive multiple keys,    |
|                   |                       | each with its own        |
|                   |                       | purpose, if the key      |
|                   |                       | derivation method used   |
|                   |                       | is secure. This is       |
|                   |                       | assessed in the next     |
|                   |                       | requirement.             |
+-------------------+-----------------------+--------------------------+
| > **1A-3.5** Key  | **1A-3.5.a** The      | Derivation and key check |
| > derivation and  | tester must confirm   | functions need to be     |
| > key check       | through examination   | selected such that an    |
| > functions are   | that the derivation   | attacker cannot gain     |
| > implemented     | and key check         | information of the key   |
| > securely.       | functions present in  | used as part of the      |
|                   | the MPoC Software are | derivation or check      |
|                   | one- way functions    | process (the "derivation |
|                   | and do not expose     | key" or "original key")  |
|                   | information about the | by observing the derived |
|                   | keys used in the      | value, or a set of them. |
|                   | derivation or check   |                          |
|                   | process.              | Examples of derivation   |
|                   |                       | functions that do not    |
|                   |                       | reveal the derivation    |
|                   |                       | key are encryption and   |
|                   |                       | one-way functions such   |
|                   |                       | as CMAC.                 |
+-------------------+-----------------------+--------------------------+
|                   | **1A-3.5.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that it is not        |                          |
|                   | possible to calculate |                          |
|                   | the derivation or key |                          |
|                   | check function output |                          |
|                   | without prior         |                          |
|                   | knowledge of the      |                          |
|                   | derivation or key     |                          |
|                   | check material,       |                          |
|                   | including the         |                          |
|                   | cryptographic key     |                          |
|                   | used.                 |                          |
+-------------------+-----------------------+--------------------------+

### 1A-4 Key Management Design

> Secure key management is critical to the security of cryptographic
> systems. It is a fundamental factor for ensuring the confidentiality
> and integrity of data and processes that support the MPoC Solution.
> key management practices must conform to the industry-accepted
> practices described in this Section. Cryptographic keys are managed
> securely using recognized industry requirements throughout the
> cryptographic lifecycle including, but not limited to:

-   Generation

-   Distribution/conveyance

-   Storage

-   Established cryptoperiods

-   Replacement/rotation when the cryptoperiod is reached

-   Escrow/backup

-   Key compromise and recovery

-   Emergency procedures to destroy and replace keys

-   Accountability and audit

> Secret and private cryptographic keys that are relied upon for
> security are required to be unique per device/application, with the
> exception of keys protected through software-protected cryptography
> means, which are used to establish an initial trust anchor prior to
> provisioning unique keys to the MPoC Application. Shared public keys
> are acceptable, but methods and procedures for revoking compromised
> public key/private key pairs must be implemented. For additional
> information about public key Infrastructure (PKI), refer to X9.79-4.
>
> Operations that involve secret or private cryptographic keys are to be
> performed using split knowledge. Split knowledge requires that no one
> person can determine any single bit of a secret or private
> cryptographic key. Split knowledge can be provided in the following
> ways:

-   Storing keys on secure cryptographic devices (SCD) approved by
    FIPS140-2 Level 3 (or equivalent in FIPS 140-3) or PCI PTS- HSM that
    will not output the cleartext key.

-   Two or more full-length components during key loading*.*

-   An M-of-N secret-sharing scheme.

+------------------+-----------------------+---------------------------+
| > **Security     | > **Test              | > **Guidance**            |
| > Requirements** | > Requirements**      |                           |
+==================+=======================+===========================+
| > **Objective:** |                       |                           |
| > Cryptographic  |                       |                           |
| > keys that      |                       |                           |
| > protect the    |                       |                           |
| > MPoC Software  |                       |                           |
| > and the        |                       |                           |
| > sensitive      |                       |                           |
| > assets are     |                       |                           |
| > securely       |                       |                           |
| > managed.       |                       |                           |
+------------------+-----------------------+---------------------------+
| > **1A-4.1** An  | **1A-4.1.a** The      | A good key-management     |
| > inventory of   | tester must confirm   | process, whether manual   |
| > all keys used  | through examination   | or automated, is based on |
| > by the MPoC    | that the information  | industry standards and    |
| > Software must  | provided matches      | addresses all elements of |
| > be maintained. | their understanding   | the key lifecycle that    |
|                  | of the MPoC Solution  | include:                  |
|                  | and contains the      |                           |
|                  | required information  | -                         |
|                  | for all keys used in  |   Distribution/conveyance |
|                  | the MPoC Software.    |                           |
|                  |                       | -   Storage               |
|                  | For each key, the     |                           |
|                  | information must be   | -   Established crypto    |
|                  | provided containing   |     periods               |
|                  | at a minimum:         |                           |
|                  |                       | -   Replacement/rotation  |
|                  | -   ID or name of the |     when the cryptoperiod |
|                  |     key               |     is reached            |
|                  |                       |                           |
|                  | -   Function/purpose  | -   Escrow/backup         |
|                  |                       |                           |
|                  | -   Uniqueness (e.g., | -   Key compromise and    |
|                  |     per transaction,  |     recovery              |
|                  |     device, solution, |                           |
|                  |     etc.)             | -   Emergency procedures  |
|                  |                       |     to destroy and        |
|                  | -   Algorithm and key |     replace keys          |
|                  |     size              |                           |
|                  |                       | -   Accountability and    |
|                  | -   Cryptoperiod (key |     audit                 |
|                  |     lifetime)         |                           |
|                  |                       | For example, key          |
|                  | -   Key-generation    | generation is required to |
|                  |     location (Name of | conform to                |
|                  |     server,           | industry-recognized       |
|                  |     application,      | procedures that ensure    |
|                  |     database, device, | the confidentiality of    |
|                  |     etc.)             | the underlying key.       |
|                  |                       | Secret and private        |
|                  | -   Key-generation    | cryptographic keys need   |
|                  |     method (SCD, PCI  | to be distributed         |
|                  |     PTS SCRP, OS, SE, | securely, never in the    |
|                  |     TEE, software,    | clear, and only to        |
|                  |     etc.)             | designated custodians or  |
|                  |                       | recipients. Procedures    |
|                  | -   Key usage         | for distribution apply    |
|                  |     location (name of | both within the entity    |
|                  |     server,           | and outside it.           |
|                  |     application,      |                           |
|                  |     database, device, | Secret and private keys   |
|                  |     etc. For          | are required to be        |
|                  |     symmetric keys    | encrypted with a strong   |
|                  |     this is at least  | key-encrypting key that   |
|                  |     2 locations.)     | is stored separately,     |
|                  |                       | stored within an SCD      |
|                  | -   Key loading       | (such as an HSM), or      |
|                  |     (where relevant,  | stored as at least two    |
|                  |     how is the key    | full-length key           |
|                  |     loaded?)          | components or key shares  |
|                  |                       | in accordance with an     |
|                  | -   Confidentiality   | industry-accepted method. |
|                  |     protection during |                           |
|                  |     transport         | *(continued on next       |
|                  |                       | page)*                    |
|                  | -   Confidentiality   |                           |
|                  |     protection during |                           |
|                  |     storage           |                           |
|                  |                       |                           |
|                  | -   Integrity         |                           |
|                  |     protection during |                           |
|                  |     transport         |                           |
|                  |                       |                           |
|                  | -   Integrity         |                           |
|                  |     protection during |                           |
|                  |     storage           |                           |
|                  |                       |                           |
|                  | -                     |                           |
|                  |   Removal/destruction |                           |
+------------------+-----------------------+---------------------------+

+------------------+-----------------------+---------------------------+
| > **Security     | > **Test              | > **Guidance**            |
| > Requirements** | > Requirements**      |                           |
+==================+=======================+===========================+
|                  | **1A-4.1.b** The      | A cryptoperiod needs to   |
|                  | tester must document  | be identified for each    |
|                  | a separate key table  | key based on a risk       |
|                  | that outlines all     | assessment, and keys are  |
|                  | cryptographic keys    | required to be changed    |
|                  | used in the MPoC      | when this period is       |
|                  | Software for the      | reached. Additionally,    |
|                  | security of the       | keys are required to be   |
|                  | solution.             | immediately prevented     |
|                  |                       | from use. Compromised     |
|                  |                       | keys should be destroyed  |
|                  |                       | and replaced promptly     |
|                  |                       | upon confirmation of a    |
|                  |                       | compromise. Secure        |
|                  |                       | key-management practices  |
|                  |                       | include:                  |
|                  |                       |                           |
|                  |                       | -   Minimizing access to  |
|                  |                       |     keys to the fewest    |
|                  |                       |     number of custodians  |
|                  |                       |     necessary.            |
|                  |                       |                           |
|                  |                       | -   Enforcing split       |
|                  |                       |     knowledge and dual    |
|                  |                       |     control for           |
|                  |                       |     activities involving  |
|                  |                       |     cleartext keys or key |
|                  |                       |     components.           |
|                  |                       |                           |
|                  |                       | -   Defining roles and    |
|                  |                       |     responsibilities for  |
|                  |                       |     Key Custodians and    |
|                  |                       |     Key Managers.         |
|                  |                       |                           |
|                  |                       | The key inventory must    |
|                  |                       | include any public keys   |
|                  |                       | or certificates used by   |
|                  |                       | the solution. Where       |
|                  |                       | possible, certificates    |
|                  |                       | should be maintained in a |
|                  |                       | standard format such as   |
|                  |                       | X.509. When certificates  |
|                  |                       | are used or stored in     |
|                  |                       | other formats,            |
|                  |                       | information about the     |
|                  |                       | certificate use and       |
|                  |                       | context may need to be    |
|                  |                       | stored in another format. |
|                  |                       |                           |
|                  |                       | For example, a specific   |
|                  |                       | protocol or               |
|                  |                       | implementation may use    |
|                  |                       | public keys in a format   |
|                  |                       | referred to as a          |
|                  |                       | certificate, which does   |
|                  |                       | not necessarily provide   |
|                  |                       | an "Issued to" field.     |
|                  |                       | When this is the case,    |
|                  |                       | the data may be intrinsic |
|                  |                       | to the implementation or  |
|                  |                       | may be stored within the  |
|                  |                       | certificate inventory     |
|                  |                       | itself.                   |
+------------------+-----------------------+---------------------------+

+------------------+-----------------------+---------------------------+
| > **Security     | > **Test              | > **Guidance**            |
| > Requirements** | > Requirements**      |                           |
+==================+=======================+===========================+
| > **1A-4.2**     | **1A-4.2.a** The      | Requirement 4A-2.6 covers |
| > Secret or      | tester must confirm   | the operational aspects   |
| > private keys   | through examination   | of key management, and    |
| > must be        | and observation that  | notes that key blocks are |
| > imported to    | secret and private    | one way of protecting the |
| > the MPoC       | keys are imported or  | confidentiality and       |
| > Software in a  | injected into the     | integrity of              |
| > form that      | MPoC Software only in | cryptographic keys.       |
| > protects their | a way that protects   |                           |
| >                | their confidentiality | When the MPoC Software    |
|  confidentiality | and integrity.        | requires secret or        |
| > and integrity, |                       | private cryptographic     |
| > and does not   | **1A-4.2.b** The      | keys to be imported,      |
| > solely rely on | tester must confirm   | these need to be          |
| > the            | through examination   | protected.                |
| > protections    | and observation that  |                           |
| > provided by    | the confidentiality,  | It is not sufficient to   |
| > any secure     | integrity, and        | send such keys protected  |
| > channel(s)     | authenticity          | only using secure channel |
| > being used.    | protections do not    | protection, such as TLS.  |
|                  | solely rely on the    | The keys are required to  |
|                  | use of a secure       | have their                |
|                  | channel.              | confidentiality           |
|                  |                       | separately protected,     |
|                  | **1A-4.2.c** The      | such as through use of a  |
|                  | tester must confirm   | key encryption key        |
|                  | through examination   | dedicated for that        |
|                  | and observation that  | purpose.                  |
|                  | keys used to encrypt  |                           |
|                  | other keys for        | Keys should be created,   |
|                  | transport are not     | and securely maintained,  |
|                  | also used to secure   | within the environment    |
|                  | keys during storage.  | where they are used       |
|                  |                       | (e.g., hardware-backed    |
|                  |                       | keystore,                 |
|                  |                       | software-protected        |
|                  |                       | cryptography, secure      |
|                  |                       | element, etc.).           |
|                  |                       | Alternatively,            |
|                  |                       | cryptographic keys may be |
|                  |                       | securely imported in an   |
|                  |                       | encrypted form, such that |
|                  |                       | keys are not exposed      |
|                  |                       | outside of the            |
|                  |                       | environment where they    |
|                  |                       | were generated.           |
|                  |                       |                           |
|                  |                       | Use of the same           |
|                  |                       | cryptographic keys for    |
|                  |                       | transport and storage can |
|                  |                       | cause additional risk of  |
|                  |                       | exposure to the           |
|                  |                       | operational keys being    |
|                  |                       | transported or stored.    |
|                  |                       |                           |
|                  |                       | Entering secret or        |
|                  |                       | private cryptographic     |
|                  |                       | keys as cleartext exposes |
|                  |                       | the value of that key.    |
|                  |                       | Implementations need to   |
|                  |                       | ensure that the entry of  |
|                  |                       | secret or private         |
|                  |                       | cryptographic keys does   |
|                  |                       | not reduce the security   |
|                  |                       | of those keys.            |
|                  |                       |                           |
|                  |                       | Implementations may       |
|                  |                       | export a secret or        |
|                  |                       | private key from an SCD   |
|                  |                       | directly into the MPoC    |
|                  |                       | Software, so that no one  |
|                  |                       | "sees" the key value, as  |
|                  |                       | long as the key is        |
|                  |                       | sufficiently protected    |
|                  |                       | after export (e.g.,       |
|                  |                       | through the use of        |
|                  |                       | white-box cryptography    |
|                  |                       | for keys stored in the    |
|                  |                       | MPoC SDK, or storage in a |
|                  |                       | hardware key store or     |
|                  |                       | HSM). Alternatively, an   |
|                  |                       | implementation may import |
|                  |                       | working keys encrypted    |
|                  |                       | under another (transport) |
|                  |                       | key.                      |
|                  |                       |                           |
|                  |                       | Alternatively, keys may   |
|                  |                       | be input using processes  |
|                  |                       | for "dual control and     |
|                  |                       | split knowledge," which   |
|                  |                       | provide for the entry of  |
|                  |                       | key components using      |
|                  |                       | multiple key custodians.  |
+------------------+-----------------------+---------------------------+

+------------------+-----------------------+---------------------------+
| > **Security     | > **Test              | > **Guidance**            |
| > Requirements** | > Requirements**      |                           |
+==================+=======================+===========================+
|                  |                       | This requirement covers   |
|                  |                       | only the support for      |
|                  |                       | secure key importing.     |
|                  |                       | Operational aspects are   |
|                  |                       | considered under the      |
|                  |                       | operational requirements  |
|                  |                       | of this standard.         |
+------------------+-----------------------+---------------------------+
| > **1A-4.3**     | **1A-4.3.a** The      | When secret or private    |
| > Secret or      | tester must confirm   | keys are embedded in the  |
| > private keys   | through examination   | MPoC Software, they need  |
| > embedded into  | and observation that  | to be protected using     |
| > an MPoC SDK    | if secret and private | software methods such as  |
| > must implement | keys are embedded in  | software-protected        |
| > software       | the MPoC SDK, they    | cryptography.             |
| > protection     | are in a form that is |                           |
| > methods and    | protected with        | Embedding of secret or    |
| > not be exposed | software-based        | private cryptographic     |
| > in cleartext.  | protection measures   | keys in aspects of the    |
|                  | such as               | MPoC Software other than  |
|                  | software-protected    | the MPoC SDK is not       |
|                  | cryptography.         | permitted.                |
+------------------+-----------------------+---------------------------+
|                  | **1A-4.3.b** The      |                           |
|                  | tester must confirm   |                           |
|                  | through examination   |                           |
|                  | that any software     |                           |
|                  | protection measures   |                           |
|                  | used are compliant to |                           |
|                  | the 1B-2.x            |                           |
|                  | requirements of this  |                           |
|                  | standard.             |                           |
+------------------+-----------------------+---------------------------+
|                  | **1A-4.3.c** The      |                           |
|                  | tester must confirm   |                           |
|                  | through examination   |                           |
|                  | that secret or        |                           |
|                  | private cryptographic |                           |
|                  | keys are not embedded |                           |
|                  | in any other aspects  |                           |
|                  | of the MPoC Software, |                           |
|                  | other than the MPoC   |                           |
|                  | SDK.                  |                           |
+------------------+-----------------------+---------------------------+
| > **1A-4.4**     | **1A-4.4.a** The      | Certificates that exist   |
| > Certificates   | tester must confirm   | on the COTS device as     |
| > that exist on  | through examination   | part of the COTS OS may   |
| > the COTS       | that any certificates | be considered out of      |
| > device as part | used by the MPoC      | scope if the solution is  |
| > of the COTS OS | Solution, which are   | not using these           |
| > must be        | part of the COTS OS,  | certificates. Where       |
| > considered in  | are included into the | certificates or public    |
| > scope if used  | scope of the          | keys are used, they are   |
| > by the         | assessment.           | required to meet the      |
| > solution for   |                       | relevant requirements for |
| > security       |                       | key strength and          |
| > purposes.      |                       | protection.               |
+------------------+-----------------------+---------------------------+
| > **1A-4.5**     | **1A-4.5.a** The      | Cryptographic keys need   |
| > Cryptographic  | tester must confirm   | to be established using   |
| > keys must be   | through examination   | processes that ensure     |
| > established    | and observation that  | their strength and        |
| > using a        | all cryptographic     | confidentiality. This may |
| > process that   | keys established by   | include use of an         |
| > ensures the    | the MPoC Software use | approved DRNG, remote key |
| > entropy and    | processes that ensure | injection, or a secure    |
| >                | the entropy input to  | key agreement protocol.   |
|  confidentiality | each key is at least  | Output of cleartext       |
| > of the key.    | equal to the          | secret or private         |
|                  | effective strength of | cryptographic keys        |
|                  | that key.             | exposes those keys to     |
|                  |                       | potential compromise.     |
|                  |                       |                           |
|                  |                       | For requirements          |
|                  |                       | outlining the effective   |
|                  |                       | strength of cryptographic |
|                  |                       | keys, refer to [*Appendix |
|                  |                       | C*.](#_bookmark134)       |
+------------------+-----------------------+---------------------------+
|                  | **1A-4.5.b** The      |                           |
|                  | tester must confirm   |                           |
|                  | through examination,  |                           |
|                  | observation, and      |                           |
|                  | interview (where      |                           |
|                  | appropriate) that all |                           |
|                  | cryptographic key     |                           |
|                  | generation processes  |                           |
|                  | are designed and      |                           |
|                  | implemented in a way  |                           |
|                  | that protects the     |                           |
|                  | confidentiality of    |                           |
|                  | the cryptographic     |                           |
|                  | keys.                 |                           |
+------------------+-----------------------+---------------------------+

[]{#_bookmark53 .anchor}

+------------------+-----------------------+---------------------------+
| > **Security     | > **Test              | > **Guidance**            |
| > Requirements** | > Requirements**      |                           |
+==================+=======================+===========================+
| > **1A-4.6** The | **1A-4.6.a** The      | Operational key           |
| > MPoC Software  | tester must confirm   | management controls in    |
| > must support   | through examination   | *[Domain                  |
| > the use of     | and observation that  | 4](#domain-4-m            |
| > HSMs for       | the MPoC Software is  | poc-software-management)* |
| > storage and    | created to support    | require the use of HSMs   |
| > operation of   | the use of HSMs for   | to secure cryptographic   |
| > secret and     | storage and operation | keys used in the MPoC     |
| > private        | of cryptographic keys | Solution. To ensure that  |
| > cryptographic  | in the back-end       | any separately listed     |
| > keys in the    | environments.         | MPoC Software product     |
| > back-end       |                       | does not prevent          |
| > environments.  |                       | compliance to later       |
|                  |                       | operational requirements, |
|                  |                       | it is important that the  |
|                  |                       | software is created to    |
|                  |                       | support HSM use.          |
+------------------+-----------------------+---------------------------+
| > **1A-4.7** The | **1A-4.7.a** The      | The secrecy and security  |
| > MPoC Software  | tester must confirm   | of cryptographic keys,    |
| > must implement | through examination   | including the private     |
| > methods to     | and observation that  | keys associated with      |
| > revoke or      | the MPoC Software is  | public key certificates,  |
| > otherwise      | able to revoke or     | is the primary protection |
| > cease the use  | otherwise cease the   | provided by cryptographic |
| > of compromised | use of cryptographic  | systems. If a key or      |
| > cryptographic  | keys or certificates  | certificate is suspected  |
| > keys or        | that are suspected of | of being compromised, it  |
| > certificates.  | being compromised.    | is therefore vital to     |
|                  |                       | ensure further use of     |
|                  |                       | that key is prevented.    |
|                  |                       |                           |
|                  |                       | Protections of this type  |
|                  |                       | can be implemented        |
|                  |                       | through methods such as   |
|                  |                       | certificate revocation    |
|                  |                       | lists (CRLs) or through   |
|                  |                       | explicit replacement of   |
|                  |                       | suspected keys /          |
|                  |                       | certificates.             |
+------------------+-----------------------+---------------------------+
| > **1A-4.8**     | **1A-4.8.a** The      | It is common for          |
| > Cryptographic  | tester must confirm   | cryptographic keys to be  |
| > keys must not  | through examination   | protected in some way by  |
| > be protected   | and observation that  | another cryptographic key |
| > with a key of  | the MPoC Software     | -- either through         |
| > lesser         | does not allow for a  | encryption (to provide    |
| > strength.      | cryptographic key to  | confidentiality           |
|                  | be protected by a key | protections) or a digital |
|                  | of lesser strength.   | signature or (H)MAC (to   |
|                  |                       | provide authenticity      |
|                  |                       | protections). If the key  |
|                  |                       | providing protections is  |
|                  |                       | weaker than the key it is |
|                  |                       | protecting, this can      |
|                  |                       | become the most easily    |
|                  |                       | exploited path to the     |
|                  |                       | compromise of that key.   |
+------------------+-----------------------+---------------------------+

### 1A-5 Secure Channels

> A secure channel is a communications connection that protects the data
> and assets communicated across it. Secure channels can be provided by
> physical means using tamper-responsive hardware or by logical means
> using transmission security protocols such as TLS, or application
> layer cryptographic methods. Secure channels are vital to protect all
> communications between the various MPoC components including (where
> present):

-   Between the MPoC SDK and external card reader(s)

-   Between the MPoC SDK and back-end environments

> If internal systems such as a TEE or SE are used, and these provide
> for the use of a secure channel to protect communications between
> itself and the REE, then these protections must be used.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Connections     |                       |                          |
| > between         |                       |                          |
| > separate        |                       |                          |
| > elements of the |                       |                          |
| > MPoC Solution   |                       |                          |
| > are protected   |                       |                          |
| > and             |                       |                          |
| > authenticated.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-5.1**      | **1A-5.1.a** The      | A secure design of the   |
| > Secure channels | tester must confirm   | communication channels   |
| > established by  | through examination   | assists with protecting  |
| > the MPoC        | that the vendor       | assets during transit.   |
| > Software must   | secure channel        | For a resilient design,  |
| > be documented.  | information matches   | it is necessary to have  |
|                   | the design of the     | a clear understanding of |
|                   | solution. The         | how the secure channel   |
|                   | information must      | is established and the   |
|                   | include at a minimum: | root of trust relied     |
|                   |                       | upon for that secure     |
|                   | -   The endpoints of  | channel.                 |
|                   |     each secure       |                          |
|                   |     channel.          | An MPoC SDK will often   |
|                   |                       | establish more than one  |
|                   | -   The root of trust | secure channel for its   |
|                   |     used for each     | operation. It is not     |
|                   |     secure channel.   | necessary that a single  |
|                   |                       | root of trust is used    |
|                   | -   Cryptography      | for all secure channels  |
|                   |     supported by each | established.             |
|                   |     secure channel.   |                          |
|                   |                       | Mutual authentication is |
|                   | -   How the channel   | not required upon first  |
|                   |     is established    | execution of the MPoC    |
|                   |     and how mutual    | SDK, as it is expected   |
|                   |     authentication is | that no instance unique  |
|                   |     guaranteed.       | cryptographic keys will  |
|                   |                       | have been provisioned at |
|                   |                       | this stage. However,     |
|                   |                       | mutual authentication is |
|                   |                       | required for secure      |
|                   |                       | channels once the        |
|                   |                       | initial                  |
|                   |                       | prov                     |
|                   |                       | isioning/personalization |
|                   |                       | process has completed,   |
|                   |                       | and prior to the         |
|                   |                       | performance of any       |
|                   |                       | payment transactions.    |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-5.2**      | **1A-5.2.a** The      | When elements are        |
| > Connections     | tester must confirm   | physically separate, a   |
| > between         | through examination   | secure channel is        |
| > different       | that communication    | required to protect the  |
| > physical and    | channels between      | communications between   |
| > logical         | different physical    | these elements. Such     |
| > elements of the | and logical elements  | secure channels need to  |
| > solution must   | are protected using   | ensure data              |
| > be secured.     | secure channels where | confidentiality and      |
|                   | possible. The tester  | authenticity during the  |
|                   | must document how the | establishment and        |
|                   | secure channel is     | subsequent use of the    |
|                   | established, how the  | channel. No secret or    |
|                   | root of trust is      | sensitive assets are     |
|                   | defined and           | permitted to be          |
|                   | implemented, and if   | transferred prior to the |
|                   | the secure channel is | establishment of the     |
|                   | sufficient to protect | secure channel, except   |
|                   | the confidentiality   | for any data             |
|                   | and authenticity of   | specifically used for    |
|                   | the connection. When  | the secure establishment |
|                   | security methods rely | of that channel.         |
|                   | on properties of the  |                          |
|                   | COTS platform instead | In addition, it is       |
|                   | of a secure channel,  | important that all       |
|                   | the tester must       | solution components,     |
|                   | document these        | including different      |
|                   | methods and confirm   | software modules that    |
|                   | that they are         | exist on the same COTS   |
|                   | suitable for use and  | device or server such as |
|                   | that they are present | attestation component    |
|                   | on the platforms      | and contactless kernel   |
|                   | being used.           | components, establish    |
|                   |                       | secure connections such  |
|                   |                       | that the communication   |
|                   |                       | cannot be tampered with  |
|                   |                       | or accessed without      |
|                   |                       | proper authorization.    |
|                   |                       | These secure connections |
|                   |                       | may be implemented       |
|                   |                       | through cryptographic    |
|                   |                       | means using a secure     |
|                   |                       | channel as defined in    |
|                   |                       | these requirements, or   |
|                   |                       | using properties         |
|                   |                       | provided by the COTS     |
|                   |                       | platform or server       |
|                   |                       | platform for protecting  |
|                   |                       | the communications.      |
|                   |                       |                          |
|                   |                       | Put another way,         |
|                   |                       | although it is a         |
|                   |                       | requirement that         |
|                   |                       | communications between   |
|                   |                       | different logical and    |
|                   |                       | physical components are  |
|                   |                       | secured, it is not       |
|                   |                       | always the case that a   |
|                   |                       | logical secure channel   |
|                   |                       | -- such as a TLS         |
|                   |                       | connection -- is         |
|                   |                       | implemented.             |
+-------------------+-----------------------+--------------------------+
| > **1A-5.3**      | **1A-5.3.a** The      | Logical secure channels  |
| > Secret or       | tester must confirm   | rely on cryptographic    |
| > private         | through examination   | protections. Ensuring    |
| > cryptographic   | and observation that  | unique keys per session  |
| > keys used to    | the keys used for the | helps to isolate each    |
| > establish and   | secure channels are   | connection, prevent      |
| > maintain secure | unique per session    | replay or relay attacks, |
| > channels        | except by chance.     | and complicate potential |
| > between the     |                       | compromises of the       |
| > elements of the |                       | cryptographic controls.  |
| > MPoC Software   |                       |                          |
| > must be unique  |                       |                          |
| > per session     |                       |                          |
| > except by       |                       |                          |
| > chance.         |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-5.4**      | **1A-5.4.a** The      | Mutual authentication    |
| > Logical secure  | tester must confirm   | between the              |
| > channels must   | through examination   | communicating components |
| > implement       | that any logical      | is required to be based  |
| > strong          | secure channels       | on cryptography that     |
| > cryptographic   | implement             | aligns with *[Appendix   |
| > controls for    | cryptography          | C: Minimum and           |
| >                 | compliant with        | Equivalent               |
|  confidentiality, | *[Appendix            | Key](#_bookmark134)      |
| > integrity, and  | C](#_bookmark134)* of | [Sizes and Strengths for |
| > authenticity.   | this standard.        | Approved                 |
|                   |                       | Algo                     |
|                   |                       | rithms](#_bookmark134)*. |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-5.5** Each | **1A-5.5.a** The      | During the installation  |
| > secure channel  | tester must confirm   | of the MPoC SDK or       |
| > that extends    | through examination   | integrating MPoC         |
| > outside of a    | and observation that  | Application, it is       |
| > physically      | the secure channels   | normally not possible to |
| > protected       | that extend outside   | authenticate the         |
| > boundary must   | of a physically       | merchant COTS device as  |
| > provide mutual  | protected boundary    | all the installable      |
| > authentication  | perform mutual        | packages are the same    |
| > to uniquely     | authentication before | for the same COTS device |
| > identify each   | any exchange of any   | model. Currently,        |
| > component prior | assets.               | however, there are no    |
| > to the exchange |                       | unique assets            |
| > of sensitive    |                       | provisioned to the MPoC  |
| > assets and      |                       | Software and it cannot   |
| > protect against |                       | perform transactions.    |
| > MITM and replay |                       |                          |
| > attacks.        |                       | It is expected that      |
|                   |                       | after initial download,  |
|                   |                       | the MPoC SDK receives    |
|                   |                       | the necessary data to    |
|                   |                       | enable its               |
|                   |                       | authentication by the    |
|                   |                       | backend in future        |
|                   |                       | interactions. It is not  |
|                   |                       | acceptable for the MPoC  |
|                   |                       | SDK to "re-provision"    |
|                   |                       | each time it is required |
|                   |                       | to re-establish a secure |
|                   |                       | channel, mutual          |
|                   |                       | authentication is        |
|                   |                       | required to be           |
|                   |                       | implemented for all      |
|                   |                       | connections after the    |
|                   |                       | initial provisioning     |
|                   |                       | process.                 |
|                   |                       |                          |
|                   |                       | Certificate pinning may  |
|                   |                       | be used in part to meet  |
|                   |                       | this requirement and is  |
|                   |                       | implemented by limiting  |
|                   |                       | the allowed certificates |
|                   |                       | that can be used as a    |
|                   |                       | root of trust. For       |
|                   |                       | example, embedding a     |
|                   |                       | certificate in the MPoC  |
|                   |                       | SDK to verify the        |
|                   |                       | back-end certificate     |
|                   |                       | instead of using the     |
|                   |                       | platform certificate     |
|                   |                       | store for this purpose   |
|                   |                       | is one method of         |
|                   |                       | certificate pinning.     |
|                   |                       |                          |
|                   |                       | Cryptographic mutual     |
|                   |                       | authentication is not    |
|                   |                       | required for             |
|                   |                       | communication            |
|                   |                       | connections entirely     |
|                   |                       | within the physical      |
|                   |                       | boundary of the COTS     |
|                   |                       | device, or within the    |
|                   |                       | physically secure areas  |
|                   |                       | of the back-end          |
|                   |                       | processing systems.      |
+-------------------+-----------------------+--------------------------+
| > **1A-5.6** The  | **1A-5.6.a** The      | A downgrade attack may   |
| > secure channel  | tester must confirm   | result in switching to a |
| > must prevent    | through examination,  | previous version of a    |
| > downgrade       | observation, and      | protocol or a lower      |
| > attacks.        | testing that the      | security setting of the  |
|                   | secure channels are   | same protocol, such as   |
|                   | not susceptible to    | reducing the level of    |
|                   | downgrade attacks.    | encryption applied.      |
|                   |                       |                          |
|                   |                       | The solution needs to    |
|                   |                       | prevent the downgrade of |
|                   |                       | any protection levels    |
|                   |                       | provided by the secure   |
|                   |                       | channels.                |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-5.7**      | **1A-5.7.a** The      | The MPoC Software assets |
| > Assets must be  | tester must confirm   | need to be protected for |
| > encrypted and   | through examination   | confidentiality and      |
| > authenticated   | and observation that  | authenticity when        |
| > at the datagram | assets in transit are | transmitted through a    |
| > level during    | protected using       | secure channel.          |
| > transport, and  | application-level     |                          |
| > not solely rely | encryption applied at | It may be possible to    |
| > on the          | the data level in     | strip the protocol used  |
| > protections     | addition to the       | by the secure channel,   |
| > provided by any | security and          | such as TLS, or          |
| > secure channel  | encryption provided   | intercept the data as it |
| > being used.     | by the secure         | passes to libraries that |
|                   | channel.              | implement the protocols  |
|                   |                       | used.                    |
|                   |                       |                          |
|                   |                       | Therefore, encryption at |
|                   |                       | the application level is |
|                   |                       | needed to provide an     |
|                   |                       | additional layer of      |
|                   |                       | security that cannot be  |
|                   |                       | stripped easily.         |
|                   |                       |                          |
|                   |                       | Assets only include the  |
|                   |                       | sub-set of assets that   |
|                   |                       | require confidentiality  |
|                   |                       | protection, and the MPoC |
|                   |                       | Software is not required |
|                   |                       | to be protected in this  |
|                   |                       | way.                     |
+-------------------+-----------------------+--------------------------+

### 1A-6 Third-Party APIs

> All MPoC Software will expose APIs to allow for integration of the
> MPoC Software into the overall MPoC Solution. Some MPoC Solutions may
> also provide other API interfaces to other applications or systems
> (e.g., where the MPoC SDK performs payment functions only and receives
> the amount from other applications in a request for payment
> processing). In all cases, it is important that the APIs provided are
> documented clearly and implemented securely so as not to compromise
> the security of the payment process.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Assets that are |                       |                          |
| > transmitted     |                       |                          |
| > through APIs to |                       |                          |
| > third-party     |                       |                          |
| > applications    |                       |                          |
| > are protected.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-6.1**      | **1A-6.1.a** The      | As part of the security  |
| > Documentation   | tester must confirm   | design of the MPoC       |
| > of any API      | through examination   | Software, the UI display |
| > exposed to      | that information      | data that is             |
| > third parties   | provided includes the | communicated to external |
| > must exist.     | following at a        | parties, including the   |
|                   | minimum:              | exposed API, need to be  |
|                   |                       | identified. As the       |
|                   | -   UI display data   | handling of these UI     |
|                   |     that is           | display data involves an |
|                   |     communicated      | external third-party     |
|                   |     through           | application, information |
|                   |     third-party APIs  | needs to be included     |
|                   |     exposed by the    | that guides the external |
|                   |     MPoC Software.    | application to take      |
|                   |                       | appropriate measures to  |
|                   | -   Guidance for      | protect the assets.      |
|                   |     users of the API  |                          |
|                   |     about how to      | This requirement does    |
|                   |     securely use the  | not mandate that UI      |
|                   |     API and protect   | display functions are    |
|                   |     the UI display    | provided to the MPoC     |
|                   |     data on the       | Application or other     |
|                   |     external          | calling applications.    |
|                   |     application.      |                          |
+-------------------+-----------------------+--------------------------+
| > **1A-6.2** APIs | **1A-6.2.a** The      | The MPoC Software may    |
| > exposed by the  | tester must confirm   | expose APIs to provide   |
| > MPoC Software   | through examination   | for integration with     |
| > must not        | that any APIs exposed | other systems. Such APIs |
| > introduce       | by the MPoC Software  | are not to reduce the    |
| > vulnerabilities | cannot reduce the     | security of the overall  |
| > to the MPoC     | security of the       | MPoC Solution when used. |
| > Solution and    | overall MPoC          |                          |
| > must provide    | Solution.             | The data transmitted     |
| > only the        |                       | through exposed APIs     |
| > defined         |                       | needs to be limited to   |
| > functionality.  |                       | the minimum required and |
|                   |                       | never contain cleartext  |
|                   |                       | account data.            |
+-------------------+-----------------------+--------------------------+
|                   | **1A-6.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that any APIs         |                          |
|                   | implemented expose    |                          |
|                   | only the defined      |                          |
|                   | functionality to      |                          |
|                   | provide the intended  |                          |
|                   | features.             |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1A-6.3** APIs | **1A-6.3.a** The      | Refer to table 4 in the  |
| > exposed by the  | tester must confirm   | introductory parts of    |
| > MPoC Software   | through examination   | this standard for        |
| > must secure     | that the protection   | examples of MPoC assets. |
| > assets          | type of the           |                          |
| > according to    | communicated assets   | If assets, such as       |
| > their required  | is maintained in any  | transaction data or A&M  |
| > protection      | API interface.        | data, are to be          |
| > type.           |                       | communicated through an  |
|                   |                       | API, these assets are    |
|                   |                       | required to maintain the |
|                   |                       | protection type that is  |
|                   |                       | required in the overall  |
|                   |                       | MPoC Solution. For       |
|                   |                       | example, if an           |
|                   |                       | identifier requires      |
|                   |                       | confidentiality          |
|                   |                       | protection, it is        |
|                   |                       | required to be           |
|                   |                       | communicated with its    |
|                   |                       | confidentiality          |
|                   |                       | protected and not in     |
|                   |                       | cleartext.               |
|                   |                       |                          |
|                   |                       | Protection may be        |
|                   |                       | provided using           |
|                   |                       | cryptographic means if   |
|                   |                       | the assets is to be      |
|                   |                       | exposed in untrusted     |
|                   |                       | memory or processing     |
|                   |                       | spaces, or through the   |
|                   |                       | shared memory            |
|                   |                       | protections provided by  |
|                   |                       | an integrated MPoC       |
|                   |                       | Software.                |
|                   |                       |                          |
|                   |                       | This requirement should  |
|                   |                       | be considered in         |
|                   |                       | conjunction with         |
|                   |                       | requirement 1D-1.2,      |
|                   |                       | which covers the         |
|                   |                       | encryption of account    |
|                   |                       | data.                    |
|                   |                       |                          |
|                   |                       | Non-sensitive payment    |
|                   |                       | initiation data, such as |
|                   |                       | a payment amount, is an  |
|                   |                       | exception to this        |
|                   |                       | requirement. Assets that |
|                   |                       | are already sufficiently |
|                   |                       | protected through        |
|                   |                       | encryption by the MPoC   |
|                   |                       | Software are also out of |
|                   |                       | scope of this            |
|                   |                       | requirement.             |
+-------------------+-----------------------+--------------------------+
|                   | **1A-6.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that, excluding       |                          |
|                   | non-sensitive payment |                          |
|                   | initiation data such  |                          |
|                   | as the amount, any    |                          |
|                   | assets included in    |                          |
|                   | any APIs are          |                          |
|                   | protected according   |                          |
|                   | to their protection   |                          |
|                   | type.                 |                          |
+-------------------+-----------------------+--------------------------+

## Module 1B: MPoC SDK Software Protection

> These requirements apply to the MPoC SDK, or the aspects of the MPoC
> Application that provide security and payment features (in the case of
> monolithic MPoC Applications). The requirements of this Module 1B do
> not apply to the back-end aspects of the MPoC Software.

### 1B-1 Software Security Mechanisms

> The security mechanisms that protect the MPoC SDK from attacks, such
> as reverse engineering, modification, and monitoring, also help
> protect the MPoC Solution assets as they are entered into, processed
> by, and transferred from the COTS device. The security mechanisms not
> only have a preventive role in the MPoC Software's security; they also
> work as detection mechanisms where they are tied to the A&M.
>
> Many types of security mechanisms exist, each with different strengths
> and protection goals. It is important that the security design of the
> MPoC Software considers the coverage of the security mechanisms and
> the interaction between them. Furthermore, it is important that the
> level of protection (strength) of the security mechanisms is
> evaluated.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The MPoC SDK    |                       |                          |
| > implements      |                       |                          |
| > security        |                       |                          |
| > mechanisms that |                       |                          |
| > protect assets  |                       |                          |
| > and resist      |                       |                          |
| > tampering       |                       |                          |
| > attempts.       |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-1.1** The  | **1B-1.1.a** The      | The MPoC SDK is required |
| > security        | tester must confirm   | to implement protections |
| > mechanisms      | through examination   | to mitigate attacks on   |
| > implemented in  | that the information  | the MPoC SDK and         |
| > the MPoC SDK    | provided is complete  | assets*,* both during    |
| > must be         | and consistent with   | execution and when the   |
| > documented.     | the tester's          | MPoC Software is         |
|                   | understanding of the  | installed but not        |
|                   | solution. This        | currently being          |
|                   | information must      | executed. Multiple       |
|                   | include the list of   | individual protection    |
|                   | security mechanisms   | methods are likely to be |
|                   | included in the MPoC  | required; therefore, it  |
|                   | SDK, with the         | is important that each   |
|                   | following items for   | of these is documented   |
|                   | each mechanism at a   | and provided with        |
|                   | minimum:              | details about how it     |
|                   |                       | works and what it is     |
|                   | -   What the          | designed to protect.     |
|                   |     mechanism         |                          |
|                   |     protects against. | Where the MPoC SDK       |
|                   |                       | relies on previous       |
|                   | -   The party         | evaluation or approval   |
|                   |     responsible for   | of subsystems, such as   |
|                   |     providing and/or  | through use of an        |
|                   |     implementing the  | approved MPoC Software   |
|                   |     security          | product, or an evaluated |
|                   |     mechanism (i.e.,  | secure element/trusted   |
|                   |     the MPoC SDK or   | execution environment,   |
|                   |     the platform).    | then the MPoC Software   |
|                   |                       | vendor can reference     |
|                   | -   The location or   | this high-level approval |
|                   |     component where   | rather than outline each |
|                   |     the mechanism is  | individual security      |
|                   |     implemented       | feature provided by that |
|                   |     (e.g., REE, TEE,  | subsystem.               |
|                   |     SE).              |                          |
|                   |                       | Details indicating what  |
|                   | -   The original      | security mechanisms the  |
|                   |     source and        | MPoC SDK implement are   |
|                   |     provider of the   | important so that the    |
|                   |     mechanism (e.g.,  | integrating MPoC         |
|                   |     third-party       | Application can ensure   |
|                   |     vendor, MPoC      | these security features  |
|                   |     Software vendor). | are properly integrated  |
|                   |                       | and used.                |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.2** All  | **1B-1.2.a** The      | Assets in the context of |
| > assets managed  | tester must confirm   | this requirement are     |
| > by the MPoC     | through examination   | resources or information |
| > Software must   | that the assets are   | valuable to the          |
| > be identified.  | correctly identified  | stakeholder or operation |
|                   | according to the      | of the MPoC Solution,    |
|                   | testers understanding | that need protection.    |
|                   | of the MPoC Software. | Examples of assets       |
|                   | The information       | include cryptographic    |
|                   | provided must         | keys, account data,      |
|                   | include, but not be   | information supplied or  |
|                   | limited to, the       | used as part of an       |
|                   | following:            | attestation system, etc. |
|                   |                       |                          |
|                   | -   Assets name and   | Refer to [Table          |
|                   |     description.      | 4](#table-4-examples-    |
|                   |                       | of-mpoc-software-assets) |
|                   | -   Components that   | for examples of MPoC     |
|                   |     have access to    | assets*.*                |
|                   |     the assets in     |                          |
|                   |     cleartext or have | The tester needs to use  |
|                   |     enough            | their understanding of   |
|                   |     information to    | the operation and        |
|                   |     recover it in     | security implementation  |
|                   |     cleartext (e.g.,  | of the MPoC Software to  |
|                   |     encrypted assets  | identify the assets      |
|                   |     and encryption    | managed by this software |
|                   |     key).             | during operation.        |
|                   |                       |                          |
|                   | -   How the assets    | The identification of    |
|                   |     are protected     | assets and a strategy to |
|                   |     according to      | protect them during the  |
|                   |     their required    | lifecycle is crucial for |
|                   |     protection type   | a secure design of the   |
|                   |     (e.g.,            | solution.                |
|                   |     confidentiality,  |                          |
|                   |     integrity,        |                          |
|                   |     authenticity) and |                          |
|                   |     lifecycle stages  |                          |
|                   |     (generation,      |                          |
|                   |     transmission,     |                          |
|                   |     storage, process, |                          |
|                   |     and removal).     |                          |
|                   |                       |                          |
|                   | -   Code flows        |                          |
|                   |     involving assets. |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the identified   |                          |
|                   | assets protections    |                          |
|                   | are appropriate for   |                          |
|                   | the type of assets.   |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.3**      | **1B-1.3.a** The      | If the security          |
| > Platform based  | tester must confirm   | mechanisms used by the   |
| > security        | through examination   | MPoC SDK depend on an    |
| > mechanisms      | that where security   | underlying system such   |
| > relied upon by  | mechanisms used by    | as a TEE, SE, etc.,      |
| > the MPoC SDK to | the MPoC SDK rely on  | there needs to be        |
| > protect the     | previous approvals or | assurance on the         |
| > assets must be  | certifications that   | security of the          |
| > evaluated.      | the evidence and      | underlying system. Any   |
|                   | scope of prior        | prior certifications     |
|                   | eva                   | relied upon are required |
|                   | luation/certification | to be relevant to the    |
|                   | is sufficient to      | payment acceptance and   |
|                   | ensure security to    | security scope of an     |
|                   | the assets they       | MPoC Solution.           |
|                   | protect.              |                          |
|                   |                       | Examples of              |
|                   |                       | certifications that may  |
|                   |                       | be acceptable, include,  |
|                   |                       | but are not limited to:  |
|                   |                       |                          |
|                   |                       | -   Common Criteria (at  |
|                   |                       |     EAL4 with AVA_VAN 5) |
|                   |                       |                          |
|                   |                       | -   Common Criteria with |
|                   |                       |     Global Platform TEE  |
|                   |                       |     PP                   |
|                   |                       |                          |
|                   |                       | -   EMVCo Chip and       |
|                   |                       |     Global Platform      |
|                   |                       |                          |
|                   |                       | -   EMVCo SBMP for TEE   |
|                   |                       |                          |
|                   |                       | -   PCI-PTS POI, PCI HSM |
|                   |                       |                          |
|                   |                       | -   FIPS 140-2/FIPS      |
|                   |                       |     140-3 (Level 3+)     |
|                   |                       |                          |
|                   |                       | The tester needs to      |
|                   |                       | ensure that the scope    |
|                   |                       | and methods used in the  |
|                   |                       | prior evaluation are     |
|                   |                       | valid for the current    |
|                   |                       | use case. If             |
|                   |                       | insufficient coverage or |
|                   |                       | testing has been         |
|                   |                       | performed, re-evaluation |
|                   |                       | of the underlying        |
|                   |                       | system, in part or       |
|                   |                       | whole, may be required   |
|                   |                       | by the MPoC laboratory.  |
|                   |                       |                          |
|                   |                       | This requirement does    |
|                   |                       | not prevent the use of   |
|                   |                       | security mechanisms that |
|                   |                       | do not have prior        |
|                   |                       | evaluation, but where    |
|                   |                       | any prior evaluation     |
|                   |                       | does not exist then      |
|                   |                       | further assessment to    |
|                   |                       | confirm the security     |
|                   |                       | features provided is     |
|                   |                       | expected.                |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.3.b** When     |                          |
|                   | prior evaluation is   |                          |
|                   | unable to be relied   |                          |
|                   | upon, the tester must |                          |
|                   | confirm through       |                          |
|                   | examination,          |                          |
|                   | observation, and      |                          |
|                   | testing, that         |                          |
|                   | security mechanisms   |                          |
|                   | used by the MPoC SDK  |                          |
|                   | provide the expected  |                          |
|                   | and required security |                          |
|                   | properties.           |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-1.4**      | **1B-1.4.a** The      | When assets (that are    |
| > Storage         | tester must confirm   | required to be protected |
| > locations used  | through examination   | for confidentiality) are |
| > by the MPoC     | about how exposure of | to be present in         |
| > SDK, including  | cleartext assets is   | cleartext in memory, the |
| > temporary       | minimized and how it  | time they are present    |
| > buffers and     | is ensured that such  | needs to be reduced as   |
| > caches,         | assets are cleared    | much as possible. This   |
| > containing      | from storage          | reduces the time that    |
| > cleartext       | locations immediately | the data is exposed as   |
| > sensitive       | after use. The        | cleartext and assists in |
| > assets must be  | removal method must   | ensuring that memory     |
| > cleared         | not rely on           | dumps or reuse do not    |
| > immediately     | language/platform     | expose previously        |
| > after use. The  | mechanisms (e.g.,     | processed values.        |
| > time where a    | garbage collectors).  |                          |
| > sensitive       |                       |                          |
| > assets is       | ***Note:** This       |                          |
| > available as    | requirement applies   |                          |
| > cleartext in    | to whenever sensitive |                          |
| > memory must be  | assets are no longer  |                          |
| > limited to the  | required, including   |                          |
| > shortest period | after early           |                          |
| > of time         | termination of a      |                          |
| > possible.       | transaction due to    |                          |
|                   | A&M or operational    |                          |
|                   | controls.*            |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.5** The  | **1B-1.5.a** The      | Obfuscation may not be   |
| > MPoC SDK must   | tester must confirm   | required if the MPoC SDK |
| > be resistant to | through examination,  | is executed in a         |
| > reverse         | observation, and      | physically separate      |
| > engineering and | testing that the      | execution environment,   |
| > cover all       | methods used to       | such as an SE or TEE,    |
| > s               | provide resistance to | which provides physical  |
| ecurity-sensitive | reverse engineering   | security controls that   |
| > areas and       | sufficiently cover    | mitigate access to the   |
| > sensitive       | the required          | MPoC SDK code.           |
| > assets.         | functionality,        |                          |
|                   | including the         | Obfuscation reduces the  |
|                   | following             | efficacy of common code  |
|                   | functionality at a    | decompilation tools.     |
|                   | minimum when present: | Obfuscation methods may  |
|                   |                       | include, but are not     |
|                   | -   The contactless   | limited to, control-flow |
|                   |     kernel code.      | and data obfuscation,    |
|                   |                       | execution of code        |
|                   | -   Code              | sections in remote/cloud |
|                   |                       | environments, and symbol |
|                   |  handling/interfacing | renaming, or protections |
|                   |     with cryptography | provided by virtualized  |
|                   |     functionality.    | execution environments   |
|                   |                       | that are specifically    |
|                   | -   Code that handles | designed to provide      |
|                   |     the sensitive     | software-based           |
|                   |     assets.           | protections to code      |
|                   |                       | execution flows (such as |
|                   | -   Security          | a vTEE).                 |
|                   |     mechanisms and    |                          |
|                   |     A&M code.         | If the MPoC SDK is       |
|                   |                       | provided as a number of  |
|                   |                       | files (libraries), the   |
|                   |                       | calls and interfaces     |
|                   |                       | between the libraries    |
|                   |                       | are required to be       |
|                   |                       | obfuscated as well.      |
|                   |                       |                          |
|                   |                       | Obfuscation is intended  |
|                   |                       | to complicate the        |
|                   |                       | reverse engineering of   |
|                   |                       | the software and         |
|                   |                       | execution process of the |
|                   |                       | MPoC SDK.                |
|                   |                       |                          |
|                   |                       | These protections are    |
|                   |                       | not required across all  |
|                   |                       | code, but need to be     |
|                   |                       | implemented to protect   |
|                   |                       | all code that handles    |
|                   |                       | assets or performs       |
|                   |                       | security checks. These   |
|                   |                       | protections should       |
|                   |                       | increase code complexity |
|                   |                       | and increase the         |
|                   |                       | reverse-engineering      |
|                   |                       | effort needed to         |
|                   |                       | understand the MPoC SDK  |
|                   |                       | code.                    |
|                   |                       |                          |
|                   |                       | Code-shrinking tools, on |
|                   |                       | their own, do not        |
|                   |                       | provide sufficient       |
|                   |                       | reverse-engineering      |
|                   |                       | protection.              |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.5.b** Where    |                          |
|                   | obfuscation is used   |                          |
|                   | as a security         |                          |
|                   | feature, the tester   |                          |
|                   | must confirm through  |                          |
|                   | examination and       |                          |
|                   | observation that the  |                          |
|                   | transformations       |                          |
|                   | applied by the        |                          |
|                   | obfuscator include    |                          |
|                   | the ability to:       |                          |
|                   |                       |                          |
|                   | -   Hide data, such   |                          |
|                   |     as (but not       |                          |
|                   |     necessarily       |                          |
|                   |     limited to),      |                          |
|                   |     function/method   |                          |
|                   |     names, strings    |                          |
|                   |     and other data,   |                          |
|                   |     and asset.        |                          |
|                   |                       |                          |
|                   | -   Modify the code   |                          |
|                   |     flow of the MPoC  |                          |
|                   |     SDK.              |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-1.6** Code | **1B-1.6.a** The      | After installation, the  |
| > and data        | tester must confirm   | MPoC SDK needs to be     |
| > provisioned to  | through examination,  | provided with unique     |
| > the MPoC SDK    | observation, and      | (configuration) data to  |
| > after           | testing that code and | be differentiated from   |
| > installation    | data provisioned to   | other installations.     |
| > must be         | the MPoC SDK after    | During                   |
| > transmitted,    | installation is       | prov                     |
| > managed, and    | transmitted, managed, | isioning/personalization |
| > stored          | and stored securely.  | assets such as key       |
| > securely.       |                       | material, configuration, |
|                   | ***Note:** This       | and unique identifiers   |
|                   | requirement applies   | may be provisioned to    |
|                   | to data that is       | the COTS device. Data    |
|                   | security sensitive    | provisioned this way is  |
|                   | (e.g., configuration  | not covered by the       |
|                   | files, webviews,      | authenticity controls of |
|                   | keys, etc. as well as | the OS store and so      |
|                   | to all code that is   | protections need to be   |
|                   | executed by the MPoC  | provided by the MPoC     |
|                   | SDK (that is not      | Solution itself.         |
|                   | already part of the   |                          |
|                   | COTS Platform)), and  | This includes any        |
|                   | merchant identifiers  | merchant identifiers     |
|                   | used as part of the   | required for the         |
|                   | transaction process.* | processing of payments,  |
|                   |                       | the management of which  |
|                   |                       | are assessed under the   |
|                   |                       | requirements of Domain   |
|                   |                       | 5.                       |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.7** The  | **1B-1.7.a** The      | Some MPoC platforms      |
| > MPoC SDK must   | tester must confirm   | provide attestation      |
| > implement       | through examination   | functions that can be    |
| > methods to      | and observation that  | used by applications to  |
| > detect          | the MPoC SDK          | assess the platform      |
| > compromised     | implements industry   | integrity.               |
| > platforms, and  | best practice with    |                          |
| > maintain the    | regard to the         | These mechanisms may be  |
| > security of     | detection of          | stronger than the ones   |
| > assets if such  | compromised platforms | provided by the MPoC SDK |
| > platforms are   | and protection of     | because they have        |
| > detected.       | MPoC SDK assets. This | insights into the        |
|                   | must include          | platform. However, it    |
|                   | detection of rooting, | may be possible to       |
|                   | as well as other      | bypass them under        |
|                   | methods that may be   | certain circumstances.   |
|                   | used to compromise    |                          |
|                   | the integrity and     | Understanding the        |
|                   | security of the       | limitation of these      |
|                   | execution             | mechanisms and their     |
|                   | environment,          | proper implementation is |
|                   | including the use of  | essential for robust     |
|                   | emulator systems.     | software hardening.      |
|                   |                       |                          |
|                   |                       | Emulators facilitate the |
|                   |                       | dynamic analysis of      |
|                   |                       | applications. The MPoC   |
|                   |                       | SDK is required to       |
|                   |                       | implement protections to |
|                   |                       | help prevent its         |
|                   |                       | execution on these       |
|                   |                       | platforms to prevent     |
|                   |                       | such analysis. The focus |
|                   |                       | of testing for this      |
|                   |                       | aspect of the            |
|                   |                       | requirement is not to    |
|                   |                       | consider all possible    |
|                   |                       | virtualization or        |
|                   |                       | hardware abstraction     |
|                   |                       | layers as non-compliant, |
|                   |                       | but how the execution of |
|                   |                       | the MPoC Software on any |
|                   |                       | such system may          |
|                   |                       | facilitate dynamic       |
|                   |                       | analysis, and what       |
|                   |                       | protections the software |
|                   |                       | implements to mitigate   |
|                   |                       | such attacks.            |
|                   |                       |                          |
|                   |                       | Protections may be       |
|                   |                       | applied outside of the   |
|                   |                       | MPoC Software itself,    |
|                   |                       | e.g., through the        |
|                   |                       | utility of the execution |
|                   |                       | environment. However,    |
|                   |                       | any security protection  |
|                   |                       | measures relied upon are |
|                   |                       | to be considered and     |
|                   |                       | confirmed through        |
|                   |                       | evaluation in this       |
|                   |                       | Section. It is not       |
|                   |                       | sufficient to reference  |
|                   |                       | execution within a       |
|                   |                       | protected environment    |
|                   |                       | and provide no further   |
|                   |                       | testing or validation of |
|                   |                       | the security of the      |
|                   |                       | implementation.          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.8**      | **1B-1.8.a** The      | After the MPoC SDK is    |
| > After initial   | tester must confirm   | installed, it goes       |
| > download and    | through examination   | through a process upon   |
| > execution, the  | and observation that  | first execution to       |
| > MPoC SDK        | the MPoC SDK          | uniquely bind that MPoC  |
| > installation    | implements methods to | SDK to the specific COTS |
| > must be         | bind itself to the    | device on which it is    |
| > securely bound  | COTS device upon      | stored.                  |
| > to the COTS     | initial execution. It |                          |
| > device on which | must not be possible  | The unique               |
| > it is           | for the bound MPoC    | (configuration) data may |
| > installed.      | SDK to operate on a   | also hold assets related |
|                   | different device or   | to the merchant account  |
|                   | emulator platform,    | or other operational     |
|                   | even if:              | data.                    |
|                   |                       |                          |
|                   | -   Data (e.g.,       | The MPoC SDK is required |
|                   |     files) can be     | to implement controls to |
|                   |     shared from the   | prevent the extraction   |
|                   |     original COTS     | of data from the MPoC    |
|                   |     device to the     | SDK such that it is not  |
|                   |     cloned device.    | possible to create a     |
|                   |                       | "clone" of the MPoC SDK  |
|                   | -   The second device | that is                  |
|                   |     is under attacker | indistinguishable from   |
|                   |     control.          | the original.            |
|                   |                       |                          |
|                   |                       | Additionally,            |
|                   |                       | protections binding the  |
|                   |                       | MPoC SDK to the COTS     |
|                   |                       | platform help to         |
|                   |                       | mitigate "code lifting"  |
|                   |                       | attacks. In such         |
|                   |                       | attacks, the MPoC SDK    |
|                   |                       | (or some portion         |
|                   |                       | thereof) is "lifted"     |
|                   |                       | from the COTS device so  |
|                   |                       | that it can be executed  |
|                   |                       | on another platform, or  |
|                   |                       | in an emulated           |
|                   |                       | environment, that is     |
|                   |                       | under the control of the |
|                   |                       | attacker.                |
|                   |                       |                          |
|                   |                       | Hardware-backed          |
|                   |                       | keystores are often used |
|                   |                       | as part of the COTS      |
|                   |                       | device-binding solution, |
|                   |                       | as these can be          |
|                   |                       | implemented so that it   |
|                   |                       | is difficult to extract  |
|                   |                       | the stored keys to clone |
|                   |                       | the MPoC SDK.            |
|                   |                       |                          |
|                   |                       | This requirement is      |
|                   |                       | concerned with the       |
|                   |                       | technical aspects of how |
|                   |                       | the MPoC SDK code is     |
|                   |                       | bound to the COTS        |
|                   |                       | platform, not with the   |
|                   |                       | method used to bind a    |
|                   |                       | specific merchant        |
|                   |                       | identity to the MPoC SDK |
|                   |                       | or MPoC Application.     |
+-------------------+-----------------------+--------------------------+
| > **1B-1.9** The  | **1B-1.9.a** The      | Provisioned and unique   |
| > MPoC SDK must   | tester must confirm   | (configuration) data is  |
| > be developed    | through examination   | not permitted to remain  |
| > such that the   | and observation that  | on the COTS device after |
| > removal of the  | removal of the MPoC   | the MPoC SDK (or         |
| > MPoC SDK or     | SDK, or MPoC          | integrating MPoC         |
| > MPoC            | Application           | Application) has been    |
| > Application     | integrating the MPoC  | removed. Although        |
| > integrating the | SDK, results in the   | applications often do    |
| > MPoC SDK        | deletion of all       | not have any control     |
| > results in the  | associated data from  | over their deletion,     |
| > deletion of all | the COTS device.      | consideration during the |
| > associated data |                       | design of the            |
| > from the COTS   |                       | application can ensure   |
| > device.         |                       | that data is handled in  |
|                   |                       | a way that it is removed |
|                   |                       | from the COTS device     |
|                   |                       | when the application is  |
|                   |                       | removed.                 |
|                   |                       |                          |
|                   |                       | Where deletion by the    |
|                   |                       | COTS OS cannot be relied |
|                   |                       | upon, the use of         |
|                   |                       | cryptographic deletion   |
|                   |                       | may be used.             |
|                   |                       |                          |
|                   |                       | Cryptographic deletion   |
|                   |                       | refers to when data is   |
|                   |                       | encrypted with strong    |
|                   |                       | cryptography, and the    |
|                   |                       | decryption key is        |
|                   |                       | deleted. In such cases,  |
|                   |                       | even when the data       |
|                   |                       | remains, it may be       |
|                   |                       | considered removed for   |
|                   |                       | the purposes of this     |
|                   |                       | requirement.             |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.10** The | **1B-1.10.a** The     | Prior to the release of  |
| > MPoC SDK must   | tester must confirm   | a software build, it is  |
| > not contain or  | through examination   | common for applications  |
| > expose          | and observation that  | to include debug or      |
| > functionality   | there is no option to | developer features that  |
| > that may        | turn on developer or  | expose data and          |
| > compromise the  | debugger mode.        | functions that would be  |
| > security of the |                       | an unacceptable risk in  |
| > MPoC Solution,  |                       | production systems. Such |
| > such as a       |                       | code or features are     |
| > developer or    |                       | required to be removed   |
| > debug mode.     |                       | from the distributed     |
|                   |                       | software object, not     |
|                   |                       | just disabled, prior to  |
|                   |                       | distribution.            |
|                   |                       |                          |
|                   |                       | However, this            |
|                   |                       | requirement does not     |
|                   |                       | imply or enforce the     |
|                   |                       | need for two code        |
|                   |                       | streams (a test stream,  |
|                   |                       | and a production         |
|                   |                       | stream). Removal of test |
|                   |                       | or debug code during a   |
|                   |                       | build process may be an  |
|                   |                       | acceptable way to meet   |
|                   |                       | this requirement.        |
|                   |                       | Telemetry and data       |
|                   |                       | collection features may  |
|                   |                       | remain in an MPoC SDK    |
|                   |                       | for the purposes of      |
|                   |                       | collecting A&M data or   |
|                   |                       | validating the ongoing   |
|                   |                       | correctness of the       |
|                   |                       | solution. However, any   |
|                   |                       | remaining software       |
|                   |                       | features are not         |
|                   |                       | permitted to bypass or   |
|                   |                       | disable the security of  |
|                   |                       | the MPoC Solution or the |
|                   |                       | protections it provides  |
|                   |                       | to the payment assets it |
|                   |                       | processes.               |
|                   |                       |                          |
|                   |                       | For example, functions   |
|                   |                       | to disable encryption of |
|                   |                       | account data or customer |
|                   |                       | PINs, or to use "test"   |
|                   |                       | cryptographic keys, are  |
|                   |                       | not permitted.           |
|                   |                       |                          |
|                   |                       | This requirement         |
|                   |                       | includes any MPoC SDK    |
|                   |                       | code implemented outside |
|                   |                       | the REE of the COTS      |
|                   |                       | device.                  |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.10.b** The     |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and testing whether   |                          |
|                   | developer mode or     |                          |
|                   | debugging code is     |                          |
|                   | present or whether it |                          |
|                   | was removed from the  |                          |
|                   | installable package.  |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-1.11**     | **1B-1.11.a** Through | The MPoC SDK may         |
| > When any part   | examination of the    | implement functionality  |
| > of the MPoC SDK | MPoC SDK implemented  | external to the REE of   |
| > functionality   | outside the REE, the  | the COTS device using    |
| > is implemented  | tester must confirm   | TEEs, SEs, or other      |
| > outside the     | that the exposed      | separate execution       |
| > REE, that code  | interface between     | environments such as     |
| > must also be    | this code and the REE | external devices or      |
| > protected       | is the minimum        | servers.                 |
| > against         | required to perform   |                          |
| > tampering and   | its task.             | It is required that this |
| > must handle     |                       | non-REE code is          |
| > input data      |                       | protected against        |
| > securely.       |                       | tampering, either to     |
|                   |                       | interfere with its       |
|                   |                       | intended execution       |
|                   |                       | process or to subvert or |
|                   |                       | intercept interfaces     |
|                   |                       | between this code and    |
|                   |                       | the REE.                 |
|                   |                       |                          |
|                   |                       | Compliance to this       |
|                   |                       | requirement may be       |
|                   |                       | achieved through         |
|                   |                       | demonstration of         |
|                   |                       | previous evaluations,    |
|                   |                       | such as through EMVCo    |
|                   |                       | SBMP, GP, or similar     |
|                   |                       | schemes. Documentation   |
|                   |                       | needs to clearly include |
|                   |                       | authenticatable evidence |
|                   |                       | of such evaluation       |
|                   |                       | (i.e., a vendor          |
|                   |                       | assertion of evaluation  |
|                   |                       | or compliance is         |
|                   |                       | insufficient).           |
|                   |                       |                          |
|                   |                       | The tester is expected   |
|                   |                       | to validate the scope of |
|                   |                       | any previous testing to  |
|                   |                       | ensure that any gaps     |
|                   |                       | between the previous     |
|                   |                       | testing and the current  |
|                   |                       | implementation are noted |
|                   |                       | and accommodated for in  |
|                   |                       | the testing. For         |
|                   |                       | example, many SE or TEE  |
|                   |                       | evaluations cover only   |
|                   |                       | the hardware and/or      |
|                   |                       | operating system aspects |
|                   |                       | of those systems and may |
|                   |                       | not include the          |
|                   |                       | applications or          |
|                   |                       | trustlets used in the    |
|                   |                       | MPoC Software.           |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.11.b** The     |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | or testing that any   |                          |
|                   | parts of the MPoC SDK |                          |
|                   | implemented outside   |                          |
|                   | the REE are free from |                          |
|                   | exploitable           |                          |
|                   | vulnerabilities in    |                          |
|                   | their implementation, |                          |
|                   | such as memory        |                          |
|                   | corruption bugs, type |                          |
|                   | confusion bugs, state |                          |
|                   | management bugs, etc. |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.11.c** The     |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | cryptographic         |                          |
|                   | operations and        |                          |
|                   | protocols implemented |                          |
|                   | outside the REE are   |                          |
|                   | implemented and used  |                          |
|                   | properly and meet the |                          |
|                   | requirements of this  |                          |
|                   | standard.             |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1B-1.11.d** The     |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that any parts of the |                          |
|                   | MPoC SDK implemented  |                          |
|                   | outside the REE are   |                          |
|                   | authenticated prior   |                          |
|                   | to execution.         |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-1.12** The | **1B-1.12.a** The     | The MPoC SDK may store   |
| > MPoC SDK assets | tester must confirm   | data on the COTS device. |
| > and code stored | through examination,  | This data could be       |
| > on the COTS     | observation, and      | abused to change the     |
| > device must be  | testing the anti-     | behavior of the MPoC SDK |
| > protected to an | tampering protections | in unintended ways       |
| > attack rating   | for MPoC SDK assets   | (e.g., change MPoC SDK   |
| > of 25 points    | by attempting to      | configuration            |
| > using the       | expose or modify      | parameters).             |
| > attack-costing  | sensitive MPoC SDK    |                          |
| > framework in    | data stored or        | Protection of assets in  |
| > [*Appendix      | processed on the COTS | the solution are         |
| > B*.](#ap        | device without        | required to be           |
| pendix-b-attack-c | detection. The tester | sufficient to withstand  |
| osting-framework) | must provide a        | expert attackers with    |
|                   | costing of this       | local access to the COTS |
|                   | attack based on the   | device (e.g., a          |
|                   | method outlined in    | malicious merchant or    |
|                   | [*Appendix B. Attack  | MPoC terminal operator   |
|                   | Costing               | with physical access to  |
|                   | Framewor              | the COTS device used to  |
|                   | k*.](#appendix-b-atta | accept payments).        |
|                   | ck-costing-framework) |                          |
|                   | This requirement is   | An attack example is an  |
|                   | passed if the most    | expert COTS device user  |
|                   | feasible attack       | that is able to reverse  |
|                   | cannot be costed for  | the MPoC SDK, roots the  |
|                   | less than 25 points.  | COTS device, and         |
|                   |                       | attempts to retrieve     |
|                   | ***Note:** It is not  | cleartext account data.  |
|                   | intended that the     | Possible controls that   |
|                   | tester attempts to    | can be implemented to    |
|                   | extract all the       | mitigate the attack are  |
|                   | security assets of    | COTS OS-level            |
|                   | the MPoC SDK, but     | attestation, application |
|                   | only those assets     | integrity checks, etc.   |
|                   | that represent the    | The combination of       |
|                   | least amount of       | controls is required to  |
|                   | effort for an expert  | be                       |
|                   | attacker, or the      |                          |
|                   | biggest gain (e.g.,   |                          |
|                   | PIN).*                |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
|                   | **1B-1.12.b** The     | sufficient to withstand  |
|                   | tester must confirm   | the attacks and provide  |
|                   | through examination,  | the A&M the opportunity  |
|                   | observation, and      | to detect the attack.    |
|                   | testing the anti-     |                          |
|                   | tampering protections | The goal of this         |
|                   | for the MPoC SDK code | requirement is that the  |
|                   | by attempting to      | tester provides          |
|                   | modify the MPoC SDK   | assurance over the       |
|                   | code stored on the    | protections that are     |
|                   | COTS device without   | documented, and the      |
|                   | detection. The tester | security mechanisms      |
|                   | must provide a        | interaction and          |
|                   | costing of this       | practicalities of        |
|                   | attack based on the   | possible attacks are     |
|                   | method outlined in    | understood.              |
|                   | *[Appendix B. Attack  |                          |
|                   | Costing               | Tests performed for this |
|                   | Framewo               | requirement are required |
|                   | rk](#appendix-b-attac | to be executed with the  |
|                   | k-costing-framework)* | monitoring system        |
|                   | . This requirement is | disabled to test the     |
|                   | passed if the most    | COTS device security     |
|                   | feasible attack       | mechanisms in isolation. |
|                   | cannot be costed for  | This simulates the       |
|                   | less than 25 points.  | temporary disconnection  |
|                   |                       | from the A&M backend.    |
|                   |                       |                          |
|                   |                       | Code protection          |
|                   |                       | mechanisms, such as      |
|                   |                       | obfuscation and/or       |
|                   |                       | platform-based           |
|                   |                       | protections, do not need |
|                   |                       | to be disabled or        |
|                   |                       | specifically bypassed    |
|                   |                       | prior to this testing.   |
|                   |                       | If platform security     |
|                   |                       | mechanisms such as       |
|                   |                       | OS-backed attestation    |
|                   |                       | are present in the       |
|                   |                       | solution, the tester is  |
|                   |                       | required to consider the |
|                   |                       | case where these         |
|                   |                       | OS-security mechanisms   |
|                   |                       | are disabled to assess   |
|                   |                       | the non-platform         |
|                   |                       | attestation functions.   |
|                   |                       |                          |
|                   |                       | Examination only may be  |
|                   |                       | sufficient in cases      |
|                   |                       | where the assets are     |
|                   |                       | managed by a component   |
|                   |                       | or system that has       |
|                   |                       | undergone previous       |
|                   |                       | evaluation to a known    |
|                   |                       | standard, such as a HSM  |
|                   |                       | compliant to the PCI HSM |
|                   |                       | requirements.            |
|                   |                       |                          |
|                   |                       | However, in all cases,   |
|                   |                       | it is expected that the  |
|                   |                       | tester will perform      |
|                   |                       | sufficient testing to    |
|                   |                       | validate the security of |
|                   |                       | the overall MPoC         |
|                   |                       | Solution.                |
+-------------------+-----------------------+--------------------------+

### 1B-2 Software-Protected Cryptography

> Protection of cryptographic operations and assets has been
> traditionally provided by tamper-responsive hardware devices such as
> HSMs or tamper-resistant hardware devices such as a secure element.
> Although use of tamper-resistant hardware components is becoming more
> common in COTS devices, support for them is not universal.
>
> Another way to protect cryptographic operations and sensitive assets
> is through software protections, such as software-protected
> cryptography, where the cryptographic functions and storage methods
> used to protect the cryptographic keys are obfuscated such that
> extraction of the sensitive assets or tracing of the execution flow of
> the cryptographic process is rendered computationally expensive. This
> includes systems such as white-box cryptography, and implementations
> where cryptographic operations are executed in a software-protected
> execution environment, such as a vTEE.
>
> When purely software methods are used to protect cryptographic keys,
> such as with software-protected cryptography, the specific instance
> used in the MPoC SDK is to be changed periodically, where the maximum
> period is less than the estimated time it would take to reverse
> engineer the software protections. It is acceptable to have two sets
> of keys during the changeover period, but all old keys are to be
> invalidated when the new keys are installed. The idea behind the
> update is that the software-protected cryptography implementation is
> updated before the needed time to break it is reached.
>
> Using protection mechanisms that are inherent to the platform on which
> the MPoC SDK runs, such as hardware-backed keystore, are another
> option for protecting cryptographic key storage on the COTS device.
> Combined approaches that use different protection methods for
> different platforms, depending on the security features provided by
> that platform, or hybrid implementations that use combinations of
> hardware-based and software-based protections may also be acceptable.
>
> There are several different methods of software protection that can be
> applied to a cryptographic process. This standard does not mandate,
> require, or endorse any particular method. However, this standard is
> created with the expectation that cryptographic keys used to secure
> the MPoC Solution are securely stored and managed. The tester is
> expected to review the implementation and methods used to inform the
> testing of the robustness of these methods, so that there is
> confidence they provide robust protection of cryptographic process and
> sensitive assets they protect.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > S               |                       |                          |
| oftware-protected |                       |                          |
| > cryptography,   |                       |                          |
| > where used,     |                       |                          |
| > provides        |                       |                          |
| > sufficient      |                       |                          |
| > protection to   |                       |                          |
| > the             |                       |                          |
| > cryptographic   |                       |                          |
| > keys it         |                       |                          |
| > protects.       |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-2.1**      | **1B-2.1.a** The      | Clear information is     |
| > Cryptography    | tester must confirm   | required to outline how  |
| > protected with  | through examination   | each cryptographic key   |
| > software-only   | that the provided     | is protected so that     |
| > means must be   | information is        | coverage can be          |
| > documented.     | complete based on the | confirmed to be          |
|                   | tester's              | comprehensive, and flaws |
|                   | understanding of the  | can be identified        |
|                   | MPoC SDK. The         | easily.                  |
|                   | information must      |                          |
|                   | include at a minimum: | For this requirement, it |
|                   |                       | is required that the     |
|                   | -   Which keys are    | information provided     |
|                   |     secured using     | covers all cryptographic |
|                   |     software-         | keys that would          |
|                   |     protected         | otherwise be exposed in  |
|                   |     cryptography, in  | cleartext within the     |
|                   |     whole or in part. | memory of the REE of the |
|                   |                       | COTS device were it not  |
|                   | -   What algorithms   | for the implementation   |
|                   |     are supported or  | of software protection   |
|                   |     implemented by    | methods.                 |
|                   |     the               |                          |
|                   |                       |                          |
|                   |    software-protected |                          |
|                   |     cryptography      |                          |
|                   |     system used.      |                          |
|                   |                       |                          |
|                   | -   How many          |                          |
|                   |     instances of      |                          |
|                   |                       |                          |
|                   |    software-protected |                          |
|                   |     cryptography are  |                          |
|                   |     present for each  |                          |
|                   |     algorithm.        |                          |
|                   |                       |                          |
|                   | -   The security      |                          |
|                   |     mechanisms        |                          |
|                   |     present in the    |                          |
|                   |                       |                          |
|                   |    software-protected |                          |
|                   |     cryptography.     |                          |
|                   |                       |                          |
|                   | -   The key hierarchy |                          |
|                   |     of the keys       |                          |
|                   |     protected by      |                          |
|                   |                       |                          |
|                   |    software-protected |                          |
|                   |     cryptography.     |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-2.2** The  | **1B-2.2.a** The      | Implementations of       |
| > s               | tester must confirm   | software protected       |
| oftware-protected | through examination   | cryptography are         |
| > cryptography    | that the              | intended to protect the  |
| > implementation  | software-protected    | cryptographic keys used. |
| > must not        | cryptography          |                          |
| > implement       | operations present in | Protections that apply   |
| > operations that | the MPoC SDK do not   | only to some aspect of   |
| > expose, or      | expose, or provide    | the implementation, or   |
| > provide access  | access to, cleartext  | that implement           |
| > to, cleartext   | cryptographic keys,   | operations that may      |
| > cryptographic   | or key                | expose the cryptographic |
| > keys, key       | components/shares.    | keys, are not sufficient |
| > c               |                       | for use with MPoC SDK.   |
| omponents/shares, |                       |                          |
| > or the          |                       | For example, a software  |
| > intermediate    |                       | protected cryptographic  |
| > results of a    |                       | implementation that does |
| > cryptographic   |                       | not sufficiently protect |
| > operation.      |                       | key related values       |
|                   |                       | during operation, or     |
|                   |                       | only provides protection |
|                   |                       | when the cryptographic   |
|                   |                       | process is not actually  |
|                   |                       | being executed, are      |
|                   |                       | insufficient. Similarly, |
|                   |                       | implementations that may |
|                   |                       | provide a key export     |
|                   |                       | feature that allows for  |
|                   |                       | exposure of cleartext    |
|                   |                       | keys or components are   |
|                   |                       | not sufficient.          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-2.3** The  | **1B-2.3.a** The      | Usually, cryptographic   |
| > s               | tester must confirm   | implementations support  |
| oftware-protected | through examination   | at least two operations  |
| > cryptography    | and observation that  | (e.g., encryption and    |
| > implementation  | the implementation of | decryption). If the MPoC |
| > must not        | software protected    | SDK needs only to        |
| > implement       | cryptography within   | encrypt data before      |
| > unnecessary     | the MPoC SDK only     | sending it to the        |
| > operations.     | implements the        | backend, the decryption  |
|                   | operations required.  | operation is not         |
|                   |                       | required to be present   |
|                   |                       | in the MPoC SDK, since   |
|                   |                       | it helps reverse the     |
|                   |                       | encryption operation and |
|                   |                       | may pose an additional   |
|                   |                       | security risk.           |
+-------------------+-----------------------+--------------------------+
| > **1B-2.4** The  | **1B-2.4.a** the      | The tester may use the   |
| > s               | tester must document  | results from the         |
| oftware-protected | an estimated          | previous attack testing  |
| > cryptography    | exploitation time     | on the software-based    |
| > implementation, | needed for an expert  | cryptography             |
| > where it        | attacker with         | implementations, to      |
| > exists, must be | physical access to    | establish a time during  |
| > replaced before | the COTS device to    | which that               |
| > the estimated   | break any             | implementation must be   |
| > time needed to  | software-protected    | replaced to mitigate     |
| > break the       | cryptography          | attacks.                 |
| > implementation. | implementations used. |                          |
| > Replacement     |                       | Software-protected       |
| > must include    |                       | cryptography may         |
| > changing of any |                       | implement several unique |
| > cryptographic   |                       | master storage keys,     |
| > keys, or other  |                       | which can be rotated     |
| > assets, within  |                       | over time to reduce the  |
| > the software    |                       | elapsed time during      |
| > protected       |                       | which a single key is    |
| > cryptographic   |                       | used. However, if an     |
| > implementation. |                       | attack is mounted on a   |
|                   |                       | software- protected      |
|                   |                       | cryptography             |
|                   |                       | implementation, this is  |
|                   |                       | usually automated, and   |
|                   |                       | rotation of master keys  |
|                   |                       | is of little use.        |
|                   |                       |                          |
|                   |                       | Therefore, to defeat     |
|                   |                       | automation, the          |
|                   |                       | software-protected       |
|                   |                       | cryptography binary is   |
|                   |                       | required to be changed   |
|                   |                       | before the time          |
|                   |                       | estimated to extract     |
|                   |                       | keys from the            |
|                   |                       | implementation.          |
|                   |                       |                          |
|                   |                       | The update of the        |
|                   |                       | software-protected       |
|                   |                       | cryptography binary may  |
|                   |                       | be implemented by        |
|                   |                       | updating the internal    |
|                   |                       | mathematical algorithm,  |
|                   |                       | its compiled binary      |
|                   |                       | structure, or its        |
|                   |                       | security mechanisms      |
|                   |                       | (obfuscation,            |
|                   |                       | anti-emulation, anti-    |
|                   |                       | DFA, encoding methods,   |
|                   |                       | etc.). The goal of the   |
|                   |                       | update is to impede the  |
|                   |                       | progress made by an      |
|                   |                       | attacker on the          |
|                   |                       | implementation.          |
+-------------------+-----------------------+--------------------------+
|                   | **1B-2.4.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the update cycle |                          |
|                   | for the software-     |                          |
|                   | protected             |                          |
|                   | cryptography is       |                          |
|                   | shorter than the time |                          |
|                   | needed to perform a   |                          |
|                   | successful attack on  |                          |
|                   | that implementation.  |                          |
+-------------------+-----------------------+--------------------------+
| > **1B-2.5** The  | **1B-2.5.a** The      | This requirement covers  |
| > s               | tester must confirm   | the implementation and   |
| oftware-protected | through examination,  | support systems for any  |
| > cryptography    | observation, and      | software-protected       |
| > implementation  | interview (where      | cryptography.            |
| > must support    | appropriate), that    |                          |
| > secure key      | the                   | Operation of those       |
| > generation and  | software-protected    | systems is covered under |
| > key management  | cryptography          | the operational          |
| > processes.      | implementation        | requirements of this     |
|                   | supports secure key   | standard.                |
|                   | generation and key    |                          |
|                   | management processes, | This requirement does    |
|                   | including:            | not enforce the manual   |
|                   |                       | handling of              |
|                   | -   Dual control and  | cryptographic keys (as   |
|                   |     split knowledge   | key components). Proper  |
|                   |     of keys.          | of back- end HSMs may    |
|                   |                       | provide for dual control |
|                   | -   Key generation    | and split knowledge      |
|                   |     methods that      | across the keys.         |
|                   |     ensure keys have  |                          |
|                   |     at least the same |                          |
|                   |     entropy as their  |                          |
|                   |     effective key     |                          |
|                   |     strength.         |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1B-2.6**      | **1B-2.6.a** The      | Cryptographic keys       |
| > Cryptographic   | tester must confirm   | contained within a       |
| > keys deployed   | through examination   | software-protected       |
| > within a        | and observation that  | cryptography             |
| > s               | keys deployed through | implementation during    |
| oftware-protected | the                   | deployment may be used   |
| > cryptography    | software-protected    | to protect keys during   |
| > implementation  | cryptographic         | storage on the COTS      |
| > must not be     | implementation are    | Platform, or to help     |
| > used for        | not used to encrypt   | secure initial           |
| > encryption of   | account data or other | provisioning.            |
| > account data or | secret/private        |                          |
| > secret/private  | cryptographic keys    | However, as the keys     |
| > cryptographic   | during transmission.  | used in these            |
| > keys during     |                       | implementations may be   |
| > transmission.   |                       | shared across many MPoC  |
|                   |                       | Applications, it is not  |
|                   |                       | acceptable to rely on    |
|                   |                       | software-protected       |
|                   |                       | cryptography mechanisms  |
|                   |                       | to secure account data   |
|                   |                       | or other cryptographic   |
|                   |                       | keys during transmission |
|                   |                       | outside of the COTS      |
|                   |                       | Platform on which the    |
|                   |                       | implementation resides.  |
+-------------------+-----------------------+--------------------------+
| > **1B-2.7** The  | **1B-2.7.a** The      | The software-protected   |
| > s               | tester must confirm   | cryptography needs to    |
| oftware-protected | through examination,  | implement protections to |
| > cryptography    | observation, and      | help it resist the       |
| > must prevent    | testing that the      | extraction of complete   |
| > the extraction  | software-protected    | or partial cryptographic |
| > of partial or   | cryptography          | material.                |
| > complete        | implementation is     |                          |
| > cryptographic   | protected against     | If the                   |
| > material to an  | known attacks against | software-protected       |
| > attack rating   | software- based       | cryptography has a       |
| > of 25 points    | cryptography.         | storage or transport key |
| > using the       |                       | used to protect all      |
| > attack-costing  | If anti-lifting or    | other keys, the          |
| > framework in    | anti-emulation        | compromise of this key   |
| > [*Appendix      | mechanisms are in     | implies the compromise   |
| > B*.](#ap        | place, separately     | of the protected keys.   |
| pendix-b-attack-c | from the A&M systems, | This is of special       |
| osting-framework) | the tester must       | concern if the           |
|                   | include the attempt   | storage/transport key is |
|                   | to bypass these       | shared across different  |
|                   | mechanisms into the   | MPoC Software            |
|                   | costing.              | installations.           |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
|                   | **1B-2.7.b** The      | The security of any      |
|                   | tester must provide a | software-protected       |
|                   | costing of this       | cryptography             |
|                   | attack based on the   | implementation is        |
|                   | method outlined in    | reliant upon periodic    |
|                   | *[Appendix            | updates, which is        |
|                   | B.](#appendix-b-attac | validated in a separate  |
|                   | k-costing-framework)* | requirement.             |
|                   | [*Attack Costing      |                          |
|                   | Framewor              | The intent of this       |
|                   | k*.](#appendix-b-atta | requirement is that the  |
|                   | ck-costing-framework) | security of the software |
|                   | This requirement is   | protected cryptography   |
|                   | passed if the most    | implementation is tested |
|                   | feasible attack       | directly. Therefore,     |
|                   | cannot be costed for  | this testing is to be    |
|                   | less than 25 points.  | performed without        |
|                   |                       | additional security      |
|                   |                       | controls such as A&M or  |
|                   |                       | anti-rooting. The vendor |
|                   |                       | of the MPoC Software or  |
|                   |                       | Software Protected       |
|                   |                       | Cryptography             |
|                   |                       | implementation may need  |
|                   |                       | to provide a test        |
|                   |                       | artifact for the testing |
|                   |                       | process.                 |
|                   |                       |                          |
|                   |                       | Costing of the attack    |
|                   |                       | must consider the        |
|                   |                       | difficulty of disabling  |
|                   |                       | these features, and any  |
|                   |                       | code-lifting or          |
|                   |                       | emulation that is        |
|                   |                       | required as part of the  |
|                   |                       | attack. Code lifting can |
|                   |                       | allow for the extraction |
|                   |                       | of the                   |
|                   |                       | software-protected       |
|                   |                       | cryptography             |
|                   |                       | implementation so that   |
|                   |                       | it can be executed in an |
|                   |                       | environment or context   |
|                   |                       | under the control of an  |
|                   |                       | attacker.                |
|                   |                       |                          |
|                   |                       | Usually, this is done    |
|                   |                       | for analysis of the      |
|                   |                       | cryptographic            |
|                   |                       | implementation and if,   |
|                   |                       | successful, can permit   |
|                   |                       | fault injections, oracle |
|                   |                       | attacks, etc.            |
|                   |                       |                          |
|                   |                       | A successful attack need |
|                   |                       | not recover the entire   |
|                   |                       | key -- it is considered  |
|                   |                       | sufficient if the tester |
|                   |                       | is able to demonstrate   |
|                   |                       | success at recovery of   |
|                   |                       | some subset of the key   |
|                   |                       | and justify that this    |
|                   |                       | can be scaled to full    |
|                   |                       | key recovery.            |
|                   |                       |                          |
|                   |                       | Examples of attacks to   |
|                   |                       | be considered by the     |
|                   |                       | tester includes Side     |
|                   |                       | Channel Analysis (SCA)   |
|                   |                       | and Fault Injection (FI) |
|                   |                       | attacks such as          |
|                   |                       | Differential Computation |
|                   |                       | Analysis (DCA) and       |
|                   |                       | Differential Fault       |
|                   |                       | Analysis (DFA).          |
+-------------------+-----------------------+--------------------------+

## Module 1C: Attestation and Monitoring Software

> Attestation is the interaction between a verifier and a prover to
> determine the current security state/behavior of the prover based on
> data provided through measurements performed by the prover. For the
> purposes of this document, the prover is the MPoC SDK (or aspects of
> the MPoC Application) executing on the COTS device, and the verifier
> may have multiple components executing locally on the COTS device and
> remotely in a back-end attestation and monitoring (A&M).
>
> The attestation data may be determined in various ways, such as
> through a health-check interface that can be accessed by the prover.
> Attestation provides necessary assurance to the verifier that
> established and expected security controls at the prover are in an
> acceptable state and have not been tampered with. Organizations
> developing A&M components are subject to these requirements.
>
> There are two types of attestations in MPoC Solutions, where the goal
> is to assess the integrity of the MPoC SDK and MPoC Application, and
> where the goal is to assess the integrity of the COTS platform.
>
> It is a requirement of this standard that the attestation system and
> monitoring system together form the attestation and monitoring (A&M).
> The attestation and monitoring (A&M) includes a back-end system that
> can interpret and respond to the attestation results (i.e., the
> attestation results are required to be monitored). The MPoC SDK can
> attest to the COTS platform or provide attestation results to be
> examined by an external system (such as the attestation and monitoring
> (A&M)). Additionally, some level of ongoing validation of the MPoC SDK
> and COTS platform is required both to supplement the intermittent
> communication with the remote attestation and monitoring (A&M), as
> well as to support offline payments (where applicable). However, as
> the MPoC SDK may be open to compromise this software cannot attest
> itself at all times.

### 1C-1 Coverage

> The attestation and monitoring (A&M) must cover the COTS platform, the
> MPoC SDK, and MPoC Application aspects present in the COTS device.

+------------------+--------------------------+-----------------------+
| > **Security     | > **Test Requirements**  | > **Guidance**        |
| > Requirements** |                          |                       |
+==================+==========================+=======================+
| > **Objective:** |                          |                       |
| > The            |                          |                       |
| > attestation    |                          |                       |
| > and monitoring |                          |                       |
| > (A&M) covers   |                          |                       |
| > all assets and |                          |                       |
| > processing of  |                          |                       |
| > the MPoC SDK   |                          |                       |
| > and MPoC       |                          |                       |
| > Application    |                          |                       |
| > throughout its |                          |                       |
| > lifecycle.     |                          |                       |
+------------------+--------------------------+-----------------------+
| > **1C-1.1**     | **1C-1.1.a** The tester  | The attestation and   |
| > Documentation  | must confirm through     | monitoring (A&M) is a |
| > on the         | examination that the     | vital part of the     |
| > coverage of    | required information     | overall security of   |
| > the            | exists, including, but   | an MPoC Solution and, |
| > attestation    | not limited to:          | therefore, the        |
| > and monitoring |                          | coverage provided by  |
| > (A&M) must     | -   What checks are      | the attestation and   |
| > exist.         |     included in the MPoC | monitoring (A&M)      |
|                  |     SDK attestation and  | parts of the MPoC     |
|                  |     monitoring (A&M)     | Software mut be       |
|                  |     and, if applicable,  | clearly outlined.     |
|                  |     which parts of their | This information      |
|                  |     result are checked   | assists in the        |
|                  |     or verified.         | integration of the    |
|                  |                          | MPoC Software with    |
|                  | -   What is covered by   | both the MPoC         |
|                  |     the checks (e.g.,    | Application, and any  |
|                  |     code, data,          | back-end systems used |
|                  |     application, OS,     | as part of the A&M    |
|                  |     cryptographic,       | services.             |
|                  |     etc.).               |                       |
|                  |                          | In the context of     |
|                  | -   When, where, and     | this requirement, the |
|                  |     under which          | terminology "no       |
|                  |     circumstances are    | exploitable design    |
|                  |     these checks         | flaws" is to be       |
|                  |     executed and         | considered in         |
|                  |     validated.           | relation to the       |
|                  |                          | ability to exploit    |
|                  | -   If a security        | these flaws during an |
|                  |     mechanism covers     | attack on the MPoC    |
|                  |     code (e.g.,          | Solution. The tester  |
|                  |     checksums), which    | is expected to        |
|                  |     parts of the code    | consider the          |
|                  |     are covered.         | exploitability of any |
|                  |                          | flaws during their    |
|                  |                          | production of attack  |
|                  |                          | costings during an    |
|                  |                          | evaluation.           |
|                  |                          |                       |
|                  |                          | MPoC requires that    |
|                  |                          | there are checks that |
|                  |                          | are performed         |
|                  |                          | on-device at all      |
|                  |                          | times, as well as     |
|                  |                          | checks that may be    |
|                  |                          | performed only when   |
|                  |                          | the data is to be     |
|                  |                          | sent to the back-end  |
|                  |                          | attestation and       |
|                  |                          | monitoring system. It |
|                  |                          | is important that the |
|                  |                          | documentation         |
|                  |                          | indicates when and    |
|                  |                          | where any checks      |
|                  |                          | occur.                |
+------------------+--------------------------+-----------------------+
|                  | **1C-1.1.b** The tester  |                       |
|                  | must confirm through     |                       |
|                  | examination that the A&M |                       |
|                  | design has no            |                       |
|                  | exploitable design       |                       |
|                  | flaws, matches the       |                       |
|                  | tester understanding of  |                       |
|                  | the MPoC Software, and   |                       |
|                  | is able to detect        |                       |
|                  | threats against an MPoC  |                       |
|                  | Solution.                |                       |
+------------------+--------------------------+-----------------------+
| > **1C-1.2** The | **1C-1.2.a** The tester  | The MPoC SDK or MPoC  |
| > A&M            | must confirm, through    | Application could     |
| > functionality  | examination, that the    | potentially be        |
| > must cover the | A&M covers the following | compromised at any    |
| > complete       | parts of the MPoC SDK    | stage of its          |
| > lifecycle of   | and MPoC Application     | lifecycle. Therefore, |
| > the MPoC SDK   | lifecycles at a minimum: | it is necessary that  |
| > and MPoC       |                          | the A&M covers the    |
| > Application,   | -   Deployment           | complete lifecycle of |
| > starting from  |     (installation)       | the software deployed |
| > installation   |                          | to the COTS           |
| > through        | -   Provisioning         | device(s).            |
| > decommission.  |     (enrolment,          |                       |
|                  |     provisioning)        | It is possible that   |
|                  |                          | for some lifecycle    |
|                  | -   Operation            | stages, the MPoC SDK  |
|                  |     (application         | or MPoC Application   |
|                  |     startup, transaction | is not able to        |
|                  |     execution, PIN       | execute. However,     |
|                  |     entry)               | platform features may |
|                  |                          | be leveraged to       |
|                  | -   Decommissioning      | protect these stages  |
|                  |     (removal of the MPoC | (e.g., during the     |
|                  |     SDK or MPoC          | deployment and        |
|                  |     Application)         | decommission of the   |
|                  |                          | MPoC Application).    |
|                  |                          |                       |
|                  |                          | Although applications |
|                  |                          | often do not have any |
|                  |                          | control over their    |
|                  |                          | deployment and        |
|                  |                          | decommissioning,      |
+------------------+--------------------------+-----------------------+

+------------------+--------------------------+-----------------------+
| > **Security     | > **Test Requirements**  | > **Guidance**        |
| > Requirements** |                          |                       |
+==================+==========================+=======================+
|                  |                          | consideration during  |
|                  |                          | the design of the     |
|                  |                          | application can       |
|                  |                          | ensure that data is   |
|                  |                          | handled securely      |
|                  |                          | during these phases.  |
|                  |                          | The intent of this    |
|                  |                          | requirement is that   |
|                  |                          | the A&M validates the |
|                  |                          | correct operation     |
|                  |                          | according to the      |
|                  |                          | design so that        |
|                  |                          | deployment and        |
|                  |                          | decommissioning can   |
|                  |                          | be validated as       |
|                  |                          | having been performed |
|                  |                          | securely.             |
+------------------+--------------------------+-----------------------+
| > **1C-1.3** The | **1C-1.3.a** The tester  | The A&M checks are    |
| > attestation    | must confirm through     | required to be        |
| > and monitoring | examination that:        | implemented at        |
| > (A&M) checks   |                          | different execution   |
| > must cover the | -   The MPoC SDK is      | points and be         |
| > entire         |     protected by the     | executed at different |
| > se             |     attestation and      | points in time to     |
| curity-sensitive |     monitoring (A&M) at  | mitigate attempts to  |
| > MPoC SDK code  |     run-time.            | bypass or avoid the   |
| > and execution  |                          | detection features.   |
| > flows that     | -   The A&M checks       | This helps to ensure  |
| > handle assets. |     provide coverage     | that there is not a   |
|                  |     over all MPoC SDK    | single point of       |
|                  |     code, execution      | failure for the A&M   |
|                  |     flow, and assets.    | checks.               |
|                  |                          |                       |
|                  | -   Some A&M validation  | A&M may involve       |
|                  |     checks are always    | different levels of   |
|                  |     active during        | checks. Some checks   |
|                  |     execution of the     | may be less intensive |
|                  |     MPoC SDK providing   | or involve call-back  |
|                  |     protection against   | checks, such as       |
|                  |     rooting, and         | checking for the      |
|                  |     activation of        | activation of         |
|                  |     developer or other   | developer options or  |
|                  |     COTS operating modes | enabling of           |
|                  |     that may impact      | accessibility         |
|                  |     security.            | features that expose  |
|                  |                          | entry of PINs, and    |
|                  |                          | therefore can provide |
|                  |                          | constant protection.  |
|                  |                          | Other attestation and |
|                  |                          | monitoring (A&M)      |
|                  |                          | checks may be more    |
|                  |                          | intrusive and be      |
|                  |                          | possible only at      |
|                  |                          | intervals to prevent  |
|                  |                          | unwarranted           |
|                  |                          | interruptions to the  |
|                  |                          | payment- processing   |
|                  |                          | flow.                 |
|                  |                          |                       |
|                  |                          | However, the MPoC SDK |
|                  |                          | is required to have   |
|                  |                          | some level of         |
|                  |                          | continuous A&M at     |
|                  |                          | run-time (e.g., it is |
|                  |                          | not sufficient to run |
|                  |                          | all A&M checks only   |
|                  |                          | at launch or at       |
|                  |                          | intervals that may    |
|                  |                          | allow for Time of     |
|                  |                          | Check Time of         |
|                  |                          | Use-based attacks).   |
|                  |                          | Such checks can be    |
|                  |                          | used to detect        |
|                  |                          | rooting or activation |
|                  |                          | of developer or other |
|                  |                          | modes that may affect |
|                  |                          | the security of the   |
|                  |                          | MPoC Software         |
|                  |                          | operation.            |
+------------------+--------------------------+-----------------------+

+------------------+--------------------------+-----------------------+
| > **Security     | > **Test Requirements**  | > **Guidance**        |
| > Requirements** |                          |                       |
+==================+==========================+=======================+
| > **1C-1.4** The | **1C-1.4.a** The tester  | The A&M is required   |
| > A&M system     | must confirm through     | to provide assurance  |
| > must attest    | examination that the A&M | that the MPoC SDK is  |
| > the COTS       | system covers the COTS   | not running on a      |
| > platform and   | OS and is able to verify | compromised COTS      |
| > MPoC           | its security state.      | platform (e.g.,       |
| > Application /  | Including validating, at | rooted, jailbroken,   |
| > MPoC SDK.      | least, the following     | etc.). Although the   |
|                  | information:             | MPoC SDK can use its  |
|                  |                          | own checks to perform |
|                  | -   If the COTS device   | this verification,    |
|                  |     is rooted,           | there may be value in |
|                  |     jailbroken, or       | providing data to the |
|                  |     operating in         | A&M backend for       |
|                  |     developer mode.      | additional validation |
|                  |                          | or updates to local   |
|                  | -   Modifications or     | checks.               |
|                  |     tampering attempt    |                       |
|                  |     events of the MPoC   | Some platforms        |
|                  |     SDK, MPoC            | provide their own     |
|                  |     Application and COTS | attestation functions |
|                  |     execution            | that cover some or    |
|                  |     environment.         | all components of     |
|                  |                          | COTS platform and     |
|                  | -   The version of the   | hardware. However,    |
|                  |     COTS OS*,* MPoC      | these attestation     |
|                  |     Application*,* and   | functions are not     |
|                  |     MPoC SDK, including  | sufficient to attest  |
|                  |     detection of any     | the security and      |
|                  |     rollback attempts.   | correct operation of  |
|                  |                          | the MPoC SDK (these   |
|                  | -   Details on the       | validation            |
|                  |     status of any        | requirements are      |
|                  |     COTS-native          | tested separately).   |
|                  |     interfaces           |                       |
|                  |     implemented by the   | The attestation       |
|                  |     MPoC SDK for account | policy (covered in    |
|                  |     data collection.     | requirement 3C- 1.1)  |
|                  |                          | outlines the          |
|                  | -   Details on the       | responses and actions |
|                  |     status of any        | to be performed based |
|                  |     COTS-native          | on the attestation    |
|                  |     interfaces that may  | results. This may     |
|                  |     be used for account  | vary on a             |
|                  |     data collection,     | per-Platform basis -- |
|                  |     which are not        | e.g., a solution      |
|                  |     implemented by the   | where the MPoC SDK    |
|                  |     MPoC SDK.            | resides entirely in a |
|                  |                          | TEE or SE (so no      |
|                  |                          | sensitive assets are  |
|                  |                          | passed in cleartext   |
|                  |                          | through the REE) may  |
|                  |                          | not consider a rooted |
|                  |                          | or jail- broken       |
|                  |                          | device to be a        |
|                  |                          | negative security     |
|                  |                          | impact.               |
|                  |                          |                       |
|                  |                          | Similarly, detection  |
|                  |                          | of a roll-back of the |
|                  |                          | COTS OS may not       |
|                  |                          | necessarily result in |
|                  |                          | immediate response    |
|                  |                          | from the A&M system,  |
|                  |                          | but may instead be    |
|                  |                          | noted and used in     |
|                  |                          | correlation with      |
|                  |                          | other signals from    |
|                  |                          | that same COTS device |
|                  |                          | to determine the      |
|                  |                          | appropriate action,   |
|                  |                          | in line with the      |
|                  |                          | Attestation and       |
|                  |                          | Monitoring policy.    |
|                  |                          |                       |
|                  |                          | A COTS Platform may   |
|                  |                          | not be able to attest |
|                  |                          | that a specific       |
|                  |                          | COTS-native interface |
|                  |                          | is "secure," and in   |
|                  |                          | such cases it may be  |
|                  |                          | sufficient for the    |
|                  |                          | attestation functions |
|                  |                          | to validate that the  |
|                  |                          | interface is present, |
|                  |                          | in good order, and    |
|                  |                          | not accessed by other |
|                  |                          | applications.         |
|                  |                          |                       |
|                  |                          | COTS platforms may    |
|                  |                          | provide their own     |
|                  |                          | logging and           |
|                  |                          | monitoring of         |
|                  |                          | interfaces that could |
|                  |                          | be used for the entry |
|                  |                          | of account data. For  |
|                  |                          | example, an OS may    |
|                  |                          | log all traffic on    |
|                  |                          | the NFC or touch      |
|                  |                          | interfaces. The       |
|                  |                          | attestation policy    |
|                  |                          | and system baseline   |
|                  |                          | should consider and   |
|                  |                          | account for these     |
|                  |                          | COTS devices.         |
+------------------+--------------------------+-----------------------+

+------------------+--------------------------+-----------------------+
| > **Security     | > **Test Requirements**  | > **Guidance**        |
| > Requirements** |                          |                       |
+==================+==========================+=======================+
|                  |                          | Detection of any      |
|                  |                          | individual item of    |
|                  |                          | concern during an A&M |
|                  |                          | check may not result  |
|                  |                          | in immediate          |
|                  |                          | disablement of        |
|                  |                          | payment acceptance.   |
|                  |                          | However, such         |
|                  |                          | detection will feed   |
|                  |                          | into the potential    |
|                  |                          | for escalated         |
|                  |                          | observation and       |
|                  |                          | analysis of that COTS |
|                  |                          | device to confirm it  |
|                  |                          | remains a secure      |
|                  |                          | environment in which  |
|                  |                          | to continue the       |
|                  |                          | acceptance of         |
|                  |                          | payments.             |
+------------------+--------------------------+-----------------------+

### 1C-2 Measurements/Detection

> To perform attestation, the A&M component measures the COTS platform,
> MPoC Application, and MPoC SDK. Some or all of these measurements are
> communicated to the A&M backend for analysis and action. The quality
> and ability of the attestation and monitoring (A&M) to detect
> potential attacks are bound by the type of measurements collected by
> the A&M backend, along with the analysis performed on those
> measurements. A&M systems are expected to incorporate knowledge across
> a population of COTS devices, enhancing the detection methods.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Sufficient      |                       |                          |
| > information is  |                       |                          |
| > collected to    |                       |                          |
| > detect and      |                       |                          |
| > mitigate        |                       |                          |
| > threats to the  |                       |                          |
| > MPoC Solution.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-2.1** The  | **1C-2.1.a** The      | > Knowledge of the       |
| > information     | tester must confirm   | > signals collected from |
| > that is         | through examination   | > the COTS device is     |
| > collected for   | that the data         | > needed to develop the  |
| > attestation and | collected for A&M     | > A&M service properly   |
| > monitoring      | purposes includes     | > and assess the quality |
| > purposes must   | sufficient            | > of the A&M.            |
| > be documented.  | information to attest | >                        |
|                   | the COTS platform,    | > This requirement       |
|                   | MPoC Application, and | > includes information   |
|                   | MPoC SDK, and         | > collected on the COTS  |
|                   | identify any attached | > device for A&M         |
|                   | devices.              | > purposes and is not    |
|                   |                       | > related directly to    |
|                   |                       | > security checks (e.g., |
|                   |                       | > COTS device model, OS  |
|                   |                       | > version, etc.).        |
|                   |                       | >                        |
|                   |                       | > A&M data where the     |
|                   |                       | > COTS device or MPoC    |
|                   |                       | > SDK is the prover may  |
|                   |                       | > be assignable to that  |
|                   |                       | > COTS device based on   |
|                   |                       | > the method of          |
|                   |                       | > collection (i.e., the  |
|                   |                       | > signals collected can  |
|                   |                       | > only have come from    |
|                   |                       | > that COTS device).     |
|                   |                       | >                        |
|                   |                       | > A&M data transmitted   |
|                   |                       | > to the back-end A&M is |
|                   |                       | > required to be         |
|                   |                       | > uniquely assignable to |
|                   |                       | > the COTS device from   |
|                   |                       | > which it originated.   |
|                   |                       | > This may be based on   |
|                   |                       | > the cryptographic      |
|                   |                       | > methods used to        |
|                   |                       | > transmit that data and |
|                   |                       | > may use                |
|                   |                       | > hardware-backed        |
|                   |                       | > features present on    |
|                   |                       | > the COTS platform,     |
|                   |                       | > like hardware-backed   |
|                   |                       | > keystores.             |
|                   |                       | >                        |
|                   |                       | > Unique assignment is   |
|                   |                       | > required so that       |
|                   |                       | > actions performed in   |
|                   |                       | > response to the data   |
|                   |                       | > collected can focus on |
|                   |                       | > the specific COTS      |
|                   |                       | > device to which that   |
|                   |                       | > data relates. This     |
|                   |                       | > does not preclude the  |
|                   |                       | > anonymizing of         |
|                   |                       | > collected data to      |
|                   |                       | > enhance future A&M     |
|                   |                       | > processing.            |
+-------------------+-----------------------+--------------------------+
|                   | **1C-2.1.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | the A&M data is       |                          |
|                   | uniquely assignable   |                          |
|                   | to the COTS device    |                          |
|                   | from which it         |                          |
|                   | originates.           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-2.2** The  | **1C-2.2.a** The      | The measurements sent to |
| > A&M data must   | tester must confirm   | the A&M backend are      |
| > reflect the     | through examination   | required to reflect the  |
| > current state   | and observation that  | current state of the     |
| > of the MPoC     | the A&M data sent to  | solution. Stale          |
| > SDK, MPoC       | the A&M backend       | measurements may provide |
| > Application,    | reflects the current  | a false sense of         |
| > COTS platform,  | state of the MPoC     | security or be used by   |
| > and peripheral  | SDK, MPoC             | an attacker to replace   |
| > devices, in     | Application, COTS     | more current data.       |
| > addition to any | platform, and         |                          |
| > security        | peripheral devices,   | However, an attacker may |
| > relevant        | in addition to any    | attempt to perform       |
| > changes or      | security relevant     | attacks during the       |
| > measurements    | changes or            | window of time between   |
| > that have       | measurements that     | communications to the    |
| > occurred since  | have occurred since   | A&M backend, so that     |
| > the last        | the last              | their attacks go         |
| > communication   | communication to the  | undetected.              |
| > to the A&M      | A&M backend.          |                          |
| > backend.        |                       | Therefore, in addition   |
|                   |                       | to ensuring the most     |
|                   |                       | current data, it is      |
|                   |                       | important that any       |
|                   |                       | security relevant A&M    |
|                   |                       | data is also transmitted |
|                   |                       | to the backend when      |
|                   |                       | communication is         |
|                   |                       | performed.               |
+-------------------+-----------------------+--------------------------+
|                   | **1C-2.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | any cached or         |                          |
|                   | historic A&M data is  |                          |
|                   | maintained in a       |                          |
|                   | manner that protects  |                          |
|                   | its integrity and     |                          |
|                   | authenticity.         |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1C-2.2.c** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | any cached or         |                          |
|                   | historic A&M data is  |                          |
|                   | unable to be used to  |                          |
|                   | replace or subvert    |                          |
|                   | the most recent and   |                          |
|                   | accurate data         |                          |
|                   | reflecting the        |                          |
|                   | current state of the  |                          |
|                   | MPoC SDK and MPoC     |                          |
|                   | Application.          |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-2.3** The  | **1C-2.3.a** The      | The A&M needs to resist  |
| > A&M data sent   | tester must confirm   | replay, preplay, or      |
| > to the backend  | through examination   | tampering attacks.       |
| > must contain a  | and observation that: |                          |
| > freshness       |                       | The data providing       |
| > indicator. The  | -   Mechanisms exist  | freshness to the         |
| > A&M data and    |     that provide      | attestation system needs |
| > the freshness   |     freshness.        | to be protected against  |
| > indicator must  |                       | tampering (e.g., the use |
| > be protected    | -   The A&M data and  | of a signed timestamp or |
| > against         |     freshness         | nonce known beforehand   |
| > tampering.      |     indicator is      | to the A&M backend).     |
|                   |     protected against |                          |
|                   |     tampering.        |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-2.4** The  | **1C-2.4.a** The      | On-device attestation    |
| > A&M             | tester must confirm   | can be time and resource |
| > functionality   | through examination   | intensive, and therefore |
| > must include an | and observation that  | full attestation checks  |
| > aspect within   | the A&M functions     | cannot be continually    |
| > the MPoC SDK,   | include checks that   | performed. However, some |
| > which performs  | execute at all times  | checks are less          |
| > continual       | when the MPoC         | intensive -- such as the |
| > monitoring.     | Application is        | check for entry into     |
|                   | executing. This must  | developer mode, or       |
|                   | include, at a         | activation of debug      |
|                   | minimum, checks for   | functionality -- and can |
|                   | developer and debug   | be more easily performed |
|                   | modes where these     | in the background at all |
|                   | features are          | times.                   |
|                   | available.            |                          |
|                   |                       | To ensure the security   |
|                   |                       | of the MPoC Solution, it |
|                   |                       | is important that the    |
|                   |                       | checks which are more    |
|                   |                       | easily deployed at all   |
|                   |                       | times, are not left      |
|                   |                       | until a full attestation |
|                   |                       | is required.             |
+-------------------+-----------------------+--------------------------+

### 1C-3 Response

> The A&M must be able to respond to potential attacks that it has
> identified. The response process, and the data that may lead to that
> response, must be documented. Attacks detected by the COTS-based A&M
> must be reported to the A&M backend.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The A&M must be |                       |                          |
| > able to provide |                       |                          |
| > suitable        |                       |                          |
| > responses to    |                       |                          |
| > mitigate        |                       |                          |
| > potential       |                       |                          |
| > attacks.        |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-3.1**      | **1C-3.1.a** The      | > The A&M system needs   |
| > Documentation   | tester must confirm   | > to implement actions   |
| > must exist that | through examination   | > when tampering of the  |
| > describes the   | that the provided     | > MPoC SDK or MPoC       |
| > actions that    | information is        | > Application is         |
| > can be taken if | sufficient and        | > detected.              |
| > the attestation | consistent with the   | >                        |
| > and monitoring  | tester's              | > Information outlining  |
| > (A&M) indicates | understanding of the  | > the functions provided |
| > that the MPoC   | solution.             | > by the attestation and |
| > SDK, MPoC       |                       | > monitoring (A&M) to    |
| > Application, or |                       | > indications of         |
| > COTS platform   |                       | > compromise is          |
| > is potentially  |                       | > required. It is likely |
| > compromised.    |                       | > that the attestation   |
|                   |                       | > and monitoring (A&M)   |
|                   |                       | > backend is able to be  |
|                   |                       | > configured to act in   |
|                   |                       | > different ways and,    |
|                   |                       | > where this is          |
|                   |                       | > possible, the          |
|                   |                       | > documentation needs to |
|                   |                       | > reflect how such       |
|                   |                       | > configuration is       |
|                   |                       | > managed securely.      |
|                   |                       | >                        |
|                   |                       | > Common responses from  |
|                   |                       | > the attestation and    |
|                   |                       | > monitoring (A&M)       |
|                   |                       | > include account        |
|                   |                       | > deactivation, assets   |
|                   |                       | > deletion, and temporal |
|                   |                       | > suspension until a     |
|                   |                       | > manual verification    |
|                   |                       | > occurs.                |
|                   |                       | >                        |
|                   |                       | > Checks that attempt to |
|                   |                       | > validate the integrity |
|                   |                       | > of the COTS platform   |
|                   |                       | > are included in this   |
|                   |                       | > requirement. Such      |
|                   |                       | > checks may include     |
|                   |                       | > validating that the    |
|                   |                       | > COTS device has not    |
|                   |                       | > been rooted,           |
|                   |                       | > jailbroken, or         |
|                   |                       | > otherwise compromised  |
|                   |                       | > so that there is no    |
|                   |                       | > longer a secure        |
|                   |                       | > platform on which the  |
|                   |                       | > MPoC SDK can execute.  |
+-------------------+-----------------------+--------------------------+
|                   | **1C-3.1.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the              |                          |
|                   | documentation         |                          |
|                   | includes potential    |                          |
|                   | configuration, or     |                          |
|                   | options for these     |                          |
|                   | actions must also be  |                          |
|                   | documented.           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-3.2**      | **1C-3.2.a** The      | A tamper attempt is      |
| > Potential       | tester must confirm   | detected by the MPoC     |
| > tampering       | through examination   | SDK, it is required that |
| > events detected | and observation that  | the MPoC SDK informs the |
| > by the MPoC SDK | the MPoC SDK is able  | A&M backend. This can    |
| > must be         | to report any         | assist with the          |
| > reported to the | potential tampering   | understanding of risk    |
| > attestation and | events to the A&M     | for similar types of     |
| > monitoring      | backend.              | solutions, as well as    |
| > (A&M) backend.  |                       | helping the A&M          |
|                   |                       | responses to be further  |
|                   |                       | tuned or developed to    |
|                   |                       | accommodate similar      |
|                   |                       | types of attacks.        |
|                   |                       |                          |
|                   |                       | Additionally, as the     |
|                   |                       | MPoC SDK is considered   |
|                   |                       | to execute in a          |
|                   |                       | potentially hostile      |
|                   |                       | environment,             |
|                   |                       | communication of         |
|                   |                       | potential tamper events  |
|                   |                       | assists in aligning      |
|                   |                       | back-end responses with  |
|                   |                       | expected responses from  |
|                   |                       | the MPoC SDK. For        |
|                   |                       | example, if an MPoC SDK  |
|                   |                       | instance detects an      |
|                   |                       | attempted compromise and |
|                   |                       | performs actions to halt |
|                   |                       | payment processing,      |
|                   |                       | further payment          |
|                   |                       | processing from that     |
|                   |                       | instance received by the |
|                   |                       | back-end system should   |
|                   |                       | be considered suspect.   |
+-------------------+-----------------------+--------------------------+
| > **1C-3.3** It   | **1C-3.3.a** The      | The ability to respond   |
| > must be         | tester must confirm   | to potential attacks is  |
| > possible for    | through examination   | a requirement even       |
| > the MPoC SDK to | and observation that  | during any loss of       |
| > disable         | the MPoC SDK is able  | communication with       |
| > processing in   | to respond            | back-end A&Ms.           |
| > the event of    | independently to      |                          |
| > tamper          | potential tamper      | Tampering events may     |
| > indications.    | events detected by    | include both direct      |
|                   | local A&M checks.     | attacks on the MPoC SDK, |
|                   |                       | such as detection of     |
|                   |                       | overlay during PIN       |
|                   |                       | entry, as well as        |
|                   |                       | compromises of the       |
|                   |                       | integrity of the COTS    |
|                   |                       | platform, such as        |
|                   |                       | rooting, jailbreaking,   |
|                   |                       | etc.                     |
+-------------------+-----------------------+--------------------------+
|                   | **1C-3.3.b** The      |                          |
|                   | tester must attempt   |                          |
|                   | to trigger a subset   |                          |
|                   | of the security       |                          |
|                   | mechanisms of the     |                          |
|                   | MPoC SDK and verify   |                          |
|                   | that the actions      |                          |
|                   | taken by the MPoC     |                          |
|                   | Solution are as       |                          |
|                   | documented. This test |                          |
|                   | must be performed     |                          |
|                   | both with and without |                          |
|                   | connection to the A&M |                          |
|                   | backend to confirm    |                          |
|                   | that independent      |                          |
|                   | action is possible.   |                          |
|                   |                       |                          |
|                   | ***Note:** This test  |                          |
|                   | is not to verify the  |                          |
|                   | attestation policy,   |                          |
|                   | but to verify that    |                          |
|                   | the documented        |                          |
|                   | response capabilities |                          |
|                   | exist in the MPoC     |                          |
|                   | Solution and can be   |                          |
|                   | triggered.*           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-3.4** The  | **1C-3.4.a** The      | When not operating in    |
| > MPoC SDK must   | tester must confirm   | offline                  |
| > perform an      | through examination   | payment-processing mode, |
| > attestation     | and observation that  | the MPoC SDK is required |
| > with the A&M    | the MPoC SDK prevents | to receive               |
| > backend upon    | further payment       | communications from the  |
| > start up and at | processing after 60   | A&M back-end component   |
| > least every 60  | minutes of continuous | at least every hour to   |
| > minutes of      | operation without a   | ensure that the MPoC     |
| > continuous      | passing response from | Solution is operating    |
| > operation or    | the A&M back-end      | securely and that the    |
| > suspend further | component when not    | MPoC SDK has passed all  |
| > payment         | operating in offline  | attestation checks       |
| > processing      | payment acceptance    | successfully.            |
| > until such      | mode.                 |                          |
| > attestation is  |                       | In the context of this   |
| > performed.      |                       | requirement, a "passing  |
|                   |                       | response" from the A&M   |
|                   |                       | back-end component       |
|                   |                       | indicates that the A&M   |
|                   |                       | system has performed and |
|                   |                       | validated all            |
|                   |                       | attestation checks       |
|                   |                       | required by the MPoC     |
|                   |                       | Software attestation     |
|                   |                       | policy.                  |
|                   |                       |                          |
|                   |                       | This requirement does    |
|                   |                       | not supersede any other  |
|                   |                       | requirements for         |
|                   |                       | consistent A&M           |
|                   |                       | monitoring or checks to  |
|                   |                       | be performed on          |
|                   |                       | execution or prior to    |
|                   |                       | specific functions such  |
|                   |                       | as PIN entry.            |
|                   |                       |                          |
|                   |                       | This requirement does    |
|                   |                       | not replace requirement  |
|                   |                       | 1C-2.4, which notes the  |
|                   |                       | need for the MPoC SDK to |
|                   |                       | perform continual and    |
|                   |                       | ongoing checks at all    |
|                   |                       | times (although these    |
|                   |                       | checks may be a subset   |
|                   |                       | of a "full" attestation  |
|                   |                       | process performed        |
|                   |                       | locally).                |
+-------------------+-----------------------+--------------------------+
| > **1C-3.5** An   | **1C-3.5.a** The      | An attacker may attempt  |
| > MPoC SDK that   | tester must confirm   | to exploit periods of no |
| > is suspended or | through examination   | execution, or suspension |
| > otherwise       | and observation that  | of the MPoC SDK, to      |
| > halted must     | an MPoC SDK resumed   | perform attacks on the   |
| > perform an A&M  | from a suspended,     | COTS platform. In such   |
| > attestation     | halted, or other mode | instances it is          |
| > prior to any    | that prevents         | important the security   |
| > payment         | execution, requires   | and integrity of the     |
| > processing.     | an A&M attestation    | platform is validated    |
|                   | process is performed  | prior to any payment     |
|                   | prior to any payment  | processing.              |
|                   | processing.           |                          |
|                   |                       | When assessing this      |
|                   |                       | requirement, the tester  |
|                   |                       | should consider how the  |
|                   |                       | COTS platforms supported |
|                   |                       | by the COTS platform     |
|                   |                       | baseline operate with    |
|                   |                       | regards to application   |
|                   |                       | switching and halting.   |
|                   |                       | Some platforms may allow |
|                   |                       | for continued secure     |
|                   |                       | operation when an        |
|                   |                       | application is not       |
|                   |                       | currently in focus or    |
|                   |                       | may allow for multiple   |
|                   |                       | applications to have     |
|                   |                       | presence on the display  |
|                   |                       | at any one time (e.g.,   |
|                   |                       | during multi-tasking or  |
|                   |                       | multi-window operation). |
|                   |                       |                          |
|                   |                       | The MPoC requirements    |
|                   |                       | allow for both remote    |
|                   |                       | and local attestation    |
|                   |                       | functions, and the type  |
|                   |                       | of attestation to be     |
|                   |                       | performed upon return to |
|                   |                       | an MPoC SDK that has     |
|                   |                       | been removed from focus  |
|                   |                       | may depend upon the COTS |
|                   |                       | platform features, and   |
|                   |                       | attestation methods      |
|                   |                       | implemented in local and |
|                   |                       | remote operation.        |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-3.6** A&M  | **1C-3.6.a** The      | A&M results that         |
| > results that    | tester must confirm   | indicate that the        |
| > may require the | through examination   | payment acceptance must  |
| > cessation of    | and observation that  | be halted are likely to  |
| > payment         | any A&M results that  | result from a            |
| > acceptance must | may require the       | compromised COTS device  |
| > not be          | cessation of payment  | or MPoC Application.     |
| > communicated    | acceptance are not    | This may impact the      |
| > through the     | communicated from the | ability for the payment  |
| > COTS device.    | A&M backend to the    | backend to receive       |
|                   | payment processing    | accurate and correct     |
|                   | backend through the   | data from the COTS       |
|                   | COTS device.          | device.                  |
|                   |                       |                          |
|                   |                       | This requirement does    |
|                   |                       | not prevent or preclude  |
|                   |                       | operational models that  |
|                   |                       | provide the MPoC SDK     |
|                   |                       | with explicit approval   |
|                   |                       | to perform payments on a |
|                   |                       | per- transaction basis.  |
+-------------------+-----------------------+--------------------------+

### 1C-4 Anti-Tampering

> The MPoC SDK is protected against tampering through the utility of the
> A&M system. For this reason, the attestation and monitoring (A&M) is a
> high-value target for attackers and becomes a critical target that
> needs to be protected against tampering.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The attestation |                       |                          |
| > and monitoring  |                       |                          |
| > (A&M),          |                       |                          |
| > including the   |                       |                          |
| > collection and  |                       |                          |
| > transmission of |                       |                          |
| > data on the     |                       |                          |
| > COTS device, is |                       |                          |
| > protected from  |                       |                          |
| > compromise.     |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-4.1** The  | **1C-4.1.a** The      | Modification of the      |
| > protections     | tester must confirm   | attestation and          |
| > provided to the | through examination   | monitoring (A&M) data or |
| > attestation and | that the information  | code may, in practice,   |
| > monitoring      | provided sufficiently | allow for the bypass of  |
| > (A&M) must be   | details the           | the security mechanisms. |
| > documented.     | anti-tamper           | The A&M component on the |
|                   | protections that have | MPoC SDK needs to be     |
|                   | been validated        | protected against        |
|                   | through the MPoC SDK  | tampering.               |
|                   | testing process.      |                          |
|                   |                       | Documentation is         |
|                   |                       | required to indicate     |
|                   |                       | what protections are     |
|                   |                       | provided, so that these  |
|                   |                       | can be confirmed as      |
|                   |                       | in-place during the lab  |
|                   |                       | validation.              |
+-------------------+-----------------------+--------------------------+
| > **1C-4.2** A    | **1C-4.2.a** The      | The modification of the  |
| > secure channel  | tester must confirm   | messages between the A&M |
| > must not be     | through examination   | component on the MPoC    |
| > relied upon as  | and observation that  | SDK and the A&M backend  |
| > the sole        | the data transmitted  | may hinder the detection |
| > protection for  | between the A&M       | of tampering events on   |
| > A&M data during | functions in the MPoC | the backend and          |
| > transmission.   | SDK and the A&M       | interfere with the       |
|                   | backend is protected  | monitoring of the MPoC   |
|                   | for authenticity and  | Solution.                |
|                   | integrity, separately |                          |
|                   | to the protections    | Hence, the authenticity  |
|                   | provided by the       | and integrity of the     |
|                   | secure channel used   | messages needs to be     |
|                   | for that connection.  | guaranteed.              |
|                   |                       |                          |
|                   |                       | The requirements in 1A-5 |
|                   |                       | outline the need for all |
|                   |                       | connections to implement |
|                   |                       | secure channels and the  |
|                   |                       | security properties of   |
|                   |                       | these channels. This     |
|                   |                       | requirement covers the   |
|                   |                       | need to protect the A&M  |
|                   |                       | data within the secure   |
|                   |                       | channel itself -- use of |
|                   |                       | a secure channel as the  |
|                   |                       | sole method of           |
|                   |                       | protection for A&M data  |
|                   |                       | integrity and            |
|                   |                       | authenticity is not      |
|                   |                       | sufficient.              |
|                   |                       |                          |
|                   |                       | The secure channel may   |
|                   |                       | be relied upon to        |
|                   |                       | provide the              |
|                   |                       | confidentiality          |
|                   |                       | protections for this     |
|                   |                       | data, as the primary     |
|                   |                       | concern is that the data |
|                   |                       | is altered rather than   |
|                   |                       | disclosed.               |
|                   |                       |                          |
|                   |                       | The A&M messages contain |
|                   |                       | sensitive assets such as |
|                   |                       | security check results.  |
|                   |                       | sensitive assets can be  |
|                   |                       | abused to reverse        |
|                   |                       | engineer the security    |
|                   |                       | mechanisms in the MPoC   |
|                   |                       | SDK. Hence,              |
|                   |                       | confidentiality is       |
|                   |                       | needed to protect the    |
|                   |                       | A&M messages.            |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-4.3** The  | **1C-4.3.a** The      | The time source used to  |
| > local time      | tester must confirm   | track the local time is  |
| > source used by  | through examination   | required to be reliable  |
| > the MPoC SDK    | and observation that  | and trusted. The COTS    |
| > must be secured | the local time source | platforms and MPoC       |
| > against         | is protected against  | Solutions may offer      |
| > tampering or    | tampering.            | different options of     |
| > alteration.     |                       | measuring time. The MPoC |
|                   |                       | SDK is required to       |
|                   |                       | select the option that   |
|                   |                       | reflects real elapsed    |
|                   |                       | time to enforce the time |
|                   |                       | limits properly. For     |
|                   |                       | example, time may be     |
|                   |                       | provided by a PCI PTS    |
|                   |                       | SCRP during each         |
|                   |                       | transaction. In these    |
|                   |                       | cases, the tester is     |
|                   |                       | expected to validate     |
|                   |                       | that interaction with    |
|                   |                       | the PCI PTS SCRP is      |
|                   |                       | required for each        |
|                   |                       | transaction.             |
|                   |                       |                          |
|                   |                       | Timers used for this     |
|                   |                       | purpose need to be       |
|                   |                       | monotonic, and clock     |
|                   |                       | sources, if used, need   |
|                   |                       | to prevent or log        |
|                   |                       | alteration by            |
|                   |                       | applications or users.   |
|                   |                       | If the clock value could |
|                   |                       | be affected by, or       |
|                   |                       | altered during, sleep    |
|                   |                       | events or periods when   |
|                   |                       | the MPoC SDK is not      |
|                   |                       | executing, payment       |
|                   |                       | processing must be       |
|                   |                       | prevented after such     |
|                   |                       | events until             |
|                   |                       | connectivity to the      |
|                   |                       | back- end system can be  |
|                   |                       | re-established and the   |
|                   |                       | offline payment data     |
|                   |                       | cleared.                 |
|                   |                       |                          |
|                   |                       | Validation of the local  |
|                   |                       | time source during       |
|                   |                       | connections to the       |
|                   |                       | attestation and          |
|                   |                       | monitoring (A&M) helps   |
|                   |                       | to identify attacks that |
|                   |                       | may attempt to           |
|                   |                       | manipulate this source.  |
|                   |                       |                          |
|                   |                       | Additionally, it helps   |
|                   |                       | to ensure that the       |
|                   |                       | attestation and          |
|                   |                       | monitoring (A&M) can     |
|                   |                       | correctly and accurately |
|                   |                       | interpret any time       |
|                   |                       | stamps used in           |
|                   |                       | transmitted attestation  |
|                   |                       | and monitoring (A&M)     |
|                   |                       | data.                    |
+-------------------+-----------------------+--------------------------+
|                   | **1C-4.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | the local time source |                          |
|                   | is validated during   |                          |
|                   | connections to the    |                          |
|                   | back- end A&Ms.       |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-4.4** The  | **1C-4.4.a** The      | The A&M backend is       |
| > A&M backend     | tester must confirm   | required to monitor and  |
| > must be able to | through examination   | be able to respond to    |
| > detect failures | and observation that  | situations where there   |
| > in the A&M      | the A&M backend is    | is an indication of      |
| > functions       | able to detect and    | failure in the MPoC SDK. |
| > within the MPoC | respond to failures   | For example, if          |
| > SDK.            | in the MPoC SDK A&M   | attestation data is      |
|                   | functions.            | repeated when it should  |
|                   |                       | not be, or is not        |
|                   |                       | present, when the MPoC   |
|                   |                       | SDK appears to be        |
|                   |                       | continuing to transact,  |
|                   |                       | it may be an indication  |
|                   |                       | of an attack on the      |
|                   |                       | payment system.          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-4.5** The  | **1C-4.5.a** The      | The A&M plays the        |
| > A&M used by the | tester must test the  | important role of        |
| > MPoC SDK must   | MPoC SDK by           | communicating the        |
| > be resistant to | attempting to tamper  | security state of the    |
| > tampering to an | with the attestation  | COTS and PCI PTS SCRP    |
| > attack rating   | system and the        | devices to the backend   |
| > of 25 points    | messages sent and     | and concentrating the    |
| > using the       | received from the     | security information of  |
| > attack- costing | attestation and       | the MPoC SDK. A          |
| > framework in    | monitoring (A&M)      | compromise of the        |
| > [*Appendix      | backend.              | attestation and          |
| > B*.](#ap        |                       | monitoring (A&M)         |
| pendix-b-attack-c |                       | component on the COTS    |
| osting-framework) |                       | device or data           |
|                   |                       | transmitted to the       |
|                   |                       | backend may be the same  |
|                   |                       | as effectively disabling |
|                   |                       | security checks.         |
+-------------------+-----------------------+--------------------------+
|                   | **1C-4.5.b** If       |                          |
|                   | security mechanisms   |                          |
|                   | prevent the           |                          |
|                   | tampering, the tester |                          |
|                   | must attempt to       |                          |
|                   | bypass the            |                          |
|                   | mechanisms. If it is  |                          |
|                   | not possible to       |                          |
|                   | bypass the mechanism, |                          |
|                   | the tester must       |                          |
|                   | describe what would   |                          |
|                   | be needed to bypass   |                          |
|                   | the mechanism         |                          |
|                   | successfully (the     |                          |
|                   | expected              |                          |
|                   | actions/situations    |                          |
|                   | needed to bypass the  |                          |
|                   | mechanism).           |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1C-4.5.c** The      |                          |
|                   | tester must provide a |                          |
|                   | costing of this       |                          |
|                   | attack based on the   |                          |
|                   | method outlined in    |                          |
|                   | *[Appendix            |                          |
|                   | B.](#appendix-b-attac |                          |
|                   | k-costing-framework)* |                          |
|                   | [*Attack Costing      |                          |
|                   | Framewor              |                          |
|                   | k*.](#appendix-b-atta |                          |
|                   | ck-costing-framework) |                          |
|                   | This requirement is   |                          |
|                   | passed if the most    |                          |
|                   | feasible attack       |                          |
|                   | cannot be costed for  |                          |
|                   | less than 25 points.  |                          |
+-------------------+-----------------------+--------------------------+

### 1C-5 A&M Integration Guidance

> The attestation and monitoring (A&M) needs to be integrated securely
> into the MPoC Solution. Therefore, it is important to ensure that
> information exists that facilitates the transfer of the security and
> operational knowledge required.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Sufficient      |                       |                          |
| > guidance and    |                       |                          |
| > features are    |                       |                          |
| > provided to     |                       |                          |
| > allow for the   |                       |                          |
| > secure          |                       |                          |
| > integration and |                       |                          |
| > operation of    |                       |                          |
| > the attestation |                       |                          |
| > and monitoring  |                       |                          |
| > (A&M).          |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-5.1** A&M  | **1C-5.1.a** The      | > This information is    |
| > back-end        | tester must confirm   | > required even when the |
| > operation       | through examination   | > attestation and        |
| > security        | that the attestation  | > monitoring (A&M) is    |
| > guidance        | and monitoring (A&M)  | > operated by the        |
| > information     | back-end operation    | > developer of that      |
| > must exist that | security guidance     | > system, as correct     |
| > explains how    | contains the required | > operation requires     |
| > the attestation | information and       | > proper levels of       |
| > and monitoring  | comment on its        | > training and           |
| > (A&M) is        | sufficiency to        | > documentation. It is   |
| > securely        | securely configure    | > not sufficient for     |
| > configured and  | the attestation and   | > operation of an        |
| > operated.       | monitoring (A&M)      | > attestation and        |
|                   | backend according to  | > monitoring (A&M)       |
|                   | the tester's          | > environment to rely    |
|                   | understanding of the  | > entirely on experience |
|                   | MPoC Software. The    | > and knowledge that is  |
|                   | documentation must    | > not otherwise          |
|                   | include the following | > documented.            |
|                   | at a minimum:         |                          |
|                   |                       |                          |
|                   | -   How to configure  |                          |
|                   |     the attestation   |                          |
|                   |     and monitoring    |                          |
|                   |     (A&M), including  |                          |
|                   |     the offline       |                          |
|                   |     policy, securely. |                          |
|                   |                       |                          |
|                   | -   A base            |                          |
|                   |     configuration for |                          |
|                   |     the attestation   |                          |
|                   |     and monitoring    |                          |
|                   |     (A&M).            |                          |
|                   |                       |                          |
|                   | -   Specific          |                          |
|                   |     integration       |                          |
|                   |     requirements that |                          |
|                   |     must be fulfilled |                          |
|                   |     to integrate the  |                          |
|                   |     attestation and   |                          |
|                   |     monitoring (A&M)  |                          |
|                   |     component         |                          |
|                   |     securely.         |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1C-5.1.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the attestation  |                          |
|                   | and monitoring (A&M)  |                          |
|                   | security guidance     |                          |
|                   | includes a base       |                          |
|                   | configuration defined |                          |
|                   | for the A&M           |                          |
|                   | component. This       |                          |
|                   | configuration is      |                          |
|                   | assumed to be a       |                          |
|                   | secure configuration  |                          |
|                   | for the A&M and must  |                          |
|                   | be the one used for   |                          |
|                   | the PCI MPoC          |                          |
|                   | validation tests.     |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1C-5.2** The  | **1C-5.2.a** The      | Integration of the A&M   |
| > security        | tester must confirm   | functionality is         |
| > guidance        | through examination   | required for all MPoC    |
| > information     | that the security     | implementations. This    |
| > must detail how | guidance includes at  | security guidance may be |
| > to securely     | a minimum:            | a formal document for    |
| > integrate the   |                       | MPoC Software components |
| > A&M software    | -   How to deploy the | that are to be operated  |
| > component into  |     A&M software      | by third parties, or     |
| > the MPoC        |     component in a    | internal knowledge base  |
| > Application.    |     production-ready  | solutions for vendors    |
|                   |     configuration     | performing all           |
|                   |     (e.g., not        | operations required of   |
|                   |     debugging         | an MPoC Solution.        |
|                   |     enabled).         |                          |
|                   |                       |                          |
|                   | -   How to integrate  |                          |
|                   |     the A&M software  |                          |
|                   |     component into    |                          |
|                   |     the MPoC          |                          |
|                   |     Application.      |                          |
|                   |                       |                          |
|                   | -   Specific          |                          |
|                   |     dependencies of   |                          |
|                   |     security checks   |                          |
|                   |     on OS versions or |                          |
|                   |     COTS platforms.   |                          |
+-------------------+-----------------------+--------------------------+
| > **1C-5.3**      | **1C-5.3.a** The      | An A&M can be configured |
| > Security        | tester must confirm   | at run-time or compile   |
| > guidance        | through examination   | time. Documentation that |
| > information     | that the              | clearly states what      |
| > must detail     | configuration options | signals and responses    |
| > what A&M        | of the A&M are        | are configurable, and    |
| > features are    | documented, including | which ones are not, help |
| > configurable,   | their possible        | understand the baseline  |
| > the processes   | settings.             | security of the solution |
| > for setting or  |                       | and work as an input for |
| > changing these  |                       | policy making.           |
| > configurations, |                       |                          |
| > and how the     |                       | Sufficient information   |
| > applicable      |                       | needs to be provided     |
| > settings may    |                       | over the configuration   |
| > affect the      |                       | of the A&M component,    |
| > security and    |                       | such that it can be      |
| > functionality   |                       | configured properly      |
| > of the overall  |                       | during integration and   |
| > MPoC Solution.  |                       | so the impact of such    |
|                   |                       | configuration decisions  |
|                   |                       | can be understood.       |
+-------------------+-----------------------+--------------------------+
|                   | **1C-5.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the              |                          |
|                   | configuration options |                          |
|                   | exist and are limited |                          |
|                   | to the documented     |                          |
|                   | options.              |                          |
+-------------------+-----------------------+--------------------------+

## Module 1D: Secure Entry and Processing of Account Data

> This Module covers the use of external and/or COTS-native systems to
> read payment account data from a payment instrument such as a payment
> card. This Module does not cover the entry of account data not
> obtained from the payment instrument, such as PINs. This Module
> includes requirements for the use of PCI PTS SCRP devices, non-PTS
> approved MSR devices, the use of the COTS-native NFC interface to read
> contactless payment instruments, and manual entry of account data.
>
> Only account data entry systems specifically addressed by this
> standard may be used within an MPoC Solution. Future updates to this
> standard may include or support other methods of account data entry.

### 1D-1 Account Data Entry and Encryption

> This Section covers the requirements for all COTS-native account data
> entry methods, and how this data must be secured as it is entered and
> processed. These requirements do not apply to data captured through a
> PCI PTS SCRP or non-PTS approved MSR device.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > All account     |                       |                          |
| > data entry      |                       |                          |
| > methods are     |                       |                          |
| > documented and  |                       |                          |
| > provide         |                       |                          |
| > encryption for  |                       |                          |
| > onward          |                       |                          |
| > processing      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-1.1**      | **1D-1.1.a** For each | It is a requirement that |
| > Documentation   | of the account data   | all account data entry   |
| > must exist that | entry methods         | methods that the MPoC    |
| > details how     | supported by the      | SDK supports are         |
| > account data is | solution, the tester  | understood and secured   |
| > entered and     | must confirm through  | properly. Use of         |
| > secured.        | examination that the  | functionality that has   |
|                   | required information  | not been assessed        |
|                   | for integration with  | presents a security risk |
|                   | the MPoC SDK is       | to the MPoC SDK.         |
|                   | present.              |                          |
|                   |                       | Documentation associated |
|                   | The information must  | with any external or     |
|                   | provide details       | add-on account data      |
|                   | about:                | entry methods needs to   |
|                   |                       | contain all the          |
|                   | -   All methods used  | necessary information to |
|                   |     for the entry of  | integrate that system    |
|                   |     account data into | securely into the MPoC   |
|                   |     the MPoC SDK.     | Solution.                |
|                   |                       |                          |
|                   | -   The supported     |                          |
|                   |     functionality of  |                          |
|                   |     each account data |                          |
|                   |     entry method.     |                          |
|                   |                       |                          |
|                   | -   All guidance      |                          |
|                   |     required for the  |                          |
|                   |     correct and       |                          |
|                   |     approved          |                          |
|                   |     operation of any  |                          |
|                   |     of the account    |                          |
|                   |     data entry        |                          |
|                   |     methods.          |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-1.2**      | **1D-1.2.a** The      | Account data is required |
| > Account data    | tester must confirm   | to be encrypted at the   |
| > must be         | through examination   | earliest to reduce the   |
| > encrypted at    | that for any account  | opportunity window in    |
| > the earliest    | data entry methods    | which account data can   |
| > possible point. | implemented on the    | be compromised in        |
| > Account data    | COTS device, the card | cleartext. Normally,     |
| > provided from   | data is encrypted     | this is done in the      |
| > acceptance      | either immediately    | external card reader     |
| > devices         | upon entry or         | itself or in the MPoC    |
| > external to the | immediately after any | SDK when a COTS native   |
| > COTS device     | required processing   | interface, such as       |
| > (such as from a | through associated    | COTS-native NFC, is      |
| > PCI PTS SCRP or | payment kernels.      | used.                    |
| > non-PTS         |                       |                          |
| > approved MSR    |                       | Although it is not the   |
| > device) must be |                       | scope of this            |
| > provided        |                       | requirement to assess    |
| > encrypted and   |                       | the encryption of any    |
| > not be          |                       | external account data    |
| > decrypted on    |                       | capture systems, such as |
| > the COTS        |                       | a PCI PTS SCRP or        |
| > platform.       |                       | non-PTS approved MSR,    |
|                   |                       | the assessor is required |
|                   |                       | to confirm that there is |
|                   |                       | no functionality on the  |
|                   |                       | COTS device that would   |
|                   |                       | expect this data to be   |
|                   |                       | provided in cleartext or |
|                   |                       | allow for the decryption |
|                   |                       | of the account data on   |
|                   |                       | the COTS platform.       |
|                   |                       |                          |
|                   |                       | Account data encryption  |
|                   |                       | is required to be        |
|                   |                       | provided separately from |
|                   |                       | any secure channels      |
|                   |                       | provided.                |
|                   |                       |                          |
|                   |                       | Encryption of account    |
|                   |                       | data by the secure       |
|                   |                       | channel, such as through |
|                   |                       | the use of TLS, is not   |
|                   |                       | sufficient to meet this  |
|                   |                       | requirement.             |
|                   |                       | Datagram-level           |
|                   |                       | encryption using         |
|                   |                       | encryption keys          |
|                   |                       | dedicated to account     |
|                   |                       | data encryption needs to |
|                   |                       | be used.                 |
+-------------------+-----------------------+--------------------------+
|                   | **1D-1.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | account data provided |                          |
|                   | by acceptance devices |                          |
|                   | external to the COTS  |                          |
|                   | device, such as PCI   |                          |
|                   | PTS SCRPs or non-PTS  |                          |
|                   | approved MSRs, is     |                          |
|                   | received encrypted    |                          |
|                   | and the cryptographic |                          |
|                   | keys required to      |                          |
|                   | decrypt this data are |                          |
|                   | not available on the  |                          |
|                   | COTS device, and the  |                          |
|                   | cleartext account     |                          |
|                   | data is never         |                          |
|                   | returned to the COTS  |                          |
|                   | device.               |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-1.3**      | **1D-1.3.a** The      | Account data-related     |
| > Secret or       | tester must confirm   | keys are not permitted   |
| > private         | through examination   | to be stored in          |
| > cryptographic   | and observation that  | cleartext on the COTS    |
| > keys related to | any secret or private | platform. This includes  |
| > account data    | keys used for         | any keys used to derive  |
| > protection must | encryption of account | the unique per           |
| > never be stored | data are not stored   | transaction key that     |
| > as cleartext in | as cleartext in       | directly encrypts the    |
| > non- volatile   | non-volatile storage  | account data. Use of a   |
| > storage within  | within the REE of the | hardware-backed keystore |
| > the REE of the  | COTS device*.*        | to maintain the account  |
| > COTS device.    |                       | data-related keys may    |
|                   |                       | assist in providing      |
|                   |                       | security over key        |
|                   |                       | storage to meet this     |
|                   |                       | requirement. This is     |
|                   |                       | assessed as part of the  |
|                   |                       | key management           |
|                   |                       | requirements.            |
|                   |                       |                          |
|                   |                       | Encryption needs to use  |
|                   |                       | suitable cryptography as |
|                   |                       | assessed in Section      |
|                   |                       | 1A-3, and use suitable   |
|                   |                       | key management as        |
|                   |                       | assessed in Section      |
|                   |                       | 1A-4.                    |
+-------------------+-----------------------+--------------------------+
| > **1D-1.4**      | **1D-1.4.a** The      | Where cryptographic keys |
| > Cryptographic   | tester must confirm   | are shared across        |
| > keys used to    | through examination   | different systems, the   |
| > encrypt account | and observation that  | risk of compromise for   |
| > data must be    | any cryptographic     | those keys increases. To |
| > unique per MPoC | keys used to encrypt  | ensure that the          |
| > Application     | account data are      | compromise of any one    |
| > installation.   | unique per MPoC       | MPoC Application does    |
|                   | Application.          | not affect the security  |
|                   |                       | of any other MPoC        |
|                   |                       | Application, the         |
|                   |                       | cryptographic keys used  |
|                   |                       | to encrypt account data  |
|                   |                       | must be unique to each   |
|                   |                       | instance of an installed |
|                   |                       | MPoC Application (not    |
|                   |                       | just unique to a         |
|                   |                       | particular MPoC          |
|                   |                       | Application version).    |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-1.5**      | **1D-1.5.a** The      | Although cryptographic   |
| > Account data    | tester must confirm   | keys related to account  |
| > encryption keys | through examination   | data security are        |
| > exposed in the  | and observation that  | required to never be     |
| > rich execution  | if any cryptographic  | stored in cleartext      |
| > environment of  | keys related to       | within the rich          |
| > the COTS device | account data          | execution environment,   |
| > must be unique  | encryption are        | these keys may be        |
| > per transaction | exposed in the rich   | exposed in the rich      |
| > and implement   | execution environment | execution environment as |
| > perfect forward | of the COTS device,   | cleartext during         |
| > secrecy.        | those keys are        | cryptographic            |
|                   | implemented using a   | operations.              |
|                   | unique key per        |                          |
|                   | transaction key       | Where this occurs, it is |
|                   | management method.    | important that the       |
|                   |                       | increased risk of        |
|                   | ***Note:** This       | exposure of these keys   |
|                   | requirement applies   | is mitigated by ensuring |
|                   | if the keys are ever  | that the keys are unique |
|                   | exposed in cleartext, | per transaction and      |
|                   | regardless of the     | implement perfect        |
|                   | operations or         | forward secrecy.         |
|                   | functions being       |                          |
|                   | performed at that     | There should not be      |
|                   | time.*                | sufficient information   |
|                   |                       | left within the MPoC SDK |
|                   |                       | or COTS platform to      |
|                   |                       | decrypt the account data |
|                   |                       | after it is encrypted or |
|                   |                       | to reconstruct the keys  |
|                   |                       | used to encrypt the      |
|                   |                       | data.                    |
+-------------------+-----------------------+--------------------------+
| > **1D-1.6** The  | **1D-1.6.a** The      | The process used to      |
| > disclosure of a | tester must confirm   | generate and distribute  |
| > secret or       | through examination   | account data encryption  |
| > private key     | that the process used | keys is not permitted to |
| > used for        | for generation of     | expose or increase the   |
| > account data    | account data          | chance of compromise for |
| > encryption must | encryption keys is    | any prior or future      |
| > not leak any    | secure, and that the  | keys. For example, any   |
| > sensitive       | disclosure of a key   | derivation process needs |
| > information of  | used for account data | to be one way.           |
| > the key values  | encryption does not   |                          |
| > for past or     | leak any information  | Use of DUKPT key         |
| > future keys.    | of past or future     | management may be        |
|                   | keys.                 | sufficient to meet this  |
|                   |                       | requirement, depending   |
|                   |                       | upon the implementation. |
+-------------------+-----------------------+--------------------------+
| > **1D-1.7** The  | **1D-1.7.a** The      | Customer receipts may be |
| > MPoC SDK must   | tester must confirm   | necessary for customer   |
| > truncate or     | through examination   | validation of the        |
| > mask the PAN,   | and observation that  | transaction and as part  |
| > using methods   | the PAN is            | of a formal payment      |
| > compliant to    | appropriately         | challenge process. When  |
| > relevant PCI    | truncated or masked   | such data is sent from   |
| > DSS FAQs, when  | when output or        | the back-end environment |
| > outputting or   | displayed (e.g., by   | for display or printing  |
| > displaying PAN  | using the COTS device | in the merchant          |
| > data that is    | screen or printing a  | environment, any PAN     |
| > not encrypted.  | receipt) according to | data on the receipt is   |
|                   | the relevant PCI DSS  | required to be truncated |
|                   | FAQs.                 | to ensure that it cannot |
|                   |                       | be uniquely correlated   |
|                   |                       | with the customer and    |
|                   |                       | that full details are    |
|                   |                       | not available to the     |
|                   |                       | merchant.                |
|                   |                       |                          |
|                   |                       | Functions to display     |
|                   |                       | cardholder data, either  |
|                   |                       | during or post           |
|                   |                       | transaction processing,  |
|                   |                       | could be used to         |
|                   |                       | facilitate the           |
|                   |                       | disclosure and           |
|                   |                       | compromise of this data. |
|                   |                       | The MPoC SDK can display |
|                   |                       | PAN data that is         |
|                   |                       | truncated or masked as   |
|                   |                       | per relevant PCI DSS     |
|                   |                       | FAQs. The intent of      |
|                   |                       | truncation is to remove  |
|                   |                       | a segment of PAN data    |
|                   |                       | permanently, so that     |
|                   |                       | only a portion of the    |
|                   |                       | PAN is available on the  |
|                   |                       | COTS device.             |
+-------------------+-----------------------+--------------------------+
|                   | **1D-1.7.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | the MPoC Software     |                          |
|                   | does not provide      |                          |
|                   | functions to display  |                          |
|                   | cleartext cardholder  |                          |
|                   | data that is not      |                          |
|                   | truncated or masked.  |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-1.8** The  | **1D-1.8.a** The      | The transaction process  |
| > MPoC SDK must   | tester must confirm   | needs to be protected    |
| > be able to      | through examination   | against manipulation or  |
| > detect and      | and observation that  | subversion. Attempts to  |
| > respond to      | the following events  | modify or overlay the    |
| > events that may | trigger a response    | cardholder prompts       |
| > impact the      | that maintains the    | (e.g., instructions to   |
| > security of the | security of the card  | the cardholder) or other |
| > card data entry | data entry process:   | UI features that are     |
| > process.        |                       | important for the        |
|                   | -   Another           | security of the solution |
|                   |     application       | are required to be       |
|                   |     overlays the MPoC | prevented.               |
|                   |     SDK.              |                          |
|                   |                       | Pausing the application  |
|                   | -   The MPoC SDK      | usually means that the   |
|                   |     pauses or stops   | application remains      |
|                   |     executing.        | partially visible while  |
|                   |                       | the user interacts with  |
|                   | -   The MPoC SDK      | a different dialog or    |
|                   |     loses its         | screen (e.g., in         |
|                   |     foreground focus. | multi-screen mode).      |
|                   |                       |                          |
|                   |                       | When the user switches   |
|                   |                       | to a different           |
|                   |                       | application, the         |
|                   |                       | application is           |
|                   |                       | considered "stopped"     |
|                   |                       | until either the user    |
|                   |                       | switches back or the     |
|                   |                       | system destroys the      |
|                   |                       | instance of the          |
|                   |                       | application.             |
|                   |                       |                          |
|                   |                       | Although account data    |
|                   |                       | entered through external |
|                   |                       | devices like a PCI PTS   |
|                   |                       | SCRP is encrypted prior  |
|                   |                       | to transmission outside  |
|                   |                       | of that device, designs  |
|                   |                       | need to consider the     |
|                   |                       | security implications of |
|                   |                       | pausing or changing      |
|                   |                       | application focus. For   |
|                   |                       | example, interception or |
|                   |                       | interruption of the      |
|                   |                       | communications path      |
|                   |                       | between the MPoC         |
|                   |                       | Software and a PCI PTS   |
|                   |                       | SCRP should not allow    |
|                   |                       | for compromise of any    |
|                   |                       | account data or access   |
|                   |                       | to sensitive functions   |
|                   |                       | within the external card |
|                   |                       | acceptance device.       |
|                   |                       |                          |
|                   |                       | The security of the      |
|                   |                       | other applications on    |
|                   |                       | the COTS device is not   |
|                   |                       | known and therefore it   |
|                   |                       | needs to be assumed that |
|                   |                       | the COTS environment may |
|                   |                       | be hostile.              |
|                   |                       |                          |
|                   |                       | In the context of this   |
|                   |                       | requirement, a           |
|                   |                       | "response" is            |
|                   |                       | implemented based on the |
|                   |                       | attestation policy of    |
|                   |                       | the MPoC Solution.       |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-1.9** The  | **1D-1.9.a** The      | Account data is          |
| > MPoC SDK must   | tester must confirm   | permitted to be stored   |
| > not store       | through examination   | on the COTS device only  |
| > account data    | and observation that  | for the purposes of      |
| > for any         | account data is not   | offline payments. This   |
| > purposes other  | stored on persistent  | includes storage where   |
| > than offline    | storage, except for   | the account data may be  |
| > payment         | the purposes of       | protected through means  |
| > processing.     | offline payment       | such as encryption or    |
|                   | processing.           | storage in               |
|                   |                       | tamper-resistant         |
|                   |                       | processing elements.     |
|                   |                       |                          |
|                   |                       | For the purposes of this |
|                   |                       | requirement, "storage"   |
|                   |                       | refers to any            |
|                   |                       | non-volatile or          |
|                   |                       | long-term memory, such   |
|                   |                       | as Flash or RAM discs.   |
|                   |                       | Temporary storage of     |
|                   |                       | data within the memory   |
|                   |                       | of the COTS devices is   |
|                   |                       | permitted; however, any  |
|                   |                       | such storage needs to be |
|                   |                       | cleared securely as soon |
|                   |                       | as possible---no later   |
|                   |                       | than when the            |
|                   |                       | transaction has been     |
|                   |                       | sent for processing.     |
|                   |                       |                          |
|                   |                       | Support for offline      |
|                   |                       | processing and           |
|                   |                       | associated data storage  |
|                   |                       | is not mandatory and may |
|                   |                       | be conditional or        |
|                   |                       | disabled as required.    |
+-------------------+-----------------------+--------------------------+

### 1D-2 Use of PCI PTS POI-approved Devices

> If an external card reader is used to accept chip-based transactions,
> or any type of contact-chip based transactions are to be accepted, the
> card reader used must be validated and listed as a PCI PTS SCRP. A PCI
> PTS SCRP must be used for any MPoC Solution that accepts contact
> chip-based payment cards, as well as for any offline PIN-based
> transactions.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Secure card     |                       |                          |
| > readers         |                       |                          |
| > supported by    |                       |                          |
| > the solution    |                       |                          |
| > provide         |                       |                          |
| > sufficient      |                       |                          |
| > protection to   |                       |                          |
| > account data.   |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-2.1**      | **1D-2.1.a** For each | Any PCI PTS devices used |
| > Information     | of the PCI PTS        | with the MPoC SDK need   |
| > must exist that | devices used in the   | to have been assessed    |
| > details the     | solution, the tester  | for the specific use     |
| > secure card     | must confirm through  | implemented in the MPoC  |
| > readers used by | examination that the  | SDK. Use of              |
| > the solution.   | following information | functionality that has   |
|                   | is provided at a      | not been assessed        |
|                   | minimum:              | presents a security risk |
|                   |                       | to the MPoC SDK.         |
|                   | -   Hardware,         |                          |
|                   |     firmware, and     | The documentation        |
|                   |     listing details   | provided by the MPoC     |
|                   |     for each PCI PTS  | Software vendor needs to |
|                   |     device used.      | contain all the          |
|                   |                       | necessary information to |
|                   | -   Supported         | integrate the PCI PTS    |
|                   |     functionality of  | SCRP securely into an    |
|                   |     each secure card  | MPoC Solution.           |
|                   |     reader.           |                          |
|                   |                       |                          |
|                   | -   All guidance      |                          |
|                   |     required for the  |                          |
|                   |     correct and       |                          |
|                   |     approved          |                          |
|                   |     operation of the  |                          |
|                   |     used secure card  |                          |
|                   |     reader.           |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-2.2** Any  | **1D-2.2.a** The      | SCRP is a PCI PTS        |
| > chip accepting  | tester must document  | approval class that      |
| > devices must be | all chip accepting    | supports software-based  |
| > approved to the | devices that can be   | PIN entry for chip       |
| > PCI PTS POI     | used with the MPoC    | transactions on a COTS   |
| > requirements as | SDK, including the    | device according to      |
| > a PCI PTS SCRP. | PCI PTS listing       | these requirements. The  |
|                   | number and confirm    | use of PCI PTS SCRP      |
|                   | that each is approved | devices not evaluated    |
|                   | under the PCI PTS     | and listed by PCI may    |
|                   | SCRP approval class.  | introduce security       |
|                   |                       | vulnerabilities in the   |
|                   |                       | MPoC Solution.           |
+-------------------+-----------------------+--------------------------+
| > **1D-2.3** The  | **1D-2.3.a** The      | The A&M needs to ensure  |
| > PCI PTS POI     | tester must confirm   | that all aspects of the  |
| > devices must be | through examination   | MPoC SDK are operating   |
| > attested as     | and observation of    | as expected and are not  |
| > part of the     | the A&M that:         | in a state that          |
| > MPoC SDK        |                       | indicates or could       |
| > attestation     | -   Any PCI PTS       | facilitate compromise.   |
| > system.         |     devices used are  | This includes validating |
|                   |     uniquely          | the state and security   |
|                   |     identified and    | posture of any attached  |
|                   |     validated.        | card-reading devices.    |
|                   |                       |                          |
|                   | -   The firmware      | This validation included |
|                   |     version is        | confirmation of the      |
|                   |     verified by the   | firmware version(s) of   |
|                   |     A&M.              | the attached devices, as |
|                   |                       | well as hardware         |
|                   | -   The state of the  | versions, and confirming |
|                   |     PCI PTS device is | that these are up to     |
|                   |     verified by the   | date with any relevant   |
|                   |     A&M.              | security patches --      |
|                   |                       | e.g., they are installed |
|                   | -   PCI PTS devices   | with the latest versions |
|                   |     have the most     | as shown on the PCI      |
|                   |     recent firmware   | listing website.         |
|                   |     installed, as     |                          |
|                   |     listed on the PCI |                          |
|                   |     PTS listing for   |                          |
|                   |     that device.      |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-2.4**      | **1D-2.4.a** The      | PCI PTS SCRP devices     |
| > Enablement      | tester must confirm   | require a cryptographic  |
| > tokens are      | through examination   | token to be provided by  |
| > required for    | and observation that  | the back-end system --   |
| > continued       | the back-end          | without such a token     |
| > operation of    | attestation and       | provided before a        |
| > the PCI PTS     | monitoring (A&M)      | predefined time limit,   |
| > SCRP and are    | component of the MPoC | the PCI PTS SCRP will    |
| > provided to PCI | Software provides     | cease to permit the      |
| > PTS SCRPs only  | enablement tokens to  | acceptance of payment    |
| > after           | the PCI PTS SCRP only | cards.                   |
| > successful      | after the PCI PTS     |                          |
| > attestation.    | SCRP has been         | These tokens help to     |
|                   | validated             | mitigate the risk of a   |
|                   | successfully through  | local compromise on a    |
|                   | an attestation        | COTS payment system, by  |
|                   | process.              | providing a "cut-off"    |
|                   |                       | for payment acceptance   |
|                   |                       | using the PCI PTS SCRP   |
|                   |                       | if a valid token is not  |
|                   |                       | provided.                |
+-------------------+-----------------------+--------------------------+
|                   | **1D-2.4.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | a PCI PTS SCRP ceases |                          |
|                   | the acceptance of     |                          |
|                   | account data if an    |                          |
|                   | updated enablement    |                          |
|                   | token is not received |                          |
|                   | prior to the expiry   |                          |
|                   | of the previous       |                          |
|                   | token. The maximum    |                          |
|                   | period during which a |                          |
|                   | PCI PTS SCRP may      |                          |
|                   | continue to accept    |                          |
|                   | account data without  |                          |
|                   | an updated enablement |                          |
|                   | token must not exceed |                          |
|                   | 24 hours.             |                          |
+-------------------+-----------------------+--------------------------+

### 1D-3 Magnetic Stripe Data

> Magnetic stripe data may be read only through external devices listed
> as meeting the PCI PTS SCRP requirements or as a Non-PTS approved MSR
> validated to the requirements of Appendix E.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Data from       |                       |                          |
| > magnetic stripe |                       |                          |
| > cards is        |                       |                          |
| > secured through |                       |                          |
| > approved        |                       |                          |
| > readers.        |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-3.1**      | **1D-3.1.a** For each | > Any MSR devices used   |
| > Documentation   | of the devices used   | > with the MPoC SDK need |
| > must exist that | to accept magnetic    | > to have been assessed  |
| > details the     | stripe transactions   | > for the specific use   |
| > MSRs used by    | in the solution, the  | > implemented in the     |
| > the solution.   | tester must confirm   | > MPoC SDK. Use of       |
|                   | through examination   | > functionality that has |
|                   | that details about    | > not been assessed      |
|                   | the following are     | > presents a security    |
|                   | provided at a         | > risk to the MPoC SDK.  |
|                   | minimum:              | >                        |
|                   |                       | > The documentation      |
|                   | -   The hardware,     | > provided by the MPoC   |
|                   |     firmware, and     | > Software needs to      |
|                   |     validation        | > contain all the        |
|                   |     details for each  | > necessary information  |
|                   |     MSR used.         | > to integrate any       |
|                   |                       | > devices accepting      |
|                   | -   The supported     | > magnetic stripe-based  |
|                   |     functionality of  | > transactions securely  |
|                   |     each MSR.         | > into an MPoC Solution. |
|                   |                       | > This may include the   |
|                   | -   All guidance      | > use of PCI PTS SCRP    |
|                   |     required for the  | > devices as well as     |
|                   |     correct and       | > non-PTS approved MSR   |
|                   |     approved          | > devices.               |
|                   |     operation of the  | >                        |
|                   |     used MSRs.        | > Validation details may |
|                   |                       | > include reference to   |
|                   |                       | > listing on a PCI       |
|                   |                       | > validation list or     |
|                   |                       | > assessment through the |
|                   |                       | > MSR Appendix.          |
+-------------------+-----------------------+--------------------------+
| > **1D-3.2**      | **1D-3.2.a** When     | > An MPoC SDK may accept |
| > Magnetic stripe | magnetic stripe       | > magnetic stripe-based  |
| > cards are       | transactions are      | > transactions using     |
| > accepted only   | supported, the tester | > either a PCI PTS SCRP  |
| > through readers | must confirm through  | > that integrates an     |
| > listed as PCI   | examination and       | > MSR, or a dedicated    |
| > PTS devices     | observation that only | > Non-PTS approved MSR   |
| > (Approval Class | approved PCI PTS SCRP | > device.                |
| > SCRP) or as     | or non-PTS approved   |                          |
| > Non-PTS         | MSR readers are able  |                          |
| > Approved MSR.   | to be used to accept  |                          |
|                   | magnetic stripe       |                          |
|                   | transactions that are |                          |
|                   | processed online.     |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1D-3.2.b** The      |                          |
|                   | tester must document  |                          |
|                   | the validation and    |                          |
|                   | listing for any MSR   |                          |
|                   | Reader devices used   |                          |
|                   | with the MPoC SDK.    |                          |
|                   | Requirements for      |                          |
|                   | non-PTS approved MSR  |                          |
|                   | devices are provided  |                          |
|                   | in *[Appendix         |                          |
|                   | E                     |                          |
|                   | :](#appendix-e-msr-se |                          |
|                   | curity-requirements)* |                          |
|                   | [*MSR Security        |                          |
|                   | Requirements          |                          |
|                   | *.](#appendix-e-msr-s |                          |
|                   | ecurity-requirements) |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-3.3** The  | **1D-3.3.a** The      | The attestation and      |
| > MSR devices     | tester must confirm   | monitoring (A&M) needs   |
| > must be         | through examination   | to ensure that all       |
| > attested as     | that:                 | aspects of the MPoC SDK  |
| > part of the     |                       | are operating as         |
| > MPoC SDK        | -   Any MSR device(s) | expected and are not in  |
| > attestation     |     used are uniquely | a state that indicates   |
| > system.         |     identified and    | or could facilitate      |
|                   |     validated by the  | compromise. This         |
|                   |     attestation and   | includes validating the  |
|                   |     monitoring (A&M). | state and security       |
|                   |                       | posture of any attached  |
|                   | -   The firmware      | card-reading devices.    |
|                   |     version of any    |                          |
|                   |     MSR device(s) is  | Firmware in the context  |
|                   |     verified by the   | of this requirement may  |
|                   |     attestation and   | include operational code |
|                   |     monitoring (A&M). | that is executed by an   |
|                   |                       | underlying processor, or |
|                   | -   The state of the  | the version of a         |
|                   |     MSR device is     | dedicated ASIC used in   |
|                   |     verified by the   | place of a               |
|                   |     attestation and   | general-purpose          |
|                   |     monitoring (A&M). | processor.               |
|                   |                       |                          |
|                   | -   The MSR           |                          |
|                   |     devices(s) are    |                          |
|                   |     confirmed by the  |                          |
|                   |     attestation and   |                          |
|                   |     monitoring (A&M)  |                          |
|                   |     to have no known  |                          |
|                   |     or exploitable    |                          |
|                   |     vulnerabilities.  |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-3.4** MSR  | **1D-3.4.a** The      | Data from a magnetic     |
| > data captured   | tester must confirm   | stripe card can be       |
| > in an MPoC      | through observation   | easily copied and        |
| > Solution must   | and examination that  | replicated onto a        |
| > not be made     | any MSR data captured | "cloned" card for use in |
| > available in    | is never exposed in   | fraudulent transactions. |
| > cleartext on    | cleartext within the  | To help mitigate against |
| > the COTS        | COTS device. This     | this risk, the data from |
| > device.         | includes validating   | the magnetic stripe is   |
|                   | that no optional      | encrypted within the PCI |
|                   | configuration         | PTS SCRP or non-PTS      |
|                   | settings or functions | approved MSR device used |
|                   | exist that may        | and is not exposed in    |
|                   | disable or prevent    | the COTS device.         |
|                   | encryption from the   |                          |
|                   | MSR itself.           |                          |
+-------------------+-----------------------+--------------------------+

### 1D-4 COTS-Native NFC Interface

> Contactless payment instruments may be accepted through the
> COTS-native NFC interface of the COTS device. This interface may be
> open to all applications on the COTS device. Protections must be
> implemented to secure the account data as it is entered and to ensure
> that the data is encrypted as soon as possible after processing within
> any payment kernel.
>
> The contactless kernel has direct access to assets. Therefore, the
> processing, memory, and storage used by this kernel must be protected
> to prevent the assets from being compromised when handled by the
> payment kernel.
>
> The requirements in this Section apply to the COTS-native NFC
> interface only.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Account data is |                       |                          |
| > protected and   |                       |                          |
| > securely        |                       |                          |
| > processed when  |                       |                          |
| > it is read by   |                       |                          |
| > the COTS-native |                       |                          |
| > NFC interface.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-4.1**      | **1D-4.1.a** The      | Contactless kernels used |
| > Information     | tester must confirm   | by the MPoC SDK provide  |
| > that details    | the following through | for processing of        |
| > the             | examination:          | account data. Therefore, |
| > implementation  |                       | the exact implementation |
| > of the          | -   That all          | and integration are      |
| > COTS-native NFC |     COTS-native NFC   | important to the overall |
| > acceptance      |     acceptance        | security of the MPoC     |
| > method,         |     methods are       | Solution.                |
| > including the   |     detailed.         |                          |
| > implementation  |                       | Contactless kernels need |
| > for any         | -   If part of the    | to be integrated in a    |
| > contactless     |     kernel is         | way that ensures they    |
| > kernels, must   |     executed remotely | are protected against    |
| > exist.          |     (e.g., a          | tampering (e.g., by      |
|                   |     cloud-based       | being integrated as part |
|                   |     kernel), where    | of the overall tamper    |
|                   |     and what parts of | protection and response  |
|                   |     the kernel are    | of the MPoC SDK).        |
|                   |     included in this  |                          |
|                   |     remote execution. |                          |
|                   |                       |                          |
|                   | -   How the kernel is |                          |
|                   |     configured and    |                          |
|                   |     how the           |                          |
|                   |     configuration is  |                          |
|                   |     protected.        |                          |
|                   |                       |                          |
|                   | -   How the kernel is |                          |
|                   |     secured against   |                          |
|                   |     tampering.        |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-4.2** The  | **1D-4.2.a** The      | To prevent interference  |
| > MPoC SDK must   | tester must confirm   | or interception of the   |
| > ensure that the | through examination   | COTS- native NFC         |
| > COTS-native NFC | and observation that  | communication, the MPoC  |
| > interface is    | the MPoC SDK          | SDK needs to attempt to  |
| > not accessed by | implements mechanisms | implement methods to     |
| > other           | to prevent, monitor,  | prevent or detect access |
| > applications    | or otherwise inhibit  | to this interface by     |
| > during a        | access to the         | other applications       |
| > payment         | COTS-native NFC       | during the payment       |
| > transaction.    | interface by other    | transaction process.     |
|                   | applications during a |                          |
|                   | payment transaction.  | This may involve         |
|                   |                       | attempting to assert     |
|                   |                       | exclusive control to the |
|                   |                       | COTS-native NFC          |
|                   |                       | interface before         |
|                   |                       | initiating the           |
|                   |                       | transaction, or          |
|                   |                       | monitoring if another    |
|                   |                       | application accesses the |
|                   |                       | interface.               |
|                   |                       |                          |
|                   |                       | The MPoC SDK needs to    |
|                   |                       | prevent transaction      |
|                   |                       | processing if it cannot  |
|                   |                       | provide a sufficient     |
|                   |                       | level of security to the |
|                   |                       | COTS-native NFC          |
|                   |                       | interface.               |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1D-4.3** The  | **1D-4.3.a** The      | The camera can be used   |
| > MPoC SDK must   | tester must confirm   | as a side-channel source |
| > ensure that the | through examination   | to gain access to assets |
| > COTS device     | and observation that  | such as CVC/CVV.         |
| > camera(s) are   | the MPoC SDK          |                          |
| > not accessed by | implements mechanisms | To prevent unauthorized  |
| > other           | to prevent, monitor,  | visual capturing of      |
| > applications    | or otherwise inhibit  | account data from a      |
| > during a        | access to the COTS    | payment instrument, such |
| > payment         | device camera(s) by   | as a payment card, when  |
| > transaction.    | other applications,   | it is in proximity to    |
|                   | during a payment      | the COTS device, the     |
|                   | transaction.          | MPoC Application should  |
|                   |                       | attempt to prevent other |
|                   |                       | applications and         |
|                   |                       | processes running on the |
|                   |                       | COTS device from using   |
|                   |                       | the camera.              |
|                   |                       |                          |
|                   |                       | The expectation is that  |
|                   |                       | other applications on    |
|                   |                       | the COTS device are not  |
|                   |                       | able to use the camera   |
|                   |                       | when the MPoC            |
|                   |                       | application prompts the  |
|                   |                       | cardholder to initiate a |
|                   |                       | contactless payment, or  |
|                   |                       | that access by another   |
|                   |                       | application during this  |
|                   |                       | time is detected and the |
|                   |                       | payment transaction      |
|                   |                       | halted.                  |
+-------------------+-----------------------+--------------------------+
| > **1D-4.4**      | **1D-4.4.a** The      | The requirements in this |
| > Contactless     | tester must confirm   | standard cover the       |
| > kernels used in | through examination   | security of a COTS-based |
| > the MPoC SDK    | that any kernel       | acceptance solution.     |
| > must be         | integrated into, or   | Validation that the      |
| > approved for    | used by, the MPoC SDK | payment process can be   |
| > use, as         | has been approved by  | performed in a           |
| > required by the | the supported payment | functionally correct and |
| > relevant        | methods.              | successful way is        |
| > payment brands. |                       | covered under the        |
|                   |                       | approval of the payment  |
|                   |                       | kernel.                  |
|                   |                       |                          |
|                   |                       | An MPoC SDK may          |
|                   |                       | implement more than one  |
|                   |                       | payment kernel, and may  |
|                   |                       | use kernels developed    |
|                   |                       | for the solution, 3rd    |
|                   |                       | party kernels, and/or    |
|                   |                       | utilize remote kernel    |
|                   |                       | functionality.           |
|                   |                       |                          |
|                   |                       | Payment kernels for      |
|                   |                       | non-PCI payment brands   |
|                   |                       | are not in scope of this |
|                   |                       | requirement.             |
|                   |                       |                          |
|                   |                       | Some payment kernel      |
|                   |                       | functional evaluations   |
|                   |                       | may require the          |
|                   |                       | assessment of a complete |
|                   |                       | transaction, e.g.,       |
|                   |                       | "level 3" testing. An    |
|                   |                       | MPoC Solution may not    |
|                   |                       | have been processed      |
|                   |                       | through such functional  |
|                   |                       | testing prior to testing |
|                   |                       | to this standard, and    |
|                   |                       | therefore this type of   |
|                   |                       | functional testing is    |
|                   |                       | not considered in scope  |
|                   |                       | of this requirement.     |
+-------------------+-----------------------+--------------------------+
|                   | **1D-4.4.b** The      |                          |
|                   | tester must document  |                          |
|                   | the EMV/brand         |                          |
|                   | approval version and  |                          |
|                   | number for the        |                          |
|                   | contactless kernel    |                          |
|                   | and confirm through   |                          |
|                   | examination that the  |                          |
|                   | scope of the approval |                          |
|                   | appears valid, given  |                          |
|                   | the tester's          |                          |
|                   | understanding of the  |                          |
|                   | solution under        |                          |
|                   | evaluation.           |                          |
+-------------------+-----------------------+--------------------------+
| > **1D-4.5** When | **1D-4.5.a** The      | For account data,        |
| > part of the     | tester must confirm   | protection using a       |
| > kernel          | through examination   | secure channel is not    |
| > functionality   | that the              | considered sufficient,   |
| > is implemented  | communication with    | application-level        |
| > remotely, the   | remote components of  | encryption is required.  |
| > connection      | the kernel is done    |                          |
| > between the     | through secure        |                          |
| > MPoC SDK and    | channels.             |                          |
| > the remote      |                       |                          |
| > component must  |                       |                          |
| > be protected    |                       |                          |
| > using a secure  |                       |                          |
| > channel.        |                       |                          |
+-------------------+-----------------------+--------------------------+

### 1D-5 Manual Entry

> Transactions using account data obtained from a manual entry process
> may be processed by an MPoC Solution only when no PIN entry is
> performed, and when the manual data entry process is protected. Entry
> of truncated PAN data, or data into software not executed on the COTS
> device, is not included in scope of these requirements.

+-----------------+--------------------------+-------------------------+
| > **Security    | > **Test Requirements**  | > **Guidance**          |
| >               |                          |                         |
|  Requirements** |                          |                         |
+=================+==========================+=========================+
| >               |                          |                         |
|  **Objective:** |                          |                         |
| > Account data  |                          |                         |
| > entered into  |                          |                         |
| > the COTS      |                          |                         |
| > device        |                          |                         |
| > through       |                          |                         |
| > manual entry  |                          |                         |
| > methods is    |                          |                         |
| > secured.      |                          |                         |
+-----------------+--------------------------+-------------------------+
| > **1D-5.1**    | **1D-5.1.a** For each of | An MPoC SDK may support |
| > Documentation | the manual account data  | manual entry of the     |
| > must exist    | entry methods used in    | PAN, e.g., to enable    |
| > that details  | the solution, the tester | payment processing if   |
| > the manual    | must confirm through     | other card presentment  |
| > entry process | examination that details | modes fail (due to a    |
| > and           | about the following are  | damaged chip or         |
| > protection    | provided at a minimum:   | magnetic stripe).       |
| > methods.      |                          | Additional account      |
|                 | -   The ways in which    | data, such as the       |
|                 |     the manual entry     | security code for the   |
|                 |     method can be        | card, may be            |
|                 |     invoked.             | additionally required   |
|                 |                          | during such payment     |
|                 | -   The protections      | processing.             |
|                 |     applied to the       |                         |
|                 |     manual entry method. | It is important that    |
|                 |                          | any such methods of     |
|                 | -   The types of account | manual entry are        |
|                 |     data that may be     | detailed to allow for a |
|                 |     manually entered.    | complete understanding  |
|                 |                          | and security assessment |
|                 |                          | of these modes of data  |
|                 |                          | presentment.            |
+-----------------+--------------------------+-------------------------+
| > **1D-5.2**    | **1D-5.2.a** The tester  | An MPoC SDK is          |
| > Manually      | must confirm through     | permitted to provide    |
| > entered       | examination and          | manual entry for        |
| > account data  | observation that         | account data only for   |
| > must be used  | manually entered account | the purposes of         |
| > only for the  | data is used only for    | transaction processing. |
| > purposes of   | the purposes of          | For example, manual     |
| > transaction   | transaction processing.  | entry of PAN data as a  |
| > processing.   |                          | data element in a       |
|                 |                          | search of prior         |
|                 |                          | transactions is not     |
|                 |                          | permitted.              |
+-----------------+--------------------------+-------------------------+

+-----------------+--------------------------+-------------------------+
| > **Security    | > **Test Requirements**  | > **Guidance**          |
| >               |                          |                         |
|  Requirements** |                          |                         |
+=================+==========================+=========================+
| > **1D-5.3**    | **1D-5.3.a** The tester  | It is common in many    |
| > Manually      | must confirm through     | COTS OS for the         |
| > entered       | examination and          | OS-provided data entry  |
| > account data  | observation the          | functions to store data |
| > must be       | following for each of    | entered so that it can  |
| > protected     | the manual account data  | build a dictionary of   |
| > during entry. | entry methods            | commonly used terms,    |
|                 | implemented:             | for the purposes of     |
|                 |                          | enhancing spell-check   |
|                 | -   The entry methods do | functions. In addition, |
|                 |     not allow the        | some OSs allow for the  |
|                 |     storage of the       | replacement of the OS   |
|                 |     account data. This   | provided data entry     |
|                 |     includes by the OS   | functions with third    |
|                 |     for purposes such as | party applications that |
|                 |     spell-checking       | may provide similar     |
|                 |     dictionary creation. | functions or perform    |
|                 |                          | other operations with   |
|                 | -   The account data is  | data that is entered.   |
|                 |     entered directly     |                         |
|                 |     into the MPoC SDK.   | It is important that    |
|                 |     Third party keyboard | account data entry      |
|                 |     or data entry        | functions secure        |
|                 |     applications are not | against the exposure of |
|                 |     used for account     | the sensitive assets    |
|                 |     data entry.          | entered through these   |
|                 |                          | types of systems.       |
|                 | -   Entry modes do not   |                         |
|                 |     use non-manual entry | To prevent oversight of |
|                 |     modes such as        | the account data during |
|                 |     optical capture,     | entry, no more than one |
|                 |     through the COTS     | digit may be displayed  |
|                 |     camera.              | at any time. Common     |
|                 |                          | implementations may     |
|                 | -   It is not possible   | display the more        |
|                 |     to take screenshots  | recently entered digit, |
|                 |     or recordings of the | with all other digits   |
|                 |     MPoC SDK during PAN  | obfuscated using a      |
|                 |     entry on the COTS    | generic symbol such as  |
|                 |     device into which    | an asterisk.            |
|                 |     the PAN is entered.  |                         |
|                 |                          | Capture of the account  |
|                 |                          | data through optical    |
|                 |                          | means, such as by       |
|                 |                          | taking a photograph of  |
|                 |                          | the payment card, can   |
|                 |                          | expose additional data  |
|                 |                          | not used during the     |
|                 |                          | transaction.            |
+-----------------+--------------------------+-------------------------+
| > **1D-5.4**    | **1D-5.4.a** The tester  | Common malware attacks  |
| > The manual    | must confirm through     | are known to overlay    |
| > PAN entry     | examination and          | information on top of   |
| > currently in  | observation that         | legitimate applications |
| > progress must | mechanisms to detect     | to obtain input data    |
| > be cancelled  | application overlays     | from the user. The MPoC |
| > when MPoC SDK | exist, and that it       | SDK needs to be able to |
| > detects       | triggers the             | detect whether another  |
| > another       | cancellation of any      | application is          |
| > application   | manual PAN entry         | overlaying the MPoC SDK |
| > overlays.     | currently in progress.   | and stop any            |
|                 |                          | transaction in          |
|                 |                          | progress.               |
+-----------------+--------------------------+-------------------------+

## Module 1E: PIN Entry on COTS Device

> This Module covers COTS-native PIN entry, even if the capability can
> be disabled at run-time with configuration options. If the MPoC SDK
> does not support PIN entry (or any other situation where the PIN may
> be exposed) on the COTS devices, this Module is not in scope. It is
> possible that the numeric value of the PIN is not captured by the MPoC
> SDK directly; instead, some interim value may be collected, such as
> touch locations or different numeric values, which must be
> reconstructed into the PIN at a later time by the MPoC SDK. These
> interim values must also meet all requirements of this Section in
> respect to protections prior to the construction of the encrypted PIN
> block. In all cases, values related to the customer PIN, including
> individual digits, touch locations, or numeric values that can be
> mapped back to PIN values, must never leave the MPoC SDK until formed
> into a fully encrypted ISO format 4 PIN block.

### 1E-1 COTS-native PIN Entry

> This Section covers the entry of cardholder PINs on the COTS device.
> When the PIN is entered on the COTS device, regardless of whether the
> PIN entry mechanisms are backed by hardware (e.g., TEE), the MPoC SDK
> is required to comply with this Section.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Cardholder PINs |                       |                          |
| > are protected   |                       |                          |
| > as they are     |                       |                          |
| > entered and     |                       |                          |
| > processed on    |                       |                          |
| > the COTS        |                       |                          |
| > device.         |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1E-1.1**      | **1E-1.1.a** The      | An MPoC SDK that accepts |
| > Documentation   | tester must confirm   | account data entry,      |
| > must exist that | through examination   | including PINs, on COTS  |
| > describes the   | that the information  | devices has to provide a |
| > secure capture  | provided contains,    | path for these sensitive |
| > and processing  | but is not limited    | assets from the hardware |
| > of the          | to:                   | of the COTS device,      |
| > cardholder PIN. |                       | through the OS and       |
|                   | -   How the PIN is    | drivers, to the MPoC SDK |
|                   |     protected during  | itself.                  |
|                   |     entry and prior   |                          |
|                   |     to encryption.    | Documentation is         |
|                   |                       | required to demonstrate  |
|                   | -   How the PIN is    | an understanding and     |
|                   |     encrypted.        | consideration for the    |
|                   |                       | entire path taken by     |
|                   | -   The security      | this data, not just how  |
|                   |     mechanisms        | the data is received and |
|                   |     implemented to    | processed within the     |
|                   |     prevent the       | MPoC SDK. For example,   |
|                   |     extraction of the | protections need to      |
|                   |     PIN at run-time.  | consider how to prevent  |
|                   |                       | determination of PINs    |
|                   | -   Side-channel      | through OS-level         |
|                   |     prevention        | features such as screen  |
|                   |     mechanisms.       | recording or logging of  |
|                   |                       | touch inputs.            |
|                   | -   The types of      |                          |
|                   |     PIN-verification  | The PIN needs to be      |
|                   |     method(s)         | protected against        |
|                   |     supported         | extraction using         |
|                   |     (offline, online, | side-channels analysis   |
|                   |     or both).         | (e.g., using the         |
|                   |                       | accelerometers and       |
|                   |                       | gyroscopes to obtain the |
|                   |                       | coordinates of user      |
|                   |                       | touch events and         |
|                   |                       | correlate such touch     |
|                   |                       | events to individual PIN |
|                   |                       | digits).                 |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1E-1.2** PIN  | **1E-1.2.a** The      | Magnetic stripe cards do |
| > entry is        | tester must confirm   | not provide the same     |
| > supported only  | through examination   | security features        |
| > for chip-based  | and observation that  | present in chip-based    |
| > transactions.   | PIN entry is          | cards and can be easily  |
|                   | supported only for    | "cloned" or copied. An   |
|                   | transactions with     | MPoC SDK that provides   |
|                   | chip-based cards.     | for the capture of both  |
|                   |                       | PIN and magnetic stripe  |
|                   |                       | track data for the same  |
|                   |                       | transaction are not      |
|                   |                       | permitted. This is true  |
|                   |                       | even if the track data   |
|                   |                       | is sent to the COTS      |
|                   |                       | device encrypted, from   |
|                   |                       | an attached SCRP or      |
|                   |                       | Non-PTS approved MSR     |
|                   |                       | because the data may be  |
|                   |                       | captured through a       |
|                   |                       | skimmer on the           |
|                   |                       | peripheral reader device |
|                   |                       | itself.                  |
+-------------------+-----------------------+--------------------------+
| > **1E-1.3** The  | **1E-1.3.a** The      | Some COTS device sensors |
| > MPoC SDK must   | tester must confirm   | can be used at the time  |
| > not leak        | through examination   | of PIN entry to extract  |
| > complete or     | that:                 | the PIN that is being    |
| > partial PIN     |                       | entered by the           |
| > digits. The     | -   The threat of     | cardholder. Furthermore, |
| > MPoC SDK must   |     extracting the    | a COTS device output     |
| > protect against |     PIN using the     | (e.g., distinctive       |
| > side channels   |     COTS device       | sounds per key or change |
| > that use        |     sensors was       | in the key digit on      |
| > sensors present |     considered.       | screen when pressed) can |
| > in the COTS     |                       | be used to extract the   |
| > device (e.g.,   | -   Each sensor has a | PIN from the COTS device |
| > accelerometers  |     rationale on why  | using screenshots or     |
| > and gyroscopes) |     they do not       | recordings.              |
| > and screen      |     present a risk    |                          |
| > capture.        |     for side channel  | Therefore, the MPoC SDK  |
|                   |     extraction of the | needs to ensure that the |
|                   |     PIN.              | implementation           |
|                   |                       | accommodates for these   |
|                   | -   Measures were     | issues and ensures that  |
|                   |     implemented to    | the method of PIN entry  |
|                   |     prevent the       | does not leak PIN digits |
|                   |     leakage of the    | through potential side   |
|                   |     PIN using the     | channels.                |
|                   |     sensors that      |                          |
|                   |     present a risk.   |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1E-1.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination,  |                          |
|                   | observation, and      |                          |
|                   | testing the correct   |                          |
|                   | implementation of the |                          |
|                   | measures that         |                          |
|                   | mitigates the         |                          |
|                   | extraction of the PIN |                          |
|                   | through side          |                          |
|                   | channels.             |                          |
+-------------------+-----------------------+--------------------------+
| > **1E-1.4** The  | **1E-1.4.a** The      | Some COTS device sensors |
| > MPoC SDK must   | tester must confirm   | can be used at the time  |
| > protect the PIN | through examination   | of PIN entry to extract  |
| > digits during   | and observation that: | the PIN that is being    |
| > entry.          |                       | entered by the           |
|                   | -   There is no       | cardholder. Furthermore, |
|                   |     feedback that     | a COTS device output     |
|                   |     could be used to  | (e.g., change in the key |
|                   |     identify the PIN  | digit on screen when     |
|                   |     digits.           | pressed) can be used to  |
|                   |                       | extract the PIN from the |
|                   | -   It is not         | COTS device using        |
|                   |     possible to take  | screenshots or           |
|                   |     screenshots or    | recordings.              |
|                   |     recordings of the |                          |
|                   |     MPoC SDK during   | Therefore, the MPoC SDK  |
|                   |     PIN entry on the  | needs to ensure that the |
|                   |     COTS device into  | implementation           |
|                   |     which the PIN is  | accommodates for these   |
|                   |     entered.          | issues and ensures that  |
|                   |                       | the method of PIN entry  |
|                   |                       | does not leak PIN digits |
|                   |                       | through potential side   |
|                   |                       | channels.                |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1E-1.5** The  | **1E-1.5.a** The      | Methods that capture and |
| > PIN must be     | tester must confirm   | encrypt the PIN in ways  |
| > encrypted into  | through examination   | not compliant to ISO9564 |
| > an ISO format   | and observation that: | can result in unforeseen |
| > 4-PIN block as  |                       | risk being introduced    |
| > soon as it is   | -   The PIN is        | into the PIN-processing  |
| > captured.       |     encrypted into an | system. ISO 9564 Format  |
|                   |     ISO format 4-PIN  | 4 uses AES and           |
|                   |     block upon entry, | encapsulates the PIN and |
|                   |     and in all cases  | PAN into the PIN block   |
|                   |     prior to          | using separate           |
|                   |     transmission      | encryption processes.    |
|                   |     outside of the    |                          |
|                   |     boundary of the   | This separation of the   |
|                   |     MPoC SDK.         | encryption processes     |
|                   |                       | within an ISO format     |
|                   | -   If the            | 4-PIN block allows for   |
|                   |     cryptographic     | the PIN and PAN to be    |
|                   |     keys used to      | managed as separate      |
|                   |     encrypt the PIN   | items during the         |
|                   |     block are exposed | formatting of the PIN    |
|                   |     in the rich       | block (on the COTS       |
|                   |     execution         | device). Maintaining     |
|                   |     environment of    | separation between the   |
|                   |     the COTS device,  | PIN and PAN can help     |
|                   |     the PIN block is  | increase the overall     |
|                   |     encrypted using   | security of the MPoC     |
|                   |     unique keys per   | Solution. However,       |
|                   |     transaction.      | separation of the PIN    |
|                   |                       | and PAN is not a         |
|                   |                       | requirement.             |
|                   |                       |                          |
|                   |                       | Only complete and        |
|                   |                       | encrypted ISO format 4   |
|                   |                       | PIN blocks may be        |
|                   |                       | transmitted from the     |
|                   |                       | COTS device.             |
|                   |                       |                          |
|                   |                       | A tokenized PAN,         |
|                   |                       | cryptographically bound  |
|                   |                       | to the actual funding    |
|                   |                       | PAN, may be used with    |
|                   |                       | these formats to allow   |
|                   |                       | for more complete        |
|                   |                       | dislocation of the PIN   |
|                   |                       | and PAN within the COTS  |
|                   |                       | device. Use of a PAN     |
|                   |                       | token is not required.   |
|                   |                       |                          |
|                   |                       | Use of a PIN-encryption  |
|                   |                       | key that is unique per   |
|                   |                       | transaction ensures that |
|                   |                       | any compromise of a      |
|                   |                       | specific PIN entry event |
|                   |                       | cannot be used to        |
|                   |                       | compromise previous PINs |
|                   |                       | processed by that        |
|                   |                       | system.                  |
|                   |                       |                          |
|                   |                       | Only the entity that is  |
|                   |                       | intended to decrypt the  |
|                   |                       | PIN is permitted to have |
|                   |                       | access to the decryption |
|                   |                       | key. If a PCI PTS SCRP   |
|                   |                       | is used for PIN          |
|                   |                       | translation, only the    |
|                   |                       | PCI PTS SCRP is          |
|                   |                       | permitted to decrypt a   |
|                   |                       | PIN after encryption by  |
|                   |                       | the MPoC SDK. If no PCI  |
|                   |                       | PTS SCRP is used, only   |
|                   |                       | the processing backend   |
|                   |                       | is permitted to decrypt  |
|                   |                       | the PIN.                 |
|                   |                       |                          |
|                   |                       | PINs may be translated   |
|                   |                       | from ISO format 4 by a   |
|                   |                       | PCI PTS SCRP or by       |
|                   |                       | back-end systems, for    |
|                   |                       | onward processing as     |
|                   |                       | required.                |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1E-1.6**      | **1E-1.6.a** The      | PIN entry is permitted   |
| > Attestation     | tester must confirm   | only when the MPoC SDK   |
| > functions       | through examination   | is running in a secure   |
| > detecting       | and observation that  | state. It is important   |
| > indications of  | attestation is        | that these attestation   |
| > potential       | performed prior to    | functions be performed   |
| > compromise must | each PIN entry.       | before the cardholder is |
| > be executed     |                       | prompted to enter PIN    |
| > prior to each   |                       | data.                    |
| > PIN entry       |                       |                          |
| > process.        |                       | The MPoC SDK may have    |
|                   |                       | multiple levels of       |
|                   |                       | attestation and is       |
|                   |                       | required to have some    |
|                   |                       | level that is always     |
|                   |                       | active. Due to power and |
|                   |                       | processing constraints,  |
|                   |                       | it may not be possible   |
|                   |                       | to have all attestation  |
|                   |                       | functions always active, |
|                   |                       | and so execution of more |
|                   |                       | complete attestation     |
|                   |                       | prior to PIN entry is    |
|                   |                       | required.                |
|                   |                       |                          |
|                   |                       | Validation of            |
|                   |                       | attestation data is      |
|                   |                       | expected to be performed |
|                   |                       | online for any online    |
|                   |                       | PIN entry process.       |
+-------------------+-----------------------+--------------------------+
|                   | **1E-1.6.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | attestation and       |                          |
|                   | monitoring (A&M)      |                          |
|                   | validation is         |                          |
|                   | performed on the COTS |                          |
|                   | device immediately    |                          |
|                   | prior to PIN entry.   |                          |
+-------------------+-----------------------+--------------------------+
| > **1E-1.7** The  | **1E-1.7.a** The      | Common malware attacks   |
| > MPoC SDK must   | tester must confirm   | are known to overlay     |
| > detect when     | through examination   | information on top of    |
| > another         | and observation that  | legitimate applications  |
| > application     | mechanisms to detect  | to obtain input data     |
| > overlays the    | application overlays  | from the user. The MPoC  |
| > MPoC SDK during | exist, and that it    | SDK needs to be able to  |
| > PIN capture. In | triggers the          | detect whether another   |
| > case of         | cancellation of any   | application is           |
| > positive        | PIN entry currently   | overlaying the MPoC SDK  |
| > detection, the  | in progress.          | and stop any transaction |
| > MPoC SDK must   |                       | in progress.             |
| > cancel any PIN  |                       |                          |
| > entry currently |                       |                          |
| > in progress.    |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1E-1.8**      | **1E-1.8.a** The      | Cleartext PINs,          |
| > PIN-related     | tester must confirm   | encrypted PIN blocks,    |
| > data (PIN, PIN  | through examination   | and PIN-encryption keys  |
| > related values  | and observation that  | need to be cleared from  |
| > such as touch   | PIN-related data is   | the system as soon as    |
| > locations, PIN  | not stored on         | they are no longer       |
| > block, PIN key) | persistent storage.   | required.                |
| > must not be     |                       |                          |
| > stored on the   |                       | For both cleartext PINs  |
| > COTS            |                       | and the PIN encryption   |
| >                 |                       | key, this means once the |
| device-persistent |                       | encrypted PIN block is   |
| > storage and     |                       | produced, these values   |
| > must be erased  |                       | are required to be       |
| > once no longer  |                       | securely erased.         |
| > required.       |                       |                          |
|                   |                       | An MPoC SDK may perform  |
|                   |                       | the two encryptions      |
|                   |                       | required for an ISO      |
|                   |                       | format 4-PIN block as    |
|                   |                       | separate parts of the    |
|                   |                       | transaction, enabling    |
|                   |                       | encryption of the PIN as |
|                   |                       | soon as possible and     |
|                   |                       | prior to the inclusion   |
|                   |                       | of the PAN or PAN token  |
|                   |                       | into the PIN block.      |
|                   |                       |                          |
|                   |                       | The encrypted PIN block  |
|                   |                       | needs to be erased once  |
|                   |                       | the PIN block has been   |
|                   |                       | transmitted from the     |
|                   |                       | COTS device.             |
+-------------------+-----------------------+--------------------------+
| > **1E-1.9**      | **1E-1.9.a** The      | Offline PINs may be sent |
| > Offline PIN     | tester must confirm   | to the payment card in   |
| > verification is | through examination   | the clear, and therefore |
| > supported only  | and observation that  | may be transmitted only  |
| > through the use | offline PIN           | when the card is         |
| > of a PCI PTS    | verification is not   | presented into a         |
| > SCRP.           | allowed for           | tamper-responsive        |
|                   | transactions where    | device, such as a PCI    |
|                   | the card has not been | PTS SCRP.                |
|                   | accepted through a    |                          |
|                   | PCI PTS SCRP.         |                          |
+-------------------+-----------------------+--------------------------+

## Module 1F: Offline Payment Transactions

> This Module is applicable to MPoC Software that supports offline
> transactions, even if the capability can be disabled at run-time with
> configuration options. Offline transactions covered by this Module are
> offline EMV transactions (where the transaction authorization is
> completely offline) and store-and-forward transactions (where the
> terminal approves the transaction, but the authorization is performed
> online after connectivity is regained).
>
> Depending on the type of transaction, different types of data may need
> to be stored on the COTS device for eventual transaction
> authorization. Types of data that may need to be stored and protected
> during an offline transaction includes account data and transaction
> results (cryptograms).
>
> Offline PIN verification (with a contact chip card presented through a
> PCI PTS SCRP) may be used in either online or offline approval
> processes.
>
> Assets stored for offline transactions must be protected according to
> their security needs. This Module covers additional security
> requirements that are needed to provide protection to these assets
> when stored on the COTS device. The protection of assets during the
> processing of a payment is covered by separate Modules.
>
> Support for offline payment processing is not a required feature of an
> MPoC Solution and may not be possible in some payment solutions due to
> local or payment brand specific rules.

### 1F-1 Offline Payment Transactions

> This Section covers the requirements for securing the processing and
> storage of data required as part of offline payment transactions.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Offline         |                       |                          |
| > transaction     |                       |                          |
| > results and     |                       |                          |
| > account data    |                       |                          |
| > are protected.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1F-1.1**      | **1F-1.1.a** The      | To prevent the recovery  |
| > Stored assets,  | tester must confirm   | of cleartext sensitive   |
| > such as account | through examination,  | assets, such data needs  |
| > data and        | observation, and      | to be stored so that it  |
| > transaction     | testing that any      | is not recoverable on    |
| > results, needed | assets, such as       | the COTS device.         |
| > to process      | account data and      |                          |
| > offline Payment | transaction results,  | The requirement is       |
| > transactions    | stored for offline    | required to be enforced  |
| > must be         | transactions cannot   | cryptographically        |
| > encrypted in    | be decrypted or       | through the use of keys  |
| > such a way that | recovered on the COTS | that are securely        |
| > the cleartext   | device after          | removed from the COTS    |
| > values cannot   | encryption.           | device immediately after |
| > be recovered on |                       | encryption or using an   |
| > the COTS device |                       | approved asymmetric      |
| > after           |                       | cryptography algorithm   |
| > encryption.     |                       | as described in          |
|                   |                       | *[Appendix               |
|                   |                       | C:](#_bookmark134)       |
|                   |                       | [Minimum and Equivalent  |
|                   |                       | Key Sizes and Strengths  |
|                   |                       | for](#_bookmark134)*     |
|                   |                       | [*Approved               |
|                   |                       | Algo                     |
|                   |                       | rithms*.](#_bookmark134) |
|                   |                       |                          |
|                   |                       | If symmetric             |
|                   |                       | cryptography is used,    |
|                   |                       | the COTS device cannot   |
|                   |                       | maintain sufficient      |
|                   |                       | information to recreate  |
|                   |                       | previous encryption keys |
|                   |                       | after their removal. An  |
|                   |                       | example of symmetric     |
|                   |                       | cryptographic methods    |
|                   |                       | meeting this requirement |
|                   |                       | would be use of a unique |
|                   |                       | key per transaction key  |
|                   |                       | management, with each    |
|                   |                       | transaction key erased   |
|                   |                       | upon the completion of   |
|                   |                       | that transaction.        |
|                   |                       |                          |
|                   |                       | In such an example, it   |
|                   |                       | is required that         |
|                   |                       | reconstruction of the    |
|                   |                       | encryption keys is not   |
|                   |                       | possible, except in the  |
|                   |                       | back- end system.        |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1F-1.2** The  | **1F-1.2.a** The      | Offline transactions are |
| > MPoC Software   | tester must confirm   | communicated to the      |
| > must be able to | through examination   | payment backend as       |
| > detect the      | and observation that  | required. Prior to       |
| > deletion or     | the MPoC Software is  | transmission, there is   |
| > modification of | able to detect the    | an opportunity window to |
| > offline         | deletion or           | delete or modify         |
| > transaction     | modification of       | transaction data. This   |
| > data.           | offline transaction   | may prevent the          |
|                   | data.                 | transaction from being   |
|                   |                       | acknowledged by the      |
|                   |                       | payment backend, alter   |
|                   |                       | the amount or parties    |
|                   |                       | involved in the          |
|                   |                       | transaction, or change   |
|                   |                       | the outcome of           |
|                   |                       | transaction processing   |
|                   |                       | decisions.               |
|                   |                       |                          |
|                   |                       | Detection of the         |
|                   |                       | deletion may occur by    |
|                   |                       | the MPoC SDK directly,   |
|                   |                       | or by some other         |
|                   |                       | (backend) aspect of the  |
|                   |                       | MPoC Software.           |
|                   |                       |                          |
|                   |                       | Attempts to attack       |
|                   |                       | offline payment          |
|                   |                       | processing by deleting   |
|                   |                       | the MPoC Software from   |
|                   |                       | the COTS device is       |
|                   |                       | covered by a different   |
|                   |                       | requirement.             |
+-------------------+-----------------------+--------------------------+
|                   | **1F-1.2.b** The      |                          |
|                   | tester must perform   |                          |
|                   | testing on the MPoC   |                          |
|                   | Software by           |                          |
|                   | performing offline    |                          |
|                   | transactions,         |                          |
|                   | deleting and          |                          |
|                   | modifying transaction |                          |
|                   | data from the COTS    |                          |
|                   | device, and verifying |                          |
|                   | that:                 |                          |
|                   |                       |                          |
|                   | -   The MPoC Software |                          |
|                   |     is able to detect |                          |
|                   |     that the executed |                          |
|                   |     transactions were |                          |
|                   |     deleted or        |                          |
|                   |     modified.         |                          |
|                   |                       |                          |
|                   | -   Further           |                          |
|                   |     transaction       |                          |
|                   |     processing is     |                          |
|                   |     prohibited until  |                          |
|                   |     the incident is   |                          |
|                   |     reported to the   |                          |
|                   |     A&M backend for   |                          |
|                   |     analysis.         |                          |
+-------------------+-----------------------+--------------------------+
| > **1F-1.3** The  | **1F-1.3.a** The      | Data that may be stored  |
| > offline Payment | tester must confirm   | as part of an offline    |
| > transaction     | through examination   | transaction may include  |
| > data must be    | and observation that  | the PAN, transaction     |
| > deleted once it | any offline           | amount, and transaction  |
| > has been        | transaction data is   | cryptograms obtained     |
| > transmitted to  | deleted once it has   | from the cardholder      |
| > the payment     | been transmitted to   | payment instrument.      |
| > backend.        | the back-end system.  |                          |
|                   |                       | To reduce the risk posed |
|                   |                       | by the storage of that   |
|                   |                       | data, transaction data   |
|                   |                       | needs to be deleted      |
|                   |                       | after it is no longer    |
|                   |                       | required. However,       |
|                   |                       | deletion is to be        |
|                   |                       | delayed until after      |
|                   |                       | transmission of the data |
|                   |                       | to process the           |
|                   |                       | transaction, to prevent  |
|                   |                       | attacks that may attempt |
|                   |                       | to "force" the deletion  |
|                   |                       | of data by disabling     |
|                   |                       | communications.          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1F-1.4**      | **1F-1.4.a** The      | Attackers may attempt to |
| > Payment         | tester must confirm   | exploit offline          |
| > transactions    | through examination   | processing to process    |
| > can only be     | and observation that  | multiple transactions    |
| > accepted in     | any further           | that would otherwise be  |
| > offline mode    | transaction           | rejected if processed    |
| > for a maximum   | processing is         | online. To reduce this   |
| > period of 48    | prevented when the    | risk, offline processing |
| > hours.          | MPoC Software has     | systems need to prevent  |
|                   | been operating in     | further processing if    |
|                   | offline mode for more | they are prevented from  |
|                   | than 48 hours.        | connecting to the        |
|                   |                       | back-end system.         |
|                   |                       |                          |
|                   |                       | The back-end             |
|                   |                       | payment-processing       |
|                   |                       | systems may be different |
|                   |                       | to the back-end A&M      |
|                   |                       | processing systems. MPoC |
|                   |                       | Software implementing    |
|                   |                       | offline payment          |
|                   |                       | processing need to       |
|                   |                       | achieve connectivity to  |
|                   |                       | the A&M backend at least |
|                   |                       | every 24 hours.          |
|                   |                       |                          |
|                   |                       | The A&M connectivity     |
|                   |                       | requirement is different |
|                   |                       | from this requirement    |
|                   |                       | and tested separately.   |
|                   |                       | This requirement is to   |
|                   |                       | halt payment processing  |
|                   |                       | once offline payment     |
|                   |                       | processing has been      |
|                   |                       | enabled for more than 48 |
|                   |                       | hours.                   |
+-------------------+-----------------------+--------------------------+
| > **1F-1.5** Data | **1F-1.5.a** The      | Although offline data is |
| > stored for      | tester must confirm   | required to be protected |
| > offline         | through examination   | cryptographically, it    |
| > transaction     | and observation that  | also needs to be         |
| > processing must | the offline data is   | isolated from other      |
| > not be          | stored at a location  | applications as part of  |
| > accessible to   | not accessible to     | a defense-in-depth       |
| > other           | other applications.   | approach to protecting   |
| > applications.   |                       | that data.               |
+-------------------+-----------------------+--------------------------+
| > **1F-1.6**      | **1F-1.6.a** The      | Online transactions may  |
| > Transactions    | tester must confirm   | allow for operations     |
| > currently       | through examination   | that are not permitted   |
| > underway during | and observation that  | as part of an offline    |
| > a transition to | the transition to     | transaction -- e.g.,     |
| > offline         | offline processing is | online PIN capture is    |
| > processing are  | managed securely, so  | not permitted for        |
| > either failed   | that any transaction  | offline payment          |
| > in a secure     | currently in process  | processing. In cases     |
| > manner or       | is either failed in a | where a transaction is   |
| > managed in      | secure manner or is   | currently underway       |
| > compliance with | compliant to the      | during the transition to |
| > the             | requirements of this  | offline processing, it   |
| > requirements of | Section.              | is important that the    |
| > this Section.   |                       | transactions is either   |
|                   |                       | failed in a secure       |
|                   |                       | manner, or the           |
|                   |                       | processing of that       |
|                   |                       | transaction is compliant |
|                   |                       | to the requirements of   |
|                   |                       | this Section.            |
+-------------------+-----------------------+--------------------------+

### 1F-2 Offline Monitoring

> Solutions providing offline payment processing must implement
> attestation and monitoring functions on the COTS device that are able
> to operate securely without connectivity with the A&M back-end
> component. Although these requirements exist to support MPoC Solution
> where a system is disconnected from both the payment processing
> back-end systems, and the A&M back-end systems, it is noted that
> offline payment processing is a separate consideration and does not
> necessarily require that the back-end A&M systems are unavailable.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The MPoC SDK    |                       |                          |
| > can securely    |                       |                          |
| > operate and     |                       |                          |
| > attest its      |                       |                          |
| > environment     |                       |                          |
| > during periods  |                       |                          |
| > where           |                       |                          |
| > connection to   |                       |                          |
| > the A&M backend |                       |                          |
| > is lost.        |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1F-2.1** The  | **1F-2.1.a** The      | The MPoC SDK cannot      |
| > initiation of   | tester must confirm   | start in offline mode    |
| > the offline     | through examination   | from a reboot state      |
| > mode must not   | and observation that  | without first contacting |
| > be available    | it is not possible to | the server. This helps   |
| > immediately     | perform offline       | mitigate attacks when    |
| > after COTS      | transactions if the   | the timer is manipulated |
| > device reboot.  | A&M and               | by rebooting the COTS    |
| > The MPoC SDK    | payment-processing    | device or when the       |
| > must work       | servers have not been | firmware is modified     |
| > offline only    | contacted after a     | since the last contact   |
| > after being     | reboot of the COTS    | with the A&M server.     |
| > connected to    | device.               |                          |
| > the A&M         |                       | Validation of the local  |
| > backend.        |                       | time as indicated by the |
|                   |                       | COTS device during       |
|                   |                       | reconnections may be     |
|                   |                       | used as part of the A&M  |
|                   |                       | data. The ability to     |
|                   |                       | correctly indicate local |
|                   |                       | time is important for    |
|                   |                       | the secure operation of  |
|                   |                       | the MPoC SDK.            |
+-------------------+-----------------------+--------------------------+
| > **1F-2.2** The  | **1F-2.2.a** The      | It is expected that the  |
| > MPoC SDK A&M    | tester must confirm   | MPoC SDK acts upon the   |
| > component must  | through examination   | results of the offline   |
| > support a       | that the MPoC SDK A&M | executed security checks |
| > separate        | component supports a  | to prevent fraud. The    |
| > attestation     | separate attestation  | degree of certainty of   |
| > policy for      | policy for offline    | the security checks      |
| > offline         | operation. The MPoC   | needs to be defined in   |
| > operation.      | SDK A&M component     | the A&M offline mode     |
|                   | must support the      | policy.                  |
|                   | following actions:    |                          |
|                   |                       |                          |
|                   | -   Confidentiality   |                          |
|                   |     protected logs of |                          |
|                   |     any checks that   |                          |
|                   |     have a high       |                          |
|                   |     chance of false   |                          |
|                   |     positive results. |                          |
|                   |                       |                          |
|                   | -   Impede the        |                          |
|                   |     ability to        |                          |
|                   |     transact until    |                          |
|                   |     the A&M backend   |                          |
|                   |     is contacted for  |                          |
|                   |     checks with high  |                          |
|                   |     confidence of     |                          |
|                   |     compromise (e.g., |                          |
|                   |     detection of      |                          |
|                   |     specific hacking  |                          |
|                   |     tools).           |                          |
|                   |                       |                          |
|                   | -   Local checks must |                          |
|                   |     include at least  |                          |
|                   |     root detection,   |                          |
|                   |     instrumentation   |                          |
|                   |     detection, data-  |                          |
|                   |     tampering checks, |                          |
|                   |     and local OS      |                          |
|                   |     attestation if    |                          |
|                   |     supported by the  |                          |
|                   |     COTS platform.    |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1F-2.3** The  | **1F-2.3.a** The      | An attacker may attempt  |
| > A&M backend     | tester must confirm   | to delete the MPoC SDK,  |
| > must implement  | through examination   | or MPoC Application,     |
| > controls to     | and observation that  | from a COTS device       |
| > mitigate        | the A&M backend       | during offline           |
| > attacks         | implements controls   | processing, so that any  |
| > attempting to   | to mitigate attacks   | stored transactions are  |
| > delete the MPoC | attempting to delete  | lost. Although this      |
| > SDK, or MPoC    | the MPoC SDK, or MPoC | cannot be prevented, the |
| > Application,    | Application, during   | A&M backend is required  |
| > during offline  | offline processing.   | to track offline use in  |
| > processing.     |                       | attempts to identify     |
|                   |                       | such abuse. For example, |
|                   |                       | a system may flag        |
|                   |                       | merchants or COTS device |
|                   |                       | instances where offline  |
|                   |                       | processing is enabled    |
|                   |                       | and the next appearance  |
|                   |                       | of that merchant or      |
|                   |                       | system is a new          |
|                   |                       | installation.            |
+-------------------+-----------------------+--------------------------+
| > **1F-2.4** The  | **1F-2.4.a** The      | It is not a requirement  |
| > MPoC SDK must   | tester must confirm   | that the MPoC SDK        |
| > disable payment | through examination   | supports offline payment |
| > acceptance      | and observation that  | processing; however,     |
| > after 24 hours  | the MPoC SDK must     | where this is supported, |
| > without         | disable processing    | communications with the  |
| > receiving a     | after 24 hours        | A&M backend may be       |
| > response from   | without a response    | interrupted during this  |
| > the A&M         | from the A&M back-end | time. In such cases, it  |
| > back-end        | allowing for the      | is acceptable for the    |
| > allowing for    | continued processing  | disablement of online    |
| > the continued   | of transactions.      | payment acceptance to be |
| > processing of   |                       | delayed for up to 24     |
| > transactions.   |                       | hours.                   |
+-------------------+-----------------------+--------------------------+
| > **1F-2.5** The  | **1F-2.5.a** The      | Security checks that do  |
| > results of the  | tester must perform   | not depend on a back-end |
| > A&M security    | testing on the MPoC   | system to obtain a       |
| > checks that are | SDK by triggering     | result (e.g., root       |
| > not dependent   | security checks in    | detection,               |
| > on the backend  | the MPoC SDK while in | anti-tampering, etc.)    |
| > must be         | offline mode and      | need to be assessed      |
| > resistant to    | verifying that they   | locally while in offline |
| > tampering to an | are active in offline | mode.                    |
| > attack rating   | mode, and that any    |                          |
| > of 25 points    | response or reaction  |                          |
| > using the       | required by the       |                          |
| > attack-costing  | attestation policy is |                          |
| > framework in    | enacted.              |                          |
| > [*Appendix      |                       |                          |
| > B*.](#ap        |                       |                          |
| pendix-b-attack-c |                       |                          |
| osting-framework) |                       |                          |
| > The             |                       |                          |
| > verifi          |                       |                          |
| cation/assessment |                       |                          |
| > of these        |                       |                          |
| > security check  |                       |                          |
| > results cannot  |                       |                          |
| > be delayed      |                       |                          |
| > until           |                       |                          |
| > connection to   |                       |                          |
| > the A&M backend |                       |                          |
| > is              |                       |                          |
| > reestablished.  |                       |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1F-2.5.b** The      |                          |
|                   | tester must perform   |                          |
|                   | testing on the MPoC   |                          |
|                   | SDK by attempting to  |                          |
|                   | extract card data and |                          |
|                   | PIN data from the     |                          |
|                   | MPoC SDK when using   |                          |
|                   | the offline A&M       |                          |
|                   | configuration.        |                          |
+-------------------+-----------------------+--------------------------+
|                   | **1F-2.5.c** The      |                          |
|                   | tester must provide a |                          |
|                   | costing of this       |                          |
|                   | attack based on the   |                          |
|                   | method outlined in    |                          |
|                   | *[Appendix            |                          |
|                   | B.](#appendix-b-attac |                          |
|                   | k-costing-framework)* |                          |
|                   | [*Attack Costing      |                          |
|                   | Framewor              |                          |
|                   | k*.](#appendix-b-atta |                          |
|                   | ck-costing-framework) |                          |
|                   | This requirement is   |                          |
|                   | passed if the most    |                          |
|                   | feasible attack       |                          |
|                   | cannot be costed for  |                          |
|                   | less than 25 points.  |                          |
+-------------------+-----------------------+--------------------------+

## Module 1G: MPoC Software Security Guidance

> MPoC Software includes the COTS-based MPoC SDK, which includes both
> payment and attestation functionality, and the back-end attestation
> and monitoring software.
>
> This Module applies in all cases to MPoC Software that is to be
> separately listed as an MPoC Product. This Module additionally applies
> to solutions that separate the MPoC functionality from other parts of
> an MPoC Application, including those where the MPoC Solution Provider
> and the MPoC Application vendor are the same organization.
>
> Monolithic MPoC Solutions are exempt from this Module as they do not
> use an MPoC SDK, and do not outsource the operation of their
> Attestation and Monitoring services.

### 1G-1 Security Guidance

> The security guidance of a component is a document that defines the
> purpose and usage of the component, the security claims of the
> component, the component dependencies, and contains the required
> information to integrate and use the component in a secure manner.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The MPoC        |                       |                          |
| > Software is     |                       |                          |
| > provided with   |                       |                          |
| > documentation   |                       |                          |
| > that allows for |                       |                          |
| > secure          |                       |                          |
| > integration and |                       |                          |
| > use within a    |                       |                          |
| > complete MPoC   |                       |                          |
| > Solution.       |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **1G-1.1** The  | **1G-1.1.a** The      | > An MPoC Software needs |
| > MPoC Software   | tester must confirm   | > to be integrated as    |
| > must be         | through examination   | > expected by the MPoC   |
| > provided with a | that there is a       | > Solution provider and  |
| > security        | security guidance     | > the assessment         |
| > guidance        | document that is      | > laboratory to ensure   |
| > document that   | provided with the     | > that the validated     |
| > describes how   | MPoC Software. This   | > security features are  |
| > the MPoC SDK    | document must be made | > correctly implemented. |
| > can be          | visible and readily   | >                        |
| > integrated with | accessible to all     | > The MPoC Solution      |
| > an MPoC         | entities integrating  | > provider is required   |
| > Application.    | the MPoC Software     | > to provide             |
|                   | into their own        | > documentation about    |
|                   | systems or solutions. | > how this integration   |
|                   |                       | > is achieved, and the   |
|                   |                       | > laboratory needs to    |
|                   |                       | > validate that this     |
|                   |                       | > conforms to their      |
|                   |                       | > expectations and       |
|                   |                       | > testing setup.         |
+-------------------+-----------------------+--------------------------+
| > **1G-1.2** The  | **1G-1.2.a** The      | > An MPoC SDK may take   |
| > MPoC Software   | tester must determine | > one of two types. The  |
| > security        | through examination,  | > first type is an       |
| > guidance        | observation, and      | > Isolating MPoC SDK,    |
| > document must   | testing that the MPoC | > which prevents the     |
| > define the type | SDK provided as part  | > MPoC Application from  |
| > of MPoC SDK     | of the MPoC Software  | > accessing the memory   |
| > that is         | is either an          | > or sensitive assets of |
| > implemented.    | Isolating SDK, or a   | > the MPoC SDK. Any MPoC |
|                   | non-Isolating SDK.    | > SDK that does not meet |
|                   | The tester may refer  | > this requirement to    |
|                   | to the results from   | > isolate and protect    |
|                   | previous test items   | > its own memory and     |
|                   | in making this        | > sensitive assets is    |
|                   | determination.        | > considered a non-      |
|                   |                       | > Isolating SDK.         |
+-------------------+-----------------------+--------------------------+
|                   | **1G-1.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the MPoC         |                          |
|                   | Software security     |                          |
|                   | guidance document     |                          |
|                   | correctly details the |                          |
|                   | type of MPoC SDK      |                          |
|                   | implemented by the    |                          |
|                   | MPoC Software.        |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1G-1.3** The  | **1G-1.3.a** The      | An MPoC Software needs   |
| > MPoC Software   | tester must confirm   | to be integrated as      |
| > must be         | through examination   | expected by the MPoC     |
| > provided with a | that there is a       | Solution provider and    |
| > security        | security guidance     | the assessment           |
| > guidance        | document that is      | laboratory to ensure     |
| > document that   | provided with the     | that the validated       |
| > describes how   | MPoC Software. This   | security features are    |
| > the MPoC        | document must be made | correctly implemented.   |
| > Software is to  | visible and readily   |                          |
| > be operated by  | accessible to all     | The MPoC Solution        |
| > an Attestation  | entities integrating  | provider is required to  |
| > and Monitoring  | the MPoC Software     | provide documentation    |
| > Service         | into their own        | about how this           |
| > provider.       | systems or solutions. | integration is achieved, |
|                   |                       | and the laboratory needs |
|                   |                       | to validate that this    |
|                   |                       | conforms to their        |
|                   |                       | expectations and testing |
|                   |                       | setup.                   |
+-------------------+-----------------------+--------------------------+
| > **1G-1.4** The  | **1G-1.4.a** The      | Clear documentation over |
| > MPoC Software   | tester must confirm   | the boundaries of the    |
| > security        | through examination   | MPoC SDK is needed to    |
| > guidance        | that the security     | scope the functionality  |
| > document must   | guidance document     | of the MPoC Software     |
| > define an       | includes an explicit  | properly and assess the  |
| > explicit MPoC   | MPoC SDK boundary.    | evaluated components.    |
| > SDK boundary.   |                       |                          |
|                   |                       | The boundary has to      |
|                   |                       | include any hardware     |
|                   |                       | (e.g., PCI PTS SCRP, SE) |
|                   |                       | that performs, or        |
|                   |                       | software that            |
|                   |                       | implements, any of the   |
|                   |                       | MPoC SDK-designated      |
|                   |                       | security                 |
|                   |                       | functionalities.         |
|                   |                       |                          |
|                   |                       | The MPoC SDK boundary    |
|                   |                       | needs to define how      |
|                   |                       | account data is input to |
|                   |                       | the MPoC SDK, and how    |
|                   |                       | A&M and control signals  |
|                   |                       | pass between the MPoC    |
|                   |                       | SDK and other components |
|                   |                       | of the Solution.         |
|                   |                       |                          |
|                   |                       | Although interfaces such |
|                   |                       | as the COTS-native NFC   |
|                   |                       | reader or touch screen   |
|                   |                       | are not part of the MPoC |
|                   |                       | SDK boundary, it is      |
|                   |                       | required that they be    |
|                   |                       | considered part of any   |
|                   |                       | account data input       |
|                   |                       | methods into the MPoC    |
|                   |                       | SDK.                     |
+-------------------+-----------------------+--------------------------+
|                   | **1G-1.4.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the MPoC SDK     |                          |
|                   | boundary, as defined, |                          |
|                   | aligns with their     |                          |
|                   | understanding of the  |                          |
|                   | MPoC Software and     |                          |
|                   | includes details      |                          |
|                   | about how all account |                          |
|                   | data and A&M data are |                          |
|                   | input or output from  |                          |
|                   | that boundary.        |                          |
+-------------------+-----------------------+--------------------------+
| > **1G-1.5** The  | **1G-1.5.a** The      | Clear documentation      |
| > MPoC Software   | tester must confirm   | about how updates to the |
| > security        | through examination   | MPoC Software and its    |
| > guidance        | that the required     | configuration can be     |
| > document must   | information is        | made is vital.           |
| > provide details | included and that it  |                          |
| > about how the   | matches the           | Because the MPoC         |
| > MPoC Software   | understanding of the  | Software is designed for |
| > code and        | tester of the MPoC    | integration into other   |
| > configuration   | Solution.             | components of an MPoC    |
| > settings can be |                       | Solution, updates may    |
| > updated         |                       | require specific         |
| > securely.       |                       | processes or             |
|                   |                       | prerequisites. When an   |
|                   |                       | MPoC Software makes      |
|                   |                       | assumptions about the    |
|                   |                       | source or protections    |
|                   |                       | provided to updates,     |
|                   |                       | this needs to be clearly |
|                   |                       | detailed in the security |
|                   |                       | guidance documentation.  |
|                   |                       |                          |
|                   |                       | Updates covered by this  |
|                   |                       | guidance includes data   |
|                   |                       | such as configuration    |
|                   |                       | for EMV kernels.         |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1G-1.6** The  | **1G-1.6.a** The      | An important part of the |
| > MPoC Software   | tester must confirm   | security posture of any  |
| > security        | through examination   | software- protected      |
| > guidance        | that the MPoC         | cryptography is the      |
| > document must   | Software security     | ability to provide       |
| > provide details | guidance              | regular updates. Any     |
| > about how any   | documentation         | implementation of an     |
| > s               | indicates how often   | MPoC SDK using a         |
| oftware-protected | any                   | software-protected       |
| > cryptography    | software-protected    | cryptography needs to    |
| > implementations | cryptography          | ensure that it complies  |
| > impact the      | implementations must  | with this update         |
| > frequency of    | be updated. This time | process, which starts    |
| > MPoC            | period must be no     | with providing this      |
| > Application     | more than the minimum | information in the MPoC  |
| > updates.        | period included as    | Software security        |
|                   | part of the testing   | guidance documentation.  |
|                   | of the                |                          |
|                   | software-protected    |                          |
|                   | cryptography.         |                          |
+-------------------+-----------------------+--------------------------+
| > **1G-1.7** The  | **1G-1.7.a** The      | It is important that the |
| > MPoC Software   | tester must confirm   | expectations of the MPoC |
| > security        | through examination   | SDK regarding protecting |
| > guidance        | that the required     | assets are understood    |
| > document must   | information is        | for the integrator and   |
| > list all assets | included and that it  | the laboratory that      |
| > that cross the  | matches the           | evaluates the            |
| > boundary of the | understanding of the  | integration of the MPoC  |
| > MPoC SDK and    | tester of the MPoC    | SDK.                     |
| > the expected    | Solution.             |                          |
| > protection that |                       | An MPoC SDK may take the |
| > the integrator  |                       | form of a non-Isolating  |
| > of the MPoC SDK |                       | SDK, or an Isolating     |
| > must provide to |                       | SDK. An Isolating SDK    |
| > these assets.   |                       | must ensure that all     |
|                   |                       | sensitive assets -- such |
|                   |                       | as cryptographic keys    |
|                   |                       | and account data -- are  |
|                   |                       | protected according to   |
|                   |                       | their asset type when    |
|                   |                       | passed outside of the    |
|                   |                       | boundary of the MPoC     |
|                   |                       | SDK.                     |
|                   |                       |                          |
|                   |                       | A non-Isolated MPoC SDK  |
|                   |                       | may provide the MPoC     |
|                   |                       | Application with access  |
|                   |                       | to some assets, such as  |
|                   |                       | the PAN to be used for   |
|                   |                       | the purpose of loyalty   |
|                   |                       | transactions or to       |
|                   |                       | support non-payment card |
|                   |                       | capture. If such access  |
|                   |                       | is permitted, this must  |
|                   |                       | be detailed in the       |
|                   |                       | guidance documentation.  |
|                   |                       |                          |
|                   |                       | Even for an Isolating    |
|                   |                       | SDK. not all assets that |
|                   |                       | cross the boundary       |
|                   |                       | between the MPoC SDK and |
|                   |                       | the MPoC Application     |
|                   |                       | require protection.      |
|                   |                       | Assets that are          |
|                   |                       | inherently protected by  |
|                   |                       | the MPoC SDK, such as    |
|                   |                       | through encryption prior |
|                   |                       | to crossing the boundary |
|                   |                       | to the MPoC Application, |
|                   |                       | do not require further   |
|                   |                       | protection. However,     |
|                   |                       | such assets and the      |
|                   |                       | protections applied must |
|                   |                       | still be identified.     |
+-------------------+-----------------------+--------------------------+
| > **1G-1.8** The  | **1G-1.8.a** The      | The integrator is        |
| > MPoC Software   | tester must confirm   | required to be aware of  |
| > security        | through examination   | how to configure the     |
| > guidance        | that the security     | MPoC Software properly   |
| > document must   | guidance:             | for deployment and what  |
| > contain         |                       | security mechanisms are  |
| > detailed        | -   Matches the       | expected to be included  |
| > guidance for    |     testers           | during the development.  |
| > secure          |     understanding of  |                          |
| > integration     |     the MPoC          |                          |
| > that includes   |     Solution.         |                          |
| > configuration   |                       |                          |
| > flags, usage of | -   Is sufficient for |                          |
| > APIs, and       |     secure            |                          |
| > expected        |     integration of    |                          |
| > security        |     the MPoC SDK      |                          |
| > mechanisms to   |     (i.e., it details |                          |
| > be applied.     |     how to integrate  |                          |
|                   |     the MPoC SDK in a |                          |
|                   |     way that would    |                          |
|                   |     enable the        |                          |
|                   |     integrating MPoC  |                          |
|                   |     Application to    |                          |
|                   |     meet the relevant |                          |
|                   |     requirements of   |                          |
|                   |     this standard).   |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **1G-1.9** The  | **1G-1.9.a** The      | The MPoC SDK is          |
| > MPoC Software   | tester must confirm   | permitted to be used     |
| > security        | through examination   | only on platforms that   |
| > guidance        | that the required     | have been validated to   |
| > document must   | information is        | provide the necessary    |
| > indicate which  | included and that it  | security and functional  |
| > COTS Platforms  | matches the           | aspects required. The    |
| > (including      | understanding of the  | integrator needs to      |
| > platform        | tester of the MPoC    | limit the use of the     |
| > versions such   | Solution.             | MPoC SDK only to         |
| > as OS, TEE, and |                       | platforms where the MPoC |
| > SE) are         |                       | SDK can be used          |
| > supported.      |                       | securely.                |
|                   |                       |                          |
|                   |                       | Sufficient granularity   |
|                   |                       | should be provided so    |
|                   |                       | that an integrator of    |
|                   |                       | the MPoC Software        |
|                   |                       | Product is able to know  |
|                   |                       | which platforms to       |
|                   |                       | target for their MPoC    |
|                   |                       | Application. This        |
|                   |                       | information must be kept |
|                   |                       | current as changes in    |
|                   |                       | the supported COTS       |
|                   |                       | platforms occur over     |
|                   |                       | time.                    |
+-------------------+-----------------------+--------------------------+
| > **1G-1.10** If  | **1G-1.10.a** The     | MPoC SDK functionality   |
| > the attestation | tester must confirm   | may need interactions    |
| > needs an        | through examination   | with the MPoC            |
| > interaction     | that the required     | Application that are not |
| > from the MPoC   | information is        | functional, but which    |
| > Application,    | included and that it  | are needed for security. |
| > the MPoC        | matches the           | These interactions are   |
| > Software        | understanding of the  | required to be           |
| > security        | tester of the MPoC    | documented properly such |
| > guidance        | Solution.             | that the integrator      |
| > document must   |                       | knows how to use the     |
| > define the      |                       | MPoC SDK properly.       |
| > scope,          |                       |                          |
| > dependencies,   |                       | Interactions include     |
| > and actors of   |                       | specific API calls,      |
| > an attestation  |                       | configuration for        |
| > policy that is  |                       | periodicity and status,  |
| > used by the     |                       | or other types of        |
| > MPoC Solution.  |                       | triggers.                |
+-------------------+-----------------------+--------------------------+
| > **1G-1.11** The | **1G-1.11.a** The     | The MPoC Software is     |
| > MPoC Software   | tester must confirm   | validated as             |
| > security        | through examination   | implementing certain key |
| > guidance        | that the MPoC         | management and           |
| > document must   | Software security     | encryption operations.   |
| > provide details | guidance provides     | However, all key         |
| > on the required | sufficient details on | management requires      |
| > key management  | how to operate the    | support from back-end    |
| > processes and   | key management        | systems, and it is       |
| > operations.     | required by the MPoC  | required that the        |
|                   | Software.             | operational aspects of   |
|                   |                       | the key management are   |
|                   |                       | clearly defined in the   |
|                   |                       | MPoC Software security   |
|                   |                       | guidance document. Where |
|                   |                       | different parties may be |
|                   |                       | responsible for          |
|                   |                       | different aspects of key |
|                   |                       | management, this is to   |
|                   |                       | be indicated in the      |
|                   |                       | document.                |
+-------------------+-----------------------+--------------------------+
|                   | **1G-1.11.b** The     |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the guidance     |                          |
|                   | clearly outlines who  |                          |
|                   | is responsible for    |                          |
|                   | the management of     |                          |
|                   | each key management   |                          |
|                   | aspect of the MPoC    |                          |
|                   | Software.             |                          |
+-------------------+-----------------------+--------------------------+

# Domain 2: MPoC Application Integration

> The security requirements in this Domain apply to MPoC Applications
> that integrate, or interface to, a listed MPoC SDK or are developed as
> part of a monolithic solution. MPoC Applications may be developed by
> an MPoC Software vendor, an MPoC Solution provider, or by another
> party. However, the Entity responsible for the listing of an MPoC
> Product is also responsible for managing the assessment and listing of
> any MPoC Applications associated with that MPoC Product.
>
> An MPoC Solution may have more than one MPoC Application listed as
> part of that MPoC Solution listing.
>
> Further details on the different types of MPoC Applications can be
> found in Section: [*MPoC SDKs and MPoC
> Applications*.](#mpoc-sdks-and-mpoc-applications) Details on the
> applicability of the various Domains and requirements of this standard
> can be found in Section: [*MPoC Domain and Section
> Applicability*.](#mpoc-domain-and-section-applicability) Details on
> the process and requirements for MPoC listings can be found in the
> MPoC Program Guide.

## Module 2A: MPoC Software Integration

> This Module covers the integration of one or more MPoC SDKs, which are
> part of listed MPoC Software Products, into an MPoC Application. Any
> one MPoC Application is not permitted to integrate more than two MPoC
> SDKs. An MPoC Application that integrates both an Isolating and
> non-Isolating MPoC SDK, is assessed against requirement as they apply
> to the integration of a non-Isolating MPoC SDK.

### 2A-1 Secure MPoC SDK Integration and Usage

> An MPoC SDK, when used, must be securely and correctly integrated into
> an overall MPoC Solution that includes the integration into the MPoC
> Application distributed and used by merchants. This integration must
> follow the guidance provided by the MPoC Solution provider, as well as
> ensuring requirements of this standard are met for the integrated
> system.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > When an MPoC    |                       |                          |
| > SDK is used, it |                       |                          |
| > must be         |                       |                          |
| > integrated into |                       |                          |
| > the overall     |                       |                          |
| > MPoC Solution   |                       |                          |
| > securely and    |                       |                          |
| > correctly.      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **2A-1.1** When | **2A-1.1.a** The      | MPoC Solutions,          |
| > an MPoC SDK is  | tester must confirm   | including the MPoC       |
| > used, the MPoC  | through examination   | Applications are         |
| > SDK must be     | that the version of   | required to be evaluated |
| > part of a       | the MPoC SDK used by  | in their entirety before |
| > listed MPoC     | the MPoC Application  | approval. When an MPoC   |
| > Software        | vendor is listed on   | SDK is relied upon for   |
| > product.        | the PCI website as an | some aspect of           |
|                   | MPoC Software         | compliance, that MPoC    |
|                   | product.              | SDK needs to have been   |
|                   |                       | previously assessed and  |
|                   |                       | listed as part of an     |
|                   |                       | MPoC Software product.   |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **2A-1.2** The  | **2A-1.2.a** The      | An MPoC SDK provides     |
| > MPoC SDK must   | tester must confirm   | various security         |
| > be integrated   | through examination   | services and functions   |
| > with the MPoC   | and observation that  | to assist with the       |
| > Application and | the MPoC Application  | overall compliance of    |
| > solution in     | vendor has integrated | the MPoC Solution. To    |
| > accordance with | the MPoC SDK in       | ensure correct and       |
| > the MPoC        | accordance with the   | secure operation the     |
| > Software        | MPoC Software         | MPoC SDK needs to be     |
| > security        | security guidance.    | integrated and used as   |
| > guidance.       |                       | intended.                |
|                   |                       |                          |
|                   |                       | An MPoC SDK may rely on  |
|                   |                       | the MPoC Application to  |
|                   |                       | provide a deployment     |
|                   |                       | configuration to be used |
|                   |                       | securely. The MPoC       |
|                   |                       | Application vendor needs |
|                   |                       | to follow the            |
|                   |                       | requirements from the    |
|                   |                       | MPoC SDK security        |
|                   |                       | guidance (e.g., on the   |
|                   |                       | use of configuration     |
|                   |                       | flags, APIs, and         |
|                   |                       | protection mechanisms to |
|                   |                       | be applied to the final  |
|                   |                       | integrated MPoC          |
|                   |                       | Application).            |
+-------------------+-----------------------+--------------------------+
| > **2A-1.3** The  | **2A-1.3.a** The      | An MPoC SDK is evaluated |
| > MPoC            | tester must confirm   | and approved based on    |
| > Application     | through examination   | the features it          |
| > integrating the | and observation that  | provides. Alteration or  |
| > MPoC SDK must   | the MPoC Application  | bypassing any of those   |
| > not bypass,     | integration did not   | features may impact the  |
| > circumvent,     | modify or re-         | security of the MPoC SDK |
| > reimplement, or | implement MPoC SDK    | in unexpected ways.      |
| > modify any of   | features that are     | Therefore, any MPoC SDK  |
| > the security or | within the MPoC SDK   | needs to be used only as |
| > operational     | boundary.             | outlined in the provided |
| > features        |                       | security guidance        |
| > provided by the |                       | documentation.           |
| > MPoC SDK.       |                       |                          |
|                   |                       | For example, an MPoC     |
|                   |                       | Application that         |
|                   |                       | integrates an MPoC SDK   |
|                   |                       | that provides PIN entry  |
|                   |                       | cannot bypass this       |
|                   |                       | function to provide its  |
|                   |                       | own PIN entry or         |
|                   |                       | encryption methods.      |
+-------------------+-----------------------+--------------------------+
| > **2A-1.4** The  | **2A-1.4.a** The      | The MPoC Application     |
| > MPoC            | tester must confirm   | relies on the MPoC SDK   |
| > Application     | through examination   | to manage all sensitive  |
| > does not        | and observation that  | assets such as           |
| > manage,         | the MPoC Application  | cardholder PINs and      |
| > process, or     | does not manage,      | account data. Where an   |
| > provide for the | process, or provide   | MPoC Application         |
| > input of any    | for the input of      | manages, processes, or   |
| > sensitive       | sensitive assets such | provides input to any    |
| > assets, or the  | as cardholder PINs,   | sensitive assets, the    |
| > MPoC            | cryptographic keys,   | MPoC Application is      |
| > Application is  | or account data.      | considered a monolithic  |
| > assessed to the |                       | MPoC Application for the |
| > requirements of |                       | purposes of assessment   |
| > Domain 1.       |                       | (and therefore is        |
|                   |                       | required to be assessed  |
|                   |                       | against Domain 1 of this |
|                   |                       | standard).               |
|                   |                       |                          |
|                   |                       | Assets that are          |
|                   |                       | encrypted by the MPoC    |
|                   |                       | Software (or by a system |
|                   |                       | or entity external to    |
|                   |                       | the COTS device) using   |
|                   |                       | cryptographic methods    |
|                   |                       | and key management       |
|                   |                       | assessed under Domain 1  |
|                   |                       | of this standard are     |
|                   |                       | considered suitably      |
|                   |                       | protected and not in     |
|                   |                       | scope of this            |
|                   |                       | requirement.             |
+-------------------+-----------------------+--------------------------+
|                   | **2A-1.4.b** Where    |                          |
|                   | the MPoC Application  |                          |
|                   | is found to manage,   |                          |
|                   | process, or allow for |                          |
|                   | the input of          |                          |
|                   | sensitive assets, the |                          |
|                   | tester must confirm   |                          |
|                   | that the MPoC         |                          |
|                   | Application has been  |                          |
|                   | included in the scope |                          |
|                   | of the Domain 1       |                          |
|                   | assessment.           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **2A-1.5**      | **2A-1.5.a** The      | The MPoC Application is  |
| > Attestation     | tester must confirm   | the method by which the  |
| > functions       | through examination   | MPoC SDK functions are   |
| > provided by the | and observation that  | delivered to the         |
| > MPoC Software   | the MPoC Application  | merchant.                |
| > must be         | vendor has integrated |                          |
| > securely and    | the MPoC Software A&M | Compromise of an MPoC    |
| > correctly       | functions as required | Application may prevent  |
| > integrated into | in the MPoC Software  | or alter the secure      |
| > the MPoC        | security guidance     | operation of the MPoC    |
| > Application.    | document.             | Solution, and so the     |
|                   |                       | security of the MPoC     |
|                   |                       | Application must be      |
|                   |                       | evaluated as part of the |
|                   |                       | attestation and          |
|                   |                       | monitoring process.      |
|                   |                       |                          |
|                   |                       | Attestation functions    |
|                   |                       | provided by the MPoC SDK |
|                   |                       | may require specific     |
|                   |                       | integration steps or     |
|                   |                       | interactions with the    |
|                   |                       | MPoC Application. For    |
|                   |                       | example, specific        |
|                   |                       | triggers or data points  |
|                   |                       | to support the secure    |
|                   |                       | operation of the         |
|                   |                       | attestation functions    |
|                   |                       | may be required within   |
|                   |                       | the MPoC Application.    |
|                   |                       |                          |
|                   |                       | These interactions are   |
|                   |                       | required to have been    |
|                   |                       | documented properly as   |
|                   |                       | part of the MPoC SDK     |
|                   |                       | validation. The process  |
|                   |                       | that this documentation  |
|                   |                       | outlines needs to be     |
|                   |                       | followed to ensure that  |
|                   |                       | the MPoC SDK provides    |
|                   |                       | the security features    |
|                   |                       | that are expected of it. |
|                   |                       |                          |
|                   |                       | Attestation needs to be  |
|                   |                       | an integral part of the  |
|                   |                       | MPoC SDK and MPoC        |
|                   |                       | Application flows. This  |
|                   |                       | means that initiating    |
|                   |                       | transactions, without    |
|                   |                       | having performed and     |
|                   |                       | passed attestation,      |
|                   |                       | needs to be prevented.   |
|                   |                       | This control may be      |
|                   |                       | enforced in the          |
|                   |                       | payment-processing       |
|                   |                       | environment (e.g., by    |
|                   |                       | requesting proof of      |
|                   |                       | successful attestation). |
|                   |                       |                          |
|                   |                       | The payment-processing   |
|                   |                       | environment is required  |
|                   |                       | to be aware when         |
|                   |                       | attestation is due, and  |
|                   |                       | not process data unless  |
|                   |                       | attestation has          |
|                   |                       | happened. It is required |
|                   |                       | that the MPoC            |
|                   |                       | Application becomes      |
|                   |                       | unable to transact if    |
|                   |                       | communication between    |
|                   |                       | the MPoC Application and |
|                   |                       | attestation API(s) is    |
|                   |                       | blocked. For offline use |
|                   |                       | cases, this requirement  |
|                   |                       | still applies. The MPoC  |
|                   |                       | Application needs to     |
|                   |                       | perform local            |
|                   |                       | attestation during       |
|                   |                       | offline periods and      |
|                   |                       | needs to ensure          |
|                   |                       | successful A&M           |
|                   |                       | connection and           |
|                   |                       | validation prior to any  |
|                   |                       | further payment          |
|                   |                       | processing when coming   |
|                   |                       | back online.             |
+-------------------+-----------------------+--------------------------+
|                   | **2A-1.5.b** The      |                          |
|                   | tester must test the  |                          |
|                   | A&M system by         |                          |
|                   | blocking the          |                          |
|                   | attestation from      |                          |
|                   | happening, either by  |                          |
|                   | tampering with the    |                          |
|                   | MPoC Application or   |                          |
|                   | the communication     |                          |
|                   | with the A&M backend  |                          |
|                   | and attempt to        |                          |
|                   | perform payments, and |                          |
|                   | verify that it is     |                          |
|                   | mandatory to perform  |                          |
|                   | attestation as        |                          |
|                   | required by the A&M   |                          |
|                   | policy.               |                          |
+-------------------+-----------------------+--------------------------+
| > **2A-1.6** The  | **2A-1.6.a** The      | Integration of multiple  |
| > MPoC            | tester must confirm   | MPoC SDKs is permitted,  |
| > Application     | through examination   | but increases the        |
| > does not        | and observation that  | complexity and potential |
| > integrate more  | the MPoC Application  | attack surface of the    |
| > than two MPoC   | does not integrate    | MPoC Application. To     |
| > SDKs.           | more than two MPoC    | limit the risk posed by  |
|                   | SDKs.                 | integration of multiple  |
|                   |                       | MPoC SDKs, no more than  |
|                   |                       | two may be integrated    |
|                   |                       | into a single MPoC       |
|                   |                       | Application.             |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **2A-1.7** The  | **2A-1.7.a** The      | During assessment to     |
| > MPoC            | tester must confirm   | Domain 1, it is          |
| > Application     | through examination   | established that the     |
| > does not        | and observation that  | MPoC SDK only outputs    |
| > implement, or   | the MPoC Application  | sensitive assets when    |
| > allow for, the  | does not implement or | that data is             |
| > decryption of   | allow for the         | appropriately protected  |
| > encrypted       | decryption of         | (e.g., through the use   |
| > sensitive       | sensitive assets      | of encryption). It is    |
| > assets output   | encrypted by the MPoC | important that the MPoC  |
| > by the MPoC     | SDK.                  | Application does not     |
| > SDK.            |                       | attempt to bypass this   |
|                   |                       | security, by             |
|                   |                       | implementing decryption  |
|                   |                       | functions to recover the |
|                   |                       | cleartext sensitive      |
|                   |                       | assets.                  |
+-------------------+-----------------------+--------------------------+
| > **2A-1.8** The  | **2A-1.8.a** Where    | An MPoC Application may  |
| > MPoC            | more than one MPoC    | integrate up to two MPoC |
| > Application     | SDK is integrated     | SDKs. However, in cases  |
| > does not share  | into an MPoC          | where this is done the   |
| > assets between  | Application, the      | MPoC SDKs must continue  |
| > different MPoC  | tester must confirm   | to operate independently |
| > SDKs.           | through examination   | of each other, even if   |
|                   | and observation that  | this leads to            |
|                   | assets are not shared | differences in user      |
|                   | between the different | experience.              |
|                   | MPoC SDKs.            |                          |
|                   |                       | Put another way, the     |
|                   |                       | existence or removal of  |
|                   |                       | one MPoC SDK should not  |
|                   |                       | impact the operation or  |
|                   |                       | security of another MPoC |
|                   |                       | SDK integrated into a    |
|                   |                       | single MPoC Application. |
+-------------------+-----------------------+--------------------------+
| > **2A-1.9** The  | **2A-1.9.a** The      | It is common for COTS    |
| > MPoC            | tester must confirm   | Platforms to require     |
| > Application is  | through examination   | that specific privileges |
| > assigned only   | that the MPoC         | are assigned to each     |
| > the privileges  | Application is        | application that         |
| > required for    | assigned only the     | executes on that         |
| > its secure      | privileges it         | platform. It is          |
| > operation.      | requires for secure   | important that the MPoC  |
|                   | operation.            | Application is only      |
|                   |                       | assigned those           |
|                   |                       | privileges it requires   |
|                   |                       | for secure operation.    |
+-------------------+-----------------------+--------------------------+
| > **2A-1.10** The | **2A-1.10.a** If the  | Even though an MPoC      |
| > MPoC            | tester is unable to   | Application may not be   |
| > Application is  | confirm through       | specifically designed to |
| > either unable   | examination and       | access MPoC assets such  |
| > to access any   | observation that the  | as cardholder PINs,      |
| > memory and      | MPoC Application is   | cryptographic keys, or   |
| > storage         | unable to access the  | account data, the        |
| > locations where | memory and storage    | implementation of the    |
| > MPoC assets may | locations used to     | MPoC SDK, or MPoC        |
| > be processed or | process or store MPoC | Application integrating  |
| > reside, or the  | assets, all further   | the MPoC SDK, may allow  |
| > requirements of | requirements in this  | for access to the memory |
| > Module 2B have  | Module must be        | or storage areas that    |
| > been met.       | assessed.             | contain these assets. In |
|                   |                       | these cases, compromise  |
|                   |                       | of the MPoC Application  |
|                   |                       | will result in exposure  |
|                   |                       | of these sensitive       |
|                   |                       | assets.                  |
+-------------------+-----------------------+--------------------------+

## Module 2B: MPoC Application Security

> This Module covers all security mechanisms required of MPoC
> Applications that share memory with, or have access to the memory of,
> the MPoC SDK they are integrating. This Module will always apply to
> monolithic MPoC Applications, and MPoC Applications that integrate a
> non- Isolating MPoC SDK. MPoC Applications that integrate an Isolating
> MPoC SDK, but do so in a way that compromises the isolation provided
> by that SDK, must also be assessed to the requirements of this Module.
>
> The MPoC Software security guidance, and MPoC Software listing,
> details if an MPoC SDK is an Isolating SDK or non-Isolating SDK.

### 2B-1 MPoC Application Security

> MPoC Applications that may be able to access MPoC SDK assets must be
> developed in line with security best practices for COTS device
> applications.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > MPoC            |                       |                          |
| > Applications    |                       |                          |
| > that could have |                       |                          |
| > access to       |                       |                          |
| > assets are      |                       |                          |
| > developed in    |                       |                          |
| > line with       |                       |                          |
| > security best   |                       |                          |
| > practice.       |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **2B-1.1** All  | **2B-1.1.a** When the | A non-Isolating SDK has  |
| > software in the | software is developed | not been validated to    |
| > MPoC            | by a PCI Secure       | provide sufficient       |
| > Application     | SLC-approved software | protection to its        |
| > must be either: | vendor, the tester    | assets. Compromise of an |
|                   | must confirm through  | MPoC Application that    |
| -   Developed by  | examination that the  | integrates a             |
|     a PCI SLC     | entity is listed on   | non-Isolated SDK can     |
|     Qualified     | the PCI website and   | therefore lead directly  |
|     Software      | is valid at the time  | to the compromise of the |
|     Vendor        | of evaluation (i.e.,  | MPoC SDK assets.         |
|                   | the listing has not   |                          |
| -   Comply with   | expired).             | Therefore, it is         |
|     all           |                       | important that any MPoC  |
|     requirements  |                       | Application that         |
|     in *[Appendix |                       | integrates a             |
|     D: Software   |                       | non-Isolated SDK is      |
|     Security](#   |                       | created using secure     |
| appendix-d-secure |                       | software development     |
| -software-lifecyc |                       | best practices. This     |
| le-requirements)* |                       | will help reduce the     |
|     [*Lifecycle   |                       | potential for            |
|                   |                       | vulnerabilities in the   |
|  Requirements*.]( |                       | MPoC Application,        |
| #appendix-d-secur |                       | increasing the security  |
| e-software-lifecy |                       | of the overall MPoC      |
| cle-requirements) |                       | Solution.                |
+-------------------+-----------------------+--------------------------+
|                   | **2B-1.1.b** When the |                          |
|                   | software is not       |                          |
|                   | developed by a PCI    |                          |
|                   | Secure SLC-approved   |                          |
|                   | software vendor, the  |                          |
|                   | tester must confirm   |                          |
|                   | through examination,  |                          |
|                   | observation, testing, |                          |
|                   | and interview that    |                          |
|                   | the requirements in   |                          |
|                   | *[Appendix D:         |                          |
|                   | Software              |                          |
|                   | Security](#appendix   |                          |
|                   | -d-secure-software-li |                          |
|                   | fecycle-requirements) |                          |
|                   | [Lifecycle            |                          |
|                   | Req                   |                          |
|                   | uirements](#appendix- |                          |
|                   | d-secure-software-lif |                          |
|                   | ecycle-requirements)* |                          |
|                   | are met.              |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **2B-1.2** The  | **2B-1.2.a** The      | The MPoC Application     |
| > MPoC            | tester must confirm   | installable package      |
| > Application     | through testing that  | needs to have its        |
| > data and code   | the modification      | authenticity protected.  |
| > must be         | (including            | This is normally a task  |
| > protected       | application rollback) | that the MPoC Software   |
| > against         | is detected by the    | cannot perform, as it    |
| > tampering       | MPoC Application and  | has no visibility on the |
| > (modification), | it is not possible to | integration part of the  |
| > including at    | perform transactions. | MPoC Application.        |
| > runtime, to an  |                       |                          |
| > attack rating   | If the modification   | The MPoC Application     |
| > of 25 points    | is detected, the      | binary code is required  |
| > using the       | tester must attempt   | to be resistant against  |
| > attack- costing | to bypass (i.e.,      | tampering. The MPoC      |
| > framework in    | disable or remove)    | Application is required  |
| > [*Appendix      | the tamper detection  | to implement controls to |
| > B*.](#ap        | code.                 | prevent modification of  |
| pendix-b-attack-c |                       | the MPoC Application     |
| osting-framework) |                       | installed on the COTS    |
| > Protections     |                       | device, including its    |
| > must include    |                       | configuration files, and |
| > controls to     |                       | binary code.             |
| > mitigate        |                       |                          |
| > attempts to     |                       | The MPoC Solution needs  |
| > perform         |                       | to prevent older and     |
| > rollback on the |                       | possibly vulnerable      |
| > MPoC            |                       | versions of the MPoC     |
| > Application or  |                       | Application from         |
| > COTS OS.        |                       | running. The version     |
|                   |                       | allowed to be used is    |
|                   |                       | controlled by the MPoC   |
|                   |                       | A&M backend, and         |
|                   |                       | validation of this       |
|                   |                       | functionality is         |
|                   |                       | performed in Module 1C.  |
|                   |                       |                          |
|                   |                       | A deprecated version is  |
|                   |                       | an older version not     |
|                   |                       | allowed to be            |
|                   |                       | operational in the field |
|                   |                       | due to being too old or  |
|                   |                       | compromised.             |
+-------------------+-----------------------+--------------------------+
|                   | **2B-1.2.b** The      |                          |
|                   | tester must provide a |                          |
|                   | costing of this       |                          |
|                   | attack based on the   |                          |
|                   | method outlined in    |                          |
|                   | *[Appendix            |                          |
|                   | B.](#appendix-b-attac |                          |
|                   | k-costing-framework)* |                          |
|                   | [*Attack Costing      |                          |
|                   | Framewor              |                          |
|                   | k*.](#appendix-b-atta |                          |
|                   | ck-costing-framework) |                          |
|                   | This requirement is   |                          |
|                   | passed if the most    |                          |
|                   | feasible attack       |                          |
|                   | cannot be costed for  |                          |
|                   | less than 25 points.  |                          |
+-------------------+-----------------------+--------------------------+

# Domain 3: Attestation and Monitoring

> These requirements cover the operational aspects of the A&M. If an A&M
> service provider wants to have its A&M Service listed independently
> from an MPoC Solution, the A&M service provider is responsible to
> ensure that the requirements in this Domain are met. When an MPoC
> Solution provider is not using an A&M service provider, the MPoC
> Solution provider is responsible to ensure that the requirements in
> this Domain are met.

## Module 3A: MPoC Software Security Guidance Compliance

> This Module covers the deployment and configuration of a certified
> attestation and monitoring software into the backend.
>
> ***Note:** This Module is applicable for composite solutions only.*

### 3A-1 Deployment and Configuration of Back-end Systems

> An MPoC Software product, when used, must be securely and correctly
> integrated into an overall MPoC Solution. This integration must follow
> the guidance provided by the MPoC Solution provider, as well as
> ensuring requirements of this standard are met for the integrated
> system.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > MPoC Software   |                       |                          |
| > back-end        |                       |                          |
| > systems, when   |                       |                          |
| > used, are       |                       |                          |
| > securely and    |                       |                          |
| > correctly       |                       |                          |
| > deployed and    |                       |                          |
| > configured.     |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **3A-1.1** When | **3A-1.1.a** The      | MPoC Solutions need to   |
| > an MPoC         | tester must confirm   | be evaluated in their    |
| > Software        | through examination   | entirety before listing. |
| > product is      | and observation that  | When an MPoC Software is |
| > used, the MPoC  | the version of the    | relied upon for some     |
| > Software        | MPoC Software used by | aspect of compliance,    |
| > product must be | the Attestation and   | that MPoC Software needs |
| > listed on the   | Monitoring Service    | to have been previously  |
| > PCI SSC         | provider is PCI       | assessed and approved.   |
| > website.        | approved.             |                          |
+-------------------+-----------------------+--------------------------+
| > **3A-1.2**      | **3A-1.2.a** The      | The MPoC Software        |
| > Back-end        | tester must confirm   | back-end system provides |
| > systems must be | through examination   | various security         |
| > deployed and    | and observation that  | services and functions   |
| > configured in   | the Attestation and   | to assist with the       |
| > accordance with | Monitoring Service    | overall compliance of    |
| > the MPoC        | provider has deployed | the MPoC Solution. To    |
| > Software        | and configured the    | ensure correct and       |
| > security        | back-end system in    | secure operation,        |
| > guidance.       | accordance with MPoC  | back-end attestation     |
|                   | Software security     | system and back- end     |
|                   | guidance.             | monitoring system need   |
|                   |                       | to be deployed and       |
|                   |                       | configured as intended.  |
+-------------------+-----------------------+--------------------------+
| > **3A-1.3** The  | **3A-1.3.a** The      | An MPoC Software is      |
| > Attestation and | tester must confirm   | evaluated and approved   |
| > Monitoring      | through examination   | based on the features    |
| > Service         | and observation that  | that it provides.        |
| > provider must   | the integration of    | Alteration or bypassing  |
| > not bypass,     | the MPoC Software did | of any of those features |
| > circumvent,     | not modify or         | may impact the security  |
| > re-implement,   | re-implement MPoC     | of the MPoC Software and |
| > or modify any   | Software features     | the MPoC Solution in     |
| > of the security | that are within the   | unexpected ways.         |
| > or operational  | MPoC Software         |                          |
| > features        | boundary.             |                          |
| > provided by     |                       |                          |
| > MPoC Software.  |                       |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **3A-1.4** The  | **3A-1.4.a** The      | The MPoC Software may be |
| > Attestation and | tester must confirm   | developed by an entity   |
| > Monitoring      | through examination   | different to that which  |
| > Service         | that the back-end     | deploys and operates the |
| > provider must   | A&Ms supports secure  | back-end attestation     |
| > have process in | updates according to  | system and back-end      |
| > place to detect | the MPoC Software     | monitoring system. Even  |
| > when their      | security guidance     | where the same entity    |
| > back-end        | document.             | develops and operates    |
| > systems require |                       | the back- end systems,   |
| > updates.        |                       | there may be separate    |
|                   |                       | teams or resources used  |
|                   |                       | for each.                |
|                   |                       |                          |
|                   |                       | To ensure that back-end  |
|                   |                       | systems remain up to     |
|                   |                       | date, the attestation    |
|                   |                       | monitoring service       |
|                   |                       | provider needs to have   |
|                   |                       | processes in place to    |
|                   |                       | monitor published        |
|                   |                       | updates and releases.    |
|                   |                       |                          |
|                   |                       | Although newly developed |
|                   |                       | systems may not yet have |
|                   |                       | a need to implement      |
|                   |                       | updates, the need to     |
|                   |                       | continually monitor for  |
|                   |                       | such need remains. It is |
|                   |                       | also expected that any   |
|                   |                       | A&M service provider     |
|                   |                       | will need to implement   |
|                   |                       | updates frequently to    |
|                   |                       | maintain the currency    |
|                   |                       | and security posture of  |
|                   |                       | their systems, and       |
|                   |                       | therefore even newly     |
|                   |                       | developed systems will   |
|                   |                       | require updates within a |
|                   |                       | short period of time.    |
+-------------------+-----------------------+--------------------------+
|                   | **3A-1.4.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the A&M service  |                          |
|                   | provider has a        |                          |
|                   | process to deliver    |                          |
|                   | updates in a timely   |                          |
|                   | manner, and this      |                          |
|                   | process is in         |                          |
|                   | demonstrable use.     |                          |
+-------------------+-----------------------+--------------------------+

## Module 3B: Baseline

> This Module contains requirements for the management of the COTS
> platform baseline.
>
> ***Note:** This Module is applicable to all A&M service providers,
> and/or monolithic MPoC Solution providers.*

### 3B-1 COTS Platform Baseline and Vulnerability Management

> The COTS platform baseline represents the COTS platforms (including
> both the physical device and the operating systems used) that are
> considered to provide sufficient security and features to allow for
> the installation and execution of the MPoC Application for the
> purposes of accepting payment transactions. This baseline must be
> managed as new security flaws, as well as updated and more secure
> versions of COTS platforms, are released.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The defined     |                       |                          |
| > COTS platform   |                       |                          |
| > baseline is     |                       |                          |
| > kept up to date |                       |                          |
| > with            |                       |                          |
| > developments    |                       |                          |
| > and changes to  |                       |                          |
| > COTS platforms. |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **3B-1.1** A    | **3B-1.1.a** The      | The COTS platform        |
| > COTS platform   | tester must confirm   | baseline outlines the    |
| > baseline must   | through examination   | COTS platforms on which  |
| > exist.          | and observation that  | the MPoC Application may |
|                   | a COTS platform       | execute and accept       |
|                   | baseline exists and   | payment transactions.    |
|                   | is validated by the   | The establishment and    |
|                   | A&M.                  | maintenance of this      |
|                   |                       | baseline must include    |
|                   |                       | the minimum set of       |
|                   |                       | features required of the |
|                   |                       | MPoC Software, both      |
|                   |                       | those outlined in this   |
|                   |                       | standard and those       |
|                   |                       | self-imposed by the MPoC |
|                   |                       | Solution itself.         |
|                   |                       |                          |
|                   |                       | The baseline may be      |
|                   |                       | instantiated in various  |
|                   |                       | ways and is expected to  |
|                   |                       | include use of both      |
|                   |                       | whitelist and specific   |
|                   |                       | block-list elements. For |
|                   |                       | example, a baseline may  |
|                   |                       | include accommodation    |
|                   |                       | for COTS devices with a  |
|                   |                       | specific OS version,     |
|                   |                       | except for those COTS    |
|                   |                       | devices that also have   |
|                   |                       | certain undesirable      |
|                   |                       | features (such as NFC    |
|                   |                       | logging, or insecure OS  |
|                   |                       | modifications).          |
|                   |                       |                          |
|                   |                       | The inclusion of any     |
|                   |                       | COTS device executing    |
|                   |                       | the MPoC Software must   |
|                   |                       | be validated by the A&M. |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **3B-1.2** A    | **3B-1.2.a** The      | The COTS platform        |
| > procedure for   | tester must confirm   | baseline is not static   |
| > managing the    | through examination   | and will change over     |
| > COTS platform   | that the COTS         | time. Therefore, a       |
| > baseline must   | platform baseline     | procedure is required be |
| > exist and be    | procedure exists. The | in place to manage the   |
| > demonstrably in | tester must examine   | existing baseline with   |
| > use.            | the procedure to      | respect to risks to the  |
|                   | verify that it        | solution.                |
|                   | contains at a         |                          |
|                   | minimum:              | There needs to be a      |
|                   |                       | clear process for        |
|                   | -   Roles and         | accepting platforms into |
|                   |     Responsibilities  | the COTS platform        |
|                   |     (e.g., who is     | baseline that ensures    |
|                   |     allowed to update | the MPoC Application can |
|                   |     the COTS platform | execute and perform its  |
|                   |     baseline).        | functions as intended    |
|                   |                       | and in a secure manner.  |
|                   | -   The acceptance    |                          |
|                   |     process and       | MPoC does not            |
|                   |     criteria for      | differentiate operating  |
|                   |     adding COTS       | systems as supported or  |
|                   |     platforms to the  | unsupported (by the OS   |
|                   |     COTS platform     | vendor). Instead, MPoC   |
|                   |     baseline (see     | requires that all        |
|                   |     next              | platforms are validated  |
|                   |     requirement).     | and secured regardless   |
|                   |                       | of any ongoing support,  |
|                   | -   How COTS          | or end of life of that   |
|                   |     platforms are     | OS.                      |
|                   |     added to the COTS |                          |
|                   |     platform          | An MPoC SDK that         |
|                   |     baseline.         | executes entirely        |
|                   |                       | outside of the REE of    |
|                   | -   How decisions are | the COTS device, may     |
|                   |     made to remove    | allow for rooted and     |
|                   |     previously        | jail-broken devices to   |
|                   |     acceptable COTS   | be included in the COTS  |
|                   |     platforms from    | platform baseline. In    |
|                   |     the COTS platform | such cases, it must be   |
|                   |     baseline. This    | confirmed that the MPoC  |
|                   |     must include a    | SDK does not allow for   |
|                   |     reference to the  | sensitive assets, such   |
|                   |     vulnerability     | as account data or       |
|                   |     management        | cryptographic keys, to   |
|                   |     process.          | be exposed in, passed    |
|                   |                       | through, or obtained     |
|                   | -   How affected      | from the REE.            |
|                   |     entities are      |                          |
|                   |     informed of       |                          |
|                   |     changes to the    |                          |
|                   |     COTS platform     |                          |
|                   |     baseline that     |                          |
|                   |     will affect them. |                          |
+-------------------+-----------------------+--------------------------+
|                   | **3B-1.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that  |                          |
|                   | the COTS platform     |                          |
|                   | baseline includes:    |                          |
|                   |                       |                          |
|                   | -   The COTS          |                          |
|                   |     platform's that   |                          |
|                   |     are supported.    |                          |
|                   |                       |                          |
|                   | -   Each supported    |                          |
|                   |     COTS platform     |                          |
|                   |     provides at a     |                          |
|                   |     minimum:          |                          |
|                   |                       |                          |
|                   |     -   An enforcing  |                          |
|                   |         mandatory     |                          |
|                   |         access        |                          |
|                   |         control       |                          |
|                   |         framework.    |                          |
|                   |                       |                          |
|                   |     -   A trusted     |                          |
|                   |         boot          |                          |
|                   |         mechanism     |                          |
|                   |         that          |                          |
|                   |         validates the |                          |
|                   |         OS            |                          |
|                   |         authenticity. |                          |
|                   |                       |                          |
|                   |     -   Validation of |                          |
|                   |         an            |                          |
|                   |         application   |                          |
|                   |         cryptographic |                          |
|                   |         signature     |                          |
|                   |         upon          |                          |
|                   |         installation  |                          |
|                   |         of            |                          |
|                   |         applications. |                          |
|                   |                       |                          |
|                   |     -   Isolation of  |                          |
|                   |         the           |                          |
|                   |         interfaces    |                          |
|                   |         and memory    |                          |
|                   |         spaces used   |                          |
|                   |         by different  |                          |
|                   |         applications. |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
|                   | **3B-1.2.c** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and observation that, |                          |
|                   | for any MPoC SDK that |                          |
|                   | executes in the REE,  |                          |
|                   | rooted or jailbroken  |                          |
|                   | COTS devices are not  |                          |
|                   | part of the COTS      |                          |
|                   | platform baseline.    |                          |
+-------------------+-----------------------+--------------------------+
|                   | **3B-1.2.d** The      |                          |
|                   | tester must confirm   |                          |
|                   | through observation   |                          |
|                   | and interview that    |                          |
|                   | the COTS platform     |                          |
|                   | baseline procedure is |                          |
|                   | actually executed.    |                          |
|                   | The required evidence |                          |
|                   | is an overview of     |                          |
|                   | changes to the COTS   |                          |
|                   | platform baseline.    |                          |
|                   | This must include a   |                          |
|                   | description of the    |                          |
|                   | changes, related      |                          |
|                   | change management     |                          |
|                   | tickets and           |                          |
|                   | communication to      |                          |
|                   | affected merchants.   |                          |
+-------------------+-----------------------+--------------------------+
| > **3B-1.3** The  | **3B-1.3.a** The      | It is intended that the  |
| > baseline COTS   | tester must confirm   | vendor identifies the    |
| > OS must be      | through examination,  | vulnerabilities that     |
| > regularly and   | observation, and      | affect the system        |
| > frequently      | interview that        | baseline.                |
| > reviewed for    | vulnerabilities in    |                          |
| >                 | the COTS OS are       | It is expected that not  |
|  vulnerabilities. | analyzed periodically | all platform             |
|                   | and assessed known    | vulnerabilities will     |
|                   | and unknown           | result in risk to MPoC   |
|                   | vulnerabilities.      | Solutions, but a process |
|                   |                       | to determine if this is  |
|                   |                       | the case needs to be     |
|                   |                       | implemented. It is not   |
|                   |                       | sufficient for           |
|                   |                       | vulnerabilities to be    |
|                   |                       | dismissed without        |
|                   |                       | appropriate research and |
|                   |                       | testing.                 |
|                   |                       |                          |
|                   |                       | Not all vulnerabilities  |
|                   |                       | that affect platforms    |
|                   |                       | within the COTS baseline |
|                   |                       | require specific         |
|                   |                       | mitigations.             |
|                   |                       | Vulnerabilities that are |
|                   |                       | not directly exploitable |
|                   |                       | or cannot result in      |
|                   |                       | exposure or risk to the  |
|                   |                       | MPoC Solution assets may |
|                   |                       | be considered and        |
|                   |                       | mitigations deferred     |
|                   |                       | until increased risk is  |
|                   |                       | noted.                   |
|                   |                       |                          |
|                   |                       | Security review of the   |
|                   |                       | COTS OS requires both    |
|                   |                       | threat detection and     |
|                   |                       | mitigation, as well as   |
|                   |                       | vulnerability detection  |
|                   |                       | and mitigation. This may |
|                   |                       | include detailed review  |
|                   |                       | of each                  |
+-------------------+-----------------------+--------------------------+
|                   | **3B-1.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination,  |                          |
|                   | observation, and      |                          |
|                   | interview that the    |                          |
|                   | identified            |                          |
|                   | vulnerabilities are   |                          |
|                   | mitigated through     |                          |
|                   | updates to the MPoC   |                          |
|                   | Application or A&M,   |                          |
|                   | in the process of     |                          |
|                   | having mitigations    |                          |
|                   | implemented, or are   |                          |
|                   | identified as having  |                          |
|                   | no security impact.   |                          |
|                   | The required evidence |                          |
|                   | is:                   |                          |
|                   |                       |                          |
|                   | -   Recent overview   |                          |
|                   |     of assessed       |                          |
|                   |     vulnerabilities   |                          |
|                   |     including         |                          |
|                   |     verdict.          |                          |
|                   |                       |                          |
|                   | -   List of mitigated |                          |
|                   |     vulnerabilities.  |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
|                   | **3B-1.3.c** The      | CVE for all supported    |
|                   | tester must confirm   | platforms (in addition   |
|                   | through examination,  | to other measures to     |
|                   | observation, and      | identify unknown         |
|                   | interview that the    | vulnerabilities), or it  |
|                   | frequency of the      | may instead be           |
|                   | vulnerability review  | implemented through a    |
|                   | process is based on   | combination of focused   |
|                   | an informed risk      | review of known          |
|                   | decision and is no    | vulnerabilities and      |
|                   | greater than every 3  | robust periodic testing. |
|                   | months.               |                          |
|                   |                       | For example, use of      |
|                   |                       | regular and focused      |
|                   |                       | penetration testing by   |
|                   |                       | mobile security experts  |
|                   |                       | instead of review of     |
|                   |                       | each individual CVE may  |
|                   |                       | be sufficient if (i) the |
|                   |                       | testing is able to show  |
|                   |                       | the efficacy of the      |
|                   |                       | security mechanisms,     |
|                   |                       | (ii) there remains a     |
|                   |                       | continuous monitoring of |
|                   |                       | the security landscape   |
|                   |                       | in between penetration   |
|                   |                       | tests.                   |
+-------------------+-----------------------+--------------------------+
| > **3B-1.4**      | **3B-1.4.a** The      | The A&Ms are a           |
| > Personnel       | tester must confirm   | combination of automated |
| > involved in     | through examination,  | and manual features.     |
| > maintaining the | observation, and      | Although the A&M         |
| > operation of    | interview that the    | software may be          |
| > the A&M must be | personnel involved    | developed and maintained |
| > appropriately   | with the operation of | by a third party (the    |
| > skilled.        | the A&M are           | MPoC Software vendor),   |
|                   | appropriately         | the operation of this    |
|                   | skilled. This must    | software will require    |
|                   | include personnel     | personnel who are        |
|                   | skilled with the      | sufficiently skilled in  |
|                   | security of the COTS  | the platforms used. As   |
|                   | platforms used in the | the security of COTS     |
|                   | baseline.             | platforms is a rapidly   |
|                   |                       | evolving field, ongoing  |
|                   |                       | training or research is  |
|                   |                       | expected for the         |
|                   |                       | personnel operating the  |
|                   |                       | A&Ms.                    |
+-------------------+-----------------------+--------------------------+

## Module 3C: Attestation and Monitoring

> This Module contains requirements for the operation of the attestation
> & monitoring service.

### 3C-1 Attestation and Monitoring Policy

> The attestation and monitoring system policy defines what data types
> are collected during the attestation process, and how this data is to
> be interpreted and managed through the attestation and monitoring
> components of the MPoC Software.

+-------------------+---------------------------+----------------------+
| > **Security      | > **Test Requirements**   | > **Guidance**       |
| > Requirements**  |                           |                      |
+===================+===========================+======================+
| > **Objective:**  |                           |                      |
| > The COTS        |                           |                      |
| > devices used    |                           |                      |
| > provide a       |                           |                      |
| > secure and      |                           |                      |
| > trustworthy     |                           |                      |
| > execution       |                           |                      |
| > environment.    |                           |                      |
+-------------------+---------------------------+----------------------+
| > **3C-1.1** A    | **3C-1.1.a** The tester   | The attestation      |
| > documented      | must confirm through      | policy outlines what |
| > attestation     | examination that an       | the requirements are |
| > policy must     | attestation policy exists | to ensure that any   |
| > exist and be    | and includes the          | COTS device          |
| > demonstrably in | following topics at a     | executing the MPoC   |
| > use.            | minimum:                  | Software provides a  |
|                   |                           | secure execution     |
|                   | -   Roles and             | environment for the  |
|                   |     responsibilities.     | MPoC Software.       |
|                   |                           |                      |
|                   | -   Data collected during | The attestation      |
|                   |     attestation*.*        | policy differs from  |
|                   |                           | the MPoC Software    |
|                   | -   Risk rating of        | guidance documents   |
|                   |     attestation data.     | referenced in        |
|                   |                           | requirement 3A-x in  |
|                   | -   Follow-up actions and | that it defines the  |
|                   |     time frames when      | appropriate          |
|                   |     attestation data seem | responses and        |
|                   |     to suggest a tampered | actions to be        |
|                   |     component.            | performed with       |
|                   |                           | respect to the       |
|                   | -   References to         | output of the A&M    |
|                   |     specific procedures   | system.              |
|                   |     and/or work           |                      |
|                   |     instructions.         | A monolithic MPoC    |
|                   |                           | Solution may not     |
|                   |                           | include MPoC         |
|                   |                           | Software guidance,   |
|                   |                           | as it is developed   |
|                   |                           | and deployed         |
|                   |                           | entirely in-house.   |
|                   |                           | However, all         |
|                   |                           | attestation and      |
|                   |                           | monitoring systems   |
|                   |                           | will always have an  |
|                   |                           | attestation policy   |
|                   |                           | that defines how the |
|                   |                           | A&M system operates, |
|                   |                           | the roles and        |
|                   |                           | responsibilities of  |
|                   |                           | those using or on an |
|                   |                           | escalation path, how |
|                   |                           | risks are ranked,    |
|                   |                           | etc.                 |
|                   |                           |                      |
|                   |                           | Put another way, the |
|                   |                           | requirements in 3A-x |
|                   |                           | consider how the A&M |
|                   |                           | system is configured |
|                   |                           | and deployed, and    |
|                   |                           | the requirements in  |
|                   |                           | this Section         |
|                   |                           | consider how the A&M |
|                   |                           | system is to be used |
|                   |                           | and operated.        |
+-------------------+---------------------------+----------------------+
|                   | **3C-1.1.b** The tester   |                      |
|                   | must confirm through      |                      |
|                   | examination that the      |                      |
|                   | attestation component is  |                      |
|                   | configured according to   |                      |
|                   | the attestation policy    |                      |
|                   | and attestation and       |                      |
|                   | monitoring (A&M)          |                      |
|                   | integration requirements  |                      |
|                   | for the MPoC Software.    |                      |
+-------------------+---------------------------+----------------------+
|                   | **3C-1.1.c** The tester   |                      |
|                   | must confirm through      |                      |
|                   | examination, observation, |                      |
|                   | and interview that the    |                      |
|                   | configuration is verified |                      |
|                   | periodically.             |                      |
+-------------------+---------------------------+----------------------+

+-------------------+---------------------------+----------------------+
| > **Security      | > **Test Requirements**   | > **Guidance**       |
| > Requirements**  |                           |                      |
+===================+===========================+======================+
| > **3C-1.2** If   | **3C-1.2.a** The tester   | Attestation and      |
| > the MPoC        | must confirm through      | monitoring functions |
| > Software        | examination that an       | provided to MPoC     |
| > supports        | Offline Attestation       | Solutions that allow |
| > offline         | Policy exists and it      | for offline          |
| > transactions,   | includes at a minimum:    | transactions need to |
| > the documented  |                           | account for the      |
| > attestation     | -   Checks are enabled    | potential operation  |
| > policy must     |     when operating in     | of those systems     |
| > contain an      |     offline mode.         | while they are       |
| > explicit        |                           | disconnected from    |
| > offline         | -   The responses when a  | the A&M back-end     |
| > operation mode. |     security check is     | systems.             |
|                   |     triggered.            |                      |
|                   |                           | Section 1F of this   |
|                   | -   Requirements for      | standard details     |
|                   |     escalation are noted  | requirements for the |
|                   |     when offline          | MPoC Software when   |
|                   |     transaction           | operating in offline |
|                   |     processing violates   | mode. This includes  |
|                   |     the requirements of   | preventing offline   |
|                   |     Section 1F.           | acceptance for more  |
|                   |                           | than 48 hours,       |
|                   |                           | requiring online     |
|                   |                           | attestation to be    |
|                   |                           | performed prior to   |
|                   |                           | enablement of        |
|                   |                           | offline mode, as     |
|                   |                           | well as other        |
|                   |                           | requirements. It is  |
|                   |                           | important that the   |
|                   |                           | offline A&M policy   |
|                   |                           | outlines the         |
|                   |                           | escalation path      |
|                   |                           | required if any of   |
|                   |                           | these functions of   |
|                   |                           | the MPoC Software    |
|                   |                           | are found to have    |
|                   |                           | been somehow         |
|                   |                           | bypassed or          |
|                   |                           | violated.            |
+-------------------+---------------------------+----------------------+
|                   | **3C-1.2.b** The tester   |                      |
|                   | must confirm through      |                      |
|                   | examination, observation, |                      |
|                   | and interview that the    |                      |
|                   | configuration is verified |                      |
|                   | periodically.             |                      |
+-------------------+---------------------------+----------------------+
| > **3C-1.3** If   | **3C-1.3.a** The tester   |                      |
| > offline         | must confirm through      |                      |
| > operation is    | examination and           |                      |
| > implemented,    | observation and interview |                      |
| > the offline     | that the offline          |                      |
| > attestation     | provisions in the         |                      |
| > policy must be  | attestation policy are    |                      |
| > followed.       | enacted and followed for  |                      |
|                   | any system operating in   |                      |
|                   | offline mode.             |                      |
+-------------------+---------------------------+----------------------+

### 3C-2 Monitoring

> Attestation data must be analyzed for signs of potential attack or
> tampering attempts. This monitoring process is an integral part of a
> whole attestation and monitoring solution and must be performed in a
> secure and repeatable manner.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Attestation     |                       |                          |
| > data is         |                       |                          |
| > analyzed, and   |                       |                          |
| > signs of        |                       |                          |
| > potential       |                       |                          |
| > attack are      |                       |                          |
| > consistently    |                       |                          |
| > responded to in |                       |                          |
| > a way that      |                       |                          |
| > maintains the   |                       |                          |
| > security and    |                       |                          |
| > integrity of    |                       |                          |
| > the MPoC        |                       |                          |
| > Solution.       |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **3C-2.1**      | **3C-2.1.a** The      | A clear and thorough     |
| > There must be   | tester must confirm   | understanding of the     |
| > an overview of  | through examination   | components used in the   |
| > the MPoC        | that a list of all    | solution, and how they   |
| > Solution being  | components that are   | are being monitored, is  |
| > monitored.      | included in the       | vital. This includes the |
|                   | monitoring process    | identification of both   |
|                   | exists and contains   | OS versions, and COTS    |
|                   | references to how     | device types, as the     |
|                   | these are integrated  | security posture of each |
|                   | into the A&M. This is | individual platform may  |
|                   | required to include   | have an impact on the    |
|                   | at least:             | security of payment      |
|                   |                       | processing. For example, |
|                   | -   The platforms     | some platforms may       |
|                   |     supported and     | implement logging of     |
|                   |     operated          | NFC, or touch data at    |
|                   |                       | the OS level, or may     |
|                   | -   MPoC Application  | provide system           |
|                   |     and MPoC SDK (if  | applications with higher |
|                   |     used)             | level privileges that    |
|                   |                       | could result in the      |
|                   | -   Any attached card | compromise of account    |
|                   |     reading devices   | data.                    |
|                   |                       |                          |
|                   |                       | It is not a requirement  |
|                   |                       | that all platforms of    |
|                   |                       | concern are prevented    |
|                   |                       | from accepting payments, |
|                   |                       | but such platforms may   |
|                   |                       | be required to undergo   |
|                   |                       | additional or enhanced   |
|                   |                       | A&M checks to verify     |
|                   |                       | their secure status.     |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **3C-2.2** A    | **3C-2.2.a** The      | This requirement ensures |
| > documented      | tester must confirm   | common understanding for |
| > operational     | through examination   | those involved in the    |
| > procedure for   | that monitoring       | monitoring of the        |
| > monitoring must | procedures exist and  | solution. The monitoring |
| > exist and be    | that they contain the | process may include both |
| > demonstrably in | necessary             | manual and automated     |
| > use.            | information. The      | aspects.                 |
|                   | monitoring procedure  |                          |
|                   | needs to include at a |                          |
|                   | minimum the following |                          |
|                   | topics:               |                          |
|                   |                       |                          |
|                   | -   Definition of     |                          |
|                   |     possible events   |                          |
|                   |     (warning alerts,  |                          |
|                   |     errors, etc.)     |                          |
|                   |     from the          |                          |
|                   |     monitoring        |                          |
|                   |     system.           |                          |
|                   |                       |                          |
|                   | -   How specific      |                          |
|                   |     events are        |                          |
|                   |     processed.        |                          |
|                   |                       |                          |
|                   | -   How undocumented, |                          |
|                   |     unexpected, and   |                          |
|                   |     unknown events    |                          |
|                   |     are handled.      |                          |
|                   |                       |                          |
|                   | -   When and how      |                          |
|                   |     events are        |                          |
|                   |     escalated and     |                          |
|                   |     when the incident |                          |
|                   |     management        |                          |
|                   |     process is        |                          |
|                   |     initiated.        |                          |
|                   |                       |                          |
|                   | -   How it is ensured |                          |
|                   |     that personnel    |                          |
|                   |     are qualified to  |                          |
|                   |     handle events.    |                          |
|                   |                       |                          |
|                   | -   References to     |                          |
|                   |     work instructions |                          |
|                   |     for the actual    |                          |
|                   |     MPoC Software     |                          |
|                   |     used.             |                          |
+-------------------+-----------------------+--------------------------+
|                   | **3C-2.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through observation   |                          |
|                   | and interview that    |                          |
|                   | the monitoring        |                          |
|                   | procedures are        |                          |
|                   | actually executed.    |                          |
|                   | The required evidence |                          |
|                   | is an overview of     |                          |
|                   | events that have been |                          |
|                   | managed. Information  |                          |
|                   | about events must     |                          |
|                   | include date, time,   |                          |
|                   | description, and      |                          |
|                   | follow up action.     |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **3C-2.3** The  | **3C-2.3.a** The      | The A&M provides         |
| > A&M results     | tester must confirm   | "health" checks of the   |
| > must be made    | through examination   | COTS platform and MPoC   |
| > available to    | and observation that  | Application to ensure    |
| > the payment     | the A&M provides for  | the secure operation of  |
| > processing      | an indication of A&M  | the MPoC Solution. When  |
| > backend.        | results to the        | the attestation and      |
|                   | payment processing    | monitoring (A&M) checks  |
|                   | backend.              | indicate that there may  |
|                   |                       | be a problem with any    |
|                   |                       | MPoC Application or COTS |
|                   |                       | platform, the A&M        |
|                   |                       | provides that            |
|                   |                       | information to the       |
|                   |                       | payment processing       |
|                   |                       | backend so that the      |
|                   |                       | continued operation of   |
|                   |                       | that specific MPoC       |
|                   |                       | Application can be       |
|                   |                       | determined.              |
|                   |                       |                          |
|                   |                       | In cases where there is  |
|                   |                       | sufficient information   |
|                   |                       | indicating that the MPoC |
|                   |                       | Application is at risk   |
|                   |                       | of compromise, the       |
|                   |                       | payment processing       |
|                   |                       | backend needs to be      |
|                   |                       | informed so that payment |
|                   |                       | processing for that MPoC |
|                   |                       | Application can be       |
|                   |                       | stopped.                 |
|                   |                       |                          |
|                   |                       | Due to the risk of       |
|                   |                       | compromise and           |
|                   |                       | interception on the COTS |
|                   |                       | platform, signals that   |
|                   |                       | may indicate risk of     |
|                   |                       | compromise of the MPoC   |
|                   |                       | Application or COTS      |
|                   |                       | platform need to be sent |
|                   |                       | to the payment           |
|                   |                       | processing backend       |
|                   |                       | directly.                |
|                   |                       |                          |
|                   |                       | This requirement does    |
|                   |                       | not dictate how the      |
|                   |                       | attestation and          |
|                   |                       | monitoring (A&M) results |
|                   |                       | are communicated, but    |
|                   |                       | does require that the    |
|                   |                       | results are current and  |
|                   |                       | relevant for the         |
|                   |                       | purposes of determining  |
|                   |                       | risk to ongoing          |
|                   |                       | transaction processing   |
|                   |                       | (as attestation results  |
|                   |                       | may not be indicative of |
|                   |                       | a clear pass/fail        |
|                   |                       | result, so risk-based    |
|                   |                       | decisions may be         |
|                   |                       | required).               |
|                   |                       |                          |
|                   |                       | A&M results may be       |
|                   |                       | provided to the payment  |
|                   |                       | processing backend by    |
|                   |                       | programmatic or          |
|                   |                       | operational methods.     |
+-------------------+-----------------------+--------------------------+

## Module 3D: Operational Security

> This Module contains the requirements regarding the operational
> security of the A&M back-end systems.

### 3D-1 Operational Management

> This Section covers the operational management of the A&M solution.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > A&M assets      |                       |                          |
| > processed in    |                       |                          |
| > back-end        |                       |                          |
| > environments    |                       |                          |
| > are secured     |                       |                          |
| > according to    |                       |                          |
| > their           |                       |                          |
| > protection      |                       |                          |
| > types.          |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **3D-1.1** When | **3D-1.1.a** When     | All systems that store,  |
| > account data is | account data is       | process, and/or transmit |
| > stored,         | stored, processed, or | account data need to be  |
| > processed,      | transmitted through   | compliant to the         |
| > and/or          | the A&M back-end      | requirements of PCI DSS. |
| > transmitted     | systems, the tester   | As attestation and       |
| > through the A&M | must confirm through  | monitoring systems are   |
| > back-end        | examination that the  | also used to control and |
| > systems, that   | environment is        | manage the security of   |
| > environment     | compliant to the      | the COTS payment         |
| > must be         | requirements of PCI   | acceptance systems,      |
| > compliant to    | DSS DESV.             | additional controls are  |
| > the             |                       | required for any A&M     |
| > requirements of |                       | environment that is not  |
| > PCI DSS DESV.   |                       | sufficiently isolated    |
|                   |                       | from the cardholder data |
|                   |                       | environment. These       |
|                   |                       | requirements apply in    |
|                   |                       | form of PCI DSS DESV     |
|                   |                       | controls, which are in   |
|                   |                       | addition to (or as a     |
|                   |                       | supplement to, where     |
|                   |                       | appropriate) other PCI   |
|                   |                       | DSS controls that may    |
|                   |                       | already apply.           |
|                   |                       |                          |
|                   |                       | Validation of PCI DSS    |
|                   |                       | DESV compliance may      |
|                   |                       | include an assessment by |
|                   |                       | qualified personnel      |
|                   |                       | during the MPoC          |
|                   |                       | assessment, or review of |
|                   |                       | an existing AOC. In all  |
|                   |                       | cases, the scope of the  |
|                   |                       | assessment is to include |
|                   |                       | the systems and          |
|                   |                       | environments involved in |
|                   |                       | the MPoC Solution.       |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **3D-1.2** When | **3D-1.2.a** The      | When the back-end A&Ms   |
| > the back-end    | tester must confirm   | are isolated             |
| > A&Ms, are       | through examination,  | sufficiently from the    |
| > sufficiently    | observation, and      | cardholder data          |
| > isolated from   | interview that        | environment, which is    |
| > any other       | account data is not   | used to process account  |
| > systems that    | stored, processed, or | data, it is not a        |
| > store, process, | transmitted through   | requirement that the A&M |
| > and/or transmit | the back-end A&Ms,    | systems also be          |
| > account data,   | and that the A&Ms are | compliant to PCI DSS.    |
| > the A&M         | sufficiently isolated | However, security        |
| > environment     | from any such account | controls are still       |
| > must comply     | data processing       | required in the          |
| > with the        | systems.              | attestation and          |
| > relevant        |                       | monitoring (A&M)         |
| > requirements    |                       | environment, so          |
| > defined in      |                       | assessment must be made  |
| > *[Appendix      |                       | against the requirements |
| > A               |                       | provided in the          |
| :](#_bookmark102) |                       | *[                       |
| > [Back-end       |                       | Appendix](#_bookmark102) |
| > Environmen      |                       | [A:](#_bookmark102)*     |
| t](#_bookmark102) |                       | [*Back-end Environment   |
| > [Security       |                       | Security                 |
| > Requirements    |                       | Requirements*.](#append  |
| ](#_bookmark102)* |                       | ix-a-back-end-environmen |
| > .               |                       | t-security-requirements) |
|                   |                       |                          |
|                   |                       | Although not PCI DSS, it |
|                   |                       | is expected that         |
|                   |                       | assessment to *[Appendix |
|                   |                       | A](#_bookmark102)* is    |
|                   |                       | performed with           |
|                   |                       | appropriately skilled    |
|                   |                       | and experienced          |
|                   |                       | individuals. On-site     |
|                   |                       | assessment is to be      |
|                   |                       | included where           |
|                   |                       | appropriate with         |
|                   |                       | consideration for any    |
|                   |                       | remote assessment        |
|                   |                       | guidance that may also   |
|                   |                       | exist.                   |
|                   |                       |                          |
|                   |                       | Appropriate separation   |
|                   |                       | may include isolation    |
|                   |                       | through networking       |
|                   |                       | controls to prevent the  |
|                   |                       | routing or access to     |
|                   |                       | account data from the    |
|                   |                       | attestation and          |
|                   |                       | monitoring (A&M)         |
|                   |                       | environment, or use of   |
|                   |                       | cryptographic controls   |
|                   |                       | (e.g., encryption of     |
|                   |                       | account data passed      |
|                   |                       | through the A&M          |
|                   |                       | environment, with no     |
|                   |                       | access to the decryption |
|                   |                       | keys or functions from   |
|                   |                       | within that              |
|                   |                       | environment).            |
+-------------------+-----------------------+--------------------------+
|                   | **3D-1.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination,  |                          |
|                   | observation, and      |                          |
|                   | interview that the    |                          |
|                   | back-end A&Ms comply  |                          |
|                   | with the relevant     |                          |
|                   | requirements defined  |                          |
|                   | in *[Appendix         |                          |
|                   | A:](#_bookmark102)    |                          |
|                   | [Bac                  |                          |
|                   | k-end](#appendix-a-ba |                          |
|                   | ck-end-environment-se |                          |
|                   | curity-requirements)* |                          |
|                   | [*Environment         |                          |
|                   | Security              |                          |
|                   | Requirem              |                          |
|                   | ents*.](#appendix-a-b |                          |
|                   | ack-end-environment-s |                          |
|                   | ecurity-requirements) |                          |
+-------------------+-----------------------+--------------------------+
| > **3D-1.3** When | **3D-1.3.a** The      | The specifics of how any |
| > the A&M service | tester must confirm   | segregation is actually  |
| > provider        | through examination   | implemented is based on  |
| > supports more   | and observation that  | a risk assessment. This  |
| > than one MPoC   | the assets of the     | requirement does not     |
| > Solution, the   | different MPoC        | preclude the pooling of  |
| > assets of the   | Solution providers    | anonymized attestation   |
| > different MPoC  | are segregated when   | data obtained from       |
| > Solution        | operated by a single  | different MPoC Solution  |
| > providers must  | A&M service provider. | providers for the        |
| > be segregated.  |                       | purposes of increasing   |
|                   |                       | the efficacy of the A&M  |
|                   |                       | detection mechanisms.    |
|                   |                       |                          |
|                   |                       | Penetration testing of   |
|                   |                       | the A&M service provider |
|                   |                       | environment is required  |
|                   |                       | as part of PCI DSS DESV, |
|                   |                       | or *[Appendix            |
|                   |                       | A](#_bookmark102)*       |
|                   |                       | validation.              |
+-------------------+-----------------------+--------------------------+
|                   | **3D-1.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | and interview that    |                          |
|                   | the implemented       |                          |
|                   | segregation controls  |                          |
|                   | included in the scope |                          |
|                   | of the A&M            |                          |
|                   | penetration testing   |                          |
|                   | process.              |                          |
+-------------------+-----------------------+--------------------------+

# Domain 4: MPoC Software Management

> The security requirements and test requirements in this Domain cover
> the operational management of the software and key management aspects
> of the MPoC Software. This Domain must be implemented by at least one
> entity in the MPoC Solution, and there may be multiple entities who
> are required to comply with these requirements. For example, a
> monolithic MPoC Solution would require that the MPoC Solution provider
> is solely responsible for meeting the requirements of this Domain.
> Alternatively, an MPoC Solution may implement a separately listed A&M
> service provider that has been separately assessed to the requirements
> of this Domain.

## Module 4A: Software Management

> This Module contains the requirements for the secure operation and
> management of the software used in an MPoC Solution. This includes any
> MPoC SDK, A&M Software, and MPoC Application(s).

### 4A-1 COTS Software Distribution and Updates

> Software that is to be installed and executed on the COTS device for
> an MPoC Solution needs to be compliant to this Section. This includes
> the MPoC Application that integrates the MPoC SDK, or the MPoC SDK
> itself if it is instantiated and distributed as a stand- alone MPoC
> Application. Unlike Domain 2 of this standard, which covers the
> development and software of the MPoC Application, this Section covers
> the operational aspects of distributing and maintaining an MPoC
> Application. This includes any ongoing key management requirements, as
> well as the requirements for the secure distribution of the MPoC
> Application(s).
>
> These requirements do not dictate any specific type of distribution
> method for the MPoC Application, such as a dedicated OS Store, but
> they do outline the minimum requirements that any method used to
> distribute the MPoC Application must meet. This includes any initial
> loading of an MPoC Application to a COTS Platform as part of the
> manufacturing or pre-sales provisioning of that COTS platform.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Software is     |                       |                          |
| > securely        |                       |                          |
| > provisioned to, |                       |                          |
| > and maintained  |                       |                          |
| > on, the COTS    |                       |                          |
| > device.         |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **4A-1.1**      | **4A-1.1.a** The      | The protection of the    |
| > Information     | tester must confirm   | MPoC Application during  |
| > about how       | through examination   | the provisioning         |
| > software is     | that the information  | lifecycle stage is       |
| > provisioned     | provided includes at  | needed to prevent the    |
| > securely to the | a minimum:            | distribution of a        |
| > supported COTS  |                       | malicious MPoC           |
| > devices must    | -   The supported     | Application.             |
| > exist.          |     MPoC Application  |                          |
|                   |     distribution      | Documentation covering   |
|                   |     methods.          | the MPoC Application     |
|                   |                       | distribution, and        |
|                   | -   How the MPoC      | provisioning helps to    |
|                   |     Application       | identify vulnerabilities |
|                   |     distribution      | in this stage of the     |
|                   |     methods supported | MPoC Software lifecycle. |
|                   |     are protected.    |                          |
|                   |     How access to     | The MPoC Application     |
|                   |     MPoC Application  | distribution method may  |
|                   |     distribution      | include the OS store of  |
|                   |     methods is        | the COTS device, or an   |
|                   |     protected (for    | MDM solution. Regardless |
|                   |     the purposes of   | of what method is used,  |
|                   |     uploading or      | MPoC Applications are to |
|                   |     changing security | be distributed in a      |
|                   |     sensitive         | secure manner, and in a  |
|                   |     settings).        | way that protects their  |
|                   |                       | integrity and            |
|                   | -   How the data      | authenticity.            |
|                   |     provisioned after |                          |
|                   |     the MPoC          | Attackers may attempt to |
|                   |     Application is    | alter MPoC Application   |
|                   |     installed and the | updates as they are      |
|                   |     purpose of that   | transferred to a COTS    |
|                   |     data. This        | device, or by altering   |
|                   |     includes          | the MPoC Application     |
|                   |     executable files  | file in the store prior  |
|                   |     and configuration | to distribution. In      |
|                   |     files.            | cases where the MPoC     |
|                   |                       | Application vendor is    |
|                   |                       | unable to verify or      |
|                   |                       | validate sufficient      |
|                   |                       | security in any          |
|                   |                       | particular distribution  |
|                   |                       | method, an alternative   |
|                   |                       | method of distribution   |
|                   |                       | is to be used.           |
|                   |                       |                          |
|                   |                       | COTS platforms that are  |
|                   |                       | not able to provide any  |
|                   |                       | method for MPoC          |
|                   |                       | Application distribution |
|                   |                       | that is sufficiently     |
|                   |                       | secure are not suitable  |
|                   |                       | for use.                 |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-1.2** The  | **4A-1.2.a** The      | The authenticity of the  |
| > MPoC            | tester must confirm   | MPoC Application is a    |
| > Application     | through examination   | paramount concern in     |
| > must be         | and observation that  | securing account data.   |
| > installable and | it is not possible to | Loading of applications  |
| > updatable       | perform transactions  | from the OS store        |
| > exclusively     | on an MPoC            | provides a level of      |
| > through the     | Application loaded    | confidence that the      |
| > defined COTS    | onto the COTS device  | application has not been |
| > application     | through means other   | tampered with before     |
| > distribution    | than the defined COTS | being installed on the   |
| > methods.        | application           | merchant COTS device.    |
|                   | distribution methods. |                          |
|                   |                       | In some OSs, it is       |
|                   |                       | possible to perform      |
|                   |                       | "side-loading" of        |
|                   |                       | applications -- that is, |
|                   |                       | install them separate to |
|                   |                       | the normal application   |
|                   |                       | distribution methods and |
|                   |                       | controls -- at any time  |
|                   |                       | by configuring the COTS  |
|                   |                       | device to allow for this |
|                   |                       | process. In other OSs,   |
|                   |                       | it may be necessary to   |
|                   |                       | establish a developer    |
|                   |                       | account or perform some  |
|                   |                       | other actions on the     |
|                   |                       | COTS device to allow for |
|                   |                       | loading of applications  |
|                   |                       | outside the distribution |
|                   |                       | store formally supported |
|                   |                       | by the MPoC Solution.    |
|                   |                       |                          |
|                   |                       | It is necessary to       |
|                   |                       | outline what processes   |
|                   |                       | are available to bypass  |
|                   |                       | the supported store(s)   |
|                   |                       | and confirm that these   |
|                   |                       | methods do not allow for |
|                   |                       | the loading of an MPoC   |
|                   |                       | Application that will    |
|                   |                       | operate normally.        |
+-------------------+-----------------------+--------------------------+
| > **4A-1.3** The  | **4A-1.3.a** The      | To distribute an MPoC    |
| > interface to    | tester must confirm   | Application, it must     |
| > each of the     | through examination   | first be distributed to  |
| > implemented     | that controls are     | a COTS application       |
| > MPoC            | implemented to        | distribution method. The |
| > Application     | prevent the           | upload access that MPoC  |
| > distribution    | compromise of any     | Application vendors have |
| > methods must be | MPoC Application      | with the COTS            |
| > protected.      | distribution channels | application distribution |
|                   | used.                 | method is required to be |
|                   |                       | protected to prevent     |
|                   |                       | tampering or replacement |
|                   |                       | of the MPoC Application  |
|                   |                       | at this stage of the     |
|                   |                       | lifecycle. This can be   |
|                   |                       | done by limiting and     |
|                   |                       | securing the access that |
|                   |                       | the MPoC Application     |
|                   |                       | development team and     |
|                   |                       | others have to the       |
|                   |                       | distribution channel.    |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-1.4** The  | **4A-1.4.a** The      | Only authentic MPoC      |
| > methods         | tester must confirm   | Applications are         |
| > implemented to  | through examination   | permitted to be          |
| > distribute the  | and observation that  | installed and operated   |
| > MPoC            | all the methods       | as part of an MPoC       |
| > Application     | supported for         | Solution. The            |
| > must provide    | distribute the MPoC   | authenticity at          |
| > authenticity to | Application provide   | installation time needs  |
| > the MPoC        | authenticity prior to | to be provided by the    |
| > Application     | initial execution.    | MPoC application defined |
| > prior to        |                       | distribution method      |
| > initial         |                       | and/or COTS platform,    |
| > execution.      |                       | before the MPoC          |
|                   |                       | Application is executed  |
|                   |                       | for the first time       |
|                   |                       | following installation   |
|                   |                       | or updating.             |
|                   |                       |                          |
|                   |                       | COTS platforms that do   |
|                   |                       | not allow for the use of |
|                   |                       | a COTS application       |
|                   |                       | distribution method that |
|                   |                       | can provide authenticity |
|                   |                       | to the MPoC Application  |
|                   |                       | at installation time are |
|                   |                       | not suitable for use     |
|                   |                       | with an MPoC Solution.   |
|                   |                       |                          |
|                   |                       | The minimum requirements |
|                   |                       | for the COTS platform    |
|                   |                       | baseline -- including    |
|                   |                       | the need to support      |
|                   |                       | validation of a digital  |
|                   |                       | signature across MPoC    |
|                   |                       | Applications that are    |
|                   |                       | loaded onto the device   |
|                   |                       | -- is covered in         |
|                   |                       | requirement 3B-x.        |
|                   |                       |                          |
|                   |                       | Some COTS platforms may  |
|                   |                       | support multiple         |
|                   |                       | signature types or allow |
|                   |                       | for the use of           |
|                   |                       | self-signed              |
|                   |                       | certificates. The intent |
|                   |                       | of this requirement is   |
|                   |                       | not to enforce that all  |
|                   |                       | signatures chain up to   |
|                   |                       | an authorized            |
|                   |                       | Certificate Authority,   |
|                   |                       | but that the COTS        |
|                   |                       | application distribution |
|                   |                       | methods implemented      |
|                   |                       | provide for the ability  |
|                   |                       | to validate that the     |
|                   |                       | MPoC Application has not |
|                   |                       | been maliciously         |
|                   |                       | modified since           |
|                   |                       | deployment to (and       |
|                   |                       | through) the COTS        |
|                   |                       | application distribution |
|                   |                       | method.                  |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-1.5** The  | **4A-1.5.a** The      | The defined COTS         |
| > MPoC            | tester must confirm   | application distribution |
| > Application     | through examination   | method may not guarantee |
| > must include    | and observation that  | that the application     |
| > methods to      | the MPoC Application  | that is provided is      |
| > allow for the   | implements methods to | genuine, instead simply  |
| > merchant to     | permit the merchant   | providing confirmation   |
| > validate the    | to validate the       | that it did indeed come  |
| > authenticity of | authenticity of the   | from the COTS            |
| > the MPoC        | MPoC Application.     | application distribution |
| > Application.    |                       | method used. Therefore,  |
|                   |                       | the merchant needs to be |
|                   |                       | able to separately       |
|                   |                       | validate the             |
|                   |                       | authenticity of the MPoC |
|                   |                       | Application.             |
|                   |                       |                          |
|                   |                       | Some COTS Platforms may  |
|                   |                       | support self-signed      |
|                   |                       | certificates, and it is  |
|                   |                       | not a requirement for a  |
|                   |                       | signature to chain up to |
|                   |                       | an authorized            |
|                   |                       | Certificate Authority.   |
|                   |                       | Because of this, it is   |
|                   |                       | necessary that the       |
|                   |                       | merchant is able to      |
|                   |                       | separately validate that |
|                   |                       | the MPoC Application     |
|                   |                       | they have downloaded is  |
|                   |                       | not just a valid         |
|                   |                       | application, but is the  |
|                   |                       | MPoC Application they    |
|                   |                       | intended to download and |
|                   |                       | use for payment          |
|                   |                       | acceptance.              |
|                   |                       |                          |
|                   |                       | This requirement is      |
|                   |                       | intended to help secure  |
|                   |                       | MPoC Solutions against   |
|                   |                       | fake or "look-alike"     |
|                   |                       | MPoC Applications,       |
|                   |                       | created for the purpose  |
|                   |                       | of capturing payment     |
|                   |                       | data for malicious use.  |
|                   |                       | There are many ways in   |
|                   |                       | which this objective may |
|                   |                       | be met, e.g., by using   |
|                   |                       | an out-of-band method    |
|                   |                       | (such as a website or    |
|                   |                       | phone number) to perform |
|                   |                       | a challenge-response     |
|                   |                       | process with the MPoC    |
|                   |                       | Application, or by using |
|                   |                       | the ability of the MPoC  |
|                   |                       | Application to           |
|                   |                       | communicate to an        |
|                   |                       | attached device, such as |
|                   |                       | a PCI PTS SCRP, as       |
|                   |                       | confirmation it is       |
|                   |                       | indeed the valid MPoC    |
|                   |                       | Application.             |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-1.6** The  | **4A-1.6.a** The      | The MPoC SDK may be      |
| > MPoC            | tester must confirm   | developed by an entity   |
| > Application     | through examination   | different than that      |
| > vendor must     | that the MPoC         | which develops and       |
| > implement a     | Application vendor    | maintains the MPoC       |
| > distribution    | provides secure       | Application. Even if the |
| > method that     | updates of the MPoC   | same entity produces     |
| > provides secure | SDK according to the  | both the MPoC Software   |
| > and timely      | MPoC Software         | and the MPoC             |
| > updates of the  | security guidance     | Application, there may   |
| > MPoC SDK.       | document.             | be separate teams or     |
|                   |                       | resources used for each. |
|                   | ***Note:** This       |                          |
|                   | requirement is        | In such scenarios, it is |
|                   | concerned with the    | possible that the MPoC   |
|                   | operational process   | SDK has an update        |
|                   | of communicating and  | process and timing that  |
|                   | delivering updates,   | are dislocated from that |
|                   | not with the          | of the MPoC Application. |
|                   | technical process of  |                          |
|                   | maintaining and       | The MPoC Software vendor |
|                   | updating MPoC         | is required to keep MPoC |
|                   | Software.*            | Application vendors      |
|                   |                       | informed of releases and |
|                   |                       | changelogs as part of    |
|                   |                       | their validation and     |
|                   |                       | listing. MPoC            |
|                   |                       | Application vendors are  |
|                   |                       | required, on their part, |
|                   |                       | to have procedures in    |
|                   |                       | place to coordinate the  |
|                   |                       | incorporation of new     |
|                   |                       | MPoC Software releases,  |
|                   |                       | including configuration  |
|                   |                       | settings.                |
+-------------------+-----------------------+--------------------------+

### 4A-2 Key Management Operations

> Encryption is relied upon as a foundational control in many MPoC
> security requirements. Security of the cryptographic keys,
> certificates, and systems used with these operations is of equal
> importance to the actual cryptographic algorithms used. This
> requirement applies to all operational aspects of key management,
> including those performed by A&M service providers, MPoC Solution
> providers, and MPoC Software vendors.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Cryptographic   |                       |                          |
| > keys and        |                       |                          |
| > certificates    |                       |                          |
| > are managed     |                       |                          |
| > securely        |                       |                          |
| > throughout      |                       |                          |
| > their complete  |                       |                          |
| > lifecycle.      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **4A-2.1**      | **4A-2.1.a** The      | The MPoC Software        |
| > Procedures to   | tester must confirm   | implements cryptography  |
| > generate,       | through examination,  | for various controls,    |
| > distribute,     | observation, and      | and this implementation  |
| > revoke, and     | interview, that       | is assessed under the    |
| > renew keys and  | procedures for the    | requirements of          |
| > certificates    | generation,           | Domain 1. However, to    |
| > must follow the | revocation, and       | ensure the security of   |
| > MPoC Software   | renewing of keys and  | the MPoC Solution, the   |
| > security        | certificates follow   | ways in which the        |
| > guidance and be | the MPoC Software     | cryptographic systems    |
| > demonstrably in | security guidance and | are used and operated    |
| > use.            | are demonstrably in   | are also important.      |
|                   | use. The procedures   |                          |
|                   | must, at a minimum,   | This includes any        |
|                   | include the following | processes that involve   |
|                   | topics:               | the generation,          |
|                   |                       | revocation, renewal, and |
|                   | -   Relation to       | distribution of          |
|                   |     incident          | cryptographic keys.      |
|                   |     management        | Operational aspects of   |
|                   |     processes.        | an MPoC Solution are not |
|                   |                       | permitted to implement   |
|                   | -   Assessment of     | their own cryptographic  |
|                   |     impact of key     | systems or protocols     |
|                   |     replacement       | separately from those    |
|                   |     (replacement of a | already implemented      |
|                   |     root CA key will  | within the MPoC          |
|                   |     have more impact  | Software.                |
|                   |     than a device     |                          |
|                   |     specific key).    | This requirement covers  |
|                   |                       | the operational aspects  |
|                   | -   Communication to  | of the key management    |
|                   |     stakeholders.     | already implemented in   |
|                   |                       | the MPoC Software        |
|                   | -   Work instructions | design. The expectation  |
|                   |     about how to      | is that no additional or |
|                   |     actually revoke   | altered key management   |
|                   |     and renew         | has been implemented     |
|                   |     specific keys and | during implementation,   |
|                   |     certificates.     | and that the operational |
|                   |                       | aspects of the existing  |
|                   |                       | key management are       |
|                   |                       | performed in an          |
|                   |                       | expected, secure, and    |
|                   |                       | compliant manner.        |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-2.2**      | **4A-2.2.a** The      | Cryptographic keys need  |
| > Secret or       | tester must confirm   | to be protected to       |
| > private         | through examination   | prevent unauthorized or  |
| > cryptographic   | and observation that  | unnecessary access that  |
| > keys used for   | cleartext secret or   | could result in the      |
| > the security of | private cryptographic | exposure of encrypted    |
| > the solution in | keys in the back-end  | data.                    |
| > the back-end    | environments are      |                          |
| > environments    | stored and processed  | Secret or private        |
| > must be         | only in HSMs          | cryptographic keys need  |
| > protected       | compliant to          | to be stored in an       |
| > through use of  | FIPS140-2/3 level 3   | encrypted form or within |
| > HSMs compliant  | (or above), or PCI    | an SCD, such as an HSM.  |
| > to FIPS140-2/3  | HSM requirements.     | This requirement applies |
| > level 3, or PCI |                       | to all keys used to      |
| > HSM             |                       | encrypt PINs and other   |
| > requirements.   |                       | account data, as well as |
|                   |                       | cryptographic keys used  |
|                   |                       | to secure attestation    |
|                   |                       | data. The requirement    |
|                   |                       | for HSM use does not     |
|                   |                       | apply to cryptographic   |
|                   |                       | keys used for the        |
|                   |                       | establishment and        |
|                   |                       | security of secure       |
|                   |                       | channels, such as TLS    |
|                   |                       | keys. Cryptographic keys |
|                   |                       | used for signing MPoC    |
|                   |                       | Applications, or that    |
|                   |                       | are used for creating    |
|                   |                       | software protected       |
|                   |                       | cryptography             |
|                   |                       | implementations, are     |
|                   |                       | also out of scope of     |
|                   |                       | this requirement.        |
+-------------------+-----------------------+--------------------------+
| > **4A-2.3** Work | **4A-2.3.a** The      | It is of vital           |
| > instructions to | tester must confirm   | importance that HSM's    |
| > operate HSMs    | through examination   | are operated as          |
| > exist and are   | that HSM operational  | prescribed by the HSM    |
| > demonstrably in | work instructions     | supplier. Documented     |
| > use for each    | exist and contain the | work instructions help   |
| > type of HSM     | following topics at a | to prevent human         |
| > used.           | minimum:              | failures.                |
|                   |                       |                          |
|                   | -   Confirmation of   | Keys that are required   |
|                   |     HSM security and  | to be protected using    |
|                   |     operational state | HSMs do not include      |
|                   |                       | cryptographic keys used  |
|                   | -   Authent           | for secure channels,     |
|                   | ication/Authorization | such as TLS keys.        |
|                   |                       | Application-level keys   |
|                   | -   Key generation    | are included in scope    |
|                   |                       | and need to be protected |
|                   | -   Key import        | by HSMs.                 |
|                   |                       |                          |
|                   | -   Key export        | Confirmation of the      |
|                   |                       | security and operational |
|                   | -   Key deletion      | state of the HSMs may    |
|                   |                       | include physical         |
|                   | -   Audit log review  | observation or           |
|                   |                       | examination by the A&M   |
|                   |                       | service provider, or     |
|                   |                       | remote cryptographic     |
|                   |                       | means where physical     |
|                   |                       | observation is not       |
|                   |                       | possible (e.g., in Cloud |
|                   |                       | HSM environments).       |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-2.4** If   | **4A-2.4.a** The      | Cloud service providers  |
| > the back-end    | tester must confirm   | offer different ways to  |
| > systems include | through examination   | manage HSM keys. In      |
| > the use of      | and interview that    | general, three options   |
| > cloud-based     | cryptographic keys    | are supported:           |
| > HSM's, the      | are generated and     |                          |
| > cryptographic   | managed by the Cloud  | -   Keys are generated   |
| > keys are        | HSM user, and not     |     and managed by the   |
| > managed by      | accessible to the     |     Cloud service        |
| > relevant MPoC   | Cloud HSM service     |     provider. Depending  |
| > entity, and not | provider.             |     on the HSM type,     |
| > accessible to   |                       |     this could even mean |
| > the Cloud HSM   |                       |     that HSM keys are    |
| > provider.       |                       |     shared with other    |
|                   |                       |     customers.           |
|                   |                       |                          |
|                   |                       | -   Keys are generated   |
|                   |                       |     and managed by the   |
|                   |                       |     Cloud HSM user, but  |
|                   |                       |     within the cloud     |
|                   |                       |     environment. The     |
|                   |                       |     keys are not shared  |
|                   |                       |     with other           |
|                   |                       |     customers, but       |
|                   |                       |     security depends on  |
|                   |                       |     the Cloud service    |
|                   |                       |     providers'           |
|                   |                       |     configuration.       |
|                   |                       |                          |
|                   |                       | -   Keys are generated   |
|                   |                       |     by the Cloud HSM     |
|                   |                       |     user in their own    |
|                   |                       |     premises and the     |
|                   |                       |     transferred securely |
|                   |                       |     to the Cloud service |
|                   |                       |     provider.            |
|                   |                       |                          |
|                   |                       | Some Cloud HSM systems   |
|                   |                       | use the HSM only for     |
|                   |                       | storage of keys and      |
|                   |                       | allow for export of keys |
|                   |                       | for cryptographic        |
|                   |                       | operations. These types  |
|                   |                       | of Cloud HSM systems are |
|                   |                       | unsuitable for use with  |
|                   |                       | MPoC Solution.           |
|                   |                       |                          |
|                   |                       | Keys that are required   |
|                   |                       | to be protected using    |
|                   |                       | HSMs do not include      |
|                   |                       | cryptographic keys used  |
|                   |                       | for secure channels,     |
|                   |                       | such as TLS keys.        |
|                   |                       | Application-level keys,  |
|                   |                       | including those keys     |
|                   |                       | used to encrypt A&M data |
|                   |                       | sent to the back-end A&M |
|                   |                       | environment, are         |
|                   |                       | included in scope and    |
|                   |                       | need to be protected by  |
|                   |                       | HSMs.                    |
+-------------------+-----------------------+--------------------------+
|                   | **4A-2.4.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination,  |                          |
|                   | observation, and      |                          |
|                   | interview that        |                          |
|                   | cryptographic keys    |                          |
|                   | used in the back-end  |                          |
|                   | systems are not       |                          |
|                   | exposed outside of    |                          |
|                   | any cloud HSMs used   |                          |
|                   | in the solution.      |                          |
+-------------------+-----------------------+--------------------------+
| > **4A-2.5**      | **4A-2.5.a** The      | Cryptographic keys are   |
| > Operational key | tester must confirm   | required to be protected |
| > management of   | through examination,  | against unauthorized     |
| > secret and      | observation, and      | disclosure. This         |
| > private         | interview that secret | includes ensuring keys   |
| > cryptographic   | or private keys in    | are always managed in    |
| > keys must       | the solution are      | one of the "approved     |
| > ensure the      | maintained in one of  | forms" as listed in this |
| > confidentiality | the permitted forms   | test requirement.        |
| > of the keys     | throughout their      |                          |
| > throughout      | lifecycle.            | This requirement applies |
| > their           |                       | to all keys used to      |
| > lifecycle.      | Permitted key forms   | encrypt PINs and account |
|                   | are:                  | data, as well as         |
|                   |                       | cryptographic keys used  |
|                   | -   Encrypted by a    | to secure attestation    |
|                   |     key encryption    | data. The requirement    |
|                   |     key of equal or   | for HSM use does not     |
|                   |     greater strength  | apply to cryptographic   |
|                   |     (these key        | keys used for the        |
|                   |     encryption keys   | establishment and        |
|                   |     need to satisfy   | security of secure       |
|                   |     this              | channels, such as TLS    |
|                   |     requirement).     | keys. Cryptographic keys |
|                   |                       | used for signing MPoC    |
|                   | -   Stored within an  | Applications, or that    |
|                   |     SCD.              | are used for creating    |
|                   |                       | software protected       |
|                   | -   Managed as two or | cryptography             |
|                   |     more full-length  | implementations, are     |
|                   |     components.       | also out of scope of     |
|                   |                       | this requirement.        |
|                   | -   Managed as an     |                          |
|                   |     M-of-N            |                          |
|                   |     secret-sharing    |                          |
|                   |     scheme.           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-2.6**      | **4A-2.6.a** The      | Cryptographic keys are   |
| > Operational     | tester must confirm   | to be protected against  |
| > management of   | through examination,  | unauthorized or          |
| > cryptographic   | observation, and      | unintentional change.    |
| > keys must       | interview that all    | For example, this can be |
| > ensure the      | keys in the solution  | achieved by:             |
| > integrity and   | have their integrity  |                          |
| > authenticity of | and authenticity      | -   Implementing         |
| > the keys        | protected.            |     cryptographic        |
| > throughout      |                       |     controls such as key |
| > their           |                       |     blocks. Key blocks   |
| > lifecycle.      |                       |     may be implemented   |
|                   |                       |     entirely in the      |
|                   |                       |     back-end systems, or |
|                   |                       |     in concert with the  |
|                   |                       |     MPoC SDK (refer      |
|                   |                       |     requirements in      |
|                   |                       |     1A-x).               |
|                   |                       |                          |
|                   |                       | -   Implementing key     |
|                   |                       |     check value or key   |
|                   |                       |     fingerprint          |
|                   |                       |     verification         |
|                   |                       |     processes.           |
|                   |                       |                          |
|                   |                       | -   Managing public keys |
|                   |                       |     in certificates.     |
+-------------------+-----------------------+--------------------------+
| > **4A-2.7**      | **4A-2.7.a** The      | Split knowledge requires |
| > Management of   | tester must confirm   | that no individual has   |
| > secret and      | through examination,  | any information about    |
| > private         | observation, and      | any part, even a single  |
| > cryptographic   | interview that dual   | bit, of the cleartext    |
| > keys must       | control and split     | key. Dual control        |
| > implement the   | knowledge are         | requires at least two    |
| > principles of   | implemented in the    | individuals to perform a |
| > dual control    | organization to       | process, as it is more   |
| > and split       | manage secret and     | difficult to establish a |
| > knowledge.      | private cryptographic | breach of process or     |
|                   | keys.                 | information when         |
|                   |                       | multiple entities are    |
|                   |                       | required to conspire to  |
|                   |                       | misuse.                  |
|                   |                       |                          |
|                   |                       | There are several ways   |
|                   |                       | to implement dual        |
|                   |                       | control and split        |
|                   |                       | knowledge using logical  |
|                   |                       | mechanisms, physical     |
|                   |                       | mechanisms, or both.     |
|                   |                       | This requirement does    |
|                   |                       | not enforce the need for |
|                   |                       | manual processes for     |
|                   |                       | keys that are instead    |
|                   |                       | always secured within an |
|                   |                       | SCD.                     |
|                   |                       |                          |
|                   |                       | Depending on the number  |
|                   |                       | of cleartext components  |
|                   |                       | there may be different   |
|                   |                       | groups of key            |
|                   |                       | custodians, although it  |
|                   |                       | is required that there   |
|                   |                       | always be more than one. |
|                   |                       | No one individual can    |
|                   |                       | ever have access to      |
|                   |                       | enough key components to |
|                   |                       | reconstruct any part of  |
|                   |                       | the cryptographic key.   |
|                   |                       |                          |
|                   |                       | For key custodians to be |
|                   |                       | free from undue          |
|                   |                       | influence in discharging |
|                   |                       | their custodial duties,  |
|                   |                       | different key custodians |
|                   |                       | who are able to form the |
|                   |                       | necessary threshold to   |
|                   |                       | create a key are not     |
|                   |                       | permitted to directly    |
|                   |                       | report to the same       |
|                   |                       | individual, except for   |
|                   |                       | organizations of         |
|                   |                       | insufficient size.       |
|                   |                       |                          |
|                   |                       | Key custodians need to   |
|                   |                       | have regular security    |
|                   |                       | awareness training.      |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **4A-2.8**      | **4A-2.8.a** The      | Expired certificates can |
| > Mechanisms must | tester must confirm   | introduce unacceptable   |
| > be in place to  | through examination   | risk to the solution.    |
| > identify        | and observation that  | Payment functions are    |
| > expired,        | a revocation          | required to be halted    |
| > invalid, or and | mechanism exists and  | when certificates that   |
| > revoked         | is effective in       | are relied upon have     |
| > certificates,   | preventing the use of | expired or are otherwise |
| > and to prevent  | revoked and/or        | detected as no longer    |
| > continued       | certificates.         | valid. Expired           |
| > processing      |                       | certificates may be an   |
| > using           |                       | indication of a          |
| > certificates    |                       | malicious user acting as |
| > that have       |                       | an imposter of a         |
| > expired or been |                       | legitimate organization  |
| > revoked.        |                       | or process who is        |
|                   |                       | phishing for sensitive   |
|                   |                       | information.             |
|                   |                       |                          |
|                   |                       | Many security incidents  |
|                   |                       | are caused by expired or |
|                   |                       | revoked certificates.    |
|                   |                       | While understanding of   |
|                   |                       | the keys used is         |
|                   |                       | important and collected  |
|                   |                       | in the key/certificate   |
|                   |                       | tables, it is equally    |
|                   |                       | important to have        |
|                   |                       | procedures to act upon   |
|                   |                       | if any key expires or is |
|                   |                       | suspected of being       |
|                   |                       | compromised.             |
|                   |                       |                          |
|                   |                       | The requirement is       |
|                   |                       | applicable to all        |
|                   |                       | components of the        |
|                   |                       | solution and includes    |
|                   |                       | only the certificates    |
|                   |                       | upon which the solution  |
|                   |                       | relies for security      |
|                   |                       | purpose.                 |
+-------------------+-----------------------+--------------------------+

### 4A-3 Penetration Testing and Vulnerability Management

> These requirements cover the requirements for penetration testing and
> vulnerability management for MPoC A&M service providers, and MPoC
> Solution providers.

+-----------------+---------------------+------------------------------+
| > **Security    | > **Test            | > **Guidance**               |
| >               | > Requirements**    |                              |
|  Requirements** |                     |                              |
+=================+=====================+==============================+
| >               |                     |                              |
|  **Objective:** |                     |                              |
| > Back-end      |                     |                              |
| > environments  |                     |                              |
| > cannot be     |                     |                              |
| > compromised   |                     |                              |
| > from within   |                     |                              |
| > an            |                     |                              |
| > authenticated |                     |                              |
| > MPoC          |                     |                              |
| > Application   |                     |                              |
| > session.      |                     |                              |
+-----------------+---------------------+------------------------------+
| > **4A-3.1** A  | **4A-3.1.a** The    | All back-end entry points    |
| > penetration   | tester must confirm | meant to parse and process   |
| > test must be  | through examination | data received from the MPoC  |
| > performed on  | that a penetration  | Software are required to     |
| > the           | test has been       | have undergone penetration   |
| > interfaces    | performed on the    | testing. This includes the   |
| > between the   | interfaces between  | payment and PIN processing   |
| > MPoC          | the MPoC            | backends, as well as any     |
| > Application   | Application, or an  | cloud/remote kernel systems  |
| > or MPoC SDK,  | MPoC SDK in a       | used, where these are part   |
| > and back-end  | suitable test       | of the MPoC Solution.        |
| > environments  | application, and    |                              |
| > (e.g., A&M,   | back-end            | This penetration test        |
| > payment       | environments prior  | differs from the test        |
| > processing    | to initial          | required in 1A-1.3 in that   |
| > and/or remote | deployment, and at  | it is to be performed in the |
| > kernel) prior | least annually      | context of a malicious MPoC  |
| > to the        | thereafter.         | Application, or an MPoC SDK  |
| > validation    | Penetration testing | in a suitable test           |
| > and listing   | reports must be     | application, using a valid   |
| > of an MPoC    | examined to confirm | and authenticated secure     |
| > Solution or   | that the scope      | channel to back-end systems. |
| > A&M service   | covers all aspects  | The testing is intended not  |
| > provider, and | of the MPoC         | to re-assess the security of |
| > at least once | Solution, or A&Ms,  | the MPoC Software, but       |
| > per year      | and that any major  | instead that the MPoC        |
| > thereafter.   | vulnerabilities     | Software has been securely   |
|                 | found during the    | integrated into the other    |
|                 | penetration testing | systems and software of the  |
|                 | have been           | overall MPoC Solution.       |
|                 | remediated.         |                              |
|                 |                     | Because this is an           |
|                 |                     | operational compliance       |
|                 |                     | requirement, it is expected  |
|                 |                     | that source code and other   |
|                 |                     | details of the logical       |
|                 |                     | aspects of the MPoC Solution |
|                 |                     | may not be available for     |
|                 |                     | this penetration test.       |
|                 |                     |                              |
|                 |                     | *(continued on next page)*   |
+-----------------+---------------------+------------------------------+

+-----------------+---------------------+------------------------------+
| > **Security    | > **Test            | > **Guidance**               |
| >               | > Requirements**    |                              |
|  Requirements** |                     |                              |
+=================+=====================+==============================+
| > **4A-3.2** A  | **4A-3.2.a** The    | Penetration testing and      |
| > security      | tester must confirm | vulnerability management     |
| -flaw-reporting | through examination | processes are expected to be |
| > program must  | that a              | part of any secure software  |
| > be            | vuln                | lifecycle process. This      |
| > implemented   | erability-reporting | requirement confirms the     |
| > to encourage  | program exists for  | scope and efficacy of the    |
| > the finding   | the system, and     | penetration testing as it is |
| > and reporting | there is evidence   | applied to a complete MPoC   |
| > of            | of accepting and    | Solution or an A&M service   |
| >               | remediating         | provider*,* as it has        |
| vulnerabilities | security            | integrated and operates the  |
| > by internal   | vulnerabilities     | MPoC Software.               |
| > and external  | found through this  |                              |
| > entities.     | program.            | A penetration test is        |
|                 |                     | considered to be a clearly   |
|                 |                     | scoped and deliberately      |
|                 |                     | engaged activity performed   |
|                 |                     | on behalf of the MPoC        |
|                 |                     | Solution provider, or A&M    |
|                 |                     | service provider*.* This     |
|                 |                     | differs from the ad hoc      |
|                 |                     | testing that may be          |
|                 |                     | performed as part of a       |
|                 |                     | vulnerability management or  |
|                 |                     | flaw reporting program.      |
|                 |                     |                              |
|                 |                     | Penetration tests need to be |
|                 |                     | performed by suitably        |
|                 |                     | skilled resources and may be |
|                 |                     | performed by resources       |
|                 |                     | internal to the entity if    |
|                 |                     | such resources exist. When   |
|                 |                     | penetration testing is       |
|                 |                     | performed by internal        |
|                 |                     | resources, the people        |
|                 |                     | performing the testing need  |
|                 |                     | to be separate from those    |
|                 |                     | who perform any operation,   |
|                 |                     | development, or integration  |
|                 |                     | work.                        |
|                 |                     |                              |
|                 |                     | Skills expected from the     |
|                 |                     | resources used for           |
|                 |                     | penetration testing include  |
|                 |                     | an understanding of EMV      |
|                 |                     | protocols and payment        |
|                 |                     | processing, skills and       |
|                 |                     | experience with mobile       |
|                 |                     | security and communications  |
|                 |                     | protocols, and a clear       |
|                 |                     | history of penetration       |
|                 |                     | testing experience.          |
|                 |                     |                              |
|                 |                     | Results from annual          |
|                 |                     | penetration testing may not  |
|                 |                     | exist for newly deployed     |
|                 |                     | MPoC Solutions, or A&M       |
|                 |                     | service providers, but need  |
|                 |                     | to be provided for any       |
|                 |                     | review performed after the   |
|                 |                     | first year after their       |
|                 |                     | initial validation. However, |
|                 |                     | an initial penetration       |
|                 |                     | testing report is required   |
|                 |                     | to be available prior to     |
|                 |                     | validation and listing of    |
|                 |                     | the MPoC Solution or A&M     |
|                 |                     | service provider*.*          |
|                 |                     |                              |
|                 |                     | Penetration testing may be   |
|                 |                     | performed by the same entity |
|                 |                     | that performs the MPoC       |
|                 |                     | evaluation, but the MPoC     |
|                 |                     | evaluation itself cannot be  |
|                 |                     | considered a penetration     |
|                 |                     | test to meet this            |
|                 |                     | requirement. A separate      |
|                 |                     | testing and reporting        |
|                 |                     | process must be implemented  |
|                 |                     | for this penetration test.   |
+-----------------+---------------------+------------------------------+
|                 | **4A-3.2.b** For    |                              |
|                 | any vulnerabilities |                              |
|                 | have been reported  |                              |
|                 | through the         |                              |
|                 | security flaw       |                              |
|                 | reporting program   |                              |
|                 | the tester must     |                              |
|                 | confirm through     |                              |
|                 | examination that    |                              |
|                 | any such            |                              |
|                 | vulnerabilities are |                              |
|                 | processed through   |                              |
|                 | the vendor          |                              |
|                 | risk-and-update     |                              |
|                 | process and patched |                              |
|                 | accordingly.        |                              |
+-----------------+---------------------+------------------------------+

# Domain 5: MPoC Solution

> The security requirements and test requirements in this Domain cover
> the operational management of the complete MPoC Solution. This
> includes the validation of compliance for the payment-processing
> environment, the PIN-processing environment, the MPoC attestation and
> monitoring environment, and any other systems such as the split kernel
> environment.
>
> Where the payment-processing and PIN processing are not performed by
> the MPoC Solution Provider those aspects may be considered out of
> scope of the assessment. Only those aspects that are included--e.g., a
> payment switch operated by the MPoC Solution provider--are to be
> included in the assessment of this Domain. However, it is not possible
> for an MPoC Solution that allows for PIN entry on the COTS device to
> never include validation of a PIN processing environment. Equally, it
> is also expected that all MPoC Solutions will include decryption or
> key management environments for account data sent from the MPoC
> Applications that are deployed as part of the MPoC Solution.
>
> Although it is not necessary for the MPoC Solution provider to
> develop, implement, or operate all of these systems, it is the
> responsibility of the MPoC Solution provider to ensure that the
> relevant requirements for each are met. This may be achieved through a
> monolithic solution, where the MPoC Solution provider is responsible
> for the assessment and compliance of all aspects of the overall MPoC
> Solution, or through a composite solution where the MPoC Solution
> provider utilizes separately assessed and listed MPoC Products. In all
> cases, the MPoC Solution provider remains responsible for the
> compliance and security of the entire MPoC Solution.

## Module 5A: Third Party Management

> This Module contains the requirements regarding the management of
> third parties.

### 5A-1 Merchant Identification and Communication

> MPoC Solutions are used by merchants to accept payment transactions.
> Initial provisioning of the MPoC Application includes providing for
> the unique identification of the merchant. Ensuring that the merchant
> is informed of changes or requirements of the MPoC Solution as the
> solution changes over time is vital to the security of the solution.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > The merchant is |                       |                          |
| > onboarded       |                       |                          |
| > securely and    |                       |                          |
| > kept up to date |                       |                          |
| > with relevant   |                       |                          |
| > information in  |                       |                          |
| > a timely        |                       |                          |
| > manner.         |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **5A-1.1** The  | **5A-1.1.a** The      | Identification is an     |
| > process of      | tester must confirm   | important security       |
| > onboarding new  | through examination   | measure against          |
| > merchants must  | that the onboarding   | financial fraud to       |
| > be documented.  | process is            | verify the identity,     |
| > At a minimum,   | documented.           | suitability, and risks   |
| > the process     |                       | involved with            |
| > must describe   |                       | maintaining a business   |
| > how merchant    |                       | relationship with the    |
| > identification  |                       | merchant.                |
| > is performed.   |                       |                          |
|                   |                       | This requirement is not  |
|                   |                       | intended to cover the    |
|                   |                       | legal or financial       |
|                   |                       | process of merchant      |
|                   |                       | on-boarding, but to      |
|                   |                       | ensure merchants are     |
|                   |                       | uniquely identified to   |
|                   |                       | help facilitate the A&M  |
|                   |                       | systems and any          |
|                   |                       | communications required. |
+-------------------+-----------------------+--------------------------+
| > **5A-1.2** The  | **5A-1.2.a** The      | This requirement is      |
| > me              | tester must confirm   | primarily concerned with |
| rchant-onboarding | through examination   | the data used to         |
| > process must    | that the provisioning | uniquely identify the    |
| > include the     | process is documented | merchant to the payment  |
| > provisioning of | and describes how the | system. It does not      |
| > a unique        | unique merchant       | require that the MPoC    |
| > merchant        | identifier is created | Application must         |
| > identifier, and | and provided to the   | implement a per-user     |
| > the             | merchant. The tester  | password or other such   |
| > provisioning    | must confirm that the | identification system.   |
| > process of this | required controls are |                          |
| > unique merchant | implemented.          | However, if any          |
| > identifier must |                       | passwords or other       |
| > be documented.  | The following topics  | credentials are          |
|                   | must be present at a  | implemented, they must   |
|                   | minimum:              | be transmitted and       |
|                   |                       | processed securely.      |
|                   | -   How the unique    |                          |
|                   |     merchant          | Fraudulent activities    |
|                   |     identifier is     | often start with         |
|                   |     created securely. | unauthorized access to   |
|                   |                       | credentials. The         |
|                   | -   That any user     | provisioning process is  |
|                   |     credentials that  | a particularly           |
|                   |     are transmitted   | vulnerable process in    |
|                   |     must not be sent  | the solutions.           |
|                   |     together.         | Well-known measures to   |
|                   |                       | improve the security of  |
|                   |                       | this process use         |
|                   |                       | separate channels and    |
|                   |                       | special PIN/password     |
|                   |                       | letters, and do not send |
|                   |                       | user IDs and passwords   |
|                   |                       | together.                |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **5A-1.3** A    | **5A-1.3.a** The      | It is important that the |
| > merchant        | tester must confirm   | merchant receives        |
| > communication   | through examination   | relevant information in  |
| > plan must exist | that a merchant       | a timely manner, and     |
| > and be          | communication plan    | this process cannot be   |
| > demonstrably in | exists and contains   | performed ad hoc when    |
| > use, that       | the following         | issues arise. A merchant |
| > includes how    | information at a      | communication plan       |
| > and when        | minimum:              | ensures that the         |
| > information is  |                       | processes for how and    |
| > shared with     | -   Changes to the    | when to communicate to   |
| > merchants and   |     system baseline.  | the merchant base are    |
| > detail the      |                       | detailed, so all parties |
| > information and | -   Changes to any    | are aware of their       |
| > trigger points  |     user manual       | obligations.             |
| > that result in  |     including at a    |                          |
| > such            |     minimum:          |                          |
| > communication.  |                       |                          |
|                   |     -   How the MPoC  |                          |
|                   |         Application   |                          |
|                   |         must be       |                          |
|                   |         installed and |                          |
|                   |         provided with |                          |
|                   |         unique        |                          |
|                   |                       |                          |
|                   |       (configuration) |                          |
|                   |         data.         |                          |
|                   |                       |                          |
|                   |     -   How to use    |                          |
|                   |         the MPoC      |                          |
|                   |         Application   |                          |
|                   |         securely      |                          |
|                   |         (e.g.,        |                          |
|                   |         privacy       |                          |
|                   |         during the    |                          |
|                   |         customer PIN  |                          |
|                   |         entry         |                          |
|                   |         process).     |                          |
|                   |                       |                          |
|                   |     -   Any security  |                          |
|                   |                       |                          |
|                   |      responsibilities |                          |
|                   |         that belong   |                          |
|                   |         to the        |                          |
|                   |         merchant when |                          |
|                   |         using the     |                          |
|                   |         Solution.     |                          |
|                   |                       |                          |
|                   |     -   User          |                          |
|                   |         information   |                          |
|                   |         about         |                          |
|                   |         peripheral    |                          |
|                   |         such as       |                          |
|                   |         non-PTS       |                          |
|                   |         approved MSR  |                          |
|                   |         or PCI PTS    |                          |
|                   |         SCRP if used  |                          |
|                   |         in the        |                          |
|                   |         Solution.     |                          |
|                   |                       |                          |
|                   |     -   How to        |                          |
|                   |         contact the   |                          |
|                   |         MPoC Solution |                          |
|                   |         provider.     |                          |
|                   |                       |                          |
|                   | -   Planned           |                          |
|                   |     maintenance       |                          |
|                   |     downtime.         |                          |
|                   |                       |                          |
|                   | -   Provisioned       |                          |
|                   |     credentials.      |                          |
|                   |                       |                          |
|                   | -   Information about |                          |
|                   |     potential         |                          |
|                   |                       |                          |
|                   |   compromise/security |                          |
|                   |     incidents.        |                          |
|                   |                       |                          |
|                   | -   End User License  |                          |
|                   |     Agreement (EULA). |                          |
+-------------------+-----------------------+--------------------------+
|                   | **5A-1.3.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the merchant     |                          |
|                   | communication plan is |                          |
|                   | demonstrably in use,  |                          |
|                   | for instance, by      |                          |
|                   | examining previously  |                          |
|                   | issued merchant       |                          |
|                   | communication (for    |                          |
|                   | MPoC Solutions that   |                          |
|                   | are already in use).  |                          |
+-------------------+-----------------------+--------------------------+

### 5A-2 Support for Multiple Entities in the Solution

> The MPoC Solution is comprised of multiple different components, such
> as the MPoC Software, MPoC Application, the A&M backend, and the
> payment-processing backends. There must be a clear process for
> understanding and defining the requirements and roles and
> responsibility of each entity involved.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Formal          |                       |                          |
| > processes exist |                       |                          |
| > to define and   |                       |                          |
| > align the       |                       |                          |
| > interaction and |                       |                          |
| > roles of the    |                       |                          |
| > different       |                       |                          |
| > entities in the |                       |                          |
| > MPoC Solution.  |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **5A-2.1**      | **5A-2.1.a** The      | The Solution might be    |
| > Documentation   | tester must confirm   | operationally managed by |
| > must exist that | through examination   | different entities. This |
| > describes how   | that documentation on | often leads to problems  |
| > the operational | cooperation exists    | in case of incidents     |
| > processes are   | and that it contains  | covering more than one   |
| > aligned between | the required          | entity. Agreements on    |
| > the different   | information.          | these kinds of topics    |
| > entities in the |                       | help to solve potential  |
| > MPoC Solution.  | Documentation must    | incidents efficiently.   |
|                   | contain the following |                          |
|                   | at a minimum:         | For example, in the case |
|                   |                       | where a specific COTS    |
|                   | -   Contact           | Platform is removed from |
|                   |     information of    | the A&M baseline due to  |
|                   |     all entities      | security concerns, it    |
|                   |     involved.         | must be clear how this   |
|                   |                       | process of removal is to |
|                   | -   Agreements on     | be handled between the   |
|                   |     incident          | various parties who      |
|                   |     management        | comprise the MPoC        |
|                   |     processes.        | Solution.                |
|                   |                       |                          |
|                   | -   Agreements on     |                          |
|                   |     escalation        |                          |
|                   |     processes.        |                          |
+-------------------+-----------------------+--------------------------+
| > **5A-2.2** The  | **5A-2.2.a** The      | An MPoC Solution may be  |
| > MPoC            | tester must confirm   | comprised of multiple    |
| > Applications    | through examination   | MPoC Software products,  |
| > deployed by the | that the MPoC         | or a combination of MPoC |
| > MPoC Solution   | Applications deployed | Software Products and    |
| > must be         | by the MPoC Solution  | monolithic MPoC          |
| > supported by    | are supported by      | Applications.            |
| > the Attestation | Attestation and       |                          |
| > and Monitoring  | Monitoring Services   | To ensure that the       |
| > systems         | (or internal systems) | security of the MPoC     |
| > implemented.    | implemented.          | Solution is maintained,  |
|                   |                       | it is important that the |
|                   |                       | MPoC Applications        |
|                   |                       | deployed are supported   |
|                   |                       | by the Attestation and   |
|                   |                       | Monitoring Services (or  |
|                   |                       | internal systems) used   |
|                   |                       | by the MPoC Solution.    |
|                   |                       |                          |
|                   |                       | For example, it would    |
|                   |                       | not be acceptable for an |
|                   |                       | MPoC Solution to use the |
|                   |                       | MPoC SDK from MPoC       |
|                   |                       | Software Product A, but  |
|                   |                       | not use an Attestation   |
|                   |                       | and Monitoring Service   |
|                   |                       | (or internal system)     |
|                   |                       | that also supports that  |
|                   |                       | same MPoC Software       |
|                   |                       | Product.                 |
+-------------------+-----------------------+--------------------------+

### 5A-3 Security of Back-end Systems

> Back-end environments used as part of an MPoC Solution are secure and
> maintained in compliance with relevant standards or requirements.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **Objective:**  |                       |                          |
| > Back-end        |                       |                          |
| > environment are |                       |                          |
| > implemented and |                       |                          |
| > operated        |                       |                          |
| > securely and in |                       |                          |
| > ways that       |                       |                          |
| > maintain        |                       |                          |
| > compliance to   |                       |                          |
| > other           |                       |                          |
| > applicable      |                       |                          |
| > standards.      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **5A-3.1**      | **5A-3.1.a** The      | > Environments that are  |
| > Environments    | tester must confirm   | > PCI DSS compliant      |
| > that store,     | through examination   | > demonstrate that the   |
| > process, or     | that a valid          | > minimum set of         |
| > transmit        | Attestation of        | > industry-expected      |
| > account data    | Compliance (AOC)      | > security controls have |
| > must comply     | outlining compliance  | > been applied to that   |
| > with the        | of any environment    | > environment, which     |
| > requirements of | within the MPoC       | > reduces risk compared  |
| > PCI DSS.        | Solution that stores, | > to environments that   |
|                   | processes, or         | > do not apply security  |
|                   | transmits account     | > controls.              |
|                   | data with the PCI DSS | >                        |
|                   | requirements.         | > This includes any      |
|                   |                       | > payment processing     |
|                   |                       | > backends directly      |
|                   |                       | > implemented by the     |
|                   |                       | > MPoC Solution, or      |
|                   |                       | > where there is the     |
|                   |                       | > ability for the MPoC   |
|                   |                       | > Solution systems to    |
|                   |                       | > have access to         |
|                   |                       | > cleartext account      |
|                   |                       | > data, or the           |
|                   |                       | > cryptographic keys     |
|                   |                       | > that can be used to    |
|                   |                       | > decrypt any encrypted  |
|                   |                       | > account data.          |
+-------------------+-----------------------+--------------------------+
| > **5A-3.2**      | **5A-3.2.a** The      | > Environments that are  |
| > Environments    | tester must confirm   | > PCI PIN compliant      |
| > performing PIN  | through examination   | > demonstrate that the   |
| > processing, or  | that a valid AOC      | > minimum set of         |
| > manage PIN      | outlining compliance  | > industry-expected      |
| > related         | of any PCI            | > security controls have |
| > cryptographic   | PIN-processing        | > been applied to that   |
| > keys, must      | environment included  | > environment, which     |
| > comply with the | in the MPoC Solution  | > reduces risk compared  |
| > requirements of | exists and is current | > to environments that   |
| > PCI PIN.        | and up to date with   | > do not apply security  |
|                   | the features          | > controls.              |
|                   | provided.             | >                        |
|                   |                       | > Specific               |
|                   |                       | > non-compliances raised |
|                   |                       | > as part of PCI PIN     |
|                   |                       | > validation, due to the |
|                   |                       | > use of an MPoC         |
|                   |                       | > Solution, need to be   |
|                   |                       | > considered when        |
|                   |                       | > assessing this         |
|                   |                       | > requirement.           |
+-------------------+-----------------------+--------------------------+
|                   | **5A-3.2.b** The      |                          |
|                   | tester must confirm   |                          |
|                   | through examination   |                          |
|                   | that the key-loading  |                          |
|                   | facilities used for   |                          |
|                   | any PCI PTS devices   |                          |
|                   | implemented in the    |                          |
|                   | MPoC Solution are     |                          |
|                   | included in the PCI   |                          |
|                   | PIN compliance scope. |                          |
+-------------------+-----------------------+--------------------------+
| > **5A-3.3** All  | **5A-3.3.a** The      | > Environments that are  |
| > remote kernel   | tester must confirm   | > PCI DSS compliant      |
| > environments    | through examination   | > demonstrate that the   |
| > implemented by  | that a valid          | > minimum set of         |
| > the solution    | Attestation of        | > industry-expected      |
| > must comply     | Compliance (AoC)      | > security controls have |
| > with PCI DSS    | outlining compliance  | > been applied to that   |
| > requirements.   | of the remote kernel  | > environment, which     |
|                   | environment(s) with   | > reduces risk compared  |
|                   | the PCI DSS           | > to environments that   |
|                   | requirements.         | > do not apply security  |
|                   |                       | > controls.              |
|                   | This AOC must cover   |                          |
|                   | the scope of the      |                          |
|                   | remote kernel         |                          |
|                   | processing            |                          |
|                   | environment.          |                          |
+-------------------+-----------------------+--------------------------+

[]{#_bookmark102 .anchor}

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **5A-3.4** The  | **5A-3.4.a** The      | The A&M environment may  |
| > A&M environment | tester must confirm   | be operated by a service |
| > must comply     | either that the A&M   | provider who already has |
| > with the        | environment complies  | been assessed and is     |
| > requirements in | with the requirements | listed as compliant to   |
| > *[Domain        | of *[Domain           | these requirements.      |
| > 3](#dom         | 3](#domain-3-attesta  | Otherwise, the           |
| ain-3-attestation | tion-and-monitoring)* | requirements in *[Domain |
| -and-monitoring)* | of this standard or   | 3:](#domain-3-att        |
| > of this         | that the A&M service  | estation-and-monitoring) |
| > standard.       | provider is listed on | [Attestation and         |
|                   | the PCI website as an | Mo                       |
|                   | approved A&M service  | nitoring](#domain-3-atte |
|                   | provider.             | station-and-monitoring)* |
|                   |                       | apply.                   |
+-------------------+-----------------------+--------------------------+

# Appendix A Back-end Environment Security Requirements

> Recognizing that back-end attestation systems that support the MPoC
> Solution may not be in scope of PCI DSS, this appendix defines the
> minimum requirements to ensure fundamental security of the back-end
> monitoring system and back-end attestation component.
>
> This appendix is referenced through test items outlined previously in
> the MPoC standard, where security assurance of those systems is
> required, but assessment to PCI DSS is not otherwise in scope. Where
> assessment against the requirements in this appendix is to be
> performed, the MPoC laboratory must confirm that all relevant systems
> and personnel are included. This may include subsets of all possible
> systems or personnel if sufficient clarity on the systems and
> operations of the environment can be determined. The term "all
> personnel" as used within these requirements refers to all personnel
> deemed to be in scope by the MPoC laboratory.
>
> Assessments to Appendix A are expected to be performed by suitably
> qualified individuals and cannot be performed as a self-assessment.
> Remote assessments may be performed to Appendix A, if in line with
> current PCI SSC guidance on remote assessment processes.

##### Table 5: Mapping of Appendix A Security Requirements to PCI DSS Requirements

+-----------------------------+----------------------------------------+
| > **Appendix A Security     | > **PCI DSS Requirements (from PCI DSS |
| > Requirements**            | > v3.2.1 & PCI DSS v4.0)**             |
+=============================+========================================+
| > **A1. Maintain security   | Requirement 12                         |
| > policies for all          |                                        |
| > personnel**               |                                        |
+-----------------------------+----------------------------------------+
| > **A2. Secure network      | Requirement 1                          |
| > connectivity**            |                                        |
|                             | Requirement 10                         |
|                             |                                        |
|                             | Requirement 11                         |
+-----------------------------+----------------------------------------+
| > **A3. Develop and         | Requirement 2                          |
| > maintain secure systems** |                                        |
|                             | Requirement 6                          |
+-----------------------------+----------------------------------------+
| > **A4. Vulnerability       | Requirement 5                          |
| > management**              |                                        |
|                             | Requirement 6                          |
|                             |                                        |
|                             | Requirement 11                         |
+-----------------------------+----------------------------------------+
| > **A5. Manage access**     | Requirement 7                          |
|                             |                                        |
|                             | Requirement 8                          |
+-----------------------------+----------------------------------------+
| > **A6. Physical security** | Requirement 9                          |
+-----------------------------+----------------------------------------+
| > **A7. Incident response   | Requirement 10                         |
| > preparedness**            |                                        |
|                             | Requirement 12                         |
+-----------------------------+----------------------------------------+

## Maintain Security Policies for All Personnel

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **Control        |                      |                          |
| > Objective:**     |                      |                          |
| > Security         |                      |                          |
| > policies define  |                      |                          |
| > rules and        |                      |                          |
| > requirements for |                      |                          |
| > all personnel to |                      |                          |
| > protect the      |                      |                          |
| > security and     |                      |                          |
| > integrity of the |                      |                          |
| > entity's         |                      |                          |
| > resources and    |                      |                          |
| > protect against  |                      |                          |
| > identified       |                      |                          |
| > risks.           |                      |                          |
+--------------------+----------------------+--------------------------+

1.  Security governance

+--------------------+----------------------+--------------------------+
| > **A.1.1.1**      | -   Examine          | The security objectives  |
| > Security         |     documentation.   | need to be defined as    |
| > objectives are   |                      | part of an overarching   |
| > aligned with     | -   Interview        | security strategy that   |
| > business         |     personnel.       | supports and facilitates |
| > objectives.      |                      | business objectives. The |
|                    |                      | security strategy needs  |
|                    |                      | to provide the           |
|                    |                      | foundation for the       |
|                    |                      | entity's security        |
|                    |                      | policies and procedures  |
|                    |                      | and provide a benchmark  |
|                    |                      | against which the health |
|                    |                      | of security controls is  |
|                    |                      | monitored and measured.  |
+====================+======================+==========================+
| > **A.1.1.2**      | -   Examine          | The assignment of        |
| > Responsibilities |     documentation.   | specific roles and       |
| > and              |                      | responsibilities need to |
| > accountability   | -   Interview        | include monitoring and   |
| > for meeting      |     personnel.       | measurement of           |
| > security         |                      | performance to ensure    |
| > objectives are   |                      | security objectives are  |
| > assigned         |                      | met. Roles and           |
| > formally,        |                      | responsibilities may be  |
| > including        |                      | assigned to a single     |
| > responsibilities |                      | owner or multiple owners |
| > for the security |                      | for different aspects.   |
| > of the           |                      |                          |
| > environment.     |                      | Ownership needs to be    |
|                    |                      | assigned to individuals  |
|                    |                      | with the authority to    |
|                    |                      | make risk-based          |
|                    |                      | decisions and upon whom  |
|                    |                      | accountability rests for |
|                    |                      | the specific function.   |
|                    |                      | Duties are required to   |
|                    |                      | be defined formally, and |
|                    |                      | owners must be able to   |
|                    |                      | demonstrate an           |
|                    |                      | understanding of their   |
|                    |                      | responsibilities and     |
|                    |                      | accountability.          |
+--------------------+----------------------+--------------------------+
| > **A.1.1.3**      | -   Examine          |                          |
| > Responsibility   |     documentation.   |                          |
| > for identifying  |                      |                          |
| > and addressing   | -   Interview        |                          |
| > evolving risks   |     personnel.       |                          |
| > is assigned.     |                      |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
+--------------------+----------------------+--------------------------+

1.  Maintain security policies

2.  Evaluate risk

+--------------------+----------------------+--------------------------+
| > **A.1.3.1** A    | -   Examine          | Risks to environments    |
| > risk-assessment  |     documented       | must be assessed at      |
| > process is       |     policies and     | least annually and upon  |
| > documented.      |     procedures.      | significant changes. The |
|                    |                      | risk assessment is       |
|                    | -   Interview        | required to identify     |
|                    |     personnel        | assets, threats,         |
|                    |     responsible for  | likelihood, and          |
|                    |     risk- assessment | potential impacts. Risk  |
|                    |     process.         | considerations need to   |
|                    |                      | include internal and     |
|                    |                      | external attacks (e.g.,  |
|                    |                      | for cybercrime, fraud,   |
|                    |                      | or theft), internal      |
|                    |                      | control failures, and    |
|                    |                      | malware. Risks must be   |
|                    |                      | prioritized and          |
|                    |                      | resources allocated to   |
|                    |                      | implement controls that  |
|                    |                      | reduce the likelihood    |
|                    |                      | and/or the potential     |
|                    |                      | impact of the threat     |
|                    |                      | being realized.          |
|                    |                      | Considerations are       |
|                    |                      | required to include      |
|                    |                      | regulatory obligations   |
|                    |                      | and changes in           |
|                    |                      | technology (e.g.,        |
|                    |                      | deprecation of           |
|                    |                      | encryption algorithms).  |
|                    |                      |                          |
|                    |                      | ***Note:** Examples of   |
|                    |                      | risk-assessment          |
|                    |                      | methodologies include    |
|                    |                      | but are not limited to   |
|                    |                      | OCTAVE, ISO 27005 and    |
|                    |                      | NIST SP 800-30.*         |
+====================+======================+==========================+
| > **A.1.3.2** The  |                      |                          |
| > documented       |                      |                          |
| > risk-assessment  |                      |                          |
| > process is       |                      |                          |
| > performed at     |                      |                          |
| > least annually   |                      |                          |
| > and upon         |                      |                          |
| > significant      |                      |                          |
| > changes.         |                      |                          |
+--------------------+----------------------+--------------------------+

1.  Manage risk

2.  Manage third-party relationships

+--------------------+----------------------+--------------------------+
| > **A.1.5.1**      | -   Examine          | Policies and procedures  |
| > Policies and     |     documented       | for managing third-party |
| > procedures for   |                      | relationships need to    |
| > managing         | policies/procedures. | consider the risk that   |
| > third-party      |                      | each relationship        |
| > relationships    | -   Interview        | represents, as well as   |
| > are maintained   |     personnel.       | how third-party          |
| > and implemented. |                      | performance and behavior |
|                    |                      | will be monitored. The   |
|                    |                      | policy needs to be kept  |
|                    |                      | up to date, approved by  |
|                    |                      | management, and          |
|                    |                      | communicated to          |
|                    |                      | applicable personnel.    |
+====================+======================+==========================+
| > **A.1.5.2** Due  | -   Examine          | Due-diligence processes  |
| > diligence is     |     documented       | need to include thorough |
| > performed prior  |     procedures.      | vetting and a risk       |
| > to any           |                      | analysis prior to        |
| > engagement with  | -   Examine results  | establishing a formal    |
| > a third party.   |     of due diligence | relationship with the    |
|                    |     efforts          | third party. Specific    |
|                    |                      | due-diligence processes  |
|                    | -   Interview        | and goals will vary for  |
|                    |     personnel.       | each entity and each is  |
|                    |                      | required to provide      |
|                    |                      | sufficient assurance     |
|                    |                      | that the third party can |
|                    |                      | meet the entity's        |
|                    |                      | security and operational |
|                    |                      | needs.                   |
+--------------------+----------------------+--------------------------+
| > **A.1.5.3**      | -   Examine          | The specific approach    |
| > Security         |     documentation    | for defining security    |
| > responsibilities |                      | responsibilities will    |
| > are defined      | -   Interview        | depend on the type of    |
| > clearly for each |     personnel.       | service, as well as the  |
| > third-party      |                      | particular agreement     |
| > engagement.      |                      | between the entity and   |
|                    |                      | any third parties. The   |
|                    |                      | entity needs to have a   |
|                    |                      | clear understanding of   |
|                    |                      | the security             |
|                    |                      | responsibilities to be   |
|                    |                      | met by the third party   |
|                    |                      | and those to be met by   |
|                    |                      | the entity.              |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.1.5.4** The  | -   Examine results  | The specific type of     |
| > entity           |     of periodic      | evidence provided by the |
| > periodically     |     verification.    | third party will depend  |
| > verifies that    |                      | on the agreement in      |
| > the agreed-upon  | -   Interview        | place between the two    |
| > responsibilities |     personnel.       | parties. The evidence    |
| > are being met.   |                      | needs to provide         |
|                    |                      | assurance that the       |
|                    |                      | agreed-upon              |
|                    |                      | responsibilities are     |
|                    |                      | being met on a continual |
|                    |                      | basis. The frequency of  |
|                    |                      | verification needs to be |
|                    |                      | aligned with the         |
|                    |                      | entity's risk analysis   |
|                    |                      | of the service being     |
|                    |                      | provided.                |
|                    |                      |                          |
|                    |                      | PCI SSC provides from    |
|                    |                      | time to time guidance on |
|                    |                      | best practice methods    |
|                    |                      | for management of third  |
|                    |                      | parties. The most recent |
|                    |                      | guidance, including for  |
|                    |                      | providers of cloud-      |
|                    |                      | based services and       |
|                    |                      | guidance provided in the |
|                    |                      | PCI DSS requirements,    |
|                    |                      | should be referenced     |
|                    |                      | when considering this    |
|                    |                      | requirement.             |
+--------------------+----------------------+--------------------------+
| > **A.1.5.5**      | -   Examine          | Agreements need to       |
| > Written          |     documentation.   | promote a consistent     |
| > agreements are   |                      | level of understanding   |
| > maintained.      | -   Interview        | between parties about    |
|                    |     personnel.       | their applicable         |
|                    |                      | responsibilities and be  |
|                    |                      | acknowledged by each     |
|                    |                      | party. The               |
|                    |                      | acknowledgement          |
|                    |                      | evidences each party's   |
|                    |                      | commitment to            |
|                    |                      | maintaining proper       |
|                    |                      | security in regard to    |
|                    |                      | the services.            |
+--------------------+----------------------+--------------------------+

1.  Educate personnel

+--------------------+----------------------+--------------------------+
| > **A.1.6.1** A    | -   Examine          | The security-awareness   |
| >                  |     documented       | program needs to result  |
| security-awareness |     policies and     | in personnel             |
| > program is       |     procedures.      | understanding the        |
| > implemented that |                      | security policy and      |
| > provides         | -   Examine          | procedures, and their    |
| > awareness to all |                      | responsibilities for     |
| > applicable       |   security-awareness | following secure         |
| > personnel about  |     materials.       | processes. All           |
| > security policy  |                      | personnel---including    |
| > and procedures.  |                      | full-time, part-time,    |
|                    |                      | and temporary employees, |
|                    |                      | contractors, and         |
|                    |                      | consultants--- with      |
|                    |                      | access to or the ability |
|                    |                      | to impact the security   |
|                    |                      | of the environment must  |
|                    |                      | be required to complete  |
|                    |                      | training.                |
|                    |                      |                          |
|                    |                      | Training is required     |
|                    |                      | upon hire and include    |
|                    |                      | periodic refresher       |
|                    |                      | sessions at appropriate  |
|                    |                      | intervals. The frequency |
|                    |                      | of training needs to be  |
|                    |                      | aligned with the         |
|                    |                      | entity's policies for    |
|                    |                      | education and security   |
|                    |                      | awareness, and           |
|                    |                      | commensurate with        |
|                    |                      | personnel job function.  |
+====================+======================+==========================+
| > **A.1.6.2**      | -   Examine records  |                          |
| > Personnel        |     of attendance.   |                          |
| > receive security |                      |                          |
| > awareness        | -   Interview        |                          |
| > training at      |     personnel.       |                          |
| > defined          |                      |                          |
| > intervals, as    |                      |                          |
| > appropriate for  |                      |                          |
| > their job        |                      |                          |
| > function but at  |                      |                          |
| > least every 12   |                      |                          |
| > months.          |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.1.6.3**      | -   Interview        |                          |
| > Personnel are    |     personnel.       |                          |
| > aware of the     |                      |                          |
| > security policy  |                      |                          |
| > and              |                      |                          |
| > responsibilities |                      |                          |
| > as applicable to |                      |                          |
| > their job        |                      |                          |
| > function.        |                      |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.1.7** Screen |                      |                          |
| > personnel        |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.1.7.1**      | -   Examine          | The intent of screening  |
| > Personnel are    |     documented       | personnel is to reduce   |
| > screened         |     policies and     | the risk of fraud and    |
| > (background      |     procedures.      | unscrupulous behavior    |
| > checks) prior to |                      | from an internal         |
| > being granted    | -   Interview        | resource. Role           |
| > access to the    |     personnel.       | descriptions need to     |
| > environment.     |                      | describe the level of    |
|                    | -   Examine results  | security or access       |
|                    |     of screening     | required for the role,   |
|                    |     process.         | and the level of         |
|                    |                      | screening needs to be    |
|                    |                      | appropriate for the      |
|                    |                      | particular position.     |
|                    |                      | Positions requiring      |
|                    |                      | greater responsibility   |
|                    |                      | or that have             |
|                    |                      | administrative access to |
|                    |                      | critical data or systems |
|                    |                      | may warrant more         |
|                    |                      | detailed background      |
|                    |                      | checks than positions    |
|                    |                      | with less responsibility |
|                    |                      | and access. The policy   |
|                    |                      | is required to also      |
|                    |                      | cover internal           |
|                    |                      | transfers, where         |
|                    |                      | personnel in lower risk  |
|                    |                      | positions and who have   |
|                    |                      | not already undergone a  |
|                    |                      | detailed background      |
|                    |                      | check are promoted or    |
|                    |                      | transferred to positions |
|                    |                      | of greater               |
|                    |                      | responsibility or        |
|                    |                      | access. The specific     |
|                    |                      | roles to be screened     |
|                    |                      | depends on the entity's  |
|                    |                      | personnel and security   |
|                    |                      | policies. For example,   |
|                    |                      | an entity may have a     |
|                    |                      | policy that requires     |
|                    |                      | detailed screening for   |
|                    |                      | all personnel or defines |
|                    |                      | different levels of      |
|                    |                      | screening for different  |
|                    |                      | job functions.           |
|                    |                      |                          |
|                    |                      | Examples of criteria     |
|                    |                      | that may be appropriate  |
|                    |                      | include employment       |
|                    |                      | history, criminal        |
|                    |                      | records, credit history, |
|                    |                      | and reference checks.    |
+--------------------+----------------------+--------------------------+
| > **A.1.7.2** The  |                      |                          |
| > screening        |                      |                          |
| > process includes |                      |                          |
| > established      |                      |                          |
| > criteria and a   |                      |                          |
| > decision process |                      |                          |
| > for background   |                      |                          |
| > check results.   |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.1.8**        |                      |                          |
| > Business as      |                      |                          |
| > Usual (BAU)      |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.1.8.1**      | -   Examine evidence | Periodic reviews and/or  |
| > Review and/or    |     of reviews       | ongoing monitoring of    |
| > monitoring is    |     and/or ongoing   | personnel and activities |
| > performed        |     monitoring.      | is required to ensure    |
| > periodically to  |                      | that security is         |
| > confirm          | -   Interview        | included as part of      |
| > personnel are    |     personnel.       | normal business          |
| > following        |                      | operations on an ongoing |
| > security         |                      | basis. Reviews must be   |
| > policies and     |                      | performed by responsible |
| > procedures.      |                      | personnel as defined by  |
|                    |                      | the entity. The          |
|                    |                      | frequency of reviews is  |
|                    |                      | required to be defined   |
|                    |                      | in accordance with the   |
|                    |                      | entity's risk            |
|                    |                      | assessments and be       |
|                    |                      | appropriate for the      |
|                    |                      | particular job function. |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.1.8.2**      | -   Examine          | The entity needs to be   |
| > Processes to     |     documented       | able to detect any       |
| > detect and       |     processes.       | failures in security     |
| > respond to       |                      | controls and respond to  |
| > security control | -   Observe          | them in a timely manner. |
| > failures are     |     implemented      | Processes for responding |
| > defined and      |     processes.       | to security control      |
| > implemented.     |                      | failures is required to  |
|                    | -   Interview        | include:                 |
|                    |     personnel.       |                          |
|                    |                      | -   Restoring the        |
|                    |                      |     security control     |
|                    |                      |                          |
|                    |                      | -   Identifying the      |
|                    |                      |     cause of failure     |
|                    |                      |                          |
|                    |                      | -   Identifying and      |
|                    |                      |     addressing any       |
|                    |                      |     security issues that |
|                    |                      |     arose during the     |
|                    |                      |     failure of the       |
|                    |                      |     security control     |
|                    |                      |                          |
|                    |                      | -   Implementing         |
|                    |                      |     mitigation, such as  |
|                    |                      |     process or technical |
|                    |                      |     controls, to prevent |
|                    |                      |     the cause of the     |
|                    |                      |     failure recurring    |
|                    |                      |                          |
|                    |                      | -   Resuming monitoring  |
|                    |                      |     of the security      |
|                    |                      |     control              |
+--------------------+----------------------+--------------------------+

## Secure Network Connectivity

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **Control        |                      |                          |
| > Objective:**     |                      |                          |
| > Ne               |                      |                          |
| twork-connectivity |                      |                          |
| > controls provide |                      |                          |
| > secure pathways  |                      |                          |
| > to the entity's  |                      |                          |
| > systems while    |                      |                          |
| > protecting those |                      |                          |
| > systems from     |                      |                          |
| > unauthorized     |                      |                          |
| > access and       |                      |                          |
| > network-based    |                      |                          |
| > threats.         |                      |                          |
+--------------------+----------------------+--------------------------+

1.  Protect systems from untrusted systems and networks

+--------------------+----------------------+--------------------------+
| > **A.2.1.1** A    | -   Examine          | Policies for protecting  |
| > security         |     documented       | the environment          |
| > policy(s) and    |     policies and     | boundaries need to       |
| > procedures for   |     procedures.      | define the purpose,      |
| > protection of    |                      | scope, roles, and        |
| > the environment  | -   Interview        | responsibilities of      |
| > boundaries are   |     personnel.       | defined boundaries to    |
| > maintained and   |                      | protect system           |
| > implemented.     |                      | components from          |
|                    |                      | untrusted networks. The  |
|                    |                      | policy is required to be |
|                    |                      | kept up to date,         |
|                    |                      | approved by management,  |
|                    |                      | and communicated to      |
|                    |                      | applicable personnel.    |
+====================+======================+==========================+
| > **A.2.1.2**      | -   Examine network  | Network and data-flow    |
| > Up-to-date       |     and data-flow    | information (e.g.,       |
| > network and      |     information.     | diagrams or              |
| > data-flow        |                      | network-mapping tools)   |
| > information is   | -   Observe methods  | accurately document how  |
| > maintained for   |     used to maintain | the entity's networks    |
| > all              |     up-to- date      | are configured, the      |
| > communication    |     network and      | identity and location of |
| > paths.           |     data-flow        | all systems, how systems |
|                    |     information.     | are connected to each    |
|                    |                      | other, and all           |
|                    |                      | communication paths with |
|                    |                      | trusted and untrusted    |
|                    |                      | networks.                |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.2.1.3**      | -   Examine          | Documentation            |
| > Access between   |     documentation    | illustrating authorized  |
| > trusted and      |     describing       | communications, both     |
| > untrusted        |     controls.        | internal and             |
| > networks,        |                      | external---including     |
| > systems, and     | -   Observe physical | source and destination   |
| > applications is  |     and/or logical   | systems, interface       |
| > limited via      |     controls.        | connections, security    |
| > physical and/or  |                      | controls for those       |
| > logical          |                      | connections, and the     |
| > controls.        |                      | type of data being       |
|                    |                      | sent---will assist in    |
|                    |                      | meeting these            |
|                    |                      | requirements.            |
|                    |                      |                          |
|                    |                      | Protection mechanisms    |
|                    |                      | may include technologies |
|                    |                      | such as network          |
|                    |                      | gateways, routers,       |
|                    |                      | firewalls, encryption,   |
|                    |                      | API controls, and        |
|                    |                      | virtualization           |
|                    |                      | techniques. Controls may |
|                    |                      | be a combination of      |
|                    |                      | software and             |
|                    |                      | hardware---e.g., use of  |
|                    |                      | packet-filtering         |
|                    |                      | capability based on      |
|                    |                      | header information,      |
|                    |                      | advanced                 |
|                    |                      | filtering/inspection     |
|                    |                      | tools, and               |
|                    |                      | implementation of        |
|                    |                      | dedicated physical       |
|                    |                      | network devices or       |
|                    |                      | channels to separate     |
|                    |                      | network segments.        |
|                    |                      |                          |
|                    |                      | Many security devices    |
|                    |                      | and software provide     |
|                    |                      | rule sets and settings   |
|                    |                      | that can validate the    |
|                    |                      | existence and            |
|                    |                      | methodologies used to    |
|                    |                      | secure network           |
|                    |                      | connectivity.            |
+--------------------+----------------------+--------------------------+
| > **A.2.1.4**      | -   Examine          |                          |
| > Traffic to and   |     documentation    |                          |
| > from systems is  |     identifying      |                          |
| > restricted to    |     necessary        |                          |
| > only that which  |     traffic.         |                          |
| > is necessary,    |                      |                          |
| > with all other   | -   Observe          |                          |
| > traffic          |     configurations   |                          |
| > specifically     |     of ingress and   |                          |
| > denied.          |     egress controls. |                          |
+--------------------+----------------------+--------------------------+
| > **A.2.1.5**      | -   Examine          | Reviewing device         |
| > Network          |     documented       | configurations allows    |
| > connectivity     |     methods for      | the entity to identify   |
| > controls are     |     monitoring       | and remove any unneeded, |
| > monitored and/or |     and/or           | outdated, or incorrect   |
| > periodically     |     periodically     | rules and confirm that   |
| > reviewed to      |     reviewing        | only authorized          |
| > confirm          |     network          | connections, ports,      |
| > configurations   |     connectivity     | protocols, services, and |
| > are effective.   |     controls.        | APIs are allowed as      |
|                    |                      | defined in the           |
|                    | -   Observe          | documented business      |
|                    |     implemented      | justifications. All      |
|                    |     methods and      | other services,          |
|                    |     processes.       | protocols, and ports     |
|                    |                      | need to remain disabled  |
|                    |                      | or be removed through    |
|                    |                      | periodic reviews. Review |
|                    |                      | processes may include    |
|                    |                      | real-time monitoring and |
|                    |                      | analysis, periodic       |
|                    |                      | maintenance cycles to    |
|                    |                      | ensure the controls are  |
|                    |                      | accurate and working as  |
|                    |                      | intended, and periodic   |
|                    |                      | reviews of network       |
|                    |                      | traffic connectivity     |
|                    |                      | across ports, protocols, |
|                    |                      | and services. For        |
|                    |                      | guidance on services,    |
|                    |                      | protocols, or ports      |
|                    |                      | considered to be         |
|                    |                      | insecure, refer to       |
|                    |                      | industry standards and   |
|                    |                      | guidance (e.g., NIST,    |
|                    |                      | ENISA, OWASP, etc.).     |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.2.2**        |                      |                          |
| > Protect systems  |                      |                          |
| > from network     |                      |                          |
| > threats          |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.2.2.1**      | -   Examine          | Controls must be         |
| > Controls are     |     documented       | implemented at the       |
| > implemented to   |     co               | perimeter and critical   |
| > detect and/or    | ntrols/configuration | systems points and       |
| > block known and  |     standards.       | include consideration of |
| > unknown network  |                      | both network-based and   |
| > attacks.         | -   Observe          | application-based attack |
|                    |     implemented      | vectors.                 |
|                    |     controls.        |                          |
|                    |                      | Methods of detection may |
|                    |                      | include signature-based, |
|                    |                      | behavioral, and other    |
|                    |                      | mechanisms that analyze  |
|                    |                      | traffic flows. Examples  |
|                    |                      | of tools include         |
|                    |                      | IDS/IPS, host firewalls, |
|                    |                      | and real-time traffic    |
|                    |                      | analysis tools. All      |
|                    |                      | mechanisms---such as     |
|                    |                      | detection engines,       |
|                    |                      | baselines, and           |
|                    |                      | signatures---must be     |
|                    |                      | configured, maintained,  |
|                    |                      | and updated per vendor   |
|                    |                      | instructions to ensure   |
|                    |                      | optimal protection.      |
+--------------------+----------------------+--------------------------+
| > **A.2.2.2**      | -   Examine          | If suspicious traffic is |
| > Suspicious       |     documented       | not automatically        |
| > traffic is       |     procedures.      | blocked, an alert should |
| > blocked or       |                      | be generated that is     |
| > generates an     | -   Observe          | actively monitored and   |
| > alert that is    |     implemented      | immediately              |
| > investigated and |     controls and     | investigated.            |
| > responded to.    |     processes.       |                          |
|                    |                      | When suspicious traffic  |
|                    |                      | is automatically         |
|                    |                      | blocked, a record of the |
|                    |                      | traffic needs to be      |
|                    |                      | generated and            |
|                    |                      | investigated to          |
|                    |                      | determine whether action |
|                    |                      | is needed to prevent     |
|                    |                      | further attack.          |
+--------------------+----------------------+--------------------------+

## Develop and Maintain Secure Systems

+--------------------+---------------------+---------------------------+
| > **Security       | > **Test            | > **Guidance**            |
| > Requirements**   | > Requirements**    |                           |
+====================+=====================+===========================+
| > **Control        |                     |                           |
| > Objective:**     |                     |                           |
| > Security risks   |                     |                           |
| > and events can   |                     |                           |
| > occur at any     |                     |                           |
| > time during the  |                     |                           |
| > lifetime of a    |                     |                           |
| > system or        |                     |                           |
| > application.     |                     |                           |
| > Integrating      |                     |                           |
| > secure processes |                     |                           |
| > throughout the   |                     |                           |
| > lifecycle        |                     |                           |
| > provides         |                     |                           |
| > assurance that   |                     |                           |
| > system integrity |                     |                           |
| > is maintained at |                     |                           |
| > all times.       |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1** Secure |                     |                           |
| > application      |                     |                           |
| > development      |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.1** A    | -   Examine         | When software is          |
| > security         |     documented      | developed by the entity   |
| > policy(s) and    |     policies and    | or bespoke or custom      |
| > procedures for   |     procedures.     | software is developed by  |
| > secure           |                     | a third party for the     |
| > management of    | -   Interview       | entity, the               |
| > the Software     |     personnel.      | software-development      |
| > Development      |                     | process is required to    |
| > Lifecycle (SDLC) |                     | employ secure coding      |
| > is maintained    |                     | practices to address      |
| > and implemented. |                     | common vulnerabilities    |
|                    |                     | applicable to the         |
|                    |                     | particular technology.    |
|                    |                     | The entity needs to       |
|                    |                     | remain up to date with    |
|                    |                     | vulnerability trends and  |
|                    |                     | update its secure coding  |
|                    |                     | practices and developer   |
|                    |                     | training as needed to     |
|                    |                     | address new threats.      |
|                    |                     | Examples of current best  |
|                    |                     | practices include OWASP,  |
|                    |                     | SANS CWE Top 25, and CERT |
|                    |                     | Secure Coding.            |
|                    |                     |                           |
|                    |                     | Application developers    |
|                    |                     | must be trained properly  |
|                    |                     | to identify and resolve   |
|                    |                     | issues related to common  |
|                    |                     | coding vulnerabilities.   |
|                    |                     | Having staff              |
|                    |                     | knowledgeable about       |
|                    |                     | secure software-          |
|                    |                     | development practices     |
|                    |                     | minimizes the number of   |
|                    |                     | security vulnerabilities  |
|                    |                     | accidentally introduced   |
|                    |                     | through poor coding       |
|                    |                     | practices. Training for   |
|                    |                     | developers may be         |
|                    |                     | provided in-house or by   |
|                    |                     | third parties and needs   |
|                    |                     | to be appropriate for the |
|                    |                     | technology used.          |
|                    |                     |                           |
|                    |                     | Common methods for        |
|                    |                     | software security testing |
|                    |                     | include threat modeling,  |
|                    |                     | code reviews, fuzz        |
|                    |                     | testing, and penetration  |
|                    |                     | testing. Software         |
|                    |                     | security testing should   |
|                    |                     | be performed by someone   |
|                    |                     | other than the developer  |
|                    |                     | of the code to allow for  |
|                    |                     | an independent, objective |
|                    |                     | review. Automated tools   |
|                    |                     | or processes may also be  |
|                    |                     | used in lieu of manual    |
|                    |                     | reviews, but keep in mind |
|                    |                     | that it may be difficult  |
|                    |                     | or even impossible for an |
|                    |                     | automated tool to         |
|                    |                     | identify some coding      |
|                    |                     | errors or other security  |
|                    |                     | issues.                   |
|                    |                     |                           |
|                    |                     | Correcting identified     |
|                    |                     | software defects before   |
|                    |                     | the software is deployed  |
|                    |                     | prevents it from exposing |
|                    |                     | the environments to       |
|                    |                     | potential exploit.        |
|                    |                     | Requiring a formal review |
|                    |                     | and sign-off by           |
|                    |                     | management verifies that  |
|                    |                     | the software is approved  |
|                    |                     | and has been developed in |
|                    |                     | accordance with policies  |
|                    |                     | and procedures.           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.2**      | -   Examine         |                           |
| > Personnel        |     evidence of     |                           |
| > involved in      |     training.       |                           |
| > software         |                     |                           |
| > development are  | -   Interview       |                           |
| > trained in       |     developer       |                           |
| > secure software- |     personnel.      |                           |
| > development      |                     |                           |
| > practices.       |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.3**      | -   Examine         |                           |
| > Software         |     documented      |                           |
| > development      |     procedures.     |                           |
| > procedures       |                     |                           |
| > include          | -   Interview       |                           |
| > processes to     |     developer       |                           |
| > address common   |     personnel.      |                           |
| > coding           |                     |                           |
| > vulnerabilities. |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.4**      | -   Examine         |                           |
| > Software         |     documented      |                           |
| > security testing |     software        |                           |
| > is conducted     |     security        |                           |
| > during the       |     testing         |                           |
| > software         |     procedures.     |                           |
| > development      |                     |                           |
| > lifecycle (SDLC) | -   Examine results |                           |
| > using            |     of software     |                           |
| > methodologies    |     security        |                           |
| > documented in    |     testing.        |                           |
| > the SDLC         |                     |                           |
| > processes.       | -   Interview       |                           |
|                    |     personnel.      |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.5** The  | -   Examine         |                           |
| > software         |     documented      |                           |
| > security testing |     software        |                           |
| > process          |     security        |                           |
| > identifies       |     testing         |                           |
| > defects and      |     procedures.     |                           |
| > security         |                     |                           |
| > vulnerabilities. | -   Examine results |                           |
|                    |     of software     |                           |
|                    |     security        |                           |
|                    |     testing.        |                           |
|                    |                     |                           |
|                    | -   Interview       |                           |
|                    |     personnel.      |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.6**      |                     |                           |
| > Identified       |                     |                           |
| > software defects |                     |                           |
| > and security     |                     |                           |
| > vulnerabilities  |                     |                           |
| > are addressed    |                     |                           |
| > prior to         |                     |                           |
| > release.         |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.1.7**      |                     |                           |
| > Results of       |                     |                           |
| > software         |                     |                           |
| > security testing |                     |                           |
| > are signed off   |                     |                           |
| > by management    |                     |                           |
| > prior to         |                     |                           |
| > software         |                     |                           |
| > release.         |                     |                           |
+--------------------+---------------------+---------------------------+

+--------------------+---------------------+---------------------------+
| > **Security       | > **Test            | > **Guidance**            |
| > Requirements**   | > Requirements**    |                           |
+====================+=====================+===========================+
| > **A.3.2**        |                     |                           |
| > Configuration    |                     |                           |
| > standards        |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.2.1** A    | -   Examine         | The policy document needs |
| > security         |     documented      | to explain the purpose,   |
| > policy(s) and    |     policies and    | scope, roles and          |
| > procedures for   |     procedures.     | responsibilities, methods |
| > system build and |                     | of access for different   |
| > configuration    | -   Interview       | account types,            |
| > management are   |     personnel.      | configuration management, |
| > maintained and   |                     | monitoring methodology,   |
| > implemented.     |                     | and controls to address   |
|                    |                     | known risks.              |
+--------------------+---------------------+---------------------------+
| > **A.3.2.2** An   | -   Examine system  | Maintaining a current     |
| > up-to-date       |     inventory.      | inventory of all system   |
| > inventory of all |                     | components enables an     |
| > system           | -   Interview       | organization to           |
| > components in    |     personnel.      | accurately and            |
| > the environment  |                     | efficiently apply         |
| > is maintained.   |                     | security controls to      |
|                    |                     | protect the assets. The   |
|                    |                     | inventory should be       |
|                    |                     | periodically confirmed by |
|                    |                     | either manual or          |
|                    |                     | automated process---e.g., |
|                    |                     | by correlation with the   |
|                    |                     | results of vulnerability  |
|                    |                     | scans or penetration      |
|                    |                     | testing---to confirm it   |
|                    |                     | is up to date.            |
+--------------------+---------------------+---------------------------+
| > **A.3.2.3**      | -   Examine system  | System configuration      |
| > Configuration    |     configuration   | standards must be kept up |
| > standards are    |     standards and   | to date to ensure that    |
| > defined and      |     build           | newly identified          |
| > implemented for  |     procedures for  | weaknesses are corrected  |
| > all system       |     all system      | prior to a system being   |
| > types.           |     component       | deployed in the           |
|                    |     types.          | environment.              |
|                    |                     |                           |
|                    | -   Examine system  | System configuration      |
|                    |     configurations. | standards and related     |
|                    |                     | processes needs to        |
|                    | -   Interview       | specifically address      |
|                    |     personnel.      | security settings and     |
|                    |                     | parameters that have      |
|                    |                     | known security            |
|                    |                     | implications for each     |
|                    |                     | type of system in use.    |
|                    |                     | Examples of               |
|                    |                     | industry-accepted         |
|                    |                     | configuration standards   |
|                    |                     | include, but are not      |
|                    |                     | limited to:               |
|                    |                     |                           |
|                    |                     | -   Center for Internet   |
|                    |                     |     Security (CIS)        |
|                    |                     |                           |
|                    |                     | -   International         |
|                    |                     |     Organization for      |
|                    |                     |     Standardization (ISO) |
|                    |                     |                           |
|                    |                     | -   SysAdmin Audit        |
|                    |                     |     Network Security      |
|                    |                     |     (SANS) Institute      |
|                    |                     |                           |
|                    |                     | -   National Institute of |
|                    |                     |     Standards Technology  |
|                    |                     |     (NIST)                |
|                    |                     |                           |
|                    |                     | The implemented controls  |
|                    |                     | need to provide assurance |
|                    |                     | that all systems in the   |
|                    |                     | environment have known    |
|                    |                     | secure configurations.    |
+--------------------+---------------------+---------------------------+
| > **A.3.2.4**      |                     |                           |
| > Configuration    |                     |                           |
| > standards        |                     |                           |
| > address all      |                     |                           |
| > known security   |                     |                           |
| > vulnerabilities  |                     |                           |
| > and are based on |                     |                           |
| >                  |                     |                           |
|  industry-accepted |                     |                           |
| > system hardening |                     |                           |
| > standards.       |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.2.5**      | -   Examine system  |                           |
| > Configuration    |     configuration   |                           |
| > standards and    |     standards and   |                           |
| > build procedures |     build           |                           |
| > include:         |     procedures for  |                           |
|                    |     all system      |                           |
| -   Changing all   |     component       |                           |
|                    |     types.          |                           |
|    vendor-supplied |                     |                           |
|     default        | -   Examine system  |                           |
|     accounts and   |     configurations. |                           |
|     system         |                     |                           |
|     settings.      | -   Interview       |                           |
|                    |     personnel.      |                           |
| -   Removing or    |                     |                           |
|     disabling all  |                     |                           |
|     unnecessary    |                     |                           |
|     system or      |                     |                           |
|     application    |                     |                           |
|     functionality. |                     |                           |
|                    |                     |                           |
| -   Preventing     |                     |                           |
|     functions that |                     |                           |
|     require        |                     |                           |
|     different      |                     |                           |
|     security       |                     |                           |
|     levels from    |                     |                           |
|     co-existing on |                     |                           |
|     the same       |                     |                           |
|     system         |                     |                           |
|     component.     |                     |                           |
+--------------------+---------------------+---------------------------+

+--------------------+---------------------+---------------------------+
| > **Security       | > **Test            | > **Guidance**            |
| > Requirements**   | > Requirements**    |                           |
+====================+=====================+===========================+
| > **A.3.3** Change |                     |                           |
| > management       |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.3.1**      | -   Examine         | Defined change-control    |
| > Change-control   |     documented      | procedures must be        |
| > procedures are   |     change-control  | followed for any change   |
| > defined and      |     procedures.     | that impacts systems in   |
| > implemented for  |                     | the environment. The      |
| > all changes to   | -   Examine records | impact of the change      |
| > system           |     of changes and  | needs to be documented so |
| > components,      |     compare to      | that all affected parties |
| > including        |     system          | can plan appropriately    |
| > "emergency       |     configurations. | for any processing        |
| > changes."        |                     | changes. Changes must be  |
|                    | -   Interview       | authorized by appropriate |
|                    |     personnel.      | parties, as defined by    |
|                    |                     | the change-management     |
|                    |                     | policy, to verify the     |
|                    |                     | change is legitimate.     |
|                    |                     |                           |
|                    |                     | Thorough testing is       |
|                    |                     | required to be performed  |
|                    |                     | to verify that the        |
|                    |                     | security of the           |
|                    |                     | environment is not        |
|                    |                     | reduced by implementing a |
|                    |                     | change. Back-out          |
|                    |                     | procedures need to be     |
|                    |                     | documented in case the    |
|                    |                     | change fails or adversely |
|                    |                     | affects the security of   |
|                    |                     | any system component.     |
+--------------------+---------------------+---------------------------+
| > **A.3.3.2** All  |                     |                           |
| > changes are      |                     |                           |
| > authorized, and  |                     |                           |
| > the security     |                     |                           |
| > impact           |                     |                           |
| > understood prior |                     |                           |
| > to implementing  |                     |                           |
| > the change.      |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.3.3** All  |                     |                           |
| > changes are      |                     |                           |
| > tested in a non- |                     |                           |
| > production       |                     |                           |
| > environment.     |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.3.4**      |                     |                           |
| > Rollback         |                     |                           |
| > procedures are   |                     |                           |
| > prepared for all |                     |                           |
| > changes.         |                     |                           |
+--------------------+---------------------+---------------------------+
| > **A.3.3.5**      | -   Examine         | The implemented process   |
| > Unauthorized     |     documentation   | needs to be able to       |
| > changes to       |     of controls     | either prevent or detect  |
| > system or        |     and/or          | and address the           |
| > application      |     processes.      | unauthorized addition,    |
| > configurations   |                     | removal, or modification  |
| > are prevented    | -   Observe         | of system-critical files  |
| > and/or detected  |     implemented     | such as configuration     |
| > and addressed.   |     controls.       | file contents, OS         |
|                    |                     | programs, and application |
|                    | -   Interview       | executables. If the       |
|                    |     personnel.      | implemented solution      |
|                    |                     | relies on detection,      |
|                    |                     | processes must be in      |
|                    |                     | place to ensure that      |
|                    |                     | unauthorized changes are  |
|                    |                     | detected and addressed as |
|                    |                     | soon as possible. When    |
|                    |                     | unauthorized change       |
|                    |                     | attempts are              |
|                    |                     | automatically blocked, a  |
|                    |                     | record of the attempted   |
|                    |                     | change should also be     |
|                    |                     | generated and             |
|                    |                     | investigated to determine |
|                    |                     | whether action is needed  |
|                    |                     | to prevent further        |
|                    |                     | attempts.                 |
|                    |                     |                           |
|                    |                     | The controls could        |
|                    |                     | include change-detection  |
|                    |                     | solutions, such as        |
|                    |                     | file-integrity monitoring |
|                    |                     | or a frequent re-load of  |
|                    |                     | a trusted build to        |
|                    |                     | restore the system        |
|                    |                     | component to a known      |
|                    |                     | secure state.             |
+--------------------+---------------------+---------------------------+

## Vulnerability Management

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **Control        |                      |                          |
| > Objective:** New |                      |                          |
| > vulnerabilities  |                      |                          |
| > are continually  |                      |                          |
| > being discovered |                      |                          |
| > and can enter    |                      |                          |
| > the network from |                      |                          |
| > both internal    |                      |                          |
| > and external     |                      |                          |
| > sources. An      |                      |                          |
| > ongoing cycle of |                      |                          |
| > testing and      |                      |                          |
| > remediation      |                      |                          |
| > helps ensure     |                      |                          |
| > that security    |                      |                          |
| > controls         |                      |                          |
| > continue to be   |                      |                          |
| > effective in a   |                      |                          |
| > changing         |                      |                          |
| > environment.     |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.4.1**        |                      |                          |
| > Protect against  |                      |                          |
| > malicious        |                      |                          |
| > software         |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.4.1.1** A    | -   Examine          | Controls must be         |
| > security         |     documented       | implemented to help      |
| > policy(s) and    |     policies and     | prevent the introduction |
| > procedures for   |     procedures.      | and execution of         |
| > protecting       |                      | malicious software       |
| > systems against  | -   Interview        | (malware) on systems in  |
| > malware are      |     personnel.       | the environment. A       |
| > maintained and   |                      | combination of methods,  |
| > implemented.     |                      | tools, and programs may  |
|                    |                      | be used---e.g., anti-    |
|                    |                      | malware software,        |
|                    |                      | application              |
|                    |                      | whitelisting, host-based |
|                    |                      | and network-based        |
|                    |                      | intrusion-prevention     |
|                    |                      | tools, and system        |
|                    |                      | instrumentation. A       |
|                    |                      | combination of real-time |
|                    |                      | protection and periodic  |
|                    |                      | scans should be          |
|                    |                      | considered.              |
|                    |                      |                          |
|                    |                      | The implemented controls |
|                    |                      | must be kept current     |
|                    |                      | (e.g., updated           |
|                    |                      | signatures, baselines,   |
|                    |                      | etc.) as applicable for  |
|                    |                      | the technology.          |
|                    |                      | Anti-malware controls    |
|                    |                      | need to remain enabled   |
|                    |                      | unless disablement is    |
|                    |                      | specifically authorized  |
|                    |                      | by management on a       |
|                    |                      | case-by-case basis for a |
|                    |                      | limited time period.     |
+--------------------+----------------------+--------------------------+
| > **A.4.1.2**      | -   Examine          |                          |
| > Controls to      |     documented       |                          |
| > prevent and/or   |     cont             |                          |
| > detect and       | rols/configurations. |                          |
| > remove malicious |                      |                          |
| > software are     | -   Observe          |                          |
| > implemented,     |     implemented      |                          |
| > active, and      |     controls and     |                          |
| > maintained.      |     processes.       |                          |
|                    |                      |                          |
|                    | -   Examine evidence |                          |
|                    |     of malware       |                          |
|                    |     prevention       |                          |
|                    |     and/or detection |                          |
|                    |     and removal.     |                          |
|                    |                      |                          |
|                    | -   Interview        |                          |
|                    |     personnel.       |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
+--------------------+----------------------+--------------------------+

> **A.4.2** Address vulnerabilities and security weaknesses

+--------------------+----------------------+--------------------------+
| > **A.4.2.1** A    | -   Examine          | Policies and procedures  |
| > security         |     documented       | define the methods used  |
| > policy(s) and    |     policies and     | to identify and          |
| > procedures for   |     procedures.      | remediate                |
| > identifying,     |                      | vulnerabilities that     |
| > ranking, and     | -   Interview        | could affect systems in  |
| > protecting       |     personnel.       | the environment, and     |
| > against          |                      | include:                 |
| > vulnerabilities  |                      |                          |
| > are maintained   |                      | -   Monitoring           |
| > and implemented. |                      |     vulnerability lists  |
|                    |                      |                          |
|                    |                      | -   Performing           |
|                    |                      |     vulnerability scans  |
|                    |                      |     and penetration      |
|                    |                      |     tests                |
|                    |                      |                          |
|                    |                      | -   Establishing bug     |
|                    |                      |     bounty programs      |
|                    |                      |                          |
|                    |                      | Reputable outside        |
|                    |                      | sources should be used   |
|                    |                      | for security and         |
|                    |                      | vulnerability            |
|                    |                      | information.             |
+====================+======================+==========================+
| > **A.4.2.2**      | -   Examine          | Vulnerability scans and  |
| > Vulnerability    |     vulnerability    | all required remediation |
| > scans, both      |     scanning reports | are to be completed as   |
| > internal and     |                      | frequently as needed to  |
| > external, are    | -   Interview        | ensure vulnerabilities   |
| > performed at     |     personnel.       | are addressed in a       |
| > least quarterly  |                      | timely manner. Rescans   |
| > to identify and  |                      | should be performed to   |
| > address          |                      | verify vulnerabilities   |
| > vulnerabilities. |                      | have been addressed. In  |
|                    |                      | addition to a regular    |
|                    |                      | scanning process,        |
|                    |                      | vulnerability scans need |
|                    |                      | to be performed after    |
|                    |                      | any significant change   |
|                    |                      | to the environment.      |
+--------------------+----------------------+--------------------------+
| > **A.4.2.3**      | -   Examine          | Internal vulnerability   |
| > Vulnerability    |     vulnerability    | scans can be performed   |
| > scans are        |     scanning         | by qualified, internal   |
| > performed by     |     reports.         | staff or outsourced to a |
| > qualified        |                      | qualified third party.   |
| > personnel:       | -   Interview        | For scans managed by the |
|                    |     personnel.       | entity, the entity needs |
| -   External scans |                      | to ensure that scanning  |
|     are performed  |                      | engines and              |
|     by a PCI SSC   |                      | vulnerability            |
|     Approved       |                      | fingerprints are up to   |
|     Scanning       |                      | date and that the        |
|     Vendor (ASV).  |                      | scanning engine is       |
|                    |                      | configured in accordance |
| -   Internal scans |                      | with vendor guidance     |
|     are performed  |                      | documentation.           |
|     by qualified   |                      |                          |
|     personnel.     |                      | Internal personnel need  |
|                    |                      | to have sufficient       |
|                    |                      | knowledge to review and  |
|                    |                      | understand the scan      |
|                    |                      | results and determine    |
|                    |                      | appropriate remediation. |
|                    |                      | Internal personnel who   |
|                    |                      | interact with an ASV or  |
|                    |                      | other external agency    |
|                    |                      | used to perform scanning |
|                    |                      | should also be           |
|                    |                      | knowledgeable in the     |
|                    |                      | network architecture and |
|                    |                      | implemented security     |
|                    |                      | controls to provide the  |
|                    |                      | ASV with information     |
|                    |                      | needed to complete the   |
|                    |                      | scan.                    |
+--------------------+----------------------+--------------------------+
| > **A.4.2.4**      | -   Examine          | Vulnerabilities must be  |
| > Identified       |     documented       | ranked and prioritized   |
| > vulnerabilities  |     procedures for   | in accordance with an    |
| > are ranked to    |     ranking          | industry-accepted        |
| > determine the    |     vulnerabilities. | methodology or           |
| > criticality of   |                      | organizational           |
| > the              | -   Interview        | risk-management          |
| > vulnerability.   |     personnel.       | strategy.                |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.4.2.5**      | -   Examine          | Penetration tests must   |
| > Penetration      |     penetration test | be performed at regular  |
| > tests are        |     reports.         | intervals and after      |
| > performed at     |                      | significant changes to   |
| > least annually.  | -   Interview        | the environment. The     |
|                    |     personnel.       | penetration-testing      |
|                    |                      | methodology should be    |
|                    |                      | based on                 |
|                    |                      | industry-accepted        |
|                    |                      | approaches and           |
|                    |                      | incorporate both         |
|                    |                      | application-layer and    |
|                    |                      | network-layer testing.   |
|                    |                      | The scope of testing     |
|                    |                      | needs to cover the       |
|                    |                      | perimeter and critical   |
|                    |                      | systems in the           |
|                    |                      | environment and include  |
|                    |                      | testing from both inside |
|                    |                      | and outside the network. |
|                    |                      | In addition, testing     |
|                    |                      | needs to be performed to |
|                    |                      | verify that all          |
|                    |                      | segmentation controls    |
|                    |                      | are operational and      |
|                    |                      | effective, and that      |
|                    |                      | out-of-scope systems and |
|                    |                      | networks do not have     |
|                    |                      | access to the            |
|                    |                      | environment. The         |
|                    |                      | specific methodology,    |
|                    |                      | depth, and frequency of  |
|                    |                      | the testing should be    |
|                    |                      | based on the entity's    |
|                    |                      | risk-assessment strategy |
|                    |                      | and be updated as needed |
|                    |                      | to consider new threats  |
|                    |                      | and vulnerabilities.     |
+--------------------+----------------------+--------------------------+
| > **A.4.2.6**      | -   Examine          | Penetration testing is   |
| > Penetration      |     penetration test | to be performed only by  |
| > tests are        |     reports.         | qualified personnel who  |
| > performed by     |                      | can demonstrate          |
| > qualified        | -   Interview        | knowledge and            |
| > personnel.       |     personnel.       | experience, and who are  |
|                    |                      | organizationally         |
|                    |                      | independent of the       |
|                    |                      | environment being        |
|                    |                      | tested.                  |
+--------------------+----------------------+--------------------------+
| > **A.4.2.7**      | -   Examine results  | Security patches and     |
| > Vulnerabilities  |     of penetration   | fixes must be            |
| > and penetration  |     tests and        | implemented based on     |
| > testing findings |     vulnerability    | risk ranking. When       |
| > considered as    |     scanning         | high-risk                |
| > high risk are    |     reports.         | vulnerabilities cannot   |
| > addressed within |                      | be addressed within one  |
| > one month. All   | -   Examine evidence | month, a formal          |
| > other            |     of remediation   | exception process needs  |
| > vulnerabilities  |     to address       | to be followed,          |
| > and identified   |     vulnerabilities  | including approval by    |
| > security issues  |     and security     | personnel with           |
| > are addressed in |     issues.          | appropriate              |
| > a timely manner. |                      | responsibility and       |
|                    | -   Interview        | accountability.          |
|                    |     personnel.       |                          |
|                    |                      | After remediation        |
|                    |                      | activities have been     |
|                    |                      | performed (e.g.,         |
|                    |                      | implementing a patch or  |
|                    |                      | updating a configuration |
|                    |                      | file to address a        |
|                    |                      | vulnerability or         |
|                    |                      | security flaw), rescans  |
|                    |                      | and penetration tests    |
|                    |                      | must be performed as     |
|                    |                      | necessary to verify the  |
|                    |                      | remediation is effective |
|                    |                      | and that the identified  |
|                    |                      | vulnerability or         |
|                    |                      | security issue has been  |
|                    |                      | mitigated.               |
|                    |                      |                          |
|                    |                      | A record of remediation  |
|                    |                      | activities should be     |
|                    |                      | maintained (e.g., via    |
|                    |                      | change-control records,  |
|                    |                      | configuration file       |
|                    |                      | updates, and audit       |
|                    |                      | logs). All updates and   |
|                    |                      | patches must be managed  |
|                    |                      | in accordance with       |
|                    |                      | change-control           |
|                    |                      | processes. When          |
|                    |                      | applicable, changes to   |
|                    |                      | system configurations    |
|                    |                      | should be reflected in   |
|                    |                      | the configuration build  |
|                    |                      | standards.               |
+--------------------+----------------------+--------------------------+

## Managing Access

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **Control        |                      |                          |
| > Objective:**     |                      |                          |
| > Strong access    |                      |                          |
| > controls protect |                      |                          |
| > systems and data |                      |                          |
| > from             |                      |                          |
| > unauthorized     |                      |                          |
| > access and can   |                      |                          |
| > limit the        |                      |                          |
| > likelihood of a  |                      |                          |
| > compromised      |                      |                          |
| > system being     |                      |                          |
| > used to gain     |                      |                          |
| > access to other  |                      |                          |
| > systems and      |                      |                          |
| > networks.        |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.5.1** Access |                      |                          |
| > Management       |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.5.1.1** A    | -   Examine          | Policies and procedures  |
| > security         |     documented       | need to include details  |
| > policy(s) and    |     policies and     | of processes for role    |
| > procedures for   |     procedures.      | assignments, oversight   |
| > assigning access |                      | processes, business      |
| > are maintained   | -   Interview        | justifications, and user |
| > and implemented. |     personnel.       | and group privilege      |
|                    |                      | controls.                |
+--------------------+----------------------+--------------------------+
| > **A.5.1.2**      | -   Examine defined  | Determining who has      |
| > Roles and        |     roles and        | access to what, for how  |
| > responsibilities |                      | long, and what level of  |
| > are defined for  |    responsibilities. | access they have needs   |
| > groups and       |                      | to be based on           |
| > accounts with    | -   Interview        | established roles and    |
| > access to        |     personnel.       | responsibilities. This   |
| > systems.         |                      | includes the processes   |
|                    |                      | used to maintain,        |
|                    |                      | monitor, and approve     |
|                    |                      | administrative and user  |
|                    |                      | access to systems and    |
|                    |                      | data.                    |
+--------------------+----------------------+--------------------------+
| > **A.5.1.3**      | -   Observe assigned | Access to systems and    |
| > Least privileges |     access           | data needs to be         |
| > are assigned     |     privileges.      | restricted based on      |
| > based on         |                      | business need, while     |
| > individual job   | -   Examine evidence | also accounting for the  |
| > function and     |     that access      | sensitivity of the data  |
| > periodically     |     privileges are   | being stored, processed, |
| > reviewed.        |     periodically     | or transmitted.          |
|                    |     reviewed.        |                          |
|                    |                      | Access privileges must   |
|                    | -   Interview        | be reviewed by           |
|                    |     personnel.       | responsible personnel as |
|                    |                      | defined by the entity.   |
|                    |                      | The frequency of reviews |
|                    |                      | should be defined in     |
|                    |                      | accordance with the      |
|                    |                      | entity's defined         |
|                    |                      | policies and be          |
|                    |                      | appropriate for the      |
|                    |                      | level of privilege       |
|                    |                      | assigned.                |
+--------------------+----------------------+--------------------------+
| > **A.5.2**        |                      |                          |
| > Account          |                      |                          |
| > management       |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.5.2.1** A    | -   Examine          | Established processes    |
| > security         |     documented       | and oversight includes   |
| > policy(s) and    |     policies and     | approval process for     |
| > procedures for   |     procedures.      | provisioning,            |
| > managing         |                      | monitoring, changing,    |
| > accounts are     | -   Interview        | and revoking accounts    |
| > maintained and   |     personnel.       | with the ability to      |
| > implemented.     |                      | access a system.         |
+--------------------+----------------------+--------------------------+
| > **A.5.2.2**      | -   Examine          | Assigned unique IDs are  |
| > Individuals are  |     documented       | required to allow the    |
| > assigned a       |     procedures.      | organization to maintain |
| > unique account   |                      | individual               |
| > ID.              | -   Observe account  | responsibility for       |
|                    |     settings.        | actions and an effective |
|                    |                      | audit trail per          |
|                    |                      | employee.                |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.5.2.3**      | -   Examine          | Implemented controls     |
| > Controls are     |     documented       | need to protect the      |
| > implemented to   |     procedures.      | confidentiality and      |
| > protect the      |                      | integrity of accounts    |
| > confidentiality  | -   Observe          | for both local and       |
| > and integrity of |     implemented      | remote users. The        |
| > accounts and     |     controls.        | controls are required to |
| > credentials.     |                      | include ensuring that    |
|                    |                      | account and credential   |
|                    |                      | information is securely  |
|                    |                      | transmitted and stored   |
|                    |                      | (e.g., using strong      |
|                    |                      | cryptography) at all     |
|                    |                      | times.                   |
+--------------------+----------------------+--------------------------+
| > **A.5.2.4**      | -   Examine          | Processes to prevent     |
| > Controls are     |     documented       | misuse of accounts needs |
| > implemented to   |     procedures.      | to include, at a         |
| > prevent misuse   |                      | minimum, the use of      |
| > of accounts.     | -   Observe          | account lockouts,        |
|                    |     implemented      | lockout durations,       |
|                    |     controls.        | session timeouts, and    |
|                    |                      | reactivation processes.  |
|                    |                      | Inactive user accounts   |
|                    |                      | must be removed or       |
|                    |                      | disabled within a timely |
|                    |                      | manner. All processes    |
|                    |                      | need to align with the   |
|                    |                      | entity's security        |
|                    |                      | policies and procedures. |
+--------------------+----------------------+--------------------------+
| > **A.5.2.5**      | -   Examine          | Configuration and        |
| > Access for third |     documented       | connection requirements  |
| > parties is       |     procedures.      | must be defined and      |
| > identified,      |                      | implemented for all      |
| > controlled, and  | -   Observe          | access by third-party    |
| > monitored.       |     implemented      | personnel. For example,  |
|                    |     controls.        | ensuring accounts are    |
|                    |                      | enabled only during the  |
|                    |                      | time needed and disabled |
|                    |                      | when not in use, and     |
|                    |                      | monitoring account       |
|                    |                      | activity when in use.    |
+--------------------+----------------------+--------------------------+
| > **A.5.2.6**      | -   Examine          | All access privileges    |
| > Access           |     documented       | must be reviewed         |
| > privileges are   |     processes.       | regularly, at least      |
| > monitored and/or |                      | quarterly, by an         |
| > reviewed at      | -   Examine evidence | authorized individual.   |
| > least quarterly  |     of monitoring    | Documentation of reviews |
| > by an authorized |     and/or reviews.  | needs to be retained.    |
| > individual to    |                      | Results of these reviews |
| > confirm access   | -   Interview        | need to include          |
| > is still         |     personnel.       | identification and       |
| > required.        |                      | removal of any unneeded  |
|                    |                      | or incorrect access, and |
|                    |                      | to ensure that only      |
|                    |                      | individuals with a       |
|                    |                      | current business need    |
|                    |                      | are granted remote       |
|                    |                      | access.                  |
|                    |                      |                          |
|                    |                      | Automated processes may  |
|                    |                      | be used to assist in     |
|                    |                      | reviewing access         |
|                    |                      | privileges (e.g., to     |
|                    |                      | generate notifications   |
|                    |                      | when an account has not  |
|                    |                      | been used for a period   |
|                    |                      | of time).                |
|                    |                      |                          |
|                    |                      | Organizational processes |
|                    |                      | to actively review and   |
|                    |                      | change access when an    |
|                    |                      | individual changes job   |
|                    |                      | function can also        |
|                    |                      | assist.                  |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.5.3**        |                      |                          |
| > Authentication   |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.5.3.1** All  | -   Examine          | Authentication consists  |
| > access to        |     documented       | of one or more of:       |
| > systems requires |     procedures.      |                          |
| > strong           |                      | -   Something you know,  |
| > authentication   | -   Observe          |     such as a password   |
| > prior to access  |     implemented      |     or passphrase        |
| > being granted.   |     controls.        |                          |
|                    |                      | -   Something you have,  |
|                    |                      |     such as a token      |
|                    |                      |     device or smart card |
|                    |                      |                          |
|                    |                      | -   Something you are,   |
|                    |                      |     such as a biometric  |
|                    |                      |                          |
|                    |                      | When passwords are used, |
|                    |                      | documented requirements  |
|                    |                      | need to include          |
|                    |                      | considerations for       |
|                    |                      | entropy                  |
|                    |                      | (strength/complexity),   |
|                    |                      | password history and     |
|                    |                      | reuse, reset processes,  |
|                    |                      | and other best practices |
|                    |                      | for secure password use. |
|                    |                      | Passwords need to meet a |
|                    |                      | minimum level of         |
|                    |                      | strength, as defined by  |
|                    |                      | the entity's security    |
|                    |                      | policy, that provides    |
|                    |                      | reasonable assurance     |
|                    |                      | they are not guessable   |
|                    |                      | and would withstand a    |
|                    |                      | brute-force attack.      |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.5.3.2**      | -   Examine          | Multi-factor             |
| > Multi-factor     |     documented       | authentication (MFA)     |
| > authentication   |     procedures.      | requires the completion  |
| > is required for  |                      | of at least two          |
| > all access to    | -   Observe          | different authentication |
| > systems in the   |     implemented      | methods (that is,        |
| > environment.     |     controls.        | something you know,      |
|                    |                      | something you have, and  |
|                    |                      | something you are) prior |
|                    |                      | to access being granted. |
|                    |                      | The authentication       |
|                    |                      | mechanisms used need to  |
|                    |                      | be implemented to ensure |
|                    |                      | their independence such  |
|                    |                      | that:                    |
|                    |                      |                          |
|                    |                      | -   Access to one factor |
|                    |                      |     does not grant       |
|                    |                      |     access to any other  |
|                    |                      |     factor, and          |
|                    |                      |                          |
|                    |                      | -   The compromise of    |
|                    |                      |     any one factor does  |
|                    |                      |     not affect the       |
|                    |                      |     integrity or         |
|                    |                      |     confidentiality of   |
|                    |                      |     any other factor.    |
|                    |                      |                          |
|                    |                      | Additionally, no prior   |
|                    |                      | knowledge of the success |
|                    |                      | or failure of any factor |
|                    |                      | can be provided to the   |
|                    |                      | individual until all     |
|                    |                      | factors have been        |
|                    |                      | presented. Refer to      |
|                    |                      | industry standards and   |
|                    |                      | best practices for       |
|                    |                      | further guidance on MFA  |
|                    |                      | principles.              |
|                    |                      |                          |
|                    |                      | MFA can be applied at    |
|                    |                      | the network level,       |
|                    |                      | system level, or         |
|                    |                      | application level. For   |
|                    |                      | example, MFA could be    |
|                    |                      | applied when connecting  |
|                    |                      | to the secure network or |
|                    |                      | network segment, or when |
|                    |                      | connecting to an         |
|                    |                      | individual system        |
|                    |                      | component in the         |
|                    |                      | environment.             |
|                    |                      |                          |
|                    |                      | MFA is required for all  |
|                    |                      | personnel connections to |
|                    |                      | the systems in the       |
|                    |                      | environment that occur   |
|                    |                      | over a network           |
|                    |                      | interface. Examples of   |
|                    |                      | access include for       |
|                    |                      | purposes of maintenance, |
|                    |                      | configuration, updating, |
|                    |                      | administration, or       |
|                    |                      | general management of    |
|                    |                      | the systems or networks. |
|                    |                      | MFA is not required for  |
|                    |                      | application or system    |
|                    |                      | accounts performing      |
|                    |                      | automated functions.     |
+--------------------+----------------------+--------------------------+

## Physical Security

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **Control        |                      |                          |
| > Objective:**     |                      |                          |
| > Individuals with |                      |                          |
| > physical access  |                      |                          |
| > to systems or    |                      |                          |
| > media could      |                      |                          |
| > potentially      |                      |                          |
| > bypass logical   |                      |                          |
| > access controls  |                      |                          |
| > and gain access  |                      |                          |
| > to sensitive     |                      |                          |
| > assets. Strong   |                      |                          |
| > physical access  |                      |                          |
| > controls also    |                      |                          |
| > protect against  |                      |                          |
| > the unauthorized |                      |                          |
| > addition,        |                      |                          |
| > modification,    |                      |                          |
| > removal, or      |                      |                          |
| > damage of        |                      |                          |
| > systems and      |                      |                          |
| > data.            |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.6.1**        |                      |                          |
| > Restrict         |                      |                          |
| > physical access  |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.6.1.1** A    | -   Examine          | The entity needs to      |
| > security         |     documented       | define the physical      |
| > policy(s) and    |     policies and     | access controls required |
| > procedures for   |     procedures.      | to prevent systems from  |
| > securing         |                      | being accessed           |
| > physical access  | -   Interview        | physically by            |
| > to systems is    |     personnel.       | unauthorized persons.    |
| > maintained and   |                      | The controls need to     |
| > implemented.     |                      | cover all physical       |
|                    |                      | access points and        |
|                    |                      | include procedures for   |
|                    |                      | managing onsite          |
|                    |                      | employees and third      |
|                    |                      | parties. Specific        |
|                    |                      | procedures are required  |
|                    |                      | for managing visitors,   |
|                    |                      | including a visible      |
|                    |                      | means for identification |
|                    |                      | and escorts by           |
|                    |                      | authorized personnel.    |
|                    |                      |                          |
|                    |                      | Physical access and      |
|                    |                      | monitoring controls need |
|                    |                      | to include use of video  |
|                    |                      | cameras and/or           |
|                    |                      | access-control           |
|                    |                      | mechanisms. Data from    |
|                    |                      | video cameras and/or     |
|                    |                      | access-control           |
|                    |                      | mechanisms needs to be   |
|                    |                      | logged to provide an     |
|                    |                      | audit trail of all       |
|                    |                      | physical access to the   |
|                    |                      | environment. Access logs |
|                    |                      | must be retained in      |
|                    |                      | accordance with the      |
|                    |                      | entity's audit log       |
|                    |                      | policy. (Refer to        |
|                    |                      | Requirement A.7.2.)      |
|                    |                      | Monitoring and periodic  |
|                    |                      | reviews of physical      |
|                    |                      | access controls and      |
|                    |                      | audit logs need to be    |
|                    |                      | performed to allow early |
|                    |                      | identification of        |
|                    |                      | incorrect controls and   |
|                    |                      | for timely response to   |
|                    |                      | suspicious activities.   |
|                    |                      | Personnel are required   |
|                    |                      | to be trained to follow  |
|                    |                      | procedures at all times. |
|                    |                      |                          |
|                    |                      | All suspicious activity  |
|                    |                      | needs to be managed per  |
|                    |                      | incident security        |
|                    |                      | procedures. (Refer to    |
|                    |                      | Requirement A.7.1.)      |
+--------------------+----------------------+--------------------------+
| > **A.6.1.2**      | -   Observe physical |                          |
| > Facility entry   |     access controls. |                          |
| > controls are in  |                      |                          |
| > place to limit   |                      |                          |
| > and monitor      |                      |                          |
| > physical access  |                      |                          |
| > to systems in    |                      |                          |
| > the environment. |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.6.1.3**      | -   Examine assigned |                          |
| > Physical access  |     access           |                          |
| > for personnel to |     permissions.     |                          |
| > the environment  |                      |                          |
| > is authorized    | -   Interview        |                          |
| > and based on     |     personnel.       |                          |
| > individual job   |                      |                          |
| > function.        | -   Observe          |                          |
|                    |     personnel access |                          |
|                    |     procedures.      |                          |
+--------------------+----------------------+--------------------------+
| > **A.6.1.4**      | -   Examine          |                          |
| > Personnel access |     documented       |                          |
| > is revoked       |     procedures.      |                          |
| > immediately upon |                      |                          |
| > termination, and | -   Examine evidence |                          |
| > all physical     |     of access        |                          |
| > access           |     revocation and   |                          |
| > mechanisms, such |     return of        |                          |
| > as keys, access  |     physical access  |                          |
| > cards, etc., are |     mechanisms.      |                          |
| > returned or      |                      |                          |
| > disabled.        | -   Interview        |                          |
|                    |     personnel.       |                          |
+--------------------+----------------------+--------------------------+
| > **A.6.2** Secure |                      |                          |
| > media            |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.6.2.1**      | -   Observe          | Controls and processes   |
| > Strict control   |     implemented      | need to cover secure     |
| > is maintained    |     controls.        | storage, transport, and  |
| > over the storage |                      | disposal of all storage  |
| > and              | -   Interview        | media used in the        |
| > accessibility of |     personnel.       | environment. Procedures  |
| > media.           |                      | and technical controls   |
|                    |                      | are needed to provide    |
|                    |                      | assurance that media     |
|                    |                      | cannot be removed,       |
|                    |                      | stolen, or copied by     |
|                    |                      | unauthorized persons.    |
|                    |                      | The specific controls    |
|                    |                      | and level of rigor       |
|                    |                      | required to protect      |
|                    |                      | media must be            |
|                    |                      | appropriate for the      |
|                    |                      | sensitivity of the data  |
|                    |                      | stored on the media.     |
+--------------------+----------------------+--------------------------+

## Incident Response Preparedness

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **Control        |                      |                          |
| > Objective:** An  |                      |                          |
| > effective        |                      |                          |
| >                  |                      |                          |
|  incident-response |                      |                          |
| > plan allows an   |                      |                          |
| > entity to        |                      |                          |
| > respond to       |                      |                          |
| > potential        |                      |                          |
| > security issues  |                      |                          |
| > quickly and      |                      |                          |
| > effectively, and |                      |                          |
| > minimize the     |                      |                          |
| > potential impact |                      |                          |
| > of a security    |                      |                          |
| > incident or      |                      |                          |
| > breach.          |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.7.1**        |                      |                          |
| >                  |                      |                          |
|  Incident-response |                      |                          |
| > plan             |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.7.1.1** A    | -   Examine          | The policy needs to      |
| > security         |     documented       | define plans,            |
| > policy(s) and    |     policies and     | procedures, and          |
| > procedures for   |     procedures.      | technologies to detect,  |
| > managing and     |                      | analyze, and promptly    |
| > responding to    | -   Interview        | respond to security      |
| > security         |     personnel.       | incidents. Defined       |
| > incidents is     |                      | procedures need to       |
| > maintained and   |                      | include response         |
| > implemented.     |                      | activities, escalation,  |
|                    |                      | and notification, and    |
|                    |                      | cover all assets and     |
|                    |                      | processes that could     |
|                    |                      | impact critical          |
|                    |                      | operations or data.      |
|                    |                      | Procedures must be       |
|                    |                      | updated in alignment     |
|                    |                      | with                     |
|                    |                      | operational/business     |
|                    |                      | changes and the          |
|                    |                      | organization\'s risk     |
|                    |                      | strategy.                |
+--------------------+----------------------+--------------------------+
| > **A.7.1.2** An   | -   Examine          | The incident-response    |
| >                  |     documented       | plan needs to be         |
|  incident-response |                      | comprehensive and        |
| > plan is in place |    incident-response | include coverage of all  |
| > that includes:   |     plans and        | systems in the           |
|                    |     procedures.      | environment.             |
| -   Roles and      |                      |                          |
|                    | -   Interview        | At a minimum,            |
|   responsibilities |     personnel.       | communication and        |
|                    |                      | contact strategies need  |
| -   Communication  |                      | to include notification  |
|     and contact    |                      | of the payment brands.   |
|     strategies     |                      |                          |
|                    |                      | Incident response        |
| -   Specific       |                      | personnel/teams must be  |
|     incident       |                      | trained and              |
|     response       |                      | knowledgeable in         |
|     procedures     |                      | incident-response        |
|                    |                      | procedures and be        |
| -   Business       |                      | available to respond     |
|     recovery and   |                      | immediately to an        |
|     continuity     |                      | incident.                |
|     procedures     |                      |                          |
|                    |                      |                          |
| -   Data back-up   |                      |                          |
|     processes      |                      |                          |
|                    |                      |                          |
| -   Analysis of    |                      |                          |
|     legal          |                      |                          |
|     requirements   |                      |                          |
|     for reporting  |                      |                          |
|     compromises    |                      |                          |
|                    |                      |                          |
| -   Coverage and   |                      |                          |
|     responses of   |                      |                          |
|     all critical   |                      |                          |
|     system         |                      |                          |
|     components     |                      |                          |
|                    |                      |                          |
| -   Consideration  |                      |                          |
|     of payment     |                      |                          |
|     brands'        |                      |                          |
|     response       |                      |                          |
|     requirements   |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.7.1.3** The  | -   Examine          | The incident-response    |
| > plan is reviewed |     documented       | plan needs to be         |
| > and tested at    |     procedures.      | reviewed, tested, and    |
| > least annually.  |                      | updated periodically to  |
|                    | -   Examine evidence | incorporate lessons      |
|                    |     of reviews and   | learned. Relevant staff  |
|                    |     testing.         | must be included in the  |
|                    |                      | testing and be briefed   |
|                    | -   Interview        | on the post-test review. |
|                    |     personnel.       | Testing needs to include |
|                    |                      | validation that system,  |
|                    |                      | audit, and monitoring    |
|                    |                      | logs are available and   |
|                    |                      | contain all needed data. |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | **Test               | > **Guidance**           |
| > Requirements**   | Requirements**       |                          |
+====================+======================+==========================+
| > **A.7.2** Audit  |                      |                          |
| > Logs             |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.7.2.1** A    | -   Examine          | The policy needs to      |
| > security         |     documented       | cover requirements for   |
| > policy(s) and    |     policies and     | the generation,          |
| > procedures for   |     procedures.      | collection, management,  |
| > generating and   |                      | and retention of audit   |
| > managing audit   | -   Interview        | logs for all system      |
| > logs is          |     personnel.       | components in the        |
| > maintained and   |                      | environment.             |
| > implemented.     |                      |                          |
+--------------------+----------------------+--------------------------+
| > **A.7.2.2**      | -   Examine system   | Recording all personnel  |
| > Audit logs are   |     configurations.  | access, both physical    |
| > implemented to:  |                      | and logical, to systems  |
|                    | -   Observe access   | in the environment is    |
| -   Link all       |     attempts.        | required to help the     |
|     access to      |                      | entity identify any      |
|     systems to an  | -   Examine audit    | misuse of accounts and   |
|     individual     |     log files.       | ensure that each         |
|     user.          |                      | individual is            |
|                    |                      | accountable for their    |
| -   Record         |                      | actions.                 |
|     security       |                      |                          |
|     events.        |                      | The determination of     |
|                    |                      | "security event" will    |
|                    |                      | vary for each            |
|                    |                      | organization and may     |
|                    |                      | include consideration    |
|                    |                      | for the type of          |
|                    |                      | technology, location,    |
|                    |                      | and function of the      |
|                    |                      | system. Logging of       |
|                    |                      | security events needs to |
|                    |                      | include notifications or |
|                    |                      | alerts related to        |
|                    |                      | suspicious or anomalous  |
|                    |                      | activities (e.g., as     |
|                    |                      | defined in Requirements  |
|                    |                      | A.2.2.2 and A.3.3.5).    |
|                    |                      | The level of detail      |
|                    |                      | logged is required to be |
|                    |                      | sufficient to identify   |
|                    |                      | who, what, where, when,  |
|                    |                      | and how an event         |
|                    |                      | occurred in the          |
|                    |                      | environment.             |
+--------------------+----------------------+--------------------------+
| > **A.7.2.3** Time | -   Examine system   | Designated central time  |
| > synchronization  |     configurations.  | server(s) must be        |
| > is implemented   |                      | defined to receive time  |
| > on systems to    |                      | signals from trusted     |
| > ensure system    |                      | external sources based   |
| > clocks are       |                      | on International Atomic  |
| > synchronized and |                      | Time or UTC. Central     |
| > have the correct |                      | time server(s) should    |
| > and consistent   |                      | peer with one another to |
| > time.            |                      | keep accurate time.      |
|                    |                      | Systems receive time     |
|                    |                      | only from designated     |
|                    |                      | central time server(s).  |
|                    |                      |                          |
|                    |                      | Time-synchronization     |
|                    |                      | technology needs to be   |
|                    |                      | kept current and time    |
|                    |                      | data must be protected   |
|                    |                      | from unauthorized        |
|                    |                      | modification.            |
+--------------------+----------------------+--------------------------+
| > **A.7.2.4** Logs | -   Examine evidence | Real-time monitoring     |
| > and security     |     of reviews of    | and/or periodic reviews  |
| > events are       |     logs and         | need to be in place for  |
| > monitored and/or |     security events. | all security events,     |
| > reviewed         |                      | critical system logs,    |
| > periodically for | -   Interview        | and security system logs |
| > all systems to   |     personnel.       | (e.g., firewalls,        |
| > identify         |                      | IDS/IPS, authentication  |
| > anomalies or     |                      | servers, e-commerce      |
| > suspicious       |                      | redirection servers,     |
| > activity.        |                      | etc.). The frequency of  |
|                    |                      | reviews should align     |
|                    |                      | with the associated      |
|                    |                      | risk.                    |
|                    |                      |                          |
|                    |                      | The use of log           |
|                    |                      | harvesting, parsing, and |
|                    |                      | alerting tools can help  |
|                    |                      | facilitate the process   |
|                    |                      | by identifying log       |
|                    |                      | events that must be      |
|                    |                      | reviewed.                |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **A.7.2.5**      | -   Examine          | Only individuals who     |
| > Audit logs are   |     cont             | have a job-related need  |
| > secured so they  | rols/configurations. | should be able to view   |
| > cannot be        |                      | audit log files. Audit   |
| > altered.         | -   Observe attempts | logs should be backed up |
|                    |     to modify audit  | promptly to a            |
|                    |     logs             | centralized log server   |
|                    |                      | or media that is         |
|                    |                      | difficult to alter.      |
|                    |                      | Physical and logical     |
|                    |                      | access controls must be  |
|                    |                      | in place to prevent      |
|                    |                      | unauthorized             |
|                    |                      | modifications to audit   |
|                    |                      | logs. File-integrity     |
|                    |                      | monitoring or            |
|                    |                      | change-detection         |
|                    |                      | software can be          |
|                    |                      | implemented to ensure    |
|                    |                      | that any changes to      |
|                    |                      | saved log data generate  |
|                    |                      | an alert.                |
+--------------------+----------------------+--------------------------+
| > **A.7.2.6**      | -   Examine audit    | Log-retention policies   |
| > Audit and        |     log files.       | need to include storage  |
| > monitoring logs  |                      | and retrieval            |
| > are retained for | -   Interview        | procedures. If stored in |
| > least one year,  |     personnel.       | off-line locations,      |
| > with a minimum   |                      | procedures need to       |
| > of three months  |                      | include assurance that   |
| > immediately      |                      | log data can be          |
| > available for    |                      | retrieved in a timely    |
| > analysis.        |                      | manner. The logs to be   |
|                    |                      | retained include at      |
|                    |                      | least those defined in   |
|                    |                      | Requirement A.7.2.2.     |
+--------------------+----------------------+--------------------------+

# Appendix B Attack Costing Framework

> This appendix provides the framework for cost calculation of attacks
> on the MPoC Solution and/or its components.
>
> It starts with the description of differences between hardware- and
> software-based tamper-responsive systems, followed by guidelines that
> must be considered for an attack cost calculation framework. The
> considerations include the importance of the attack scalability factor
> as well as its definition, remediation and pre-remediation solutions,
> and their role and construction of a full attack path. The full attack
> path rating is constructed based on the tests conducted during the
> evaluation as per testing requirements.
>
> The rating process is described by listing the steps that the
> laboratory performs when rating a full attack based on the information
> collected by partial attack tests and documentation analysis.
>
> The relevant factors that this costing framework takes into account
> include attack time, attacker expertise, scalability, knowledge of A&M
> back- end systems, equipment required for the attack, and COTS device
> access. The detailed description of all the factors is followed by a
> discussion about ratings, with examples that show the importance of
> different factors.

## Differences between Hardware and Software Tampering

> There are differences between a hardware-based tamper-responsive
> system and a software-based tamper-responsive system that are
> considered as we look at the attack-costing framework. The key
> differences are:

4.  **Physical presence and scalability**. A hardware-based
    tamper-responsive system generally requires an attacker to be
    physically present, while a software-based tamper-responsive system
    could be vulnerable to remote attacks. Additionally, the
    exploitation phase of attacks on software-based tamper-responsive
    systems could require much less time, expertise, and tools,
    increasing the scalability of the attack even if the attack requires
    physical presence.

5.  **Layered security**. Like hardware tamper-response systems,
    software tamper-response systems are based on layered security;
    however, the number of layers and relevance of each level are much
    more prominent for software tamper-response systems. This means that
    multiple levels of protection must be bypassed before an attacker
    can extract an asset. Therefore, full and partial attacks must be
    considered as well as remediation techniques. Additionally, the
    detection approach of a tamper state is much more distributed in
    nature. For example, a tamper state might be detected by the
    back-end attestation and monitoring system with support of the MPoC
    Application.

6.  **Technology**. There are much wider sets of technologies that
    contribute to the layered security in the case of software-based
    tamper- responsive systems, such as software-based protection in
    REE, TEE solutions partially supported by hardware, and SE
    solutions.

7.  **Use of COTS and attack stages**: The use of numerous supporting
    technologies in a layered security architecture leads to a full
    attack necessarily consisting of several stages. The following
    stages are considered:

    a.  **Gaining control of the COTS device (rooting).** Gaining
        control of the platform either by using an OEM supported method
        or based on existing exploits is often the first stage of an
        attack. While it is often the first stage, it could be that the
        MPoC Application itself has an exploitable vulnerability and
        that full control of the COTS is not needed for the full attack
        path. Prevention of remote attacks on platforms includes
        regularly updating the COTS OS.

    b.  **Gaining control of the MPoC Application**. Even for a COTS
        device under full attacker control, several security mechanisms
        have to be circumvented to gain control of the MPoC Application.
        Gaining control of the MPoC Application is usually the second
        stage of the attack. It might be possible to access some of the
        assets by controlling only the COTS device (COTS-native NFC
        data, touch signals); however, there might be additional
        security mechanisms added by the MPoC Application, in which case
        control of the MPoC Application is needed.

    c.  **Asset compromise**. Asset compromise is the goal of the attack
        and usually attainable after the second stage of the attack. It
        could be possible that after getting access to the COTS, the
        assets of the MPoC Application could be extracted from memory
        without necessarily gaining full control of the MPoC
        Application. However, the MPoC Application could protect against
        these attack paths.

> Gaining control of the COTS device or device rooting refers to
> obtaining the necessary privileged level of control on the COTS device
> for a particular attack. Currently, rooting or jail-breaking is
> possible in multiple COTS platforms. Therefore, merchants as well as
> merchant employees could enable root access to a COTS Platform on
> which an MPoC Application is running.
>
> Remote exploits to gain root access for the most common COTS device
> types are available for non-patched versions of those COTS platforms.
> Remote exploits to gain access to updated versions of platforms would
> require development of zero-day exploit. The effort required for such
> activity would require a significant amount of work.
>
> The proactive attestation of the platform is the key aspect of the
> security protection against the attacks that require rooting.
> Attestation of the platform that relays on hardware mechanisms within
> the platform (e.g., TEE, Secure processors) usually provide a
> significant barrier for an attacker.
>
> For attacks that require root privileges, rooting is considered a
> first step of a full attack, and the estimated effort for
> identification and exploitation are accounted for based on public
> knowledge. If sufficiently resistant anti-root mechanisms are present
> or rooting of the COTS device is not possible for other reasons, the
> full attack cannot be executed.

## Considerations for Attack Cost Calculations

> The following considerations exist for this attack framework:

-   Identification and exploitation stages

-   Scalability rating factor

-   Remediation and pre-remediation

-   Partial and full attacks

### Identification and Exploitation Stages

> For an attacker wanting to exploit a vulnerability, the vulnerability
> must first be identified. This may appear to be a trivial separation,
> but it is an important one. To illustrate this, first consider a
> vulnerability that is uncovered following months of analysis by an
> expert, and a simple attack method published on the Internet. Compare
> this to a vulnerability that is well known but requires enormous
> expenditure of time and resources to exploit. Of course, factors such
> as time need to be treated differently in these cases, and therefore
> the "cost" required to identify an exploit is included in the costing
> calculation.
>
> Exploitation involves the actual performance of an attack (partial or
> full) on a live system.

### Scalability Rating Factor

> This factor addresses the attack potential that affects large groups
> of merchants that use the same MPoC Application.
>
> While an attack can be remote, local attacks following a few simple
> pre-described steps could lead to a scalable attack. Even if physical
> access is necessary for an effective pre-described attack, the fraud
> could be performed on multiple merchant COTS devices by an organized
> group of attackers or merchant employees downloading the attack
> description from the internet.
>
> Scalability of an attack could depend on the control of the COTS
> device (usually referred to as "rooting") if that step is required for
> the full attack. In some cases, rooting can be achieved by the phone
> owner; however, anti-rooting mechanisms and attestation functions
> supported by the hardware of different COTS could create a significant
> obstacle to scaling such an attack.
>
> Control of the COTS device with highest privileges could also be
> obtained by exploiting the COTS platform remotely. This can
> potentially lead to scalable attacks for partial attacks that depend
> on the rooting of the COTS. The only way to prevent such scalable
> attacks is to have a sufficiently patched system for all approved COTS
> devices.
>
> As the evaluation laboratory assesses only one version of the MPoC
> Application, the portability of the attack cannot be assessed on the
> level of the MPoC Application.
>
> Scalability of the attack is of high importance for MPoC Solutions, as
> reflected in the number of points given to the scalability factor.

### Remediation and Pre-remediation

> Remediation provides the MPoC vendor with a solution for attacks
> against which the MPoC Application cannot defend in the field and
> renders the solutions sufficiently secure. The remediation step is
> possible only after successful detection of some portion of an attack,
> such as changes to the security configuration of the COTS platform,
> but prior to the exploitation of those changes to expose any assets.
>
> In case of pre-remediation, the product is updated on a regular basis
> to implement proactive mitigations against known attack paths, or so
> that the learning curve for the execution of an attack is reset at
> every update -- thereby necessitating a new identification phase for
> any known attacks. Pre-remediation may resolve the attack attempts
> that cannot be detected by A&M back-end systems or prevent those
> attacks that are already known.
>
> Remediation and pre-remediation are not rated, but they determine
> whether a partial attack is feasible. If an attack requires more time
> than the pre-remediation cycle takes, or if the attack can be detected
> and mitigated before the fraud is performed, the partial attack is not
> considered when constructing the full attack.

### Approach to Attack Calculations

> Where the MPoC standard requires a costing be provided as evidence for
> a testing requirement, the costing is to be provided for the specific
> asset or context of the requirement. For example, a test requirement
> may require that a cryptographic key be exposed by the attack, and
> another may require that a PIN be exposed. Each of these attacks are
> to be considered independently and without consideration for any other
> assets. An attack that requires that a PIN be exposed is considered
> successful even if the attack does not also expose the cardholder data
> associated with that PIN.
>
> When considering an attack, the laboratory may look to chain multiple
> "partial" attacks -- each one used to bypass a specific security
> control -- which can be then chained into a "full" attack that is used
> to compromise the specific asset covered by the test requirement under
> assessment.
>
> Partial attacks provide the lab with a possibility to assess strengths
> of different security measures toward the full attack (i.e., a partial
> attack is to test-specific security mechanism(s), and a full attack is
> to compromise a specific assets). It provides the vendor with the
> analysis of which security measures in the chain are the weakest.
> Circumventing one countermeasure while having five working together
> toward a secure product is not a significant increase of risk.
> Circumventing four out of six reduces the security level significantly
> and increases the risk toward a full attack.

-   **Partial and full attacks**. When the lab assesses a partial
    attack, the rating factors should be noted to have a clear view for
    the full attack (combination of multiple partial attacks). After
    assessing the strength of all security protection features, the
    laboratory needs to analyze the possibility of a full attack. For a
    possible full attack, the laboratory will calculate the rating based
    on the factors determined for all partial attacks as described in
    the next section.

-   **Remediation and pre-remediation**. Remediation and pre-remediation
    can be used to disqualify a partial attack from consideration for
    rating. The tester, however, has to perform the attack to assess the
    time needed for the attack development. The

> attack can be disqualified if the pre-remediation and remediation
> techniques act faster than the time needed for identification and
> exploitation. The learning curve from the previous attacks or
> laboratory expertise must be taken into consideration.

## Rating Procedure

> The security landscape in which MPoC systems operate dictates a
> risk-mitigation approach toward the dynamically developing risk
> landscape. In short, if the security robustness can be circumvented by
> a skilled attacker de-layering the security architecture, the MPoC
> Solution could remediate the risk-pre-remediation and remediation
> techniques discussed in the previous section) and keep the security
> level sufficiently high.
>
> The rating approach, which takes into account the attestation and
> monitoring detection time as well as the remediation time before the
> costing for a full attack is considered, is shown in [Figure
> 4](#figure-4-attack-costing-rating-procedure-for-a-full-attack). The
> laboratory needs to collect sufficient evidence that attack detection
> and remediation together are sufficiently strong to prevent an attack,
> including attacks that use knowledge from any previous attack
> attempts. Where the laboratory finds that a partial attack is
> possible, that is some part of the security controls can be bypassed,
> the laboratory may choose to expose this in their reporting so that
> the vendor may consider if steps can be taken to improve these
> security controls.

##### Figure 4: Attack Costing Rating Procedure for a Full Attack

![](vertopal_465415c1b298463ba932b756b3983353/media/image6.png){width="6.431272965879265in"
height="3.91in"}

> Where the A&M is not explicitly required to be disabled by the test
> requirement, consideration is needed with respect to the ability of
> the A&M to detect and remediate the full attack before it is
> completed. If testing indicates that the full attack fails because it
> is detected and successfully remediated prior to the compromise of any
> assets, then that is not to be considered as a successful attack and
> no rating is to be given to that attack. In such cases, the laboratory
> is expected to consider additional or alternative attack paths that
> would not be detected and remediated.
>
> If the partial attack that circumvents the security protection
> mechanism cannot be detected and remediated or pre-remediated, the
> attack can contribute to the full attack path. Therefore, it is
> necessary to identify the values that different rating factors have so
> that a full attack rating can be calculated. A full attack comprised
> of partial attacks without remediation or pre-remediation should be
> rated. The rating of full attacks based on testing of security
> components is described below.
>
> If a full attack cannot be constructed, but there are several
> successful partial attacks, the remaining risk should be identified by
> the laboratory. Because the security is built from layers of
> protection measures, the fact that some of the measures can be
> circumvented reduces the overall security of the solution. Therefore,
> the remaining risk for the solution should be described.
>
> The relevant factors for attack rating are shown in the following
> table.

##### Table 6: Attack Rating Table

+---------------------------------+------------------+-----------------+
| > **Attack Factor**             | > **             | > *             |
|                                 | Identification** | *Exploitation** |
+=================================+==================+=================+
| > Attack time                   |                  |                 |
+---------------------------------+------------------+-----------------+
| > Attacker Expertise            |                  |                 |
+---------------------------------+------------------+-----------------+
| > Scalability                   |                  |                 |
+---------------------------------+------------------+-----------------+
| > Knowledge back-end systems    |                  |                 |
+---------------------------------+------------------+-----------------+
| > Equipment                     |                  |                 |
+---------------------------------+------------------+-----------------+
| > COTS device access            |                  |                 |
+---------------------------------+------------------+-----------------+
| > **Subtotal**                  |                  |                 |
+---------------------------------+------------------+-----------------+
| > **Total**                     |                  |                 |
+---------------------------------+------------------+-----------------+

> As shown in [*Figure
> 4*](#figure-4-attack-costing-rating-procedure-for-a-full-attack),
> partial attacks factors are assessed after the tester performs
> relevant tests. Partial attacks are analyzed and the tester determines
> whether a composition could lead to a full attack. For a possible full
> attack, the laboratory will calculate the rating based on the factors
> determined for all partial attacks with the following approach:

-   **Attack time**: The time taken for that stage of the attack
    (identification or exploitation) to be completed.

-   **Attacker Expertise**: The partial attack with the highest
    expertise determines the expertise of the full attack. The full
    attack would not be possible without all the partial attacks and
    expertise needed for them.

-   **Knowledge back-end systems:** If the knowledge of the back-end
    systems is needed for any of the partial attacks, the rating of the
    full attack is determined by the highest level of knowledge needed.
    The full attack would not be possible without all the partial
    attacks.

-   **Equipment**: The partial attack with the most complex equipment
    determines the equipment of the full attack. The full attack would
    not be possible without all the partial attacks and equipment needed
    for them.

-   **COTS device access**: The partial attack with the most difficult
    category of the COTS device access determines the COTS device access
    of the full attack. The full attack would not be possible without
    all the partial attacks and needed COTS device access for each of
    them.

-   **Scalability**: The scalability of the attack is determined based
    on all the partial attacks that have to be executed. If a step
    cannot scale easily to a simple and effective attack, the full
    attack is not scalable.

> The categories are rated with values as described in the rest of this
> section.

### Attack Time

> The **attack time** is given in the time in hours taken by an attacker
> to identify or exploit an attack. If the attack consists of several
> steps, the attack time can be determined and added to achieve a total
> attack time for each of these steps. Actual labor time must be used
> instead of time expired as long as there is not a minimum attack time
> enforced by the attack method applied (for instance, the time needed
> for performing a side-channel analysis, data collections, or the time
> needed for an epoxy to harden).
>
> In those cases where attendance is not required during part of the
> attack time, the attack time is to be taken as expired time divided by
> 3.

+-----------------+--------------------------+------------------------+
| > **Attack      | > **Identification**     | > **Exploitation**     |
| > Time**        |                          |                        |
+=================+==========================+========================+
| > \<1 Day       | 2                        | 2                      |
+-----------------+--------------------------+------------------------+
| > \<1 week      | 3                        | 3                      |
+-----------------+--------------------------+------------------------+
| > \<1 month     | 5                        | 5                      |
+-----------------+--------------------------+------------------------+
| > \>1 month     | 7                        | 7                      |
+-----------------+--------------------------+------------------------+

### Attacker Expertise

> The attacker expertise factor determines the needed expertise to
> perform the attack identification and exploitation. The identified
> levels of expertise are as follows:

-   **Layman**. Persons without professional or specialized knowledge in
    > a particular subject. An attacker who is capable of using an
    > exploit in the form of a script or a written procedure prepared by
    > another attacker. Laymen could be capable of minimal modifications
    > dictated by a simple step process. A layman may be capable of
    > developing an attack if it involves the use of existing platform
    > features (e.g., activating a screen recorder function provided by
    > the OS).

-   **Proficient**. Persons who are competent and have the necessary
    > ability, knowledge, and skill to perform customization of attacks
    > successfully. They are familiar with the security functionalities
    > and behavior of the underlying systems. Proficient attackers are
    > capable of flashing OS images and can use root access and
    > management software such as Magisk.

-   **Expert**. Persons who are highly knowledgeable and skillful in one
    > or more areas. They are familiar and knowledgeable regarding
    > needed aspects of the solution that could include the underlying
    > OS, algorithms, protocols, hardware components, and physical and
    > logical architectures implemented in the COTS device or system
    > type. This person is capable of developing or introducing complex
    > modifications of an exploit for a specific vulnerability in the
    > system.

+--------------------+------------------------+-----------------------+
| > **Attacker       | > **Identification**   | > **Exploitation**    |
| > Expertise**      |                        |                       |
+====================+========================+=======================+
| Layman             | 0                      | 0                     |
+--------------------+------------------------+-----------------------+
| Proficient         | 3                      | 3                     |
+--------------------+------------------------+-----------------------+
| > Expert           | 4                      | 4                     |
+--------------------+------------------------+-----------------------+

### Scalability

> While the time and expertise required to identify and exploit a
> vulnerability are similar for both hardware and software
> tamper-responsive systems, it should be noted that a software attack
> can be re-used much easier on the same or different platforms, even if
> the local presence is required to initiate the exploitation.
>
> Along with the attack specifics, the following categories are
> identified:

+---------------------+------------------------+-----------------------+
| > **Scalability**   | > **Identification**   | > **Exploitation**    |
+=====================+========================+=======================+
| > Instance Specific | > N/A                  | > 18                  |
+---------------------+------------------------+-----------------------+
| > Scalable with     | > N/A                  | 6                     |
| > physical access   |                        |                       |
+---------------------+------------------------+-----------------------+
| > Remotely scalable | > N/A                  | 0                     |
+---------------------+------------------------+-----------------------+

-   **Instance specific:** The attack is not scalable and needs to be
    > heavily customized for each COTS device (e.g., the attack depends
    > on the extraction of keys from each COTS device, and that
    > extraction process must be performed as a bespoke process for each
    > COTS device attacked).

-   **Scalable with physical access:** The attack can be leveraged
    > against multiple COTS Platforms and/or MPoC Application instances,
    > but requires that the attacker has physical access to the COTS
    > device during the attack. Consideration for if locked or unlocked
    > access is necessary is calculated in the "access" part of the
    > costing.

-   **Remotely scalable:** The attack may be leveraged against multiple
    > COTS Platforms and/or MPoC Application instances, and does not
    > require the attacker to have any physical access to the COTS
    > device during the attack. Scalability of the attack is of a very
    > high importance for the MPoC; therefore, it has a high number of
    > points.

> Scalability scoring only applies to the exploitation phase of the
> attack, and a costing that is instance-specific is mostly likely to
> also require proficient or expert skill during the exploitation stage
> of the attack (as expertise is required to be used during the attack
> to enable its application on the instance under attack).
>
> An MPoC assessment must consider the types of COTS Platforms to which
> the MPoC Application may be deployed, but it is not possible to make
> determinations during the assessment of how many specific COTS
> Platforms may be included in any given MPoC Solution. For this reason,
> the scalability factor is given as two types -- scalable (with or
> without physical access), or instance specific. If an attack is
> scalable across any given subset of the COTS Platforms supported, it
> must be considered a scalable attack.
>
> While attacks can be remote, local attacks following a few simple
> pre-described steps can lead to fraud performed on multiple merchant
> COTS devices by an organized group of attackers or by merchant
> employees downloading the description from the internet. Such attacks
> must also be considered scalable. This type of attack would be costed
> as "Scalable with physical access."
>
> A scalable attack may also be performed remotely by fooling a merchant
> into clicking links or installing malicious application and providing
> the needed privileges to that application. This would be costed as
> "Remotely scalable."
>
> Scalability of an attack could depend on the control of the COTS
> device (rooted device) if that step is required for the full attack.

### Knowledge of the A&M Back-end Systems

> The back-end attestation and monitoring (A&M) is a critical component
> of the overall software tamper-responsive system. This component is
> especially critical in a software-based payment, where depending on
> security and risk management policies, the monitoring system may
> terminate the payment transaction capability of any MPoC Application
> instance immediately when there are signs that the COTS device may be
> compromised. The knowledge of the attestation and monitoring (A&M) can
> be critical for performing certain attacks. It includes information on
> its capabilities and behavior, possibly including the anomaly
> detection algorithms used to interpret the various attestation data
> that comes from the MPoC Application. Identified levels are as
> follows:

+----------------------+------------------------+----------------------+
| > **Knowledge of     | > **Identification**   | > **Exploitation**   |
| > A&M**              |                        |                      |
+======================+========================+======================+
| > Public information | 0                      | 0                    |
+----------------------+------------------------+----------------------+
| > Restricted         | 1                      | 1                    |
| > information        |                        |                      |
+----------------------+------------------------+----------------------+
| > Sensitive          | 3                      | 4                    |
| > information        |                        |                      |
+----------------------+------------------------+----------------------+

-   **Public information** about the back-end monitoring system (or no
    > information): Information is considered public if it can be easily
    > obtained by anyone (e.g., from the Internet) or if it is provided
    > by the vendor to any customer.

-   **Restricted information** concerning the back-end monitoring system
    > (e.g., as gained from vendor technical specifications):
    > Information is considered restricted if it is distributed on
    > request and the distribution is registered.

-   **Sensitive information** about the back-end monitoring
    > system---e.g., knowledge of internal design, which may have to be
    > obtained by "social engineering" or exhaustive
    > reverse-engineering.

### Equipment

> Attackers may require the use of equipment in the execution of some
> attack vectors. The type of equipment required to execute an attack
> vector will determine the attack cost associated. The two levels are:

-   **Standard SW/only** includes pre-existing tools which can be easily
    > obtained, such as Frida, Magisk, or jail-breaking scripts and
    > procedures.

-   **Specialized equipment** includes special software that is not
    > readily available and has to be created.

+---------------------+------------------------+-----------------------+
| > **Equipment**     | > **Identification**   | > **Exploitation**    |
+=====================+========================+=======================+
| > Standard SW/only  | 0                      | 0                     |
+---------------------+------------------------+-----------------------+
| > Specialized       | 3                      | 3                     |
+---------------------+------------------------+-----------------------+

> The COTS device security, including the acceptability of any hardware
> used in the MPoC Solution, is the responsibility of the MPoC Solution
> provider and their risk management system. Hardware-based security
> relies on the fact that such solutions have passed high assurance
> security assessments. The risk management system as well as methods
> used to determine the acceptability of any hardware security level is
> assessed by the MPoC laboratory with the documentation assessment
> based on the relevant security certification as listed in the
> requirements of this document. Therefore, hardware attacks themselves
> and hardware equipment used for such attacks are out of scope of this
> rating system.

### COTS Device Access and Remote Attacks

> While some attack vectors require only remote access to the COTS
> device, other attack vectors require local levels of COTS device
> access. This attack cost factor considers attack vectors that require
> varying degrees of access to the physical COTS device under attack.
>
> Remote attacks for fully patched platforms are rare and require
> significant effort and skills. Unpatched systems as well as possible
> zero- day vulnerabilities could facilitate remote attacks. Zero-day
> vulnerabilities that provide remote access to the platform are
> difficult to find for the whole community, let alone for a laboratory
> during the time of the evaluation. Such attack chains are either very
> difficult to find and require a lot of time or the expertise to
> develop attack chains is not readily available.
>
> The unpatched systems have vulnerabilities that are publicly available
> and it is the responsibility of the evaluation laboratory to assess
> the effort of implementing the exploit depending on the type of
> vulnerabilities as shown in the example ratings within this section.
> Use or support of unpatched systems can be expected to lead to reduced
> time, expertise, or increased scalability for an attack -- potentially
> reducing attack ratings to an unacceptable level.
>
> The assessment should consider recently disclosed vulnerabilities,
> which may lead to potential attacks. It is a requirement of this
> standard that the A&M systems are constantly updated to monitor for
> and/or address vulnerabilities that could affect the security of the
> payment process.
>
> Three types of access are identified:

-   Remote -- where no physical access is required.

-   Local locked -- where physical access is required, but the device
    may be in a locked state.

-   Local unlocked -- where physical access with the device in an
    unlocked state is required.

+-------------------+-------------------------+------------------------+
| > **Access**      | > **Identification**    | > **Exploitation**     |
+===================+=========================+========================+
| > Remote          | 0                       | 0                      |
+-------------------+-------------------------+------------------------+
| > Local locked    | 0                       | 2                      |
+-------------------+-------------------------+------------------------+
| > Local unlocked  | 0                       | 3                      |
+-------------------+-------------------------+------------------------+

> Attacks that are marked as "scalable with physical access" will always
> require local access in the costing as well.

## Summary Attack Rating Table

> The table below summarizes the factors and costings for an MPoC attack
> rating.

+----------------------+-----------------------+----------------------+
| > **Attack Time**    | > **Identification**  | > **Exploitation**   |
+======================+=======================+======================+
| > \<1 Day            | 2                     | 2                    |
+----------------------+-----------------------+----------------------+
| > \<1 week           | 3                     | 3                    |
+----------------------+-----------------------+----------------------+
| > \<1 month          | 5                     | 5                    |
+----------------------+-----------------------+----------------------+
| > \>1 month          | 7                     | 7                    |
+----------------------+-----------------------+----------------------+
| **Attacker           | > **Identification**  | > **Exploitation**   |
| Expertise**          |                       |                      |
+----------------------+-----------------------+----------------------+
| > Layman             | 0                     | 0                    |
+----------------------+-----------------------+----------------------+
| > Proficient         | 3                     | 3                    |
+----------------------+-----------------------+----------------------+
| > Expert             | 4                     | 4                    |
+----------------------+-----------------------+----------------------+
| > **Scalability**    | > **Identification**  | > **Exploitation**   |
+----------------------+-----------------------+----------------------+
| > Instance Specific  | > N/A                 | > 12                 |
+----------------------+-----------------------+----------------------+
| > Scalable with      | > N/A                 | 6                    |
| > physical access    |                       |                      |
+----------------------+-----------------------+----------------------+
| > Remotely scalable  | > N/A                 | 0                    |
+----------------------+-----------------------+----------------------+
| **Knowledge of A&M** | > **Identification**  | > **Exploitation**   |
+----------------------+-----------------------+----------------------+
| > Public information | 0                     | 0                    |
+----------------------+-----------------------+----------------------+
| Restricted           | 1                     | 1                    |
| information          |                       |                      |
+----------------------+-----------------------+----------------------+
| > Sensitive          | 3                     | 4                    |
| > information        |                       |                      |
+----------------------+-----------------------+----------------------+
| > **Equipment**      | > **Identification**  | > **Exploitation**   |
+----------------------+-----------------------+----------------------+
| > Standard SW/only   | 0                     | 0                    |
+----------------------+-----------------------+----------------------+
| > Specialized        | 3                     | 3                    |
+----------------------+-----------------------+----------------------+

+----------------------+-----------------------+----------------------+
| > **Access**         | > **Identification**  | > **Exploitation**   |
+======================+=======================+======================+
| > Remote             | 0                     | 0                    |
+----------------------+-----------------------+----------------------+
| > Local locked       | 0                     | 2                    |
+----------------------+-----------------------+----------------------+
| > Local unlocked     | 0                     | 3                    |
+----------------------+-----------------------+----------------------+

## Discussion of Ratings with Examples

> In this section, we present the theoretical attacks of different types
> and considerations. The attack costing examples show how the
> assessment of an MPoC Product may differ based on the strength,
> scalability, and modality (local/remote) of the attack. These costings
> are provided as examples only and are not necessarily indicative of
> all costing possibilities for solutions that meet the high-level
> criteria provided.
>
> The examples provided include the following types of MPoC Solutions:

-   A relatively weak MPoC Solution with a scalable attack and one that
    prevents a scalable attack.

-   A relatively strong MPoC Solution with a scalable attack and
    non-scalable attack.

-   An MPoC Solution where there is the ability to use legitimate
    functionality provided by the COTS OS to expose account data, in
    both remote and non-remote attack modes.

### Example of a Weak Solution

> An example of a weak solution has the following evaluation results:

-   Weak attestation functions (bypass possible).

-   Lack of obfuscation.

-   Successful dynamic binary instrumentation (requiring rooted COTS
    > device), which leads to payment assets disclosure.

-   Available remote exploit for several approved platforms as well as
    > possibility for merchant and merchant employee to root the COTS
    > device without being detected by the backend.

> The relevant parameters of this attack if it were scalable are:

+---------------------+-------------------+----+-------------------+---+
| > **Attack Factor** | > *               |    | >                 |   |
|                     | *Identification** |    |  **Exploitation** |   |
+=====================+===================+====+===================+===+
| > Attack time       | \< 1 week         | 3  | > \< 1 day        | 2 |
+---------------------+-------------------+----+-------------------+---+
| > Attacker          | Proficient        | 3  | > Layman          | 0 |
| > Expertise         |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > Scalability       | N/A               | 0  | > Scalable        | 0 |
+---------------------+-------------------+----+-------------------+---+
| > Knowledge         | Public            | 0  | > Public          | 0 |
| > back-end systems  | information       |    | > information     |   |
+---------------------+-------------------+----+-------------------+---+
| > Equipment         | Standard          | 0  | > Standard        | 0 |
+---------------------+-------------------+----+-------------------+---+
| > COTS device       | Local unlocked    | 0  | > Remote          | 0 |
| > access            |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > **Sub total**     | 6                 |    | 2                 |   |
+---------------------+-------------------+----+-------------------+---+
| > **Total**         | 8                 |    |                   |   |
+---------------------+-------------------+----+-------------------+---+

> The relevant parameters of this attack if some aspect prevents
> scalability are:

+---------------------+-------------------+----+-------------------+---+
| > **Attack Factor** | > *               |    | >                 |   |
|                     | *Identification** |    |  **Exploitation** |   |
+=====================+===================+====+===================+===+
| > Attack time       | \< 1 week         | 3  | > \< 1 day        | 2 |
+---------------------+-------------------+----+-------------------+---+
| > Attacker          | Proficient        | 3  | > Proficient      | 3 |
| > Expertise         |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > Scalability       | N/A               | 0  | > Instance        | 1 |
|                     |                   |    | > specific        | 2 |
+---------------------+-------------------+----+-------------------+---+
| > Knowledge         | Public            | 0  | > Public          | 0 |
| > back-end systems  | information       |    | > information     |   |
+---------------------+-------------------+----+-------------------+---+
| > Equipment         | Standard          | 0  | > Standard        | 0 |
+---------------------+-------------------+----+-------------------+---+
| > COTS device       | Local unlocked    | 0  | > Remote          | 0 |
| > access            |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > **Sub total**     | 6                 |    | 17                |   |
+---------------------+-------------------+----+-------------------+---+
| > **Total**         | > 23              |    |                   |   |
+---------------------+-------------------+----+-------------------+---+

### Example of a Strong Solution - Scalable and non-Scalable Examples

> An example of a strong solution has the following evaluation results:

-   It takes an expert 2-3 weeks or more to reverse engineer the
    > solution and circumvent the runtime security mechanisms.

-   Obfuscation is very good.

-   Rooting is not detected (or rooting detections can be easily
    circumvented). The relevant parameters of this attack (for a
    scalable solution) are:

+---------------------+-------------------+----+-------------------+---+
| > **Attack Factor** | > *               |    | >                 |   |
|                     | *Identification** |    |  **Exploitation** |   |
+=====================+===================+====+===================+===+
| > Attack time       | \< 1 month        | 5  | > \< 1 day        | 2 |
+---------------------+-------------------+----+-------------------+---+
| > Attacker          | Expert            | 4  | > Layman          | 0 |
| > Expertise         |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > Scalability       | N/A               | 0  | > Scalable        | 0 |
+---------------------+-------------------+----+-------------------+---+
| > Knowledge         | Public            | 0  | > Public          | 0 |
| > back-end systems  | information       |    | > information     |   |
+---------------------+-------------------+----+-------------------+---+
| > Equipment         | Specialized       | 3  | > Standard        | 0 |
+---------------------+-------------------+----+-------------------+---+
| > COTS device       | Local unlocked    | 0  | > Remote          | 0 |
| > access            |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > **Sub total**     | 12                |    | 2                 |   |
+---------------------+-------------------+----+-------------------+---+
| > **Total**         | > 14              |    |                   |   |
+---------------------+-------------------+----+-------------------+---+

> If this attack was instead not scalable (due to MPoC Solution
> controls, or simply the type of vulnerability exploited) the costing
> would instead be as below:

+---------------------+-------------------+----+-------------------+---+
| > **Attack Factor** | > *               |    | >                 |   |
|                     | *Identification** |    |  **Exploitation** |   |
+=====================+===================+====+===================+===+
| > Attack time       | \< 1 month        | 5  | > \< 1 day        | 2 |
+---------------------+-------------------+----+-------------------+---+
| > Attacker          | Expert            | 4  | > Proficient      | 3 |
| > Expertise         |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > Scalability       | N/A               | 0  | > Instance        | 1 |
|                     |                   |    | > specific        | 2 |
+---------------------+-------------------+----+-------------------+---+
| > Knowledge         | Public            | 0  | > Public          | 0 |
| > back-end systems  | information       |    | > information     |   |
+---------------------+-------------------+----+-------------------+---+
| > Equipment         | Specialized       | 3  | > Standard        | 0 |
+---------------------+-------------------+----+-------------------+---+
| > COTS device       | Local unlocked    | 0  | > Remote          | 0 |
| > access            |                   |    |                   |   |
+---------------------+-------------------+----+-------------------+---+
| > **Sub total**     | 12                |    | 17                |   |
+---------------------+-------------------+----+-------------------+---+
| > **Total**         | > 29              |    |                   |   |
+---------------------+-------------------+----+-------------------+---+

### Use and Abuse of Legitimate Functionality Provided by OS

> Different attacks exist that use legitimate functionality provided by
> the OS to gain access to MPoC assets. Examples of such attacks include
> TeaBot, Cloak, or Dagger using an overlay function as well as
> accessibility services or developer controls. This example including
> rating indicates how laboratories should approach such risks during
> the evaluation.
>
> An example of an abuse of legitimate functionality attack has the
> following evaluation results:

-   Merchant security-guidance documents (user guidance) do not prevent
    > merchant, employees, or attackers from installing a malicious
    > application to monitor touch events, turn on developer options,
    > give the malicious application logging privileges, and run
    > applications in the background.

-   The attestation and monitoring mechanism does not provide sufficient
    > information about:

    -   The applications that can monitor touch events.

    -   Whether the developer options are turned on.

    -   Whether malicious applications are running in the background.

-   The attack is scalable either in the sense that:

    -   Anyone can access and perform these actions on the COTS that
        runs the application, deeming this attack scalable in the sense
        of simplified activities that can be performed on multiple
        sites.

    -   The attack can be performed remotely by fooling a merchant into
        installing malicious application and providing the needed
        privileges.

> The relevant parameters of this attack are:

+--------------------+------------------+----+---------------------+---+
| > **Attack         | > **             |    | > **Exploitation**  |   |
| > Factor**         | Identification** |    |                     |   |
+====================+==================+====+=====================+===+
| > Attack time      | > \< 1 month     | >  | \< 1 day            | > |
|                    |                  |  5 |                     |   |
|                    |                  |    |                     | 2 |
+--------------------+------------------+----+---------------------+---+
| > Attacker         | > Proficient     | >  | Layman              | > |
| > Expertise        |                  |  3 |                     |   |
|                    |                  |    |                     | 0 |
+--------------------+------------------+----+---------------------+---+
| > Scalability      | > N/A            | >  | Scalable            | > |
|                    |                  |  0 |                     |   |
|                    |                  |    |                     | 0 |
+--------------------+------------------+----+---------------------+---+
| > Knowledge        | > Public         | >  | Public information  | > |
| > back-end systems | > information    |  0 |                     |   |
|                    |                  |    |                     | 0 |
+--------------------+------------------+----+---------------------+---+
| > Equipment        | > Standard       | >  | Standard            | > |
|                    |                  |  0 |                     |   |
|                    |                  |    |                     | 0 |
+--------------------+------------------+----+---------------------+---+
| > COTS device      | > Local unlocked | >  | Local unlocked      | > |
| > access           |                  |  0 |                     |   |
|                    |                  |    |                     | 3 |
+--------------------+------------------+----+---------------------+---+
| > **Sub total**    | 8                |    | 5                   |   |
+--------------------+------------------+----+---------------------+---+
| > **Total**        | > 13             |    |                     |   |
+--------------------+------------------+----+---------------------+---+

> If this attack required the attacker to be physically present to
> attach a cable and execute a simple set of commands on a locally
> unlocked device, the costing would instead be as below:

+--------------------+-----------------+----+---------------------+---+
| > **Attack         | > **I           |    | > **Exploitation**  |   |
| > Factor**         | dentification** |    |                     |   |
+====================+=================+====+=====================+===+
| > Attack time      | \< 1 month      | 5  | \< 1 day            | 2 |
+--------------------+-----------------+----+---------------------+---+
| > Attacker         | Proficient      | 3  | Layman              | 0 |
| > Expertise        |                 |    |                     |   |
+--------------------+-----------------+----+---------------------+---+
| > Scalability      | N/A             | 0  | Scalable with       | 6 |
|                    |                 |    | physical access     |   |
+--------------------+-----------------+----+---------------------+---+
| > Knowledge        | Public          | 0  | Public information  | 0 |
| > back-end systems | information     |    |                     |   |
+--------------------+-----------------+----+---------------------+---+
| > Equipment        | Standard        | 0  | Standard            | 0 |
+--------------------+-----------------+----+---------------------+---+
| > COTS device      | Local unlocked  | 0  | Local unlocked      | 3 |
| > access           |                 |    |                     |   |
+--------------------+-----------------+----+---------------------+---+
| > **Sub total**    | 8               |    | 11                  |   |
+--------------------+-----------------+----+---------------------+---+
| > **Total**        | > 19            |    |                     |   |
+--------------------+-----------------+----+---------------------+---+

> If instead the attack requires more advanced expertise and tooling to
> expose, and more skill to perform on each device (but still with local
> unlocked access), the costing would instead be:

+-------------------+------------------+----+----------------------+---+
| > **Attack        | > **             |    | > **Exploitation**   |   |
| > Factor**        | Identification** |    |                      |   |
+===================+==================+====+======================+===+
| > Attack time     | \< 1 month       | 5  | \< 1 day             | 2 |
+-------------------+------------------+----+----------------------+---+
| > Attacker        | Expert           | 4  | Proficient           | 3 |
| > Expertise       |                  |    |                      |   |
+-------------------+------------------+----+----------------------+---+
| > Scalability     | N/A              | 0  | Scalable with        | 6 |
|                   |                  |    | physical access      |   |
+-------------------+------------------+----+----------------------+---+
| > Knowledge       | Public           | 0  | Public information   | 0 |
| > back-end        | information      |    |                      |   |
| > systems         |                  |    |                      |   |
+-------------------+------------------+----+----------------------+---+
| > Equipment       | Specialized      | 3  | Standard             | 0 |
+-------------------+------------------+----+----------------------+---+
| > COTS device     | Local unlocked   | 0  | Local unlocked       | 3 |
| > access          |                  |    |                      |   |
+-------------------+------------------+----+----------------------+---+
| > **Sub total**   | 12               |    | 14                   |   |
+-------------------+------------------+----+----------------------+---+
| > **Total**       | > 26             |    |                      |   |
+-------------------+------------------+----+----------------------+---+

## Detailed Examples

> This section provides rating examples for two attacks to support the
> laboratory in rating full attack paths based on its assessment of
> solution components and construction of the full attack from there.
> Although rating of a full attack on a platform cannot be tested within
> the scope of the MPoC evolution, the attack shows the effort needed,
> as well as the rating that such an attack would receive. Managing
> risks of attacks on the COTS platforms is handled by the MPoC Solution
> vendor risk-management system as assessed with this program. The
> second example is based on testing activities within the scope of this
> program.

### Example of Attack on a Platform - Full Attack - Remote Attack on Platform

> ***Note**: The attack activities are out of scope for testing
> activities within MPoC evaluation process*
>
> The first example describes the attack on the platform that cannot be
> identified during the MPoC Application assessment by the laboratory.
> Nevertheless, this attack is included to provide insight into the
> effort needed for such attacks and show the rating approach. The risk
> of the remote attacks on the platform should be addressed by the MPoC
> Solution provider process that manages risks.
>
> The full attack described here could lead to payment assets disclosure
> by gaining full control of the platform and assuming the MPoC
> Application is weak and trusts the COTS platform. The attack is based
> on the real-world attack presented by Samuel GroÃ (@5aelo), Project
> Zero in *Full remote attack based on No Clicks Required - Exploiting
> Memory Corruption Vulnerabilities in Messenger Apps*.
>
> This attack describes what is required to gain remote access and
> privilege escalation on a platform without known vulnerabilities. The
> attack description is publicly available.
>
> **Attack description:** The steps of the attack are:

1.  **Reverse engineering**: A researcher starts with the exploration of
    > the MPoC Application structure and protection measures. Sometimes
    > this knowledge is ported from the community. After extracting the
    > contents of the MPoC Application and exploring it, the researcher
    > finds a vulnerability in the NSUnarchiver API that can be
    > triggered without interaction via iMessage, which includes a
    > Shared key dictionary. The vulnerability is registered as
    > CVE-2019-8641 and it is a type of confusion attack.

2.  **Understanding platform protection**: The researcher analyzed the
    > solution to identify attack countermeasures. The first
    > countermeasure included separating data and execution parts of the
    > memory and preventing writing in execution parts. However, it
    > would be possible to use existing functions and build
    > return-oriented programming by storing pointers to functions
    > instead. To prevent this attack path, the mitigation techniques of
    > ASLR, Pointer Authentication (PAC), and Code signing have been
    > introduced. The ASLR or address space layout randomization is a
    > countermeasure to prevent return-oriented programming and prevent
    > jumping to predefined addresses. Pointer authentication is present
    > to prevent return-oriented programming. It uses a tag in a pointer
    > to sign and verify pointers.

3.  **Building an exploit**: To exploit the vulnerability, the
    > researcher must overcome ASLR as well as PAC. ASLR is overcome by
    > heap spraying with pointers and PAC is handled by creating fake
    > instances of legitimate classes. At this point, the researcher has
    > access to data and camera, and can run code outside the sandbox.

4.  **Privilege escalation**: The next step is "borrowed" from another
    > researcher (published exploit) and consists of expanding the
    > existing attack with the kernel exploit SockPuppet (CVE-2019-8605
    > from JavaScript), which has not been patched. This stage of the
    > attack provides access to platform hardware, FS, disabling of code
    > signing, hiding malware, etc.

5.  **Conclusion**: At the final stage, the attacker has full control
    > over the platform. For a MPoC Application in the COTS device that
    > suffers such a breach, the payment assets could be available in
    > memory or by developing additional code to tailor the attack to
    > access the COTS-native NFC and send the card data to a remote
    > server.

> **Comments and rating process**. Discovering the parts of this attack,
> as some parts have been borrowed from other experts, took about 1-to-2
> people approximately 3 months. Despite the long identification time,
> the scalability of the attack indicates it is a lucrative pursuit for
> attackers. Because the attack is available publicly, if the MPoC
> Application would support a vulnerable platform, it would be weak
> against memory dumping and instrumentation, and the A&M would not
> detect the version and prevent the MPoC Application from working. As a
> result, the tester would have to rate the attack.

+--------------------+------------------+----+--------------------+----+
| > **Attack         | > **             |    | > **Exploitation** |    |
| > Factor**         | Identification** |    |                    |    |
+====================+==================+====+====================+====+
| > Attack time      | > \> 1 month     | >  | > \< 1 day         | >  |
|                    |                  |  7 |                    |  2 |
+--------------------+------------------+----+--------------------+----+
| > Attacker         | > Expert         | >  | > Layman           | >  |
| > Expertise        |                  |  4 |                    |  0 |
+--------------------+------------------+----+--------------------+----+
| > Scalability      | > N/A            | >  | > Scalable         | >  |
|                    |                  |  0 |                    |  0 |
+--------------------+------------------+----+--------------------+----+
| > Knowledge        | > Public         | >  | > Public           | >  |
| > back-end systems | > information    |  0 | > information      |  0 |
+--------------------+------------------+----+--------------------+----+
| > Equipment        | > Specialized    | >  | > Specialized      | >  |
|                    |                  |  3 |                    |  3 |
+--------------------+------------------+----+--------------------+----+
| > COTS device      | > Local unlocked | >  | > Remote           | >  |
| > access           |                  |  0 |                    |  0 |
+--------------------+------------------+----+--------------------+----+
| > **Sub total**    | 14               |    | 5                  |    |
+--------------------+------------------+----+--------------------+----+
| > **Total**        | > 19             |    |                    |    |
+--------------------+------------------+----+--------------------+----+

> This attack requires the highest level of expertise, consumes
> significant amounts of time, and results in high scalability on a
> subset of platforms. This has the potential of affecting significant
> number of merchants and driving the rating below acceptable levels.
>
> If the A&M system implemented robust controls to prevent this type of
> attack, it is possible that "sensitive information" would be required
> in the identification phase (+3 points) as well as proficient skill in
> the exploitation phase (+3 points) to facilitate bypassing of the A&M
>
> controls. Alternatively, new zero-day type attacks may require
> specialized equipment in terms of the attack software. Therefore,
> different implementations and attack scenarios may result in similar
> attacks producing an overall costing of 25 points or above.

### Example - Full Attack - Perform Fake Payments

> This attack describes what is required to perform faked payments for a
> specific MPoC Application with several security measures that have
> been shown to provide limited resistance during laboratory testing.
>
> **Attack description**. An attacker with MPoC Application control can
> modify the MPoC Application to simulate payments when the attacker
> card is detected. The attacker can acquire goods at the attacked
> merchant and the screen of the COTS device being used will behave
> normally, displaying the expected information on the screen; however,
> it will not send the payment to the backend. A merchant with enough
> transactions per day will probably identify the theft as shoplifting,
> as it leaves no trace in the system.
>
> The steps of the attack are:

6.  **Rooting the COTS device**. Older Android versions can run the MPoC
    > Application based on the policy of the MPoC Solution. Therefore,
    > the rooting of a COTS device can be performed with standard
    > tooling by unlocking the bootloader and installing a public
    > rootkit. The attestation system does not detect this partial
    > attack.

> The relevant parameters of this partial attack are:

-   **Elapsed time**: \<1 day

-   **Attacker Expertise**: Laymen

-   **Scalability**: scalable

-   **Knowledge of** A&M **backend**: N/A

-   **Equipment**: Standard software

-   **COTS device access**: local locked

7.  **Running an MPoC Application on a rooted COTS device**. It is
    > possible to run the MPoC Application on a rooted COTS device as
    > anti-instrumentation. Anti-debugging can be circumvented due to
    > the following weakness found during the evaluation:

```{=html}
<!-- -->
```
a.  **Circumventing runtime protection**. It was identified that runtime
    protection is limited to some parts of the code, leaving the
    possibility for the attacker to modify the unprotected code flow
    relevant for this attack.

b.  **Sensitive information is logged**. The current state of the
    execution flow of the MPoC Application reveals information such as
    messages from security components and the current state of the
    execution flow. This information can aid in attacking the MPoC
    Application flow.

c.  **Monitoring system**. It is possible to circumvent the
    anti-instrumentation because no information is sent to the backend
    about the MPoC Application being compromised. It is possible to
    perform the transaction after the Frida instrumentation script was

> ported. The back-end system does not show any reactions caused by the
> compromise of the MPoC Application or COTS device. User-specific
> information was not removed from the phone due to the compromise.
>
> The relevant parameters of this partial attack are:

-   **Elapsed time**: \<1 week

-   **Attacker Expertise**: Proficient

-   **Scalability**: scalable

-   **Knowledge of** A&M **backend**: N/A

-   **Equipment**: Standard software

-   **COTS device access**: local locked

    1.  **Developing exploit**. Because the obfuscation and run-time
        > integrity are found to be weak during the evaluation, the
        > development of an exploit that modifies the code flow could be
        > performed.

> Circumventing the obfuscation and developing the exploit would require
> the following parameters:

-   **Elapsed time**: \>1 week

-   **Attacker Expertise**: Expert

-   **Scalability**: scalable

-   **Knowledge of** A&M **backend**: N/A

-   **Equipment**: Standard software

-   **COTS device access**: local locked

> Therefore, the full attack would have the following rating:

-   The elapsed time for identification is accumulated for all the steps
    > resulting in the attack time below a month.

-   The elapsed time for exploitation considers only the activities that
    must be repeated for other COTS devices with the same platform \<1
    day.

-   For all other categories, the highest necessary rating is considered
    because it is the minimum for the full attack to be completed. For
    example, if one partial attack requires expert while the rest of the
    partial attacks require only proficient, the full attack cannot be
    completed without an expert.

-   For exploitation, only the activities that must be repeated are
    considered in the rating. The steps of the attack are costed in a
    full attack table below:

[]{#_bookmark134 .anchor}

+--------------------+------------------+----+--------------------+----+
| > **Attack         | > **             |    | > **Exploitation** |    |
| > Factor**         | Identification** |    |                    |    |
+====================+==================+====+====================+====+
| > Attack time      | > \< 1 month     | >  | > \< 1 day         | >  |
|                    |                  |  5 |                    |  2 |
+--------------------+------------------+----+--------------------+----+
| > Attacker         | > Expert         | >  | > Layman           | >  |
| > Expertise        |                  |  4 |                    |  0 |
+--------------------+------------------+----+--------------------+----+
| > Scalability      | > N/A            | >  | > Scalable with    | >  |
|                    |                  |  0 | > physical access  |  6 |
+--------------------+------------------+----+--------------------+----+
| > Knowledge        | > Public         | >  | > Public           | >  |
| > back-end systems | > information    |  0 | > information      |  0 |
+--------------------+------------------+----+--------------------+----+
| > Equipment        | > Standard       | >  | > Standard         | >  |
|                    |                  |  0 |                    |  0 |
+--------------------+------------------+----+--------------------+----+
| > COTS device      | > Local unlocked | >  | > Local locked     | >  |
| > access           |                  |  0 |                    |  2 |
+--------------------+------------------+----+--------------------+----+
| > **Sub total**    | 9                |    | 10                 |    |
+--------------------+------------------+----+--------------------+----+
| > **Total**        | > 19             |    |                    |    |
+--------------------+------------------+----+--------------------+----+

# Appendix C Minimum and Equivalent Key Sizes and Strengths for Approved Algorithms

> [Table 7](#table-7-minimum-key-size) lists the minimum key sizes and
> parameters for the algorithms used with key transport, exchange, or
> establishment and for data protection in connection with these
> requirements. Approved key establishment schemes are described in NIST
> SP800-56A (ECC/FCC3-based key agreement), NIST SP800-56B (IFC-based
> key agreement) and NIST SP800-38F (AES-based key encryption/wrapping).
>
> Other key sizes and algorithms may be supported for non-payment brand
> relevant transactions; otherwise, these are the only encryption
> algorithms designated as Approved Algorithms.

##### Table 7: Minimum Key Size

+------------------+-------+-----------------+-----------+----------+
| > **Algorithm**  | >     | > **ECC (ECDSA, | > **FFC   | >        |
|                  | **IFC | > ECDH,         | > (DSA,   |  **AES** |
|                  | > (R  | > ECMQV)**      | > DH,     |          |
|                  | SA)** |                 | > MQV)**  |          |
+==================+=======+=================+===========+==========+
| > Minimum key    | >     | > 224           | >         | > 128    |
| > size in number |  2048 |                 |  2048/224 |          |
| > of bits        |       |                 |           |          |
+------------------+-------+-----------------+-----------+----------+

## Equivalent Key Sizes

> Key-encipherment keys are to be at least of equal or greater strength
> than any key they protect. This applies to any key-encipherment keys
> used to protect secret or private keys that are stored, keys used to
> encrypt any secret, or private keys for loading or transport. For
> purposes of this requirement, the algorithms and key sizes in each row
> are considered equivalent. In [Table
> 8](#table-8-equivalent-key-sizes):

-   RSA key size refers to the size of the modulus.

-   Elliptic Curve key size refers to the minimum order of the base
    point on the elliptic curve. This order is to be slightly smaller
    than the field size.

-   DSA key sizes refer to the size of the modulus and the minimum size
    of a large subgroup.

##### Table 8: Equivalent Key Sizes

+-------------------+-------+-------+-------------+-----------+-----+
| > **Algorithm**   | > *   | >     | > **ECC     | > **FFC   | > * |
|                   | *Effe | **IFC | > (ECDSA,   | > (DSA,   | *AE |
|                   | ctive | > (R  | > ECDH,     | > DH,     | S** |
|                   | > Bit | SA)** | > ECMQV)**  | > MQV)**  |     |
|                   | >     |       |             |           |     |
|                   | Stren |       |             |           |     |
|                   | gth** |       |             |           |     |
+===================+=======+=======+=============+===========+=====+
| > Minimum key     | > 112 | >     | > 224       | >         | --  |
| > size in number  |       |  2048 |             |  2048/224 |     |
| > of bits         |       |       |             |           |     |
+-------------------+-------+-------+-------------+-----------+-----+
| > Minimum key     | > 128 | >     | > 256       | >         | >   |
| > size in number  |       |  3072 |             |  3072/256 | 128 |
| > of bits         |       |       |             |           |     |
+-------------------+-------+-------+-------------+-----------+-----+
| > Minimum key     | > 192 | >     | > 384       | >         | >   |
| > size in number  |       |  7680 |             |  7680/384 | 192 |
| > of bits         |       |       |             |           |     |
+-------------------+-------+-------+-------------+-----------+-----+
| > Minimum key     | > 256 | >     | > 512       | >         | >   |
| > size in number  |       | 15360 |             | 15360/512 | 256 |
| > of bits         |       |       |             |           |     |
+-------------------+-------+-------+-------------+-----------+-----+

For implementations using Diffie-Hellman (DH) or Elliptic Curve
Diffie-Hellman (ECDH):

-   DH implementations entities must generate and distribute the
    system-wide parameters securely: generator g, prime number p and
    parameter q, the large prime factor of (p - 1). Parameter p must be
    at least 2048 bits long and parameter q must be at least 224 bits
    long. Each entity must generate a private key x and a public key y
    using the domain parameters (p, q, g).

-   ECDH implementations entities must securely generate and distribute
    the system-wide parameters. Entities may generate the elliptic curve
    domain parameters or use a recommended curve (see FIPS186-4). The
    elliptic curve specified by the domain parameters must at least be
    as secure as P-224. Each entity must generate a private key d and a
    public key Q using the specified elliptic curve domain parameters.
    (See FIPS 186-4 for methods of generating d and Q.)

-   Each private key is to be statistically unique, unpredictable, and
    created using an approved Random Number Generator (RNG), as
    described in this document. See *[Table
    10](#table-10-random-number-generators)* for more information.

-   Entities are to authenticate the DH or ECDH public keys using DSA,
    ECDSA, a certificate, or a symmetric MAC (see *ISO 16609 -- Banking
    --Requirements for message authentication using symmetric
    techniques*). One of the following should be used:

```{=html}
<!-- -->
```
-   MAC algorithm 1 using padding method 3

-   MAC algorithm 5 using padding method 4

> TLS implementations are used to prevent using cipher suites that do
> not enforce the use of cryptographic ciphers, hash functions, and key
> lengths as outlined in this appendix.
>
> KCVs are values used to identify a key without revealing any bits of
> the actual key itself. Some check values are computed by encrypting an
> all-zero block using the key or component as the encryption key by
> using the leftmost n-bits of the result, where n is 24 bits (10
> hexadecimal digits or 5 bytes) for AES. Alternatively, AES uses a
> technique where the KCV is calculated by MACing an all-zero block
> using the CMAC algorithm as specified in ISO 97971 (see also NIST SP
> 800-38B). The check value will be the leftmost n-bits of the result,
> where n is 10
>
> hexadecimal digits. AES is the block cipher used in the CMAC function.
> The key length of a key or component will be MAC'd using the AES block
> cipher with an equivalent length (e.g., AES-128 uses 128-bit for MAC
> while AES-256 uses 256).

## Hash Algorithms

> For hash algorithms used for authentication or security purposes, only
> the algorithms and associated bit lengths in [Table
> 9](#table-9-hash-algorithms) are permitted.

##### Table 9: Hash Algorithms

+-----------------------------------+----------------------------------+
| > **Algorithm**                   | > **Length**                     |
+===================================+==================================+
| > SHA2 family                     | > \>255                          |
+-----------------------------------+----------------------------------+
| > SHA3 family                     | > \>255                          |
+-----------------------------------+----------------------------------+

> RNGs are either a deterministic random number generator or a
> Non-deterministic Random Number Generator (NRNG).

## Random Number Generators

> All DRNG must be seeded by an NRNG that provides sufficient
> authenticated entropy. The entropy required must be at least as many
> bits as the intended key strength and should be twice as many bits.
> Entropy sources are discussed in NIST SP800-90B.

##### Table 10: Random Number Generators

+----------+-----------------------------------------------------------+
| >        | > **Requirement**                                         |
|  **RNG** |                                                           |
+==========+===========================================================+
| > DRNG   | Tested and approved under NIST SP 800-90A or ISO/IEC      |
|          | 18031 \[Â§9\]                                              |
+----------+-----------------------------------------------------------+
| > NRNG   | Tested and approved under NIST SP 800-90C or ISO/IEC      |
|          | 18031 \[Â§8\]                                              |
+----------+-----------------------------------------------------------+

## Prime Number Generators

> For cryptographic processes that require prime numbers, use prime
> number generators tested to ISO/IEC 18032 Information Technology\--
> Security Techniques: Prime Number Generation or X9.80 Prime Number
> Generation, Primality Testing, and Primality Certificates.

# Appendix D Secure Software Lifecycle Requirements

> This appendix provides a baseline of security requirements with
> corresponding assessment procedures and guidance to help software
> vendors that design, develop, and maintain secure software used in the
> solution throughout the software lifecycle. Vendor's commitment to
> building capability to develop and maintain secure software is
> demonstrated by either:

-   Evaluation per Appendix D by an approved MPoC Laboratory as part of
    its evaluation, or

-   Through an independent assessment of software lifecycle management
    practices assessed by a Secure SLC Assessment performed by a Secure
    SLC Assessor (listed on the PCI SSC website) and confirmed by
    submitting a Secure SLC ROC and Secure SLC AOC.

## Leveraging PCI Secure SLC Standard for Appendix D Security Requirements

> The SSF Secure SLC Standard defines security requirements for
> payment-software vendors to integrate security throughout the entire
> software lifecycle, resulting in software that is secure by design and
> better able to withstand attacks. Software vendors whose development
> processes have been validated as meeting the Secure SLC Standard are
> listed on the PCI SSC website as a Secure SLC Qualified Vendor.
>
> It is possible to validate compliance to the security requirements in
> this appendix by confirming that the following are met:

-   The software lifecycle management practices were assessed by a
    Secure SLC Assessor and confirmed to meet all requirements in the
    Secure SLC Standard with the results documented in a Secure SLC ROC
    and Secure SLC AOC.

-   The software was developed and is being maintained using the
    software lifecycle management practices that were covered by the
    Secure SLC assessment.

-   A full Secure SLC assessment of the software lifecycle management
    practices was completed within the previous 36 months. Additionally,
    if the most recent full Secure SLC assessment occurred more than 12
    months ago, an Annual attestation was provided by the
    developer/vendor within the previous 12 months that confirms
    continued adherence to Secure SLC Standard for the software
    lifecycle management practices in use.

## Software Security Governance

> A formal software security governance program is established to
> reflect the vendor's commitment to build secure software, and protect
> any sensitive assets and resources stored, processed, or transmitted
> by that software.

+------------------+---+-----------------------+---+--------------------------+
| > **Security     |   | > **Test              |   | > **Guidance**           |
| > Requirements** |   | > Requirements**      |   |                          |
+==================+===+=======================+===+==========================+
| > **D.1.1**      |   |                       |   |                          |
| > Security       |   |                       |   |                          |
| > Responsibility |   |                       |   |                          |
| > and Resources  |   |                       |   |                          |
| >                |   |                       |   |                          |
| > Senior         |   |                       |   |                          |
| > leadership     |   |                       |   |                          |
| > team           |   |                       |   |                          |
| > establishes    |   |                       |   |                          |
| > formal         |   |                       |   |                          |
| > responsibility |   |                       |   |                          |
| > and authority  |   |                       |   |                          |
| > for the        |   |                       |   |                          |
| > security of    |   |                       |   |                          |
| > the vendor's   |   |                       |   |                          |
| > products and   |   |                       |   |                          |
| > services, and  |   |                       |   |                          |
| > resources are  |   |                       |   |                          |
| > allocated to   |   |                       |   |                          |
| > execute the    |   |                       |   |                          |
| > strategy and   |   |                       |   |                          |
| > ensure that    |   |                       |   |                          |
| > personnel are  |   |                       |   |                          |
| > appropriately  |   |                       |   |                          |
| > skilled        |   |                       |   |                          |
+------------------+---+-----------------------+---+--------------------------+
| > **D.1.1.1**    | * |                       | T |                          |
| > Overall        | * |                       | h |                          |
| > responsibility | D |                       | e |                          |
| > for the        | . |                       | f |                          |
| > security of    | 1 |                       | o |                          |
| > the vendor's   | . |                       | r |                          |
| > products and   | 1 |                       | m |                          |
| > services is    | . |                       | a |                          |
| > assigned by    | 1 |                       | l |                          |
| > the vendor's   | . |                       | a |                          |
| > senior         | a |                       | s |                          |
| > leadership     | * |                       | s |                          |
| > team.          | * |                       | i |                          |
|                  | E |                       | g |                          |
|                  | x |                       | n |                          |
|                  | a |                       | m |                          |
|                  | m |                       | e |                          |
|                  | i |                       | n |                          |
|                  | n |                       | t |                          |
|                  | e |                       | o |                          |
|                  | v |                       | f |                          |
|                  | e |                       | r |                          |
|                  | n |                       | e |                          |
|                  | d |                       | s |                          |
|                  | o |                       | p |                          |
|                  | r |                       | o |                          |
|                  | e |                       | n |                          |
|                  | v |                       | s |                          |
|                  | i |                       | i |                          |
|                  | d |                       | b |                          |
|                  | e |                       | i |                          |
|                  | n |                       | l |                          |
|                  | c |                       | i |                          |
|                  | e |                       | t |                          |
|                  | a |                       | y |                          |
|                  | n |                       | b |                          |
|                  | d |                       | y |                          |
|                  | i |                       | t |                          |
|                  | n |                       | h |                          |
|                  | t |                       | e |                          |
|                  | e |                       | v |                          |
|                  | r |                       | e |                          |
|                  | v |                       | n |                          |
|                  | i |                       | d |                          |
|                  | e |                       | o |                          |
|                  | w |                       | r |                          |
|                  | t |                       | ' |                          |
|                  | h |                       | s |                          |
|                  | e |                       | s |                          |
|                  | i |                       | e |                          |
|                  | n |                       | n |                          |
|                  | d |                       | i |                          |
|                  | i |                       | o |                          |
|                  | v |                       | r |                          |
|                  | i |                       | l |                          |
|                  | d |                       | e |                          |
|                  | u |                       | a |                          |
|                  | a |                       | d |                          |
|                  | l |                       | e |                          |
|                  | o |                       | r |                          |
|                  | r |                       | s |                          |
|                  | i |                       | h |                          |
|                  | n |                       | i |                          |
|                  | d |                       | p |                          |
|                  | i |                       | t |                          |
|                  | v |                       | e |                          |
|                  | i |                       | a |                          |
|                  | d |                       | m |                          |
|                  | u |                       | e |                          |
|                  | a |                       | n |                          |
|                  | l |                       | s |                          |
|                  | s |                       | u |                          |
|                  | a |                       | r |                          |
|                  | s |                       | e |                          |
|                  | s |                       | s |                          |
|                  | i |                       | s |                          |
|                  | g |                       | t |                          |
|                  | n |                       | r |                          |
|                  | e |                       | a |                          |
|                  | d |                       | t |                          |
|                  | o |                       | e |                          |
|                  | v |                       | g |                          |
|                  | e |                       | i |                          |
|                  | r |                       | c |                          |
|                  | a |                       | - |                          |
|                  | l |                       | l |                          |
|                  | l |                       | e |                          |
|                  | r |                       | v |                          |
|                  | e |                       | e |                          |
|                  | s |                       | l |                          |
|                  | p |                       | v |                          |
|                  | o |                       | i |                          |
|                  | n |                       | s |                          |
|                  | s |                       | i |                          |
|                  | i |                       | b |                          |
|                  | b |                       | i |                          |
|                  | i |                       | l |                          |
|                  | l |                       | i |                          |
|                  | i |                       | t |                          |
|                  | t |                       | y |                          |
|                  | y |                       | i |                          |
|                  | f |                       | n |                          |
|                  | o |                       | t |                          |
|                  | r |                       | o |                          |
|                  | t |                       | a |                          |
|                  | h |                       | n |                          |
|                  | e |                       | d |                          |
|                  | s |                       | i |                          |
|                  | e |                       | n |                          |
|                  | c |                       | f |                          |
|                  | u |                       | l |                          |
|                  | r |                       | u |                          |
|                  | i |                       | e |                          |
|                  | t |                       | n |                          |
|                  | y |                       | c |                          |
|                  | o |                       | e |                          |
|                  | f |                       | o |                          |
|                  | t |                       | v |                          |
|                  | h |                       | e |                          |
|                  | e |                       | r |                          |
|                  | v |                       | t |                          |
|                  | e |                       | h |                          |
|                  | n |                       | e |                          |
|                  | d |                       | v |                          |
|                  | o |                       | e |                          |
|                  | r |                       | n |                          |
|                  | ' |                       | d |                          |
|                  | s |                       | o |                          |
|                  | p |                       | r |                          |
|                  | r |                       | ' |                          |
|                  | o |                       | s |                          |
|                  | d |                       | s |                          |
|                  | u |                       | o |                          |
|                  | c |                       | f |                          |
|                  | t |                       | t |                          |
|                  | s |                       | w |                          |
|                  | a |                       | a |                          |
|                  | n |                       | r |                          |
|                  | d |                       | e |                          |
|                  | s |                       | s |                          |
|                  | e |                       | e |                          |
|                  | r |                       | c |                          |
|                  | v |                       | u |                          |
|                  | i |                       | r |                          |
|                  | c |                       | i |                          |
|                  | e |                       | t |                          |
|                  | s |                       | y |                          |
|                  | t |                       | p |                          |
|                  | o |                       | r |                          |
|                  | c |                       | a |                          |
|                  | o |                       | c |                          |
|                  | n |                       | t |                          |
|                  | f |                       | i |                          |
|                  | i |                       | c |                          |
|                  | r |                       | e |                          |
|                  | m |                       | s |                          |
|                  | t |                       | . |                          |
|                  | h |                       | S |                          |
|                  | e |                       | e |                          |
|                  | f |                       | n |                          |
|                  | o |                       | i |                          |
|                  | l |                       | o |                          |
|                  | l |                       | r |                          |
|                  | o |                       | l |                          |
|                  | w |                       | e |                          |
|                  | i |                       | a |                          |
|                  | n |                       | d |                          |
|                  | g |                       | e |                          |
|                  | : |                       | r |                          |
|                  |   |                       | s |                          |
|                  | - |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | p |                          |
|                  |   |                       | t |                          |
|                  | A |                       | y |                          |
|                  | c |                       | p |                          |
|                  | c |                       | i |                          |
|                  | o |                       | c |                          |
|                  | u |                       | a |                          |
|                  | n |                       | l |                          |
|                  | t |                       | l |                          |
|                  | a |                       | y |                          |
|                  | b |                       | r |                          |
|                  | i |                       | e |                          |
|                  | l |                       | p |                          |
|                  | i |                       | r |                          |
|                  | t |                       | e |                          |
|                  | y |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | t |                          |
|                  |   |                       | s |                          |
|                  | f |                       | t |                          |
|                  | o |                       | h |                          |
|                  | r |                       | o |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | i |                          |
|                  |   |                       | n |                          |
|                  | e |                       | d |                          |
|                  | n |                       | i |                          |
|                  | s |                       | v |                          |
|                  | u |                       | i |                          |
|                  | r |                       | d |                          |
|                  | i |                       | u |                          |
|                  | n |                       | a |                          |
|                  | g |                       | l |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | t |                          |
|                  | t |                       | e |                          |
|                  | h |                       | a |                          |
|                  | e |                       | m |                          |
|                  |   |                       | s |                          |
|                  |   |                       | w |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  | s |                       | h |                          |
|                  | e |                       | t |                          |
|                  | c |                       | h |                          |
|                  | u |                       | e |                          |
|                  | r |                       | r |                          |
|                  | i |                       | e |                          |
|                  | t |                       | s |                          |
|                  | y |                       | p |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | s |                          |
|                  |   |                       | i |                          |
|                  | o |                       | b |                          |
|                  | f |                       | i |                          |
|                  |   |                       | l |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  | t |                       | a |                          |
|                  | h |                       | n |                          |
|                  | e |                       | d |                          |
|                  |   |                       | a |                          |
|                  |   |                       | u |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  | v |                       | o |                          |
|                  | e |                       | r |                          |
|                  | n |                       | i |                          |
|                  | d |                       | t |                          |
|                  | o |                       | y |                          |
|                  | r |                       | t |                          |
|                  | ' |                       | o |                          |
|                  | s |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | k |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  | p |                       | t |                          |
|                  | r |                       | r |                          |
|                  | o |                       | a |                          |
|                  | d |                       | t |                          |
|                  | u |                       | e |                          |
|                  | c |                       | g |                          |
|                  | t |                       | i |                          |
|                  | s |                       | c |                          |
|                  |   |                       | b |                          |
|                  |   |                       | u |                          |
|                  |   |                       | s |                          |
|                  |   |                       | i |                          |
|                  | a |                       | n |                          |
|                  | n |                       | e |                          |
|                  | d |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | d |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  | s |                       | i |                          |
|                  | e |                       | s |                          |
|                  | r |                       | i |                          |
|                  | v |                       | o |                          |
|                  | i |                       | n |                          |
|                  | c |                       | s |                          |
|                  | e |                       | f |                          |
|                  | s |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  | i |                       | v |                          |
|                  | s |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  | f |                       | o |                          |
|                  | o |                       | r |                          |
|                  | r |                       | g |                          |
|                  | m |                       | a |                          |
|                  | a |                       | n |                          |
|                  | l |                       | i |                          |
|                  | l |                       | z |                          |
|                  | y |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  | a |                       | . |                          |
|                  | s |                       | I |                          |
|                  | s |                       | n |                          |
|                  | i |                       | m |                          |
|                  | g |                       | a |                          |
|                  | n |                       | n |                          |
|                  | e |                       | y |                          |
|                  | d |                       | c |                          |
|                  |   |                       | a |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  | t |                       | , |                          |
|                  | o |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  | a |                       | r |                          |
|                  | n |                       | l |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | d |                          |
|                  |   |                       | e |                          |
|                  | i |                       | r |                          |
|                  | n |                       | s |                          |
|                  | d |                       | h |                          |
|                  | i |                       | i |                          |
|                  | v |                       | p |                          |
|                  | i |                       | t |                          |
|                  | d |                       | e |                          |
|                  | u |                       | a |                          |
|                  | a |                       | m |                          |
|                  | l |                       | s |                          |
|                  |   |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  | o |                       | o |                          |
|                  | r |                       | m |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | s |                          |
|                  | t |                       | e |                          |
|                  | e |                       | d |                          |
|                  | a |                       | o |                          |
|                  | m |                       | f |                          |
|                  |   |                       | m |                          |
|                  |   |                       | e |                          |
|                  |   |                       | m |                          |
|                  |   |                       | b |                          |
|                  | b |                       | e |                          |
|                  | y |                       | r |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | t |                          |
|                  | t |                       | h |                          |
|                  | h |                       | e |                          |
|                  | e |                       | e |                          |
|                  |   |                       | x |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  |   |                       | u |                          |
|                  | v |                       | t |                          |
|                  | e |                       | i |                          |
|                  | n |                       | v |                          |
|                  | d |                       | e |                          |
|                  | o |                       | t |                          |
|                  | r |                       | e |                          |
|                  | ' |                       | a |                          |
|                  | s |                       | m |                          |
|                  |   |                       | s |                          |
|                  |   |                       | u |                          |
|                  |   |                       | c |                          |
|                  |   |                       | h |                          |
|                  | s |                       | a |                          |
|                  | e |                       | s |                          |
|                  | n |                       | t |                          |
|                  | i |                       | h |                          |
|                  | o |                       | e |                          |
|                  | r |                       | c |                          |
|                  |   |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | e |                          |
|                  |   |                       | f |                          |
|                  | l |                       | e |                          |
|                  | e |                       | x |                          |
|                  | a |                       | e |                          |
|                  | d |                       | c |                          |
|                  | e |                       | u |                          |
|                  | r |                       | t |                          |
|                  | s |                       | i |                          |
|                  | h |                       | v |                          |
|                  | i |                       | e |                          |
|                  | p |                       | o |                          |
|                  | . |                       | f |                          |
|                  |   |                       | f |                          |
|                  | - |                       | i |                          |
|                  |   |                       | c |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  | R |                       | ( |                          |
|                  | e |                       | C |                          |
|                  | s |                       | E |                          |
|                  | p |                       | O |                          |
|                  | o |                       | ) |                          |
|                  | n |                       | , |                          |
|                  | s |                       | c |                          |
|                  | i |                       | h |                          |
|                  | b |                       | i |                          |
|                  | i |                       | e |                          |
|                  | l |                       | f |                          |
|                  | i |                       | f |                          |
|                  | t |                       | i |                          |
|                  | i |                       | n |                          |
|                  | e |                       | a |                          |
|                  | s |                       | n |                          |
|                  |   |                       | c |                          |
|                  |   |                       | i |                          |
|                  |   |                       | a |                          |
|                  |   |                       | l |                          |
|                  | i |                       | o |                          |
|                  | n |                       | f |                          |
|                  | c |                       | f |                          |
|                  | l |                       | i |                          |
|                  | u |                       | c |                          |
|                  | d |                       | e |                          |
|                  | e |                       | r |                          |
|                  |   |                       | ( |                          |
|                  |   |                       | C |                          |
|                  |   |                       | F |                          |
|                  |   |                       | O |                          |
|                  | k |                       | ) |                          |
|                  | e |                       | , |                          |
|                  | e |                       | c |                          |
|                  | p |                       | h |                          |
|                  | i |                       | i |                          |
|                  | n |                       | e |                          |
|                  | g |                       | f |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  |   |                       | h |                          |
|                  | s |                       | n |                          |
|                  | e |                       | o |                          |
|                  | n |                       | l |                          |
|                  | i |                       | o |                          |
|                  | o |                       | g |                          |
|                  | r |                       | y |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | f |                          |
|                  |   |                       | i |                          |
|                  | l |                       | c |                          |
|                  | e |                       | e |                          |
|                  | a |                       | r |                          |
|                  | d |                       | ( |                          |
|                  | e |                       | C |                          |
|                  | r |                       | T |                          |
|                  | s |                       | O |                          |
|                  | h |                       | ) |                          |
|                  | i |                       | , |                          |
|                  | p |                       | c |                          |
|                  |   |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | e |                          |
|                  |   |                       | f |                          |
|                  | i |                       | i |                          |
|                  | n |                       | n |                          |
|                  | f |                       | f |                          |
|                  | o |                       | o |                          |
|                  | r |                       | r |                          |
|                  | m |                       | m |                          |
|                  | e |                       | a |                          |
|                  | d |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | o |                          |
|                  | o |                       | f |                          |
|                  | f |                       | f |                          |
|                  |   |                       | i |                          |
|                  |   |                       | c |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  | s |                       | ( |                          |
|                  | e |                       | C |                          |
|                  | c |                       | I |                          |
|                  | u |                       | O |                          |
|                  | r |                       | ) |                          |
|                  | i |                       | , |                          |
|                  | t |                       | c |                          |
|                  | y |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | e |                          |
|                  |   |                       | f |                          |
|                  |   |                       | r |                          |
|                  | u |                       | i |                          |
|                  | p |                       | s |                          |
|                  | d |                       | k |                          |
|                  | a |                       | o |                          |
|                  | t |                       | f |                          |
|                  | e |                       | f |                          |
|                  | s |                       | i |                          |
|                  | , |                       | c |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | ( |                          |
|                  |   |                       | C |                          |
|                  | i |                       | R |                          |
|                  | s |                       | O |                          |
|                  | s |                       | ) |                          |
|                  | u |                       | , |                          |
|                  | e |                       | o |                          |
|                  | s |                       | r |                          |
|                  | , |                       | s |                          |
|                  |   |                       | i |                          |
|                  |   |                       | m |                          |
|                  |   |                       | i |                          |
|                  |   |                       | l |                          |
|                  | a |                       | a |                          |
|                  | n |                       | r |                          |
|                  | d |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  | o |                       | , |                          |
|                  | t |                       | b |                          |
|                  | h |                       | u |                          |
|                  | e |                       | t |                          |
|                  | r |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | s |                          |
|                  |   |                       | i |                          |
|                  | m |                       | s |                          |
|                  | a |                       | n |                          |
|                  | t |                       | o |                          |
|                  | t |                       | t |                          |
|                  | e |                       | t |                          |
|                  | r |                       | r |                          |
|                  | s |                       | u |                          |
|                  |   |                       | e |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  | r |                       | a |                          |
|                  | e |                       | l |                          |
|                  | l |                       | l |                          |
|                  | a |                       | o |                          |
|                  | t |                       | r |                          |
|                  | e |                       | g |                          |
|                  | d |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | i |                          |
|                  |   |                       | z |                          |
|                  |   |                       | a |                          |
|                  | t |                       | t |                          |
|                  | o |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | s |                          |
|                  |   |                       | . |                          |
|                  | t |                       | U |                          |
|                  | h |                       | l |                          |
|                  | e |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  | s |                       | e |                          |
|                  | e |                       | l |                          |
|                  | c |                       | y |                          |
|                  | u |                       | , |                          |
|                  | r |                       | t |                          |
|                  | i |                       | h |                          |
|                  | t |                       | e |                          |
|                  | y |                       | d |                          |
|                  |   |                       | i |                          |
|                  |   |                       | s |                          |
|                  |   |                       | t |                          |
|                  |   |                       | i |                          |
|                  | o |                       | n |                          |
|                  | f |                       | c |                          |
|                  |   |                       | t |                          |
|                  |   |                       | s |                          |
|                  |   |                       | t |                          |
|                  |   |                       | r |                          |
|                  | t |                       | u |                          |
|                  | h |                       | c |                          |
|                  | e |                       | t |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | o |                          |
|                  | v |                       | f |                          |
|                  | e |                       | t |                          |
|                  | n |                       | h |                          |
|                  | d |                       | e |                          |
|                  | o |                       | s |                          |
|                  | r |                       | e |                          |
|                  | ' |                       | n |                          |
|                  | s |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  | p |                       | a |                          |
|                  | r |                       | d |                          |
|                  | o |                       | e |                          |
|                  | d |                       | r |                          |
|                  | u |                       | s |                          |
|                  | c |                       | h |                          |
|                  | t |                       | i |                          |
|                  | s |                       | p |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | m |                          |
|                  | a |                       | i |                          |
|                  | n |                       | s |                          |
|                  | d |                       | d |                          |
|                  |   |                       | e |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  | s |                       | m |                          |
|                  | e |                       | i |                          |
|                  | r |                       | n |                          |
|                  | v |                       | e |                          |
|                  | i |                       | d |                          |
|                  | c |                       | b |                          |
|                  | e |                       | y |                          |
|                  | s |                       | t |                          |
|                  | . |                       | h |                          |
|                  |   |                       | e |                          |
|                  | - |                       | v |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  | U |                       | o |                          |
|                  | p |                       | r |                          |
|                  | d |                       | . |                          |
|                  | a |                       |   |                          |
|                  | t |                       | A |                          |
|                  | e |                       | s |                          |
|                  | s |                       | s |                          |
|                  |   |                       | i |                          |
|                  |   |                       | g |                          |
|                  |   |                       | n |                          |
|                  |   |                       | m |                          |
|                  | a |                       | e |                          |
|                  | r |                       | n |                          |
|                  | e |                       | t |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | v |                          |
|                  | p |                       | e |                          |
|                  | r |                       | r |                          |
|                  | o |                       | a |                          |
|                  | v |                       | l |                          |
|                  | i |                       | l |                          |
|                  | d |                       | r |                          |
|                  | e |                       | e |                          |
|                  | d |                       | s |                          |
|                  |   |                       | p |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | s |                          |
|                  | t |                       | i |                          |
|                  | o |                       | b |                          |
|                  |   |                       | i |                          |
|                  |   |                       | l |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  | s |                       | y |                          |
|                  | e |                       | f |                          |
|                  | n |                       | o |                          |
|                  | i |                       | r |                          |
|                  | o |                       | t |                          |
|                  | r |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | v |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  | l |                       | d |                          |
|                  | e |                       | o |                          |
|                  | a |                       | r |                          |
|                  | d |                       | ' |                          |
|                  | e |                       | s |                          |
|                  | r |                       | s |                          |
|                  | s |                       | o |                          |
|                  | h |                       | f |                          |
|                  | i |                       | t |                          |
|                  | p |                       | w |                          |
|                  |   |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  | a |                       | e |                          |
|                  | t |                       | c |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  | l |                       | y |                          |
|                  | e |                       | p |                          |
|                  | a |                       | r |                          |
|                  | s |                       | o |                          |
|                  | t |                       | g |                          |
|                  |   |                       | r |                          |
|                  |   |                       | a |                          |
|                  |   |                       | m |                          |
|                  |   |                       | s |                          |
|                  | a |                       | h |                          |
|                  | n |                       | o |                          |
|                  | n |                       | u |                          |
|                  | u |                       | l |                          |
|                  | a |                       | d |                          |
|                  | l |                       | i |                          |
|                  | l |                       | n |                          |
|                  | y |                       | c |                          |
|                  |   |                       | l |                          |
|                  |   |                       | u |                          |
|                  |   |                       | d |                          |
|                  |   |                       | e |                          |
|                  | o |                       | t |                          |
|                  | n |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | u |                          |
|                  |   |                       | t |                          |
|                  | t |                       | h |                          |
|                  | h |                       | o |                          |
|                  | e |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  |   |                       | t |                          |
|                  | p |                       | o |                          |
|                  | e |                       | e |                          |
|                  | r |                       | n |                          |
|                  | f |                       | f |                          |
|                  | o |                       | o |                          |
|                  | r |                       | r |                          |
|                  | m |                       | c |                          |
|                  | a |                       | e |                          |
|                  | n |                       | a |                          |
|                  | c |                       | n |                          |
|                  | e |                       | d |                          |
|                  |   |                       | e |                          |
|                  |   |                       | x |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  | o |                       | u |                          |
|                  | f |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  | a |                       | o |                          |
|                  | n |                       | r |                          |
|                  | d |                       | g |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | i |                          |
|                  |   |                       | z |                          |
|                  | c |                       | a |                          |
|                  | h |                       | t |                          |
|                  | a |                       | i |                          |
|                  | n |                       | o |                          |
|                  | g |                       | n |                          |
|                  | e |                       | ' |                          |
|                  | s |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | t |                          |
|                  | t |                       | w |                          |
|                  | o |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | - |                          |
|                  |   |                       | s |                          |
|                  | t |                       | e |                          |
|                  | h |                       | c |                          |
|                  | e |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  | v |                       | s |                          |
|                  | e |                       | t |                          |
|                  | n |                       | r |                          |
|                  | d |                       | a |                          |
|                  | o |                       | t |                          |
|                  | r |                       | e |                          |
|                  | ' |                       | g |                          |
|                  | s |                       | y |                          |
|                  |   |                       | . |                          |
|                  |   |                       | W |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  | s |                       | h |                          |
|                  | o |                       | o |                          |
|                  | f |                       | u |                          |
|                  | t |                       | t |                          |
|                  | w |                       | a |                          |
|                  | a |                       | p |                          |
|                  | r |                       | p |                          |
|                  | e |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  | s |                       | a |                          |
|                  | e |                       | t |                          |
|                  | c |                       | e |                          |
|                  | u |                       | a |                          |
|                  | r |                       | u |                          |
|                  | i |                       | t |                          |
|                  | t |                       | h |                          |
|                  | y |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  | p |                       | , |                          |
|                  | o |                       | t |                          |
|                  | l |                       | h |                          |
|                  | i |                       | o |                          |
|                  | c |                       | s |                          |
|                  | y |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | p |                          |
|                  | a |                       | o |                          |
|                  | n |                       | n |                          |
|                  | d |                       | s |                          |
|                  |   |                       | i |                          |
|                  |   |                       | b |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  | s |                       | f |                          |
|                  | t |                       | o |                          |
|                  | r |                       | r |                          |
|                  | a |                       | t |                          |
|                  | t |                       | h |                          |
|                  | e |                       | e |                          |
|                  | g |                       | s |                          |
|                  | y |                       | e |                          |
|                  |   |                       | c |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  | d |                       | t |                          |
|                  | e |                       | y |                          |
|                  | s |                       | o |                          |
|                  | c |                       | f |                          |
|                  | r |                       | t |                          |
|                  | i |                       | h |                          |
|                  | b |                       | e |                          |
|                  | e |                       | v |                          |
|                  | d |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  | i |                       | ' |                          |
|                  | n |                       | s |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | d |                          |
|                  | C |                       | u |                          |
|                  | o |                       | c |                          |
|                  | n |                       | t |                          |
|                  | t |                       | s |                          |
|                  | r |                       | a |                          |
|                  | o |                       | n |                          |
|                  | l |                       | d |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | v |                          |
|                  | O |                       | i |                          |
|                  | b |                       | c |                          |
|                  | j |                       | e |                          |
|                  | e |                       | s |                          |
|                  | c |                       | c |                          |
|                  | t |                       | a |                          |
|                  | i |                       | n |                          |
|                  | v |                       | n |                          |
|                  | e |                       | o |                          |
|                  |   |                       | t |                          |
|                  |   |                       | b |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  | 2 |                       | e |                          |
|                  | . |                       | a |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | a |                          |
|                  |   |                       | b |                          |
|                  |   |                       | l |                          |
|                  |   |                       | y |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | l |                          |
|                  |   |                       | d |                          |
|                  |   |                       | a |                          |
|                  |   |                       | c |                          |
|                  |   |                       | c |                          |
|                  |   |                       | o |                          |
|                  |   |                       | u |                          |
|                  |   |                       | n |                          |
|                  |   |                       | t |                          |
|                  |   |                       | a |                          |
|                  |   |                       | b |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | s |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | n |                          |
|                  |   |                       | g |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | g |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | i |                          |
|                  |   |                       | z |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | ' |                          |
|                  |   |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  |   |                       | s |                          |
|                  |   |                       | t |                          |
|                  |   |                       | r |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | g |                          |
|                  |   |                       | y |                          |
|                  |   |                       | i |                          |
|                  |   |                       | s |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | l |                          |
|                  |   |                       | l |                          |
|                  |   |                       | o |                          |
|                  |   |                       | w |                          |
|                  |   |                       | e |                          |
|                  |   |                       | d |                          |
|                  |   |                       | . |                          |
|                  |   |                       | T |                          |
|                  |   |                       | h |                          |
|                  |   |                       | o |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | p |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | s |                          |
|                  |   |                       | i |                          |
|                  |   |                       | b |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | v |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | ' |                          |
|                  |   |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | t |                          |
|                  |   |                       | w |                          |
|                  |   |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  |   |                       | s |                          |
|                  |   |                       | h |                          |
|                  |   |                       | o |                          |
|                  |   |                       | u |                          |
|                  |   |                       | l |                          |
|                  |   |                       | d |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | v |                          |
|                  |   |                       | i |                          |
|                  |   |                       | d |                          |
|                  |   |                       | e |                          |
|                  |   |                       | p |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | d |                          |
|                  |   |                       | i |                          |
|                  |   |                       | c |                          |
|                  |   |                       | u |                          |
|                  |   |                       | p |                          |
|                  |   |                       | d |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | t |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | v |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | ' |                          |
|                  |   |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | t |                          |
|                  |   |                       | w |                          |
|                  |   |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | c |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | y |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | g |                          |
|                  |   |                       | r |                          |
|                  |   |                       | a |                          |
|                  |   |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | p |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | c |                          |
|                  |   |                       | e |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | t |                          |
|                  |   |                       | r |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | g |                          |
|                  |   |                       | y |                          |
|                  |   |                       | t |                          |
|                  |   |                       | o |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | d |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | s |                          |
|                  |   |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | p |                          |
|                  |   |                       | . |                          |
|                  |   |                       | T |                          |
|                  |   |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | s |                          |
|                  |   |                       | a |                          |
|                  |   |                       | l |                          |
|                  |   |                       | l |                          |
|                  |   |                       | o |                          |
|                  |   |                       | w |                          |
|                  |   |                       | s |                          |
|                  |   |                       | s |                          |
|                  |   |                       | e |                          |
|                  |   |                       | n |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | l |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | d |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | s |                          |
|                  |   |                       | h |                          |
|                  |   |                       | i |                          |
|                  |   |                       | p |                          |
|                  |   |                       | t |                          |
|                  |   |                       | o |                          |
|                  |   |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | k |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | t |                          |
|                  |   |                       | r |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | e |                          |
|                  |   |                       | g |                          |
|                  |   |                       | y |                          |
|                  |   |                       | i |                          |
|                  |   |                       | s |                          |
|                  |   |                       | b |                          |
|                  |   |                       | e |                          |
|                  |   |                       | i |                          |
|                  |   |                       | n |                          |
|                  |   |                       | g |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | z |                          |
|                  |   |                       | e |                          |
|                  |   |                       | d |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | o |                          |
|                  |   |                       | u |                          |
|                  |   |                       | r |                          |
|                  |   |                       | c |                          |
|                  |   |                       | e |                          |
|                  |   |                       | d |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | p |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | l |                          |
|                  |   |                       | y |                          |
|                  |   |                       | , |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | d |                          |
|                  |   |                       | t |                          |
|                  |   |                       | h |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | c |                          |
|                  |   |                       | h |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | g |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | q |                          |
|                  |   |                       | u |                          |
|                  |   |                       | i |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | d |                          |
|                  |   |                       | a |                          |
|                  |   |                       | s |                          |
|                  |   |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | s |                          |
|                  |   |                       | u |                          |
|                  |   |                       | l |                          |
|                  |   |                       | t |                          |
|                  |   |                       | o |                          |
|                  |   |                       | f |                          |
|                  |   |                       | i |                          |
|                  |   |                       | t |                          |
|                  |   |                       | s |                          |
|                  |   |                       | p |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | f |                          |
|                  |   |                       | o |                          |
|                  |   |                       | r |                          |
|                  |   |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | c |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | r |                          |
|                  |   |                       | e |                          |
|                  |   |                       | a |                          |
|                  |   |                       | p |                          |
|                  |   |                       | p |                          |
|                  |   |                       | r |                          |
|                  |   |                       | o |                          |
|                  |   |                       | v |                          |
|                  |   |                       | e |                          |
|                  |   |                       | d |                          |
|                  |   |                       | i |                          |
|                  |   |                       | n |                          |
|                  |   |                       | a |                          |
|                  |   |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | m |                          |
|                  |   |                       | e |                          |
|                  |   |                       | l |                          |
|                  |   |                       | y |                          |
|                  |   |                       | m |                          |
|                  |   |                       | a |                          |
|                  |   |                       | n |                          |
|                  |   |                       | n |                          |
|                  |   |                       | e |                          |
|                  |   |                       | r |                          |
|                  |   |                       | . |                          |
|                  |   |                       |   |                          |
|                  |   |                       | * |                          |
|                  |   |                       | ( |                          |
|                  |   |                       | c |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | t |                          |
|                  |   |                       | i |                          |
|                  |   |                       | n |                          |
|                  |   |                       | u |                          |
|                  |   |                       | e |                          |
|                  |   |                       | d |                          |
|                  |   |                       | o |                          |
|                  |   |                       | n |                          |
|                  |   |                       | n |                          |
|                  |   |                       | e |                          |
|                  |   |                       | x |                          |
|                  |   |                       | t |                          |
|                  |   |                       | p |                          |
|                  |   |                       | a |                          |
|                  |   |                       | g |                          |
|                  |   |                       | e |                          |
|                  |   |                       | ) |                          |
|                  |   |                       | * |                          |
+------------------+---+-----------------------+---+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
|                   |                       | Evidence to support this |
|                   |                       | control objective might  |
|                   |                       | include job              |
|                   |                       | descriptions,            |
|                   |                       | organization charts,     |
|                   |                       | presentations, audio     |
|                   |                       | recordings, senior       |
|                   |                       | leadership meeting       |
|                   |                       | minutes, reports, e-     |
|                   |                       | mails, formal            |
|                   |                       | communications from      |
|                   |                       | senior leadership to the |
|                   |                       | rest of the              |
|                   |                       | organization, or any     |
|                   |                       | other records that       |
|                   |                       | clearly reflect formal   |
|                   |                       | assignment of            |
|                   |                       | responsibility and       |
|                   |                       | authority, and           |
|                   |                       | communications between   |
|                   |                       | senior leadership and    |
|                   |                       | those responsible for    |
|                   |                       | the vendor's software    |
|                   |                       | security program         |
|                   |                       | regarding program        |
|                   |                       | performance.             |
+-------------------+-----------------------+--------------------------+
| > **D.1.1.2**     | **D.1.1.2.a** Examine | Individuals, including   |
| > Software        | vendor evidence to    | third-party personnel,   |
| > security        | confirm the           | involved in the design,  |
| >                 | following:            | development, testing,    |
|  responsibilities |                       | and maintenance of the   |
| > are assigned.   | -   Software security | vendor's products and    |
|                   |     responsibilities  | services should be       |
|                   |     are clearly       | assigned responsibility  |
|                   |     defined and       | and accountability for   |
|                   |     assigned to       | ensuring that software   |
|                   |     appropriate       | is designed and          |
|                   |     individuals or    | maintained in accordance |
|                   |     teams, including  | with the vendor's        |
|                   |                       | security strategy and    |
|                   |  software-development | all applicable security  |
|                   |     personnel.        | requirements, including  |
|                   |                       | software-specific        |
|                   | -   Assignment of     | requirements.            |
|                   |     responsibilities  |                          |
|                   |     for ensuring the  | Responsibilities can be  |
|                   |     security of the   | assigned to an           |
|                   |     vendor's products | individual, group, or    |
|                   |     and services      | role; however,           |
|                   |     covers the entire | individuals assigned to  |
|                   |     software          | a particular group or    |
|                   |     lifecycle.        | role should clearly      |
|                   |                       | understand how those     |
|                   |                       | software security        |
|                   |                       | responsibilities affect  |
|                   |                       | their individual job     |
|                   |                       | functions, the           |
|                   |                       | organization's security  |
|                   |                       | expectations, and the    |
|                   |                       | individual's role in     |
|                   |                       | fulfilling those         |
|                   |                       | expectations.            |
|                   |                       |                          |
|                   |                       | Individuals assigned     |
|                   |                       | software-security        |
|                   |                       | responsibilities should  |
|                   |                       | be able to demonstrate   |
|                   |                       | an understanding of      |
|                   |                       | their responsibilities   |
|                   |                       | and accountability.      |
|                   |                       |                          |
|                   |                       | Evidence to support this |
|                   |                       | security objective might |
|                   |                       | include job              |
|                   |                       | descriptions, employee   |
|                   |                       | agreements,              |
|                   |                       | presentations, company   |
|                   |                       | communications, training |
|                   |                       | materials, e-mails,      |
|                   |                       | intranet content, or any |
|                   |                       | other documentation or   |
|                   |                       | records that clearly and |
|                   |                       | consistently show the    |
|                   |                       | assignment of security   |
|                   |                       | responsibilities, and    |
|                   |                       | the acknowledgement and  |
|                   |                       | understanding of those   |
|                   |                       | roles and                |
|                   |                       | responsibilities.        |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.1.2.b**         |                          |
|                   | Interview a sample of |                          |
|                   | responsible           |                          |
|                   | individuals,          |                          |
|                   | including             |                          |
|                   | software-development  |                          |
|                   | personnel, to confirm |                          |
|                   | they are clearly      |                          |
|                   | aware of and          |                          |
|                   | understand their      |                          |
|                   | software security     |                          |
|                   | responsibilities.     |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.1.3**     | **D.1.1.3.a** Examine | To be effective in       |
| > Sof             | vendor evidence to    | meeting their software   |
| tware-development | confirm the           | security                 |
| > personnel       | following:            | responsibilities,        |
| > maintain skills |                       | software-development     |
| > in software     | -   A mature process  | personnel must be        |
| > security        |     is implemented    | trained or have          |
| > matters         |     and maintained    | experience in performing |
| > relevant to     |     for managing and  | such responsibilities    |
| > their specific  |     maintaining       | and must maintain the    |
| > role,           |     software security | appropriate skills to    |
| > responsibility, |     skills for        | properly carry out those |
| > and job         |     software-         | responsibilities.        |
| > function.       |     development       |                          |
|                   |     personnel.        | At a minimum, all        |
|                   |                       | software-development     |
|                   | -   The skills        | personnel must have a    |
|                   |     required for each | basic understanding of   |
|                   |     defined role,     | general software         |
|                   |     responsibility,   | security concepts and    |
|                   |     and job function  | best practices.          |
|                   |     are clearly       | Individuals with         |
|                   |     defined.          | specialized roles and    |
|                   |                       | responsibilities should  |
|                   | -   The criteria for  | additionally possess     |
|                   |     maintaining       | specialized skills       |
|                   |     individual skills | relevant to the          |
|                   |     are clearly       | functions they perform.  |
|                   |     defined.          | Examples of specialized  |
|                   |                       | skills include secure    |
|                   | -   The process       | software design          |
|                   |     includes a review | (software architects),   |
|                   |     at least annually | secure coding techniques |
|                   |     to ensure         | (software developers),   |
|                   |                       | and security-testing     |
|                   |  software-development | techniques (software     |
|                   |     personnel are     | testers).                |
|                   |     maintaining the   |                          |
|                   |     necessary skills  | Efforts to maintain      |
|                   |     for the security  | those skills may include |
|                   |     responsibilities  | vendor- provided         |
|                   |     they have been    | training, ongoing        |
|                   |     assigned.         | participation in local   |
|                   |                       | or regional user groups, |
|                   |                       | or the achievement and   |
|                   |                       | maintenance of           |
|                   |                       | industry-specific        |
|                   |                       | certifications. It is up |
|                   |                       | to the vendor to define  |
|                   |                       | the necessary criteria   |
|                   |                       | for maintaining          |
|                   |                       | appropriate job-specific |
|                   |                       | skills and confirm       |
|                   |                       | individual adherence at  |
|                   |                       | least annually.          |
|                   |                       |                          |
|                   |                       | Evidence to support this |
|                   |                       | security objective might |
|                   |                       | include policies and     |
|                   |                       | processes, training      |
|                   |                       | materials or content,    |
|                   |                       | records of on-the-job    |
|                   |                       | training or course       |
|                   |                       | attendance, individual   |
|                   |                       | qualification            |
|                   |                       | certificates, continuing |
|                   |                       | education credits, or    |
|                   |                       | any other documentation  |
|                   |                       | or evidence that         |
|                   |                       | demonstrates clearly and |
|                   |                       | consistently that        |
|                   |                       | software- development    |
|                   |                       | personnel possess and    |
|                   |                       | maintain appropriate     |
|                   |                       | skills and knowledge for |
|                   |                       | their specific job       |
|                   |                       | function and             |
|                   |                       | responsibilities.        |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.1.3.b** For a   |                          |
|                   | sample of             |                          |
|                   | software-development  |                          |
|                   | personnel, examine    |                          |
|                   | vendor evidence and   |                          |
|                   | interview personnel   |                          |
|                   | to confirm the        |                          |
|                   | following:            |                          |
|                   |                       |                          |
|                   | -   Individuals have  |                          |
|                   |     demonstrated that |                          |
|                   |     they possess the  |                          |
|                   |     skills required   |                          |
|                   |     for their role,   |                          |
|                   |     responsibility,   |                          |
|                   |     or job function.  |                          |
|                   |                       |                          |
|                   | -   Individuals have  |                          |
|                   |     satisfied the     |                          |
|                   |     criteria for      |                          |
|                   |     maintaining their |                          |
|                   |     individual        |                          |
|                   |     skills.           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.2**       |                       |                          |
| > Security        |                       |                          |
| > Responsibility  |                       |                          |
| > and Resources   |                       |                          |
| >                 |                       |                          |
| > Senior          |                       |                          |
| > leadership team |                       |                          |
| > establishes     |                       |                          |
| > formal          |                       |                          |
| > responsibility  |                       |                          |
| > and authority   |                       |                          |
| > for the         |                       |                          |
| > security of the |                       |                          |
| > vendor's        |                       |                          |
| > products and    |                       |                          |
| > services, and   |                       |                          |
| > resources are   |                       |                          |
| > allocated to    |                       |                          |
| > execute the     |                       |                          |
| > strategy and    |                       |                          |
| > ensure that     |                       |                          |
| > personnel are   |                       |                          |
| > appropriately   |                       |                          |
| > skilled         |                       |                          |
+-------------------+-----------------------+--------------------------+
| 1.  Regulatory    | 1.  Examine vendor    | Many organizations are   |
|     and industry  |     evidence and      | subject to requirements  |
|     security and  |     interview         | for protecting certain   |
|     compliance    |     personnel to      | types of information and |
|     requirements  |     confirm the       | data such as personally  |
|     applicable to |     following:        | identifiable information |
|     the vendor's  |                       | (PII), cardholder data   |
|     operations,   |     -   A mature      | (CHD), and protected     |
|     products, and |         process       | health information       |
|     services and  |         exists to     | (PHI).                   |
|     the data      |         identify and  |                          |
|     stored,       |         monitor       | Vendors should maintain  |
|     processed, or |         external      | awareness of evolving    |
|     transmitted   |         regulatory    | industry and regulatory  |
|     by the vendor |         and industry  | requirements applicable  |
|     are           |         security and  | to their operations and  |
|     identified    |         compliance    | products. Maintaining    |
|     and           |         requirements. | ongoing awareness of     |
|     monitored.    |                       | external security and    |
|                   |     -   The process   | compliance obligations   |
|                   |         includes      | allows the vendor to     |
|                   |         reviewing     | ensure its processes     |
|                   |         sources of    | adequately address those |
|                   |         regulatory    | requirements at all      |
|                   |         and industry  | times, including         |
|                   |         security and  | whenever those           |
|                   |         compliance    | requirements are         |
|                   |         requirements  | updated, or new          |
|                   |         for changes   | requirements introduced. |
|                   |         at least      |                          |
|                   |         annually.     | Evidence to support this |
|                   |                       | control objective might  |
|                   |     -   The process   | include documented       |
|                   |         results in an | policies and processes,  |
|                   |         inventory of  | internal standards,      |
|                   |         external      | requirement mappings,    |
|                   |         regulatory    | internal presentations,  |
|                   |         and industry  | training materials, or   |
|                   |         security and  | any other documentation  |
|                   |         compliance    | or records that clearly  |
|                   |         requirements. | and consistently show    |
|                   |                       | that the vendor has made |
|                   |     -   The inventory | reasonable efforts to    |
|                   |         is updated as | understand and monitor   |
|                   |         external      | its external security    |
|                   |         security and  | and compliance           |
|                   |         compliance    | requirements.            |
|                   |         requirements  |                          |
|                   |         change.       |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.2.2** A   | **D.1.2.2.a** Examine | Vendors must establish a |
| > software        | vendor evidence to    | company-wide software    |
| > security policy | confirm the           | security policy to       |
| > is defined and  | following:            | ensure that all          |
| > establishes the |                       | individuals or teams -   |
| > specific rules  | -   A software        | including relevant       |
| > and goals for   |     security policy   | business partners -      |
| > ensuring the    |     exists and is     | involved in software     |
| > vendor's        |     communicated to   | design, development, and |
| > products and    |     appropriate       | maintenance are aware    |
| > services are    |     vendor personnel  | and have a consistent    |
| > designed,       |     and business      | understanding of how the |
| > developed, and  |     partners,         | vendor's software        |
| > maintained to   |     including all     | products and services    |
| > be secure,      |     software-         | should be securely built |
| > resistant to    |     development       | and maintained, and how  |
| > attack, and in  |     personnel.        | any critical assets      |
| > a way that      |                       | should be handled. The   |
| > satisfies the   | -   At a minimum, the | software security policy |
| > vendor's        |     policy covers all | (or policies) should be  |
| > security and    |     control           | known and thoroughly     |
| > compliance      |     objectives within | understood by those with |
| > obligations.    |     this standard     | the responsibility to    |
|                   |     either explicitly | ensure they are met, as  |
|                   |     or implicitly.    | well as those            |
|                   |                       | individuals and teams    |
|                   | -   The policy is     | who have the ability to  |
|                   |     defined in        | affect the security of   |
|                   |     sufficient detail | the vendor's products    |
|                   |     such that the     | and services. The        |
|                   |     security rules    | vendor's senior          |
|                   |     and goals are     | leadership team should   |
|                   |     measurable.       | openly support the       |
|                   |                       | establishment and        |
|                   | -   The vendor's      | enforcement of the       |
|                   |     senior leadership | security policy through  |
|                   |     team has approved | appropriate              |
|                   |     the software      | communications to vendor |
|                   |     security policy.  | personnel, to reinforce  |
|                   |                       | the importance of        |
|                   |                       | software security to the |
|                   |                       | vendor organization and  |
|                   |                       | its leadership.          |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.2.2.b**         |                          |
|                   | Interview a sample of |                          |
|                   | software- development |                          |
|                   | personnel to confirm  |                          |
|                   | they are aware of and |                          |
|                   | understand the        |                          |
|                   | software security     |                          |
|                   | policy.               |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.2.3** A   | **D.1.2.3.a** Examine | A software-security      |
| > formal          | vendor evidence and   | strategy is a high-level |
| >                 | interview responsible | plan, roadmap, or        |
| software-security | personnel to confirm  | methodology for ensuring |
| > strategy for    | the following:        | the secure design,       |
| > ensuring the    |                       | development, and         |
| > security of the | -   A strategy to     | maintenance of the       |
| > vendor's        |     ensure the        | vendor's products and    |
| > products and    |     security of the   | services, and adherence  |
| > services and    |     vendor's products | to the vendor's software |
| > satisfying its  |     and services is   | security policy.         |
| > software        |     defined.          |                          |
| > security policy |                       | Vendors should either    |
| > is established  | -   The               | adopt existing           |
| > and maintained. |     software-security | frameworks or            |
|                   |     strategy clearly  | methodologies or develop |
|                   |     outlines how the  | their own in accordance  |
|                   |     software security | with industry-accepted   |
|                   |     policy is to be   | practices for secure     |
|                   |     satisfied.        | software lifecycle       |
|                   |                       | management. By aligning  |
|                   | -   The               | its software-security    |
|                   |     software-security | strategy with            |
|                   |     strategy is based | industry-accepted        |
|                   |     on or aligned     | methodologies, the       |
|                   |     with              | vendor is less likely to |
|                   |     industry-accepted | overlook important       |
|                   |     methodologies.    | aspects of secure        |
|                   |                       | software lifecycle       |
|                   | -   The               | management.              |
|                   |     software-security |                          |
|                   |     strategy covers   | Vendors that develop     |
|                   |     the entire        | their own methodologies  |
|                   |     lifecycle of the  | should understand how    |
|                   |     vendor's products | they differ from         |
|                   |     and services.     | industry-accepted        |
|                   |                       | methodologies, identify  |
|                   | -   The               | any gaps, and ensure     |
|                   |     software-security | that sufficient evidence |
|                   |     strategy is       | is maintained to clearly |
|                   |     communicated to   | show how their           |
|                   |     appropriate       | methodologies are at     |
|                   |     personnel,        | least as effective as    |
|                   |     including         | those accepted by the    |
|                   |     software-         | industry. Examples of    |
|                   |     development       | industry-accepted        |
|                   |     personnel.        | methodologies that are   |
|                   |                       | commonly used as         |
|                   | -   The               | benchmarks for secure    |
|                   |     software-security | software development and |
|                   |     strategy is       | management include, but  |
|                   |     reviewed at least | are not limited to,      |
|                   |     annually and      | current versions of:     |
|                   |     updated as        |                          |
|                   |     needed, such as   | -   *ISO/IEC 27034       |
|                   |     when business     |     Application Security |
|                   |     needs, external   |     Guidelines*          |
|                   |     drivers, and      |                          |
|                   |     products and      | -   *Building Security   |
|                   |     services evolve.  |     In Maturity Model    |
|                   |                       |     (BSIMM)*             |
|                   |                       |                          |
|                   |                       | -   *OWASP Software      |
|                   |                       |     Assurance Maturity   |
|                   |                       |     Model (OpenSAMM)*    |
|                   |                       |                          |
|                   |                       | -   *NIST Special        |
|                   |                       |     Publication 800-160  |
|                   |                       |     and its Appendixes*  |
|                   |                       |                          |
|                   |                       | The software-security    |
|                   |                       | strategy should evolve   |
|                   |                       | as internal factors,     |
|                   |                       | such as the vendor's     |
|                   |                       | business strategy or     |
|                   |                       | product/service          |
|                   |                       | offerings or external    |
|                   |                       | factors such as external |
|                   |                       | security and compliance  |
|                   |                       | requirements, evolve.    |
|                   |                       | Therefore, the           |
|                   |                       | software-security        |
|                   |                       | strategy is not static   |
|                   |                       | and should be reviewed   |
|                   |                       | and updated periodically |
|                   |                       | to maintain alignment    |
|                   |                       | with business needs and  |
|                   |                       | priorities.              |
|                   |                       |                          |
|                   |                       | *(continued on next      |
|                   |                       | page)*                   |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.2.3.b**         |                          |
|                   | Interview a sample of |                          |
|                   | software- development |                          |
|                   | personnel to confirm  |                          |
|                   | they are aware of and |                          |
|                   | understand the        |                          |
|                   | software-security     |                          |
|                   | strategy.             |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
|                   |                       | Evidence to support this |
|                   |                       | requirement might        |
|                   |                       | include documented       |
|                   |                       | security plans or        |
|                   |                       | methodologies,           |
|                   |                       | presentations, policies  |
|                   |                       | and processes, training  |
|                   |                       | materials, meeting       |
|                   |                       | minutes, interviewer     |
|                   |                       | notes, e-mails or        |
|                   |                       | executive                |
|                   |                       | communications,          |
|                   |                       | mappings, or references  |
|                   |                       | to industry- accepted    |
|                   |                       | methodologies, gap       |
|                   |                       | analysis results, or any |
|                   |                       | other records or         |
|                   |                       | documentation that       |
|                   |                       | clearly and consistently |
|                   |                       | shows that the vendor    |
|                   |                       | has made a reasonable    |
|                   |                       | effort to develop,       |
|                   |                       | maintain, and keep       |
|                   |                       | current a formal         |
|                   |                       | strategy for satisfying  |
|                   |                       | the vendor's software    |
|                   |                       | security policy.         |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.2.4**     | **D.1.2.4.a** Examine | Software                 |
| > Software        | vendor evidence and   | security-assurance       |
| > s               | interview personnel   | processes are activities |
| ecurity-assurance | to confirm the        | that are implemented to  |
| > processes are   | following:            | carry out the vendor's   |
| > implemented and |                       | software- security       |
| > maintained      | -   Software          | strategy and to          |
| > throughout the  |                       | facilitate secure        |
| > entire software |    security-assurance | software design,         |
| > lifecycle.      |     processes are     | development, and         |
| >                 |     defined,          | maintenance. To ensure   |
| > ***Note:** The  |     implemented, and  | that security and        |
| > focus is on the |     maintained.       | compliance requirements  |
| > overall         |                       | are met, software        |
| > management of   | -   An inventory of   | security policy is       |
| > s               |     software          | satisfied, and the       |
| ecurity-assurance |                       | vendor's products and    |
| > processes and   |    security-assurance | services are secure and  |
| > provides the    |     processes is      | resistant to attack,     |
| > foundation for  |     maintained.       | vendors need to define   |
| > specific        |                       | such processes           |
| > assurance       |                       | throughout all phases of |
| > processes       |                       | the software lifecycle.  |
| > defined within  |                       | These may include        |
| > this document.* |                       | security "checkpoints,"  |
|                   |                       | which are distinct       |
|                   |                       | points within the        |
|                   |                       | software-development     |
|                   |                       | process where software   |
|                   |                       | is checked to make sure  |
|                   |                       | security requirements    |
|                   |                       | are met. Examples of     |
|                   |                       | software security-       |
|                   |                       | assurance processes and  |
|                   |                       | controls include         |
|                   |                       | software- design         |
|                   |                       | reviews, automated code  |
|                   |                       | reviews,                 |
|                   |                       | security-specific        |
|                   |                       | functional testing, and  |
|                   |                       | change-management        |
|                   |                       | processes.               |
|                   |                       |                          |
|                   |                       | For organizations that   |
|                   |                       | leverage Agile software- |
|                   |                       | development              |
|                   |                       | methodologies, security  |
|                   |                       | checkpoints may be       |
|                   |                       | incorporated into the    |
|                   |                       | "story" acceptance       |
|                   |                       | criteria or the criteria |
|                   |                       | for determining when     |
|                   |                       | work is considered       |
|                   |                       | "done."                  |
|                   |                       |                          |
|                   |                       | Evidence to support this |
|                   |                       | requirement might        |
|                   |                       | include documented       |
|                   |                       | policies and processes,  |
|                   |                       | security-control         |
|                   |                       | inventories, output from |
|                   |                       | Governance Risk and      |
|                   |                       | Compliance (GRC) or      |
|                   |                       | other management tools,  |
|                   |                       | software- specific       |
|                   |                       | requirements             |
|                   |                       | documentation, or any    |
|                   |                       | other evidence that      |
|                   |                       | clearly and consistently |
|                   |                       | identifies the software  |
|                   |                       | security-assurance       |
|                   |                       | processes that have been |
|                   |                       | implemented and shows    |
|                   |                       | that the                 |
|                   |                       | security-assurance       |
|                   |                       | processes are            |
|                   |                       | appropriate for the      |
|                   |                       | function they are        |
|                   |                       | intended to provide.     |
|                   |                       | Additionally, evidence   |
|                   |                       | to show the software     |
|                   |                       | security-assurance       |
|                   |                       | processes are            |
|                   |                       | implemented properly may |
|                   |                       | include system or        |
|                   |                       | process outputs such as  |
|                   |                       | threat models, security  |
|                   |                       | test results, bug        |
|                   |                       | tracking data, audit log |
|                   |                       | data, incident response, |
|                   |                       | etc.                     |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.2.4.b** For a   |                          |
|                   | sample of software    |                          |
|                   | security- assurance   |                          |
|                   | processes, examine    |                          |
|                   | vendor evidence and   |                          |
|                   | interview personnel   |                          |
|                   | to confirm the        |                          |
|                   | following:            |                          |
|                   |                       |                          |
|                   | -   Software          |                          |
|                   |                       |                          |
|                   |    security-assurance |                          |
|                   |     processes clearly |                          |
|                   |     address the       |                          |
|                   |     specific rules    |                          |
|                   |     and goals within  |                          |
|                   |     the vendor's      |                          |
|                   |     software security |                          |
|                   |     policy.           |                          |
|                   |                       |                          |
|                   | -   Software          |                          |
|                   |                       |                          |
|                   |    security-assurance |                          |
|                   |     processes are     |                          |
|                   |     aligned with the  |                          |
|                   |     vendor's          |                          |
|                   |     software-security |                          |
|                   |     strategy.         |                          |
|                   |                       |                          |
|                   | -   Vendor personnel, |                          |
|                   |     including         |                          |
|                   |     software-         |                          |
|                   |     development       |                          |
|                   |     personnel, are    |                          |
|                   |     assigned          |                          |
|                   |     responsibility    |                          |
|                   |     and               |                          |
|                   |     accountability    |                          |
|                   |     for the execution |                          |
|                   |     and performance   |                          |
|                   |     of the security-  |                          |
|                   |     assurance process |                          |
|                   |     in accordance     |                          |
|                   |     with D.1.1.2.     |                          |
|                   |                       |                          |
|                   | -   The individuals   |                          |
|                   |     or teams          |                          |
|                   |     responsible for   |                          |
|                   |     performing and    |                          |
|                   |     maintaining each  |                          |
|                   |     security-         |                          |
|                   |     assurance process |                          |
|                   |     are clearly aware |                          |
|                   |     of their          |                          |
|                   |     responsibilities. |                          |
|                   |                       |                          |
|                   | -   The results or    |                          |
|                   |     outcomes of each  |                          |
|                   |     security-         |                          |
|                   |     assurance process |                          |
|                   |     are monitored in  |                          |
|                   |     accordance with   |                          |
|                   |     D1.2.6.           |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.2.5**     | **D.1.2.5.a** Examine | To demonstrate the       |
| > Evidence is     | vendor evidence,      | effectiveness of         |
| > generated and   | including the         | software security-       |
| > maintained to   | inventory of software | assurance processes,     |
| > demonstrate the | security-assurance    | evidence should be       |
| > effectiveness   | processes, and        | generated and maintained |
| > of software     | interview personnel   | for each process to show |
| > security-       | to confirm that       | that it directly results |
| > assurance       | evidence is generated | in or contributes to the |
| > processes.      | and maintained for    | expected security        |
|                   | each security-        | outcomes (e.g., fewer    |
|                   | assurance process.    | vulnerabilities or       |
|                   |                       | greater resistance to    |
|                   |                       | attacks).                |
|                   |                       |                          |
|                   |                       | Evidence needs to be     |
|                   |                       | frequently collected and |
|                   |                       | kept up to date to       |
|                   |                       | ensure it accurately     |
|                   |                       | reflects the ongoing     |
|                   |                       | effectiveness of         |
|                   |                       | security-assurance       |
|                   |                       | processes. Without a     |
|                   |                       | track record of          |
|                   |                       | performance for software |
|                   |                       | security- assurance      |
|                   |                       | processes, it becomes    |
|                   |                       | almost impossible to     |
|                   |                       | effectively perform      |
|                   |                       | root-cause analysis when |
|                   |                       | such processes fail to   |
|                   |                       | produce the expected     |
|                   |                       | results.                 |
|                   |                       |                          |
|                   |                       | Evidence to support this |
|                   |                       | objective might include  |
|                   |                       | security control and     |
|                   |                       | evidence generation      |
|                   |                       | inventories,             |
|                   |                       | vulnerability reports,   |
|                   |                       | penetration testing      |
|                   |                       | results, or any other    |
|                   |                       | records and evidence     |
|                   |                       | that clearly and         |
|                   |                       | consistently shows       |
|                   |                       | evidence is generated    |
|                   |                       | for each software        |
|                   |                       | security- assurance      |
|                   |                       | process and that the     |
|                   |                       | evidence clearly shows   |
|                   |                       | the effectiveness of the |
|                   |                       | processes.               |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.2.5.b** For a   |                          |
|                   | sample of             |                          |
|                   | security-assurance    |                          |
|                   | processes, examine    |                          |
|                   | evidence and other    |                          |
|                   | output from the       |                          |
|                   | processes and         |                          |
|                   | interview personnel   |                          |
|                   | to confirm the        |                          |
|                   | evidence generated    |                          |
|                   | for each process      |                          |
|                   | reasonably            |                          |
|                   | demonstrates the      |                          |
|                   | process is operating  |                          |
|                   | effectively and as    |                          |
|                   | intended.             |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.1.2.6**     | **D.1.2.6.a** Examine | Software vendors should  |
| > Failures or     | vendor evidence and   | monitor their            |
| > weaknesses in   | interview personnel   | security-assurance       |
| > software        | to confirm the        | processes to confirm the |
| > s               | following:            | processes remain         |
| ecurity-assurance |                       | appropriate (i.e., fit   |
| > processes are   | -   A mature process  | for purpose), and        |
| > detected. Weak  |     exists to detect  | effective for their      |
| > or ineffective  |     and evaluate weak | intended purpose and     |
| > security-       |     or ineffective    | function. For example,   |
| > assurance       |                       | the use of manual code   |
| > processes are   |    security-assurance | reviews may be           |
| > updated,        |     processes.        | sufficient to detect all |
| > augmented, or   |                       | coding errors and        |
| > replaced.       | -   The criteria for  | vulnerabilities for      |
|                   |     determining a     | software with a very     |
|                   |     weak or           | limited code base.       |
|                   |     ineffective       | However, as the code     |
|                   |                       | base grows, the use of   |
|                   |    security-assurance | manual code reviews for  |
|                   |     process are       | the same purpose becomes |
|                   |     defined and       | increasingly impractical |
|                   |     justified.        | or insufficient, and     |
|                   |                       | automated testing tools  |
|                   | -   Security          | (such as automated       |
|                   |     assurance         | static-code scanners and |
|                   |     processes are     | dynamic                  |
|                   |     updated,          | software-analysis tools) |
|                   |     augmented, or     | should be used.          |
|                   |     replaced when     |                          |
|                   |     deemed weak or    | One method for detecting |
|                   |     ineffective.      | weak or ineffective      |
|                   |                       | security controls is to  |
|                   |                       | define a set of metrics  |
|                   |                       | or trends that can be    |
|                   |                       | used to measure the      |
|                   |                       | effectiveness of         |
|                   |                       | security-assurance       |
|                   |                       | processes. For example,  |
|                   |                       | the results from a       |
|                   |                       | vendor's security        |
|                   |                       | testing may provide      |
|                   |                       | greater insight into the |
|                   |                       | effectiveness of         |
|                   |                       | security-assurance       |
|                   |                       | processes. If security   |
|                   |                       | tests repeatedly find    |
|                   |                       | vulnerabilities within   |
|                   |                       | the software, it may     |
|                   |                       | indicate that applicable |
|                   |                       | security-assurance       |
|                   |                       | processes are not being  |
|                   |                       | executed properly or     |
|                   |                       | working as intended.     |
|                   |                       | Another method for       |
|                   |                       | detecting weak or        |
|                   |                       | ineffective              |
|                   |                       | security-assurance       |
|                   |                       | processes would be to    |
|                   |                       | perform regular reviews  |
|                   |                       | of those processes and   |
|                   |                       | the evidence generated   |
|                   |                       | by those processes to    |
|                   |                       | verify they continue to  |
|                   |                       | be appropriate for their |
|                   |                       | intended purpose.        |
|                   |                       |                          |
|                   |                       | Evidence to support this |
|                   |                       | requirement might        |
|                   |                       | include                  |
|                   |                       | process-generated        |
|                   |                       | evidence, security test  |
|                   |                       | results, root- cause     |
|                   |                       | analysis, documented     |
|                   |                       | remediation actions, or  |
|                   |                       | any other evidence that  |
|                   |                       | clearly and consistently |
|                   |                       | shows that the           |
|                   |                       | effectiveness of         |
|                   |                       | software                 |
|                   |                       | security-assurance       |
|                   |                       | processes is monitored,  |
|                   |                       | failures and weaknesses  |
|                   |                       | are detected, and        |
|                   |                       | security-assurance       |
|                   |                       | processes are updated,   |
|                   |                       | augmented, or replaced   |
|                   |                       | when no longer effective |
|                   |                       | at satisfying their      |
|                   |                       | intended purpose.        |
+-------------------+-----------------------+--------------------------+
|                   | **D.1.2.6.b** For a   |                          |
|                   | sample of the         |                          |
|                   | security-assurance    |                          |
|                   | processes identified  |                          |
|                   | in D.1.2.4, interview |                          |
|                   | personnel and examine |                          |
|                   | any additional        |                          |
|                   | evidence necessary to |                          |
|                   | determine if any      |                          |
|                   | failures or           |                          |
|                   | weaknesses in those   |                          |
|                   | security processes    |                          |
|                   | occurred, and to      |                          |
|                   | confirm that weak or  |                          |
|                   | ineffective processes |                          |
|                   | were updated,         |                          |
|                   | augmented, or         |                          |
|                   | replaced.             |                          |
+-------------------+-----------------------+--------------------------+

## Secure Software Engineering

> Software is designed and developed to protect critical software assets
> and to be resistant to attacks.

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.2.1** Threat |                      |                          |
| > Identification   |                      |                          |
| > and Mitigation   |                      |                          |
| >                  |                      |                          |
| > Continuously     |                      |                          |
| > identifies,      |                      |                          |
| > assesses, and    |                      |                          |
| > manages risk to  |                      |                          |
| > its software and |                      |                          |
| > services.        |                      |                          |
+--------------------+----------------------+--------------------------+
| > **D.2.1.1**      | **D.2.1.1.a**        | Before the vendor can    |
| > Critical assets  | Examine vendor       | determine how to         |
| > are identified   | evidence to confirm  | effectively secure and   |
| > and classified.  | the following:       | defend its software      |
|                    |                      | against attacks, it must |
|                    | -   A mature process | first develop a thorough |
|                    |     exists to        | understanding of the     |
|                    |     identify and     | software's critical      |
|                    |     classify         | assets that could be     |
|                    |     critical assets. | targeted by attackers.   |
|                    |                      |                          |
|                    | -   The criteria for | Critical assets include  |
|                    |     identifying      | any sensitive assets     |
|                    |     critical assets  | collected, stored,       |
|                    |     and determining  | processed, or            |
|                    |     the              | transmitted by the       |
|                    |     confidentiality, | vendor's software, as    |
|                    |     integrity, and   | well as any sensitive    |
|                    |     resiliency       | functions and sensitive  |
|                    |     requirements for | resources within or used |
|                    |     each critical    | by the software.         |
|                    |     assets are       | Examples of analysis     |
|                    |     defined.         | techniques that could be |
|                    |                      | used to identify         |
|                    | -   The process      | critical assets include, |
|                    |     accounts for all | but are not limited to,  |
|                    |     types of         | Mission Impact Analysis  |
|                    |     critical         | (MIA), Functional        |
|                    |                      | Dependency Network       |
|                    |   assets---including | Analysis (FDNA), and     |
|                    |     sensitive        | Mission Threat Analysis. |
|                    |     assets,          |                          |
|                    |     sensitive        |                          |
|                    |     resources, and   |                          |
|                    |     sensitive        |                          |
|                    |     functions---for  |                          |
|                    |     the vendor's     |                          |
|                    |     software.        |                          |
|                    |                      |                          |
|                    | -   The process      |                          |
|                    |     results in an    |                          |
|                    |     inventory of     |                          |
|                    |     critical assets  |                          |
|                    |     used by the      |                          |
|                    |     vendor's         |                          |
|                    |     software.        |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.2.1.2**      | **D.2.1.2.a**        | Determining how to       |
| > Threats to the   | Examine vendor       | effectively secure and   |
| > software and     | evidence, including  | defend software against  |
| > weaknesses       | process              | attacks requires a       |
| > within its       | documentation and    | thorough understanding   |
| > design are       | assessment results   | of the specific threats  |
| > continuously     | to confirm the       | and vulnerabilities      |
| > identified and   | following:           | applicable to the        |
| > assessed.        |                      | vendor's software. This  |
|                    | -   A mature process | typically involves       |
|                    |     exists to        | understanding:           |
|                    |     identify,        |                          |
|                    |     assess, and      | -   The motivations an   |
|                    |     monitor software |     attacker may have    |
|                    |     threats and      |     for attacking        |
|                    |     design           |     software.            |
|                    |     weaknesses       |                          |
|                    |     (i.e., flaws).   | -   Weaknesses in the    |
|                    |                      |     software design that |
|                    | -   The assessment   |     an attacker might    |
|                    |     accounts for all |     attempt to exploit.  |
|                    |     software         |                          |
|                    |     inputs/outputs,  | -   The exploitability   |
|                    |     process/data     |     of identified        |
|                    |     flows, trust     |     weaknesses.          |
|                    |     boundaries and   |                          |
|                    |     decision points, | -   The impact of a      |
|                    |     and how they may |     successful attack.   |
|                    |     be exploited by  |                          |
|                    |     an attacker.     | This information helps   |
|                    |                      | the vendor to identify   |
|                    | -   The assessment   | the threats and design   |
|                    |     accounts for the | flaws that present the   |
|                    |     entire code      | most significant and     |
|                    |     base, including  | immediate risk, and to   |
|                    |     how the use of   | prioritize remediation   |
|                    |     third-party,     | activities necessary to  |
|                    |     open-source, or  | address them.            |
|                    |     shared           |                          |
|                    |     components or    | Information regarding    |
|                    |     libraries, APIs, | software threats can be  |
|                    |     services, and    | obtained from a variety  |
|                    |     applications     | of sources, both         |
|                    |     used for the     | external and internal.   |
|                    |     delivery and     |                          |
|                    |     operation of the | Examples of external     |
|                    |     software may be  | sources include          |
|                    |     leveraged in an  | publications from        |
|                    |     attack.          | organizations such as    |
|                    |                      | SANS, MITRE, and CERT    |
|                    | -   The assessment   | that specialize in       |
|                    |     results in a     | tracking common system   |
|                    |     recorded         | vulnerabilities and      |
|                    |     inventory of     | attack techniques, or    |
|                    |     threats and      | industry-specific        |
|                    |     design flaws.    | sources that provide     |
|                    |                      | threat intelligence for  |
|                    | -   Assessments are  | specific sectors, such   |
|                    |     routinely        | as FS-ISAC for the       |
|                    |     performed to     | financial services       |
|                    |     account for      | industry and R-CISC for  |
|                    |     changes to       | the retail industry.     |
|                    |     existing or the  | Other external sources   |
|                    |     emergence of new | of threat information    |
|                    |     threats or       | and design weaknesses    |
|                    |     design flaws.    | could include technology |
|                    |                      | vendors, open-source     |
|                    |                      | user communities,        |
|                    |                      | industry publications,   |
|                    |                      | and academic papers.     |
|                    |                      | Internal sources could   |
|                    |                      | include reports from     |
|                    |                      | internal research and    |
|                    |                      |                          |
|                    |                      | design teams, formal     |
|                    |                      | threat models, or actual |
|                    |                      | activity data from       |
|                    |                      | internal security or     |
|                    |                      | operations teams.        |
|                    |                      |                          |
|                    |                      | *(continued on next      |
|                    |                      | page)*                   |
+--------------------+----------------------+--------------------------+
|                    | **D.2.1.2.b** When   |                          |
|                    | open-source software |                          |
|                    | components are       |                          |
|                    | utilized as part of  |                          |
|                    | the software,        |                          |
|                    | examine vendor       |                          |
|                    | evidence, including  |                          |
|                    | process              |                          |
|                    | documentation and    |                          |
|                    | assessment results   |                          |
|                    | to confirm these     |                          |
|                    | components are       |                          |
|                    | managed as follows:  |                          |
|                    |                      |                          |
|                    | -   An inventory of  |                          |
|                    |     open-source      |                          |
|                    |     components used  |                          |
|                    |     in the vendor's  |                          |
|                    |     software is      |                          |
|                    |     maintained.      |                          |
|                    |                      |                          |
|                    | -   A mature process |                          |
|                    |     exists to        |                          |
|                    |     analyze and      |                          |
|                    |     mitigate the use |                          |
|                    |     of open-source   |                          |
|                    |     components with  |                          |
|                    |     known            |                          |
|                    |     vulnerabilities. |                          |
|                    |                      |                          |
|                    | -   The vendor       |                          |
|                    |     monitors         |                          |
|                    |     vulnerabilities  |                          |
|                    |     in open- source  |                          |
|                    |     components       |                          |
|                    |     throughout their |                          |
|                    |     use or inclusion |                          |
|                    |     in the vendor's  |                          |
|                    |     software.        |                          |
|                    |                      |                          |
|                    | -   An appropriate   |                          |
|                    |     patching         |                          |
|                    |     strategy for     |                          |
|                    |     open- source     |                          |
|                    |     components is    |                          |
|                    |     defined.         |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
|                    | **D.2.1.2.c**        | When open-source         |
|                    | Examine assessment   | software components are  |
|                    | results for the      | used, the vendor should  |
|                    | selected software to | consider any risks       |
|                    | confirm the          | associated with the use  |
|                    | following:           | of the open-source       |
|                    |                      | components and the       |
|                    | -   All software     | extent to which the      |
|                    |     inputs/outputs,  | open-source software     |
|                    |     process/data     | provider manages the     |
|                    |     flows, trust     | security of those        |
|                    |     boundaries, and  | components.              |
|                    |     decision points  | Additionally, the vendor |
|                    |     were considered  | will need to confirm     |
|                    |     during the       | that support---including |
|                    |     assessment.      | up-to-date security      |
|                    |                      | patches---is available   |
|                    | -   The entire code  | (whether provided by an  |
|                    |     base, including  | internal or external     |
|                    |     how the use of   | entity) for the          |
|                    |     third-party,     | open-source component.   |
|                    |     open-source or   | The use of open-source   |
|                    |     shared           | components should be     |
|                    |     components or    | supported by a clear     |
|                    |     libraries, APIs, | policy about how those   |
|                    |     services, and    | components are evaluated |
|                    |     applications     | and implemented. A       |
|                    |     used for the     | reliable support system  |
|                    |     delivery and     | should be in place to    |
|                    |     operation of the | identify errors or       |
|                    |     software were    | problems and evaluate    |
|                    |     considered       | and address them in a    |
|                    |     during the       | timely manner.           |
|                    |     assessment.      |                          |
|                    |                      | When vulnerabilities are |
|                    |                      | identified in            |
|                    |                      | open-source components   |
|                    |                      | that are applicable to   |
|                    |                      | their software, vendors  |
|                    |                      | should have processes in |
|                    |                      | place to analyze those   |
|                    |                      | vulnerabilities and      |
|                    |                      | update the components to |
|                    |                      | appropriate,             |
|                    |                      | non-vulnerable versions  |
|                    |                      | in a timely manner. When |
|                    |                      | patches for open-source  |
|                    |                      | components are no longer |
|                    |                      | available, those         |
|                    |                      | components should be     |
|                    |                      | replaced by actively     |
|                    |                      | supported ones. Vendors  |
|                    |                      | should identify and      |
|                    |                      | establish sources and    |
|                    |                      | processes for managing   |
|                    |                      | vulnerabilities in       |
|                    |                      | open-source components   |
|                    |                      | that are appropriate for |
|                    |                      | their software design    |
|                    |                      | and release frequency.   |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.2.1.3**      | **D.2.1.3.a**        | To ensure that its       |
| > Software         | Examine vendor       | software is resistant to |
| > security         | evidence, including  | attacks, vendors must    |
| > controls are     | process              | implement                |
| > implemented in   | documentation and    | software-specific        |
| > the software to  | software-specific    | controls or              |
| > mitigate threats | threat and design    | countermeasures in their |
| > and design       | information, to      | software to mitigate the |
| > weaknesses.      | confirm the          | specific threats and     |
|                    | following:           | design weaknesses.       |
|                    |                      | Examples of such         |
|                    | -   A mature process | controls include the use |
|                    |     exists for       | of multi-factor          |
|                    |     defining         | authentication           |
|                    |     software-        | mechanisms to prevent    |
|                    |     specific         | unauthorized individuals |
|                    |     security         | gaining access to        |
|                    |     requirements and | critical assets, and     |
|                    |     implementing     | logging mechanisms to    |
|                    |     software         | detect if and when       |
|                    |     security         | authentication           |
|                    |     controls within  | mechanisms might have    |
|                    |     the software to  | been circumvented. Other |
|                    |     mitigate         | examples include the use |
|                    |     software threats | of input validation      |
|                    |     and design       | routines or              |
|                    |     flaws.           | parameterized queries to |
|                    |                      | protect software from    |
|                    | -   Decisions on     | SQL-injection attacks.   |
|                    |     whether and how  | Except where specific    |
|                    |     to mitigate a    | software security        |
|                    |     specific threat  | controls and             |
|                    |     or design flaw   | countermeasures are      |
|                    |     are recorded,    | defined within this      |
|                    |     justified, and   | standard, it is up to    |
|                    |     approved by      | the vendor to determine  |
|                    |     appropriate      | the most appropriate     |
|                    |     personnel.       | software security        |
|                    |                      | controls to implement.   |
|                    | -   Any remaining    | The specific controls    |
|                    |     residual risk is | used will be dependent   |
|                    |     recorded,        | on the software threats  |
|                    |     justified, and   | identified, as well as   |
|                    |     approved by      | the software's           |
|                    |     appropriate      | architecture, the        |
|                    |     personnel.       | software's intended      |
|                    |                      | function, the data it    |
|                    |                      | handles, and the         |
|                    |                      | external resources it    |
|                    |                      | utilizes.                |
|                    |                      |                          |
|                    |                      | Evidence to support this |
|                    |                      | security objective may   |
|                    |                      | include                  |
|                    |                      | software-specific        |
|                    |                      | requirements             |
|                    |                      | documentation, feature   |
|                    |                      | lists, security control  |
|                    |                      | inventories,             |
|                    |                      | change-management        |
|                    |                      | documentation, risk      |
|                    |                      | assessment reports, test |
|                    |                      | results, or any other    |
|                    |                      | evidence or information  |
|                    |                      | that clearly and         |
|                    |                      | consistently shows that  |
|                    |                      | the vendor implements    |
|                    |                      | and maintains security   |
|                    |                      | controls in software to  |
|                    |                      | address the risks to     |
|                    |                      | that software.           |
+--------------------+----------------------+--------------------------+
|                    | **D.2.1.3.b**        |                          |
|                    | Examine evidence and |                          |
|                    | interview personnel  |                          |
|                    | to confirm the       |                          |
|                    | following:           |                          |
|                    |                      |                          |
|                    | -   Decisions on     |                          |
|                    |     whether and how  |                          |
|                    |     to mitigate a    |                          |
|                    |     specific threat  |                          |
|                    |     or design flaw   |                          |
|                    |     are reasonably   |                          |
|                    |     justified.       |                          |
|                    |                      |                          |
|                    | -   Any remaining    |                          |
|                    |     residual risk is |                          |
|                    |     reasonably       |                          |
|                    |     justified.       |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.2.1.3.c**        |                          |
|                    | Examine vendor       |                          |
|                    | evidence to confirm  |                          |
|                    | that security        |                          |
|                    | controls have been   |                          |
|                    | implemented to       |                          |
|                    | mitigate all         |                          |
|                    | identified threats   |                          |
|                    | and design flaws.    |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.2.1.4**      | **D.2.1.4.a**        | Vendors should monitor   |
| > Failures or      | Examine vendor       | and/or routinely test    |
| > weaknesses in    | evidence and         | their software to        |
| > software         | interview personnel  | confirm that implemented |
| > security         | to confirm the       | software security        |
| > controls are     | following:           | controls remain          |
| > detected. Weak   |                      | appropriate (i.e., fit   |
| > or ineffective   | -   A mature process | for purpose) and         |
| > security         |     exists to        | effective for            |
| > controls are     |     identify weak or | sufficiently mitigating  |
| > updated,         |     ineffective      | evolving risks or design |
| > augmented, or    |     software         | flaws. For example, a    |
| > replaced.        |     security         | software-specific        |
|                    |     controls and to  | security requirement may |
|                    |     update, augment, | call for cryptography to |
|                    |     or replace them. | be used to protect       |
|                    |                      | software communications. |
|                    | -   The criteria for | While the use of SSL may |
|                    |     determining a    | have been sufficient     |
|                    |     weak or          | upon the initial design  |
|                    |     ineffective      | and release of the       |
|                    |     security control | software, SSL is no      |
|                    |     are defined and  | longer sufficient to     |
|                    |     justified.       | adequately protect       |
|                    |                      | communications as new    |
|                    | -   The process      | threats and attack       |
|                    |     involves         | methods have             |
|                    |     monitoring       | significantly reduced    |
|                    |     security control | its effectiveness as a   |
|                    |     effectiveness    | security control.        |
|                    |     throughout the   | Therefore, it is         |
|                    |     software         | imperative that vendors  |
|                    |     lifecycle.       | have processes in place  |
|                    |                      | to continuously monitor  |
|                    | -   Weak or          | implemented security     |
|                    |     ineffective      | controls to make sure    |
|                    |     security         | that they remain         |
|                    |     controls are     | appropriate and          |
|                    |     updated,         | sufficient to mitigate   |
|                    |     augmented, or    | evolving threats and     |
|                    |     replaced in a    | design flaws throughout  |
|                    |     timely manner    | the entire lifetime of   |
|                    |     upon detection.  | the software.            |
|                    |                      |                          |
|                    |                      | Evidence to support this |
|                    |                      | requirement might        |
|                    |                      | include                  |
|                    |                      | software-specific        |
|                    |                      | documentation, features  |
|                    |                      | lists, software-         |
|                    |                      | specific security        |
|                    |                      | control inventories,     |
|                    |                      | change-management        |
|                    |                      | documentation,           |
|                    |                      | risk-assessment reports, |
|                    |                      | penetration test         |
|                    |                      | results, output from     |
|                    |                      | active s, bug bounty     |
|                    |                      | program data, or any     |
|                    |                      | other evidence or        |
|                    |                      | information that clearly |
|                    |                      | and consistently shows   |
|                    |                      | that the effectiveness   |
|                    |                      | of software security     |
|                    |                      | controls is monitored    |
|                    |                      | and that                 |
|                    |                      | software-specific        |
|                    |                      | software security        |
|                    |                      | controls are updated,    |
|                    |                      | augmented, or replaced   |
|                    |                      | when no longer effective |
|                    |                      | at satisfying their      |
|                    |                      | intended purpose of      |
|                    |                      | resisting attacks.       |
+--------------------+----------------------+--------------------------+
|                    | **D.2.1.4.b**        |                          |
|                    | Examine vendor       |                          |
|                    | evidence, including  |                          |
|                    | software-specific    |                          |
|                    | data or test         |                          |
|                    | results, and details |                          |
|                    | of software-specific |                          |
|                    | updates to confirm   |                          |
|                    | the following:       |                          |
|                    |                      |                          |
|                    | -   Security         |                          |
|                    |     controls that    |                          |
|                    |     have been deemed |                          |
|                    |     "weak" or        |                          |
|                    |     "ineffective"    |                          |
|                    |     have been        |                          |
|                    |     updated,         |                          |
|                    |     augmented, or    |                          |
|                    |     replaced.        |                          |
|                    |                      |                          |
|                    | -   Decisions on     |                          |
|                    |     whether and how  |                          |
|                    |     to replace and   |                          |
|                    |     augment weak or  |                          |
|                    |     ineffective      |                          |
|                    |     security         |                          |
|                    |     controls are     |                          |
|                    |     made in          |                          |
|                    |     accordance with  |                          |
|                    |     defined criteria |                          |
|                    |     and with         |                          |
|                    |     D.2.1.3.         |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.2.2**        |                      |                          |
| > Vulnerability    |                      |                          |
| > Detection and    |                      |                          |
| > Mitigation       |                      |                          |
| >                  |                      |                          |
| > Detect and       |                      |                          |
| > mitigate         |                      |                          |
| > vulnerabilities  |                      |                          |
| > in software to   |                      |                          |
| > ensure that its  |                      |                          |
| > software remains |                      |                          |
| > resistant to     |                      |                          |
| > attacks          |                      |                          |
| > throughout its   |                      |                          |
| > entire           |                      |                          |
| > lifecycle.       |                      |                          |
+--------------------+----------------------+--------------------------+
| > **D.2.2.1**      | **D.2.2.1.a**        | Software should be       |
| > Existing and     | Examine vendor       | monitored or routinely   |
| > emerging         | evidence and         | tested to confirm that   |
| > software         | interview personnel  | vulnerabilities are      |
| > vulnerabilities  | to confirm the       | identified and mitigated |
| > are detected in  | following:           | before software or code  |
| > a timely manner. |                      | updates are released     |
|                    | -   A mature process | into production, and to  |
|                    |     exists for       | address any              |
|                    |     testing software | vulnerabilities that may |
|                    |     for the          | have been discovered     |
|                    |     existence and    | since release.           |
|                    |     emergence of     |                          |
|                    |     vulnerabilities  | Routine security testing |
|                    |     (i.e., security  | should be performed      |
|                    |     testing).        | prior to or as part of   |
|                    |                      | the code-commit process  |
|                    | -   Tools or methods | to detect coding errors  |
|                    |     used for         | or the use of insecure   |
|                    |     security testing | functions. It could also |
|                    |     are appropriate  | be performed during      |
|                    |     for detecting    | unit, integration,       |
|                    |     applicable       | regression, or           |
|                    |     vulnerabilities  | interoperability         |
|                    |     in the vendor's  | testing, or during       |
|                    |     software, and    | separate security        |
|                    |     are suitable for | testing. Security        |
|                    |     the software     | testing should be        |
|                    |     architectures,   | performed consistently   |
|                    |     and the software | and throughout all       |
|                    |     development      | stages of the software   |
|                    |     languages and    | lifecycle, including     |
|                    |     frameworks       | during various           |
|                    |     employed.        | pre-release phases of    |
|                    |                      | the software-            |
|                    | -   Security testing | development process and  |
|                    |     is performed     | after code release, to   |
|                    |     throughout the   | ensure the software is   |
|                    |     entire software  | free from                |
|                    |     lifecycle,       | vulnerabilities upon     |
|                    |     including after  | launch and any           |
|                    |     release.         | subsequent updates, and  |
|                    |                      | remains free from        |
|                    | -   Security testing | vulnerabilities          |
|                    |     accounts for the | throughout its lifetime. |
|                    |     entire code      |                          |
|                    |     base, including  | Security testing should  |
|                    |     detecting        | be performed by          |
|                    |     vulnerabilities  | appropriately skilled    |
|                    |     in any           | vendor personnel or      |
|                    |     third-party,     | third parties. In        |
|                    |     open-source, and | addition, security       |
|                    |     shared           | testing personnel should |
|                    |     components and   | be able to conduct tests |
|                    |     libraries.       | in an objective way and  |
|                    |                      | be authorized to         |
|                    | -   Security testing | escalate any identified  |
|                    |     is performed by  | vulnerabilities to       |
|                    |     authorized and   | appropriate management   |
|                    |     objective vendor | or development personnel |
|                    |     personnel or     | so they can be properly  |
|                    |     third parties.   | addressed.               |
|                    |                      |                          |
|                    | -   Security testing | Evidence to support this |
|                    |     results in an    | security objective could |
|                    |     inventory of     | include                  |
|                    |     identified       | software-specific        |
|                    |     vulnerabilities. | requirements             |
|                    |                      | documentation, security  |
|                    | -   Security-testing | test results, feature    |
|                    |     details          | lists, change-management |
|                    |     including the    | documentation, entries   |
|                    |     tools used,      | in the vendor's workflow |
|                    |     their            | (bug tracking) database, |
|                    |     configurations,  | or any other evidence or |
|                    |     and the specific | information that clearly |
|                    |     tests performed  | and consistently shows   |
|                    |     are recorded and | that security testing is |
|                    |     retained.        | performed routinely to   |
|                    |                      | detect vulnerabilities   |
|                    |                      | in code prior to release |
|                    |                      | as well as               |
|                    |                      | vulnerabilities          |
|                    |                      | discovered since code    |
|                    |                      | launch.                  |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
|                    | **D.2.2.1.b**        |                          |
|                    | Examine evidence,    |                          |
|                    | including software-  |                          |
|                    | specific security    |                          |
|                    | testing              |                          |
|                    | configurations and   |                          |
|                    | test results to      |                          |
|                    | confirm the          |                          |
|                    | following:           |                          |
|                    |                      |                          |
|                    | -   Security-testing |                          |
|                    |     tools are        |                          |
|                    |     configured in a  |                          |
|                    |     way that is      |                          |
|                    |     appropriate for  |                          |
|                    |     the intended     |                          |
|                    |     tests performed. |                          |
|                    |                      |                          |
|                    | -   Security testing |                          |
|                    |     accounts for the |                          |
|                    |     entire code      |                          |
|                    |     base, including  |                          |
|                    |     detecting        |                          |
|                    |     vulnerabilities  |                          |
|                    |     in any           |                          |
|                    |     third-party,     |                          |
|                    |     open-source, and |                          |
|                    |     shared           |                          |
|                    |     components and   |                          |
|                    |     libraries.       |                          |
|                    |                      |                          |
|                    | -   Security testing |                          |
|                    |     was performed by |                          |
|                    |     authorized and   |                          |
|                    |     objective vendor |                          |
|                    |     personnel or     |                          |
|                    |     third parties.   |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.2.2.1.c**        |                          |
|                    | Examine vendor       |                          |
|                    | evidence and         |                          |
|                    | interview personnel  |                          |
|                    | to confirm that      |                          |
|                    | personnel            |                          |
|                    | responsible for      |                          |
|                    | testing are          |                          |
|                    | knowledgeable and    |                          |
|                    | skilled in the       |                          |
|                    | following areas in   |                          |
|                    | accordance with      |                          |
|                    | D1.1.3:              |                          |
|                    |                      |                          |
|                    | -   Software         |                          |
|                    |     security testing |                          |
|                    |     techniques       |                          |
|                    |                      |                          |
|                    | -   Security testing |                          |
|                    |     tools settings,  |                          |
|                    |     configurations,  |                          |
|                    |     and recommended  |                          |
|                    |     usage            |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.2.2.1.d**        |                          |
|                    | Examine              |                          |
|                    | software-specific    |                          |
|                    | testing results to   |                          |
|                    | confirm that         |                          |
|                    | security testing is  |                          |
|                    | performed throughout |                          |
|                    | the software         |                          |
|                    | lifecycle.           |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.2.2.2**      | **D.2.2.2.a**        | Vulnerabilities should   |
| > Newly discovered | Examine vendor       | be addressed in a way    |
| > vulnerabilities  | evidence and         | commensurate with the    |
| > are fixed in a   | interview personnel  | risk they pose to the    |
| > timely manner.   | to confirm the       | software or its          |
| > The              | following:           | stakeholders. The most   |
| > reintroduction   |                      | critical or severe       |
| > of similar or    | -   A mature process | vulnerabilities (i.e.,   |
| > previously       |     exists for       | those with the highest   |
| > resolved         |     distributing and | exploitability and/or    |
| > vulnerabilities  |     deploying fixes  | the greatest impact to   |
| > is prevented.    |     for newly        | stakeholders) should be  |
|                    |     discovered       | patched immediately,     |
|                    |     vulnerabilities  | followed by those with   |
|                    |     and preventing   | moderate-to-low          |
|                    |     the              | exploitability and/or    |
|                    |     reintroduction   | impact. Additionally,    |
|                    |     of previously    | the discovery of new     |
|                    |     resolved         | classes of               |
|                    |     vulnerabilities. | vulnerabilities should   |
|                    |                      | be used as a source of   |
|                    | -   The process      | input for process        |
|                    |     includes methods | improvement. Software    |
|                    |     to prevent       | should be reviewed for   |
|                    |     previously       | instances of similar     |
|                    |     resolved         | vulnerabilities, and the |
|                    |     vulnerabilities  | vendor's development     |
|                    |     or other similar | processes updated to     |
|                    |     vulnerabilities  | enable detection and     |
|                    |     from being       | mitigation of such       |
|                    |     reintroduced     | vulnerabilities in the   |
|                    |     into the         | future.                  |
|                    |     software.        |                          |
|                    |                      | In some cases, it may be |
|                    | -   The criteria for | impractical for a vendor |
|                    |     determining the  | to fix all identified    |
|                    |     "criticality" or | vulnerabilities prior to |
|                    |     "severity" of    | the release of           |
|                    |     vulnerabilities  | production code or       |
|                    |     and how to       | updates. In such         |
|                    |     address          | circumstances, the       |
|                    |     vulnerabilities  | vendor should have a     |
|                    |     are defined and  | methodology with clear   |
|                    |     justified.       | criteria defined for     |
|                    |                      | prioritizing             |
|                    | -   Fixes to address | vulnerability fixes. The |
|                    |     vulnerabilities  | default outcome should   |
|                    |     in production    | always be that           |
|                    |     code are made    | vulnerabilities are      |
|                    |     available and    | fixed before the         |
|                    |     deployed in      | software is released. In |
|                    |     accordance with  | cases where it is not    |
|                    |     defined          | possible to fix a        |
|                    |     criteria.        | vulnerability prior to   |
|                    |                      | release, an exception    |
|                    | -   Decisions not to | process involving        |
|                    |     provide fixes in | management at a level    |
|                    |     accordance with  | commensurate with the    |
|                    |     defined criteria | severity of the          |
|                    |     are approved and | vulnerability should be  |
|                    |     justified by     | invoked. The process     |
|                    |     appropriate      | should include           |
|                    |     personnel on a   | documented justification |
|                    |     case- by-case    | for why a fix for was    |
|                    |     basis.           | not provided to address  |
|                    |                      | the vulnerability.       |
|                    |                      |                          |
|                    |                      | If it is not possible to |
|                    |                      | mitigate a certain       |
|                    |                      | vulnerability prior to   |
|                    |                      | release, the vendor      |
|                    |                      | should provide           |
|                    |                      | stakeholders with        |
|                    |                      | additional guidance to   |
|                    |                      | mitigate the risk of     |
|                    |                      | exploitation until a     |
|                    |                      | security update to fix   |
|                    |                      | the vulnerability can be |
|                    |                      | made available.          |
|                    |                      |                          |
|                    |                      | *(continued on next      |
|                    |                      | page)*                   |
+--------------------+----------------------+--------------------------+
|                    | **D.2.2.2.b** For a  |                          |
|                    | sample of vendor     |                          |
|                    | software, examine    |                          |
|                    | software-specific    |                          |
|                    | security-testing     |                          |
|                    | results and the      |                          |
|                    | details of software  |                          |
|                    | updates to confirm   |                          |
|                    | that security fixes  |                          |
|                    | are made available   |                          |
|                    | and deployed (where  |                          |
|                    | applicable) in       |                          |
|                    | accordance with      |                          |
|                    | defined criteria.    |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.2.2.2.c** For    |                          |
|                    | the sample of vendor |                          |
|                    | software, interview  |                          |
|                    | personnel to confirm |                          |
|                    | that decisions not   |                          |
|                    | to provide security  |                          |
|                    | fixes in accordance  |                          |
|                    | with defined         |                          |
|                    | criteria are         |                          |
|                    | justified by         |                          |
|                    | appropriate          |                          |
|                    | personnel.           |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
|                    |                      | Under no circumstances   |
|                    |                      | should a previously      |
|                    |                      | resolved vulnerability   |
|                    |                      | be reintroduced into     |
|                    |                      | production code, nor     |
|                    |                      | should similar           |
|                    |                      | vulnerabilities within   |
|                    |                      | the same class of        |
|                    |                      | vulnerabilities be       |
|                    |                      | reintroduced. Additional |
|                    |                      | assurance processes and  |
|                    |                      | safeguards should be     |
|                    |                      | implemented to ensure    |
|                    |                      | that such incidents are  |
|                    |                      | avoided. The specific    |
|                    |                      | processes to prevent     |
|                    |                      | such occurrences will    |
|                    |                      | largely depend about how |
|                    |                      | the vendor's software is |
|                    |                      | structured and how the   |
|                    |                      | vendor manages software  |
|                    |                      | updates. It is up to the |
|                    |                      | vendor to determine the  |
|                    |                      | most appropriate methods |
|                    |                      | to prevent the           |
|                    |                      | reintroduction of        |
|                    |                      | vulnerabilities into     |
|                    |                      | production code.         |
+--------------------+----------------------+--------------------------+

## Secure Software and Data Management

> The confidentiality and integrity of software and its critical assets
> are maintained throughout the software lifecycle.

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.3.1**       |                       |                          |
| > Change          |                       |                          |
| > Management      |                       |                          |
| >                 |                       |                          |
| > Identify and    |                       |                          |
| > manage all      |                       |                          |
| > software        |                       |                          |
| > changes         |                       |                          |
| > throughout the  |                       |                          |
| > software        |                       |                          |
| > lifecycle.      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **D.3.1.1** All | **D.3.1.1.a** Examine | All changes to software  |
| > changes to      | vendor evidence and   | should be defined,       |
| > software are    | interview personnel   | documented, approved,    |
| > identified,     | to confirm:           | and tracked so that any  |
| > assessed, and   |                       | vulnerabilities          |
| > approved.       | -   A mature process  | attributed to such       |
|                   |     exists to         | changes may be           |
|                   |     identify, assess, | identified and resolved  |
|                   |     and approve all   | as quickly as possible.  |
|                   |     changes to        | The harder it is to      |
|                   |     software.         | trace vulnerabilities    |
|                   |                       | back to the changes that |
|                   | -   The process       | introduced them, the     |
|                   |     includes an       | longer it takes to       |
|                   |     analysis of the   | resolve those            |
|                   |     security impact   | vulnerabilities, which   |
|                   |     of all changes.   | places the software at   |
|                   |                       | greater risk of attack   |
|                   | -   The process       | or compromise.           |
|                   |     results in an     |                          |
|                   |     inventory of all  | It is imperative to      |
|                   |     changes made to   | understand the security  |
|                   |     software,         | risk of a change to the  |
|                   |     including a       | software to ensure that  |
|                   |     record of the     | it is addressed          |
|                   |     determined        | accordingly. It often    |
|                   |     security impact.  | involves understanding   |
|                   |                       | the types of software    |
|                   | -   All               | functionality the change |
|                   |     change-management | impacts (e.g.,           |
|                   |     decisions are     | functionality that deals |
|                   |     recorded.         | with encryption or       |
|                   |                       | authentication           |
|                   | -   All implemented   | processes), the type of  |
|                   |     changes are       | information assets that  |
|                   |     authorized by     | the functionality can    |
|                   |     responsible       | access or manipulate,    |
|                   |     personnel.        | the likelihood of        |
|                   |                       | successful vulnerability |
|                   | -   The inventory of  | exploitation, and the    |
|                   |     changes           | impact a successful      |
|                   |     identifies the    | attack may have on       |
|                   |     individual        | stakeholders.            |
|                   |     creator of the    |                          |
|                   |     code and          |                          |
|                   |     individual        |                          |
|                   |     authorizing the   |                          |
|                   |     change, for each  |                          |
|                   |     code change.      |                          |
|                   |                       |                          |
|                   | -   All decisions to  |                          |
|                   |     implement changes |                          |
|                   |     are justified.    |                          |
+-------------------+-----------------------+--------------------------+
|                   | **D.3.1.1.b** For a   |                          |
|                   | sample of changes,    |                          |
|                   | examine               |                          |
|                   | software-specific and |                          |
|                   | change-specific       |                          |
|                   | documentation or      |                          |
|                   | evidence to confirm   |                          |
|                   | the following:        |                          |
|                   |                       |                          |
|                   | -   All changes are   |                          |
|                   |     authorized by     |                          |
|                   |     responsible       |                          |
|                   |     personnel.        |                          |
|                   |                       |                          |
|                   | -   All decisions to  |                          |
|                   |     implement the     |                          |
|                   |     changes are       |                          |
|                   |     recorded and      |                          |
|                   |     include           |                          |
|                   |     justification for |                          |
|                   |     the change.       |                          |
|                   |                       |                          |
|                   | -   The inventory of  |                          |
|                   |     changes clearly   |                          |
|                   |     identifies the    |                          |
|                   |     individual        |                          |
|                   |     creator of the    |                          |
|                   |     code and the      |                          |
|                   |     individual        |                          |
|                   |     authorizing the   |                          |
|                   |     change, for each  |                          |
|                   |     code change.      |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.3.1.2** All | **D.3.1.2.a** Examine | Without a thoroughly     |
| > software        | vendor evidence and   | defined versioning       |
| > versions are    | interview personnel   | methodology, changes to  |
| > uniquely        | to confirm the        | software may not be      |
| > identified and  | following:            | properly identified, and |
| > tracked         |                       | customers and            |
| > throughout the  | -   A formal system   | integrators/resellers    |
| > software        |     or methodology    | may not understand the   |
| > lifecycle.      |     for uniquely      | impact of such changes.  |
|                   |     identifying each  |                          |
|                   |     version of        | The system or            |
|                   |     software is       | methodology adopted by   |
|                   |     defined.          | the vendor should allow  |
|                   |                       | different release        |
|                   | -   The system or     | versions of a software   |
|                   |     methodology       | product to be easily     |
|                   |     includes          | distinguishable. To      |
|                   |     arranging unique  | ensure a software        |
|                   |     identifiers or    | version accurately       |
|                   |     version elements  | represents the release   |
|                   |     in a sequential   | version, the versioning  |
|                   |     and logical way.  | system or methodology    |
|                   |                       | should be integrated     |
|                   | -   All changes to    | with applicable          |
|                   |     software          | lifecycle functions,     |
|                   |     functionality are | such as code control and |
|                   |     clearly           | change management.       |
|                   |     associated with a |                          |
|                   |     unique software   | The versioning system or |
|                   |     version.          | methodology should       |
|                   |                       | encompass all changes to |
|                   |                       | all relevant software    |
|                   |                       | components. As several   |
|                   |                       | iterations of a software |
|                   |                       | component may be         |
|                   |                       | produced for a single    |
|                   |                       | software release, the    |
|                   |                       | versioning system or     |
|                   |                       | methodology should       |
|                   |                       | easily identify the      |
|                   |                       | version of each          |
|                   |                       | component associated     |
|                   |                       | with a specific software |
|                   |                       | release version.         |
|                   |                       |                          |
|                   |                       | The method used for      |
|                   |                       | identifying the software |
|                   |                       | release versions---e.g., |
|                   |                       | a version numbering      |
|                   |                       | scheme---should be       |
|                   |                       | documented and reflect   |
|                   |                       | the type of change and   |
|                   |                       | its impact on the        |
|                   |                       | software.                |
+-------------------+-----------------------+--------------------------+
|                   | **D.3.1.2.b** For a   |                          |
|                   | sample of software    |                          |
|                   | updates, examine      |                          |
|                   | vendor evidence,      |                          |
|                   | including             |                          |
|                   | change-specific       |                          |
|                   | documentation, to     |                          |
|                   | confirm the           |                          |
|                   | following:            |                          |
|                   |                       |                          |
|                   | -   Software versions |                          |
|                   |     are updated in    |                          |
|                   |     accordance with   |                          |
|                   |     the defined       |                          |
|                   |     versioning system |                          |
|                   |     or methodology.   |                          |
|                   |                       |                          |
|                   | -   All changes to    |                          |
|                   |     software          |                          |
|                   |     functionality are |                          |
|                   |     clearly           |                          |
|                   |     associated with a |                          |
|                   |     unique software   |                          |
|                   |     version.          |                          |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.3.2**       |                       |                          |
| > Software        |                       |                          |
| > integrity       |                       |                          |
| > Protection      |                       |                          |
| >                 |                       |                          |
| > The integrity   |                       |                          |
| > of software is  |                       |                          |
| > protected       |                       |                          |
| > throughout the  |                       |                          |
| > software        |                       |                          |
| > lifecycle.      |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **D.3.2.1** The | **D.3.2.1.a** Examine | Effective software-code  |
| > integrity of    | evidence, interview   | control practices help   |
| > all software    | personnel, and        | ensure that all changes  |
| > code, including | observe tools and     | to code are authorized   |
| > third-party     | processes to confirm: | and performed only by    |
| > components, is  |                       | those with a legitimate  |
| > maintained      | -   A mature process, | reason to change the     |
| > throughout the  |     mechanism, and/or | code.                    |
| > entire software |     tool(s) exist to  |                          |
| > lifecycle.      |     protect the       | Examples of these        |
|                   |     integrity of the  | practices include code   |
|                   |     software code,    | check-in and check-out   |
|                   |     including         | procedures with strict   |
|                   |     third-party       | access controls, and a   |
|                   |     components.       | comparison---e.g., using |
|                   |                       | a checksum---immediately |
|                   | -   The processes,    | before updating code to  |
|                   |     mechanisms,       | confirm that the last    |
|                   |     and/or tools are  | approved version has not |
|                   |     reasonable and    | been changed. It is      |
|                   |     appropriate for   | important that controls  |
|                   |     protecting the    | cover all software code, |
|                   |     integrity of      | third-party components   |
|                   |     software code.    | and libraries,           |
|                   |                       | configuration files,     |
|                   | -   Processes,        | etc. that are controlled |
|                   |     mechanisms, or    | by the vendor.           |
|                   |     the use of tools  |                          |
|                   |     results in the    | The integrity and        |
|                   |     timely detection  | confidentiality of these |
|                   |     of any            | assets must be           |
|                   |     unauthorized      | maintained, as they      |
|                   |     attempts to       | often contain sensitive  |
|                   |     tamper with or    | assets such as           |
|                   |     access software   | intellectual property    |
|                   |     code.             | (e.g., business logic),  |
|                   |                       | logic of security        |
|                   | -   Unauthorized      | functions, configuration |
|                   |     attempts to       | of cryptographic         |
|                   |     tamper with or    | functions (e.g.,         |
|                   |     access software   | software-protected       |
|                   |     code are          | cryptography), etc.      |
|                   |     investigated in a |                          |
|                   |     timely manner.    |                          |
+-------------------+-----------------------+--------------------------+
| > **D.3.2.2**     | **D.3.2.2.a** Examine | Effective software-code  |
| > Software        | vendor evidence,      | control practices help   |
| > releases and    | interview personnel,  | ensure that all changes  |
| > updates are     | and observe tools and | to code are authorized   |
| > delivered in a  | processes to confirm  | and performed only by    |
| > secure way that | the following:        | those with a legitimate  |
| > ensures the     |                       | reason to change the     |
| > integrity of    | -   A mature process, | code.                    |
| > the update      |     mechanism, and/or |                          |
| > code.           |     tool(s) exist to  | Examples of these        |
|                   |     ensure the        | practices include code   |
|                   |     integrity of      | check-in and check-out   |
|                   |     software updates  | procedures with strict   |
|                   |     during delivery.  | access controls, and a   |
|                   |                       | comparison---e.g., using |
|                   | -   The processes,    | a checksum---immediately |
|                   |     mechanisms,       | before updating code to  |
|                   |     and/or tools are  | confirm that the last    |
|                   |     reasonable and    | approved version has not |
|                   |     appropriate for   | been changed. It is      |
|                   |     protecting the    | important that controls  |
|                   |     update code.      | cover all software code, |
|                   |                       | third-party components   |
|                   | -   Processes,        | and libraries,           |
|                   |     mechanisms,       | configuration files,     |
|                   |     and/or the use of | etc. that are controlled |
|                   |     tools results in  | by the vendor.           |
|                   |     the secure        |                          |
|                   |     delivery of       | The integrity and        |
|                   |     update code.      | confidentiality of these |
|                   |                       | assets must be           |
|                   |                       | maintained, as they      |
|                   |                       | often contain sensitive  |
|                   |                       | assets such as           |
|                   |                       | intellectual property    |
|                   |                       | (e.g., business logic),  |
|                   |                       | logic of security        |
|                   |                       | functions, configuration |
|                   |                       | of cryptographic         |
|                   |                       | functions (e.g.,         |
|                   |                       | software-protected       |
|                   |                       | cryptography), etc.      |
+-------------------+-----------------------+--------------------------+

+-------------------+-----------------------+--------------------------+
| > **Security      | > **Test              | > **Guidance**           |
| > Requirements**  | > Requirements**      |                          |
+===================+=======================+==========================+
| > **D.3.3**       |                       |                          |
| > Sensitive Data  |                       |                          |
| > Protection      |                       |                          |
| >                 |                       |                          |
| > The             |                       |                          |
| > confidentiality |                       |                          |
| > of sensitive    |                       |                          |
| > production data |                       |                          |
| > is maintained   |                       |                          |
| > on vendor       |                       |                          |
| > systems.        |                       |                          |
+-------------------+-----------------------+--------------------------+
| > **D.3.3.1**     | **D.3.3.1.a** Examine | To protect the           |
| > Sensitive       | vendor evidence and   | confidentiality of any   |
| > production data | interview personnel   | sensitive production     |
| > is only         | to confirm the        | data---that is,          |
| > collected and   | following:            | sensitive assets that is |
| > retained on     |                       | owned by and entity      |
| > vendor systems  | -   A mature process  | other than the vendor--- |
| > where there is  |     exists to record  | and stored on vendor     |
| > a legitimate    |     and authorize the | systems, such data       |
| > business or     |     collection and    | should never be used for |
| > technical need. |     retention of any  | purposes other than      |
|                   |     sensitive         | those for which the data |
|                   |     production data.  | was originally           |
|                   |                       | collected. If the vendor |
|                   | -   An inventory of   | provides services to its |
|                   |     sensitive         | customers that could     |
|                   |     production data   | result in the collection |
|                   |     captured or       | of sensitive production  |
|                   |     stored by the     | data (e.g., for          |
|                   |     vendor's products | troubleshooting or       |
|                   |     and services is   | debugging purposes), the |
|                   |     maintained.       | vendor should record     |
|                   |                       | those specific data      |
|                   | -   Decisions to use  | elements it collects and |
|                   |     sensitive         | retains, and clearly     |
|                   |     production data   | communicate what data    |
|                   |     are approved by   | elements are collected   |
|                   |     appropriate       | and why they are         |
|                   |     vendor personnel. | collected to its         |
|                   |                       | customers and other      |
|                   | -   Decisions to use  | relevant stakeholders.   |
|                   |     sensitive         |                          |
|                   |     production data   | The inventory of         |
|                   |     are recorded and  | sensitive production     |
|                   |     reasonably        | data retained by the     |
|                   |     justified.        | vendor should include    |
|                   |                       | identification of the    |
|                   |                       | specific data elements   |
|                   |                       | captured, whether        |
|                   |                       | storage of each element  |
|                   |                       | is permitted, and the    |
|                   |                       | security controls        |
|                   |                       | required---e.g., to      |
|                   |                       | protect confidentiality  |
|                   |                       | and/or integrity---for   |
|                   |                       | each data element during |
|                   |                       | storage and              |
|                   |                       | transmission.            |
+-------------------+-----------------------+--------------------------+
| > **D.3.3.2**     | **D.3.3.2.a** Examine | When vendors collect     |
| > Sensitive       | vendor evidence and   | sensitive production     |
| > production data | interview personnel   | data from their          |
| > is protected    | to confirm that a     | customers---e.g., for    |
| > when retained   | mature process exists | debugging or other       |
| > on vendor       | to ensure sensitive   | customer support         |
| > systems and     | production data is    | purposes---the vendor    |
| > securely        | protected when        | should coordinate with   |
| > deleted when no | retained on vendor    | its stakeholders to      |
| > longer needed.  | systems and is        | identify which data      |
|                   | securely deleted when | elements require         |
|                   | no longer needed.     | protection. Vendor       |
|                   |                       | stakeholders may have    |
|                   |                       | their own definition and |
|                   |                       | associated security      |
|                   |                       | requirements for         |
|                   |                       | sensitive assets, and    |
|                   |                       | appropriate protection   |
|                   |                       | efforts should be agreed |
|                   |                       | upon by both parties.    |
|                   |                       |                          |
|                   |                       | When the vendor collects |
|                   |                       | or retains sensitive     |
|                   |                       | production data, the     |
|                   |                       | vendor should ensure it  |
|                   |                       | is secured---e.g., by    |
|                   |                       | using robust access      |
|                   |                       | control measures and/or  |
|                   |                       | strong cryptography with |
|                   |                       | industry-accepted        |
|                   |                       | key-management           |
|                   |                       | processes. As soon as it |
|                   |                       | is no longer needed for  |
|                   |                       | its collected purpose,   |
|                   |                       | sensitive production     |
|                   |                       | data should be securely  |
|                   |                       | deleted such that it is  |
|                   |                       | not possible to          |
|                   |                       | reconstruct or recover   |
|                   |                       | the data from any vendor |
|                   |                       | system.                  |
+-------------------+-----------------------+--------------------------+
|                   | **D.3.3.2.b** Examine |                          |
|                   | vendor evidence and   |                          |
|                   | observe a sample of   |                          |
|                   | vendor systems to     |                          |
|                   | confirm the           |                          |
|                   | following:            |                          |
|                   |                       |                          |
|                   | -   Sensitive         |                          |
|                   |     production data   |                          |
|                   |     is not resident   |                          |
|                   |     on vendor systems |                          |
|                   |     unless            |                          |
|                   |     appropriate       |                          |
|                   |     evidence of       |                          |
|                   |     approval and      |                          |
|                   |     justification     |                          |
|                   |     exists.           |                          |
|                   |                       |                          |
|                   | -   Sensitive         |                          |
|                   |     production data   |                          |
|                   |     is appropriately  |                          |
|                   |     protected where   |                          |
|                   |     it is retained.   |                          |
|                   |                       |                          |
|                   | -   Secure deletion   |                          |
|                   |     processes or      |                          |
|                   |     mechanisms are    |                          |
|                   |     sufficient to     |                          |
|                   |     render sensitive  |                          |
|                   |     production data   |                          |
|                   |     irretrievable.    |                          |
+-------------------+-----------------------+--------------------------+

## Security Communications

> The vendor provides timely information to its stakeholders (e.g.,
> customers, installers, integrators, etc.) regarding security issues
> affecting its software, and thorough guidance on secure software
> implementation, configuration, operation, and updates.

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.4.1** Vendor |                      |                          |
| > Implementation   |                      |                          |
| > Guidance         |                      |                          |
| >                  |                      |                          |
| > Stakeholders are |                      |                          |
| > provided with    |                      |                          |
| > clear and        |                      |                          |
| > thorough         |                      |                          |
| > guidance on the  |                      |                          |
| > secure           |                      |                          |
| > implementation,  |                      |                          |
| > configuration,   |                      |                          |
| > and operation of |                      |                          |
| > its software.    |                      |                          |
+--------------------+----------------------+--------------------------+
| > **D.4.1.1** The  | **D.4.1.1.a**        | When followed, the       |
| > vendor provides  | Examine vendor       | vendor\'s implementation |
| > stakeholders     | evidence and         | guidance provides        |
| > with clear and   | interview personnel  | assurance that the       |
| > thorough         | to confirm the       | software and patches are |
| > guidance on the  | following:           | securely installed,      |
| > secure           |                      | configured, and          |
| > implementation,  | -   A mature process | maintained in the        |
| > configuration,   |     exists to        | customer environment,    |
| > and operation of |     produce,         | and that all desired     |
| > its software.    |     maintain, and    | security functionality   |
|                    |     make available   | is active and working as |
|                    |     to stakeholders' | intended. The guidance   |
|                    |     guidance on the  | should cover all options |
|                    |     secure           | and functionality        |
|                    |     implementation,  | available to software    |
|                    |     configuration,   | users that could affect  |
|                    |     and operation of | the security of the      |
|                    |     its software.    | software or the data it  |
|                    |                      | interacts with. The      |
|                    | -   The              | guidance should also     |
|                    |     implementation   | include secure           |
|                    |     guidance         | configuration options    |
|                    |     includes         | for any components       |
|                    |     documentation of | provided with or         |
|                    |     all configurable | supported by the         |
|                    |     security-        | software, such as        |
|                    |     related options  | external software and    |
|                    |     and parameters   | underlying platforms.    |
|                    |     for the vendor's |                          |
|                    |     software, and    | Examples of configurable |
|                    |     instructions for | options include:         |
|                    |     properly         |                          |
|                    |     configuring and  | -   Changing default     |
|                    |     securing each of |     credentials and      |
|                    |     those options    |     passwords.           |
|                    |     and parameters.  |                          |
|                    |                      | -   Enabling and         |
|                    |                      |     disabling            |
|                    |                      |     application          |
|                    |                      |     accounts, services,  |
|                    |                      |     and features.        |
|                    |                      |                          |
|                    |                      | -   Changes in resource  |
|                    |                      |     access permissions.  |
|                    |                      |                          |
|                    |                      | -   Integration with     |
|                    |                      |     third-party          |
|                    |                      |     cryptographic        |
|                    |                      |     libraries, RNGs,     |
|                    |                      |     etc.                 |
|                    |                      |                          |
|                    |                      | Following the secure     |
|                    |                      | implementation guidance  |
|                    |                      | should result in a       |
|                    |                      | secure configuration     |
|                    |                      | across all configurable  |
|                    |                      | options.                 |
+--------------------+----------------------+--------------------------+
|                    | **D.4.1.1.b** For a  |                          |
|                    | sample of vendor     |                          |
|                    | software, examine    |                          |
|                    | software-specific    |                          |
|                    | documentation and    |                          |
|                    | materials to confirm |                          |
|                    | that the vendor      |                          |
|                    | provides and         |                          |
|                    | maintains guidance   |                          |
|                    | on the secure        |                          |
|                    | configuration of     |                          |
|                    | each                 |                          |
|                    | security-related     |                          |
|                    | option or parameter  |                          |
|                    | available in the     |                          |
|                    | vendor's software.   |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.4.1.2**      | **D.4.1.2.a**        | As the vendor is         |
| > Secure           | Examine vendor       | expected to continuously |
| > implementation   | evidence to confirm  | identify, assess, and    |
| > guidance         | the following:       | manage risks to its      |
| > includes         |                      | software, the vendor's   |
| > detailed         | -   The secure       | software-change          |
| > instructions     |     implementation   | processes should include |
| > about how to     |     guidance         | determining the impact   |
| > securely         |     includes         | of the change to vendor  |
| > install,         |     instructions     | guidance. Software       |
| > configure, and   |     about how to     | changes that impact a    |
| > maintain all     |     securely install | configurable feature or  |
| > software         |     or initialize,   | option should result in  |
| > components and   |     configure, and   | an update to the secure  |
| > supported        |     maintain the     | implementation guidance. |
| > platforms.       |     software.        |                          |
|                    |                      |                          |
|                    | -   The secure       |                          |
|                    |     implementation   |                          |
|                    |     guidance is      |                          |
|                    |     sufficiently     |                          |
|                    |     detailed.        |                          |
|                    |                      |                          |
|                    | -   Evidence exists  |                          |
|                    |     or is obtained   |                          |
|                    |     to show that     |                          |
|                    |     following the    |                          |
|                    |     secure           |                          |
|                    |     implementation   |                          |
|                    |     guidance results |                          |
|                    |     in a secure      |                          |
|                    |     software         |                          |
|                    |     configuration.   |                          |
+--------------------+----------------------+--------------------------+
| > **D.4.1.3**      | **D.4.1.3.a**        |                          |
| > Secure           | Examine vendor       |                          |
| > implementation   | evidence and         |                          |
| > guidance is      | interview personnel  |                          |
| > aligned with     | to confirm the       |                          |
| > software         | following:           |                          |
| > updates.         |                      |                          |
|                    | -   The process to   |                          |
|                    |     produce and      |                          |
|                    |     maintain secure  |                          |
|                    |     implementation   |                          |
|                    |     guidance         |                          |
|                    |     includes         |                          |
|                    |     generation of    |                          |
|                    |     updated guidance |                          |
|                    |     when new         |                          |
|                    |     software updates |                          |
|                    |     are released, or |                          |
|                    |     security-related |                          |
|                    |     options or       |                          |
|                    |     parameters are   |                          |
|                    |     introduced or    |                          |
|                    |     modified.        |                          |
|                    |                      |                          |
|                    | -   Secure           |                          |
|                    |     implementation   |                          |
|                    |     guidance is      |                          |
|                    |     reviewed at      |                          |
|                    |     least annually   |                          |
|                    |     for accuracy     |                          |
|                    |     even if updates  |                          |
|                    |     to               |                          |
|                    |     security-related |                          |
|                    |     options and      |                          |
|                    |     parameters are   |                          |
|                    |     not issued.      |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.4.1.3.b** For a  |                          |
|                    | sample of software   |                          |
|                    | updates, examine     |                          |
|                    | secure               |                          |
|                    | implementation       |                          |
|                    | guidance as well as  |                          |
|                    | details of the       |                          |
|                    | software updates to  |                          |
|                    | confirm that as      |                          |
|                    | security-related     |                          |
|                    | options and          |                          |
|                    | parameters are       |                          |
|                    | updated or added,    |                          |
|                    | the secure           |                          |
|                    | implementation       |                          |
|                    | guidance is updated. |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **D.4.2**        |                      |                          |
| > Stakeholder      |                      |                          |
| > Communications   |                      |                          |
| >                  |                      |                          |
| > Communication    |                      |                          |
| > channels are     |                      |                          |
| > maintained with  |                      |                          |
| > stakeholders     |                      |                          |
| > regarding        |                      |                          |
| > potential        |                      |                          |
| > security issues  |                      |                          |
| > and mitigation   |                      |                          |
| > options.         |                      |                          |
+--------------------+----------------------+--------------------------+
| > **D.4.2.1**      | **D.4.2.1.a**        | Vendors should monitor   |
| > Communication    | Examine evidence and | the threat landscape to  |
| > channels are     | interview personnel  | identify new             |
| > defined and made | to confirm the       | vulnerabilities and      |
| > available for    | following:           | security issues that     |
| > customers,       |                      | impact their software on |
| > installers,      | -   A mature process | the market. Vendors      |
| > integrators, and |     exists to        | should also provide open |
| > other relevant   |     support open,    | lines of communication   |
| > parties to       |     bi- directional  | to enable researchers or |
| > report and       |     communications   | other stakeholders to    |
| > receive          |     with             | report newly discovered  |
| > information on   |     stakeholders for | vulnerabilities in the   |
| > security issues  |     reporting and    | vendor's products and    |
| > and mitigation   |     receiving        | services.                |
| > options.         |     security         |                          |
|                    |     information      | Communication channels   |
|                    |     regarding the    | could include a publicly |
|                    |     vendor's         | disclosed e-mail         |
|                    |     products and     | address, website page.   |
|                    |     services.        | or other method to       |
|                    |                      | facilitate interactions  |
|                    | -   Communication    | with external            |
|                    |     channels provide | researchers---e.g.,      |
|                    |     stakeholders the | through a formal bug     |
|                    |     ability to       | bounty program. The      |
|                    |     report security- | vendor should also       |
|                    |     related issues   | maintain teams to        |
|                    |     and to receive   | respond to such reports  |
|                    |     timely status    | and drive processes to   |
|                    |     updates on their | fix vulnerabilities in   |
|                    |     queries.         | the vendor's software.   |
|                    |                      |                          |
|                    | -   The vendor       | In addition to           |
|                    |     maintains        | supporting the receipt   |
|                    |     resources to     | of information about     |
|                    |     respond to       | vulnerabilities within   |
|                    |     reports or       | its software products,   |
|                    |     inquiries        | the vendor should also   |
|                    |     regarding the    | issue communications to  |
|                    |     security of the  | customers, installers,   |
|                    |     vendor's         | and integrators to       |
|                    |     products and     | provide information      |
|                    |     services.        | about known              |
|                    |                      | vulnerabilities and when |
|                    |                      | fixes will be available. |
|                    |                      | Fixes/patches should be  |
|                    |                      | developed and released   |
|                    |                      | in a timely manner,      |
|                    |                      | based on criticality and |
|                    |                      | in accordance with       |
|                    |                      | D.2.2.2.                 |
|                    |                      |                          |
|                    |                      | Vendor security          |
|                    |                      | notifications should     |
|                    |                      | include the criticality  |
|                    |                      | and potential impact of  |
|                    |                      | the vulnerability, as    |
|                    |                      | well as clear guidance   |
|                    |                      | for addressing the       |
|                    |                      | vulnerability (e.g., how |
|                    |                      | to install a patch or    |
|                    |                      | software update). When a |
|                    |                      | fix is not readily       |
|                    |                      | available, the vendor    |
|                    |                      | should communicate the   |
|                    |                      | risk and provide         |
|                    |                      | guidance on mitigation   |
|                    |                      | options.                 |
|                    |                      |                          |
|                    |                      | *(continued on next      |
|                    |                      | page)*                   |
+--------------------+----------------------+--------------------------+
| > **D.4.2.2**      | **D.4.2.2.a**        |                          |
| > Stakeholders are | Examine evidence and |                          |
| > notified about   | interview personnel  |                          |
| > security updates | to confirm a mature  |                          |
| > in a timely      | process exists to    |                          |
| > manner.          | notify stakeholders  |                          |
|                    | about security       |                          |
|                    | updates in a timely  |                          |
|                    | manner.              |                          |
+--------------------+----------------------+--------------------------+
| > **D.4.2.3** When | **D.4.2.3.a**        |                          |
| > security updates | Examine evidence and |                          |
| > are not readily  | interview personnel  |                          |
| > available to     | to confirm that      |                          |
| > address known    | processes include    |                          |
| > vulnerabilities  | providing            |                          |
| > or exploits,     | stakeholders with    |                          |
| > security         | instructions for     |                          |
| > notifications    | mitigating the       |                          |
| > are issued to    | threat or reducing   |                          |
| > all relevant     | the likelihood       |                          |
| > stakeholders to  | and/or impact of     |                          |
| > provide          | exploitation of      |                          |
| > instructions for | known security       |                          |
| > mitigating the   | issues for which a   |                          |
| > risks associated | timely patch is not  |                          |
| > with the known   | provided.            |                          |
| > vulnerabilities  |                      |                          |
| > and exploits.    |                      |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.4.2.3.b** For a  |                          |
|                    | sample of software   |                          |
|                    | security updates,    |                          |
|                    | examine stakeholder  |                          |
|                    | communications,      |                          |
|                    | product-specific     |                          |
|                    | documentation,       |                          |
|                    | security-testing     |                          |
|                    | results, and other   |                          |
|                    | materials to confirm |                          |
|                    | that where known     |                          |
|                    | vulnerabilities are  |                          |
|                    | not addressed in the |                          |
|                    | security updates,    |                          |
|                    | risk mitigation      |                          |
|                    | instructions are     |                          |
|                    | provided to          |                          |
|                    | stakeholders.        |                          |
+--------------------+----------------------+--------------------------+

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
|                    |                      | Vendor-initiated         |
|                    |                      | communications could     |
|                    |                      | include e-mail           |
|                    |                      | notifications, website   |
|                    |                      | alerts, written notices, |
|                    |                      | social media posts, and  |
|                    |                      | any other channels the   |
|                    |                      | vendor maintains for     |
|                    |                      | stakeholder engagement.  |
|                    |                      | Communication channels   |
|                    |                      | should be publicized so  |
|                    |                      | that stakeholders know   |
|                    |                      | how to access them       |
|                    |                      | (e.g., by signing up for |
|                    |                      | e-mail notifications).   |
|                    |                      | Vendor contact           |
|                    |                      | information should also  |
|                    |                      | be provided for          |
|                    |                      | stakeholders to submit   |
|                    |                      | further questions        |
|                    |                      | regarding security       |
|                    |                      | notifications.           |
+--------------------+----------------------+--------------------------+
| > **D.4.3**        |                      |                          |
| > Software Update  |                      |                          |
| > Information      |                      |                          |
| >                  |                      |                          |
| > Stakeholders are |                      |                          |
| > provided with    |                      |                          |
| > detailed         |                      |                          |
| > explanations of  |                      |                          |
| > all software     |                      |                          |
| > changes.         |                      |                          |
+--------------------+----------------------+--------------------------+
| > **D.4.3.1** Upon | **D.4.3.1.a**        | Release notes should be  |
| > release of any   | Examine evidence and | provided for all         |
| > software         | interview personnel  | software updates,        |
| > updates, a       | to confirm the       | including details of any |
| > summary of the   | following:           | impact on software       |
| > specific changes |                      | functionality and        |
| > made to the      | -   A mature process | security controls.       |
| > software is      |     exists to        | Informing stakeholders   |
| > provided to      |     communicate all  | of the impact of a       |
| > stakeholders.    |     software changes | software update enables  |
|                    |     to stakeholders  | them to make informed    |
|                    |     upon software    | decisions on whether and |
|                    |     updates.         | when to implement it.    |
|                    |                      |                          |
|                    | -   The process      |                          |
|                    |     results in a     |                          |
|                    |     clear and        |                          |
|                    |     detailed summary |                          |
|                    |     of all software  |                          |
|                    |     changes.         |                          |
|                    |                      |                          |
|                    | -   The change       |                          |
|                    |     summary          |                          |
|                    |     information      |                          |
|                    |     clearly outlines |                          |
|                    |     the specific     |                          |
|                    |     software         |                          |
|                    |     functionality    |                          |
|                    |     impacted by the  |                          |
|                    |     changes.         |                          |
|                    |                      |                          |
|                    | -   Change details   |                          |
|                    |     are easily       |                          |
|                    |     accessible to    |                          |
|                    |     stakeholders.    |                          |
+--------------------+----------------------+--------------------------+
|                    | **D.4.3.1.b** For a  |                          |
|                    | sample of software   |                          |
|                    | updates, examine     |                          |
|                    | publicly available   |                          |
|                    | information or       |                          |
|                    | notifications        |                          |
|                    | regarding the        |                          |
|                    | software updates to  |                          |
|                    | confirm the          |                          |
|                    | following:           |                          |
|                    |                      |                          |
|                    | -   Change summary   |                          |
|                    |     information is   |                          |
|                    |     made available   |                          |
|                    |     to stakeholders. |                          |
|                    |                      |                          |
|                    | -   Change summary   |                          |
|                    |     information      |                          |
|                    |     accurately       |                          |
|                    |     reflects the     |                          |
|                    |     changes made to  |                          |
|                    |     the software.    |                          |
+--------------------+----------------------+--------------------------+

# Appendix E MSR Security Requirements

> This appendix provides the security requirements for any non-PTS
> approved MSR devices used with an MPoC Solution. The security and
> testing requirements described in this appendix provide a framework
> for protecting the confidentiality and integrity of account data
> captured using a non-PTS approved MSR, used in combination with the
> existing elements of an overall MPoC Solution. Adding optional support
> to process magnetic stripe transactions with a magnetic stripe only
> reader allows merchants to use a single solution to accept payments,
> where magnetic stripe acceptance is desired but the PCI PTS SCRP
> device used with the MPoC Solution does not support MSR functionality.
>
> Only requirements for the non-PTS approved MSR device itself are
> covered in this Appendix. Requirements for the integration and use of
> a non-PTS approved MSR device within an overall MPoC Solution are
> covered within the MPoC requirements listed in the body of this
> document.

## MSR Validation and Testing Requirements

> Magnetic stripe data input to an MPoC Solution must be read by an
> approved device. This device may be a PCI PTS SCRP, tested and
> approved through the PCI PTS POI program, or a non-PTS approved MSR
> tested according to the requirements in this appendix. Regardless of
> validation, magnetic stripe-based transactions may not be used by an
> MPoC Solution with PIN acceptance.
>
> Many of the testing requirements in this appendix are based on, and
> reference, the PCI PTS POI v6.x Derived Test Requirements document.
> However, this appendix references only a subset of the requirements
> that would be tested against a PCI PTS SCRP device and exclude all
> physical security testing requirements. When the PCI PTS POI testing
> requirements require testing for data or implementations that are not
> provided by the MSR device -- such as PIN acceptance and processing,
> or physical security -- these requirements are not to be assessed.

## Account Data Input

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.1.1** A      | **E.1.1.a** The      | Support for non-PTS      |
| > non-PTS approved | tester must confirm  | approved MSR devices is  |
| > MSR device must  | through examination  | provided to accommodate  |
| > only provide for | and observation that | magnetic stripe cards.   |
| > the acceptance   | the non-PTS approved | Acceptance of any other  |
| > of account data  | MSR does not provide | account data presentment |
| > through a        | any other methods    | method, such as manual   |
| > magnetic         | for account data     | entry, contact or        |
| > readhead         | acceptance other     | contactless chip, may    |
| > interface.       | than through a       | not be implemented in a  |
|                    | magnetic readhead    | non-PTS approved MSR     |
|                    | interface.           | device.                  |
+--------------------+----------------------+--------------------------+

## No Account Data Storage

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.2.1** A      | **E.2.1.a** The      | Account data should be   |
| > non-PTS approved | tester must confirm  | transferred from the     |
| > MSR device must  | through examination  | non-PTS approved MSR     |
| > not store        | and observation that | device to the MPoC       |
| > account data.    | the non-PTS approved | Software as soon as      |
|                    | MSR does not store   | practicable. Although    |
|                    | account data. It     | there may be some delay  |
|                    | must not be possible | between the read of the  |
|                    | for more than one    | data and the transfer of |
|                    | set of magnetic      | the data to the MPoC     |
|                    | stripe data to be    | Software, there can be   |
|                    | present within the   | only one set of data     |
|                    | memory of the        | within the non-PTS       |
|                    | non-PTS approved MSR | approved MSR device at   |
|                    | device at any one    | any one time.            |
|                    | time.                |                          |
+--------------------+----------------------+--------------------------+

## Account Data Processing

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.3.1** All    | **E.3.1.a** The      | Account data should be   |
| > account data is  | tester must evaluate | transferred from the     |
| > either encrypted | the non-PTS approved | non-PTS approved MSR     |
| > immediately upon | MSR to PCI PTS POI   | device to the MPoC       |
| > entry or entered | v6.x DTR A11 and     | Software as soon as      |
| > in cleartext     | confirm compliance   | practicable. Although    |
| > into a secure    | to all applicable    | there may be some delay  |
| > device and       | requirements.        | between the read of the  |
| > processed within |                      | data and the transfer of |
| > the secure       |                      | the data to the MPoC     |
| > controller of    |                      | Software, there can be   |
| > the device.      |                      | only one set of data     |
|                    |                      | within the non-PTS       |
|                    |                      | approved MSR device at   |
|                    |                      | any one time.            |
+--------------------+----------------------+--------------------------+

## Firmware Updates

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.4.1** Where  | **E.4.1.a** The      | Support for network      |
| > the device       | tester must evaluate | connections, or          |
| > implements       | the non-PTS approved | network-based updates,   |
| > firmware, the    | MSR to PCI PTS POI   | is not required.         |
| > device must      | v6.x DTR B2 and      | However, where such      |
| > support firmware | confirm compliance   | updates are supported,   |
| > updates. The     | to all applicable    | then a declared security |
| > device must      | requirements.        | protocol is required.    |
| >                  |                      | This security protocol   |
|  cryptographically |                      | is tested under the      |
| > authenticate the |                      | requirements of the      |
| > firmware and if  |                      | "Communication and       |
| > the authenticity |                      | Interfaces" section (PCI |
| > is not           |                      | PTS POI v6.x Module 3).  |
| > confirmed, the   |                      |                          |
| > firmware update  |                      |                          |
| > is rejected and  |                      |                          |
| > deleted.         |                      |                          |
| >                  |                      |                          |
| > The update       |                      |                          |
| > mechanism        |                      |                          |
| > ensures security |                      |                          |
| > (i.e.,           |                      |                          |
| > integrity,       |                      |                          |
| > mutual           |                      |                          |
| > authentication,  |                      |                          |
| > and protection   |                      |                          |
| > against replay)  |                      |                          |
| > by using an      |                      |                          |
| > appropriate and  |                      |                          |
| > declared         |                      |                          |
| > security         |                      |                          |
| > protocol when    |                      |                          |
| > using network    |                      |                          |
| > connections.     |                      |                          |
+--------------------+----------------------+--------------------------+

## Protection of Sensitive Services

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.5.1** Access | **E.5.1.a** The      | Although PCI PTS POI     |
| > to sensitive     | tester must evaluate | v6.x B5 includes testing |
| > services         | the non-PTS approved | requirements that cover  |
| > requires         | MSR to PCI PTS POI   | aspects of PIN security, |
| > authentication.  | v6.x DTR B5 and      | a non- PTS approved MSR  |
| > Sensitive        | confirm compliance   | device must not allow    |
| > services provide | to all applicable    | for the entry or         |
| > access to the    | requirements.        | processing of cardholder |
| > underlying       |                      | PINs.                    |
| > sensitive        |                      |                          |
| > functions.       |                      |                          |
| > Sensitive        |                      |                          |
| > functions are    |                      |                          |
| > those functions  |                      |                          |
| > that process     |                      |                          |
| > sensitive assets |                      |                          |
| > such as          |                      |                          |
| > cryptographic    |                      |                          |
| > keys, account    |                      |                          |
| > data, and        |                      |                          |
| > passwo           |                      |                          |
| rds/authentication |                      |                          |
| > codes. Entering  |                      |                          |
| > or exiting       |                      |                          |
| > sensitive        |                      |                          |
| > service shall    |                      |                          |
| > not reveal or    |                      |                          |
| > otherwise affect |                      |                          |
| > sensitive        |                      |                          |
| > assets.          |                      |                          |
+--------------------+----------------------+--------------------------+

## Sensitive Service Limits

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.6.1** To     | **E.6.1.a** The      |                          |
| > minimize the     | tester must evaluate |                          |
| > risks from       | the non-PTS approved |                          |
| > unauthorized use | MSR to PCI PTS POI   |                          |
| > of sensitive     | v6.x DTR B6 and      |                          |
| > services, limits | confirm compliance   |                          |
| > on the number of | to all applicable    |                          |
| > actions that can | requirements.        |                          |
| > be performed and |                      |                          |
| > a time limit     |                      |                          |
| > shall be         |                      |                          |
| > imposed, after   |                      |                          |
| > which the device |                      |                          |
| > is forced to     |                      |                          |
| > return to its    |                      |                          |
| > normal mode.     |                      |                          |
+--------------------+----------------------+--------------------------+

## Key Management

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.7.1** The    | **E.7.1.a** The      | Implementation of key    |
| > key management   | tester must evaluate | blocks is not required   |
| > techniques       | the non-PTS approved | for devices that support |
| > implemented in   | MSR to PCI PTS POI   | only a single encryption |
| > the device       | v6.x DTR B9 and      | key (i.e., for the       |
| > conform to       | confirm compliance   | encryption of account    |
| > ISO11568 and/or  | to all applicable    | data from the magnetic   |
| > ANSI X9.24. When | requirements.        | stripe).                 |
| > multiple         |                      |                          |
| > cryptographic    |                      |                          |
| > keys are         |                      |                          |
| > supported,       |                      |                          |
| > key-management   |                      |                          |
| > techniques must  |                      |                          |
| > support key      |                      |                          |
| > blocks as        |                      |                          |
| > defined in DTR   |                      |                          |
| > B9.              |                      |                          |
+--------------------+----------------------+--------------------------+

## Encryption Mechanism

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.8.1** All    | **E.8.1.a** The      | > Encryption algorithms  |
| > account data     | tester must evaluate | > used to protect        |
| > shall be         | the non-PTS approved | > account data are       |
| > encrypted using  | MSR to PCI PTS POI   | > required to provide at |
| > only ANSI X9 or  | v6.x DTR B10 and     | > least 128 bits of      |
| > ISO-approved     | confirm compliance   | > effective strength.    |
| > encryption       | to all applicable    | > TDEA encryption is not |
| > algorithms       | requirements.        | > permitted to be used   |
| > (e.g., AES) and  |                      | > by a non- PTS approved |
| > should use ANSI  |                      | > MSR device for any     |
| > X9 or            |                      | > security services.     |
| > ISO-approved     |                      | >                        |
| > modes of         |                      | > Use of AES encryption  |
| > operation.       |                      | > for non-PTS approved   |
|                    |                      | > MSR devices is         |
|                    |                      | > recommended.           |
+--------------------+----------------------+--------------------------+
|                    | **E.8.1.b** The      |                          |
|                    | tester must confirm  |                          |
|                    | through examination  |                          |
|                    | and observation that |                          |
|                    | the non-PTS approved |                          |
|                    | MSR uses only        |                          |
|                    | algorithms and key   |                          |
|                    | lengths that provide |                          |
|                    | an effective key     |                          |
|                    | strength of at least |                          |
|                    | 128 bits.            |                          |
+--------------------+----------------------+--------------------------+

## Remote Access

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.9.1** If the | **E.9.1.a** The      | If the device supports   |
| > device can be    | tester must evaluate | remote access,           |
| > accessed         | the non-PTS approved | cryptographic keys used  |
| > remotely for the | MSR to PCI PTS POI   | to secure this access    |
| > purposes of      | v6.x DTR B22 and     | are required to be       |
| > administration,  | confirm compliance   | different from the keys  |
| > all access       | to all applicable    | used for account data    |
| > attempts must be | requirements.        | encryption. This is      |
| >                  |                      | tested under the key     |
|  cryptographically |                      | management requirements. |
| > authenticated.   |                      |                          |
| > If the           |                      |                          |
| > authenticity of  |                      |                          |
| > the access       |                      |                          |
| > request cannot   |                      |                          |
| > be confirmed,    |                      |                          |
| > the access       |                      |                          |
| > request is       |                      |                          |
| > denied.          |                      |                          |
+--------------------+----------------------+--------------------------+

## Output of Cleartext Account Data

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.10.1** There | **E.10.1.a** The     | Although PCI PTS POI     |
| > is no mechanism  | tester must evaluate | v6.x B23 supports the    |
| > in the device    | the non-PTS approved | testing of devices that  |
| > that allows the  | MSR to PCI PTS POI   | provide for a            |
| > outputting of    | v6.x DTR B23 and     | non-encrypting mode,     |
| > cleartext        | confirm compliance   | non-PTS approved MSR     |
| > account data.    | to all applicable    | devices are not          |
|                    | requirements.        | permitted to implement   |
|                    |                      | any mode where account   |
|                    |                      | data is output in        |
|                    |                      | cleartext.               |
+--------------------+----------------------+--------------------------+

## Surrogate PAN Values

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| 1.  If the device  | **E.11.1.a** The     | Support for surrogate    |
|     is capable of  | tester must evaluate | PAN values is not        |
|     generating     | the non-PTS approved | required for non- PTS    |
|     surrogate PAN  | MSR to PCI PTS POI   | approved MSR devices.    |
|     values to be   | v6.x DTR B24 and     |                          |
|     outputted      | confirm compliance   | Non-PTS approved MSRs    |
|     outside of the | to all applicable    | tested against PCI PTS   |
|     device, it is  | requirements.        | POI v6.x B24 are not     |
|     not possible   |                      | required to implement    |
|     to determine   |                      | physical tamper          |
|     the original   |                      | detection, and the       |
|     PAN knowing    |                      | testing requirements     |
|     only the       |                      | that validate physical   |
|     surrogate      |                      | security need not be     |
|     values. When a |                      | assessed.                |
|     hash function  |                      |                          |
|     is used to     |                      |                          |
|     generate       |                      |                          |
|     surrogate PAN  |                      |                          |
|     values:        |                      |                          |
|                    |                      |                          |
|     -   Input to   |                      |                          |
|         the hash   |                      |                          |
|         function   |                      |                          |
|         must use a |                      |                          |
|         salt with  |                      |                          |
|         minimum    |                      |                          |
|         length of  |                      |                          |
|         64 bits.   |                      |                          |
|                    |                      |                          |
|     -   The salt   |                      |                          |
|         is kept    |                      |                          |
|         secret and |                      |                          |
|                    |                      |                          |
|      appropriately |                      |                          |
|         protected. |                      |                          |
+--------------------+----------------------+--------------------------+

## Communications and Interfaces

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.12.1** The   | **E.12.1.a** The     | Only applicable sections |
| > device must      | tester must evaluate | of the Module 3          |
| > provide for      | the non-PTS approved | requirements must be     |
| > secure           | MSR to Module 3 of   | assessed. For example,   |
| > communications   | PCI PTS POI v6.x and | requirements covering    |
| > and interfaces,  | confirm compliance   | the security of IP       |
| > including data   | to all applicable    | protocols need not be    |
| > origin           | requirements.        | assessed against devices |
| > authentication   |                      | that do not provide IP   |
| > of encrypted     |                      | connectivity.            |
| > messages and     |                      |                          |
| > protections      |                      | Regardless of interface  |
| > against logical  |                      | types supported, testing |
| > anomalies.       |                      | of requirements          |
|                    |                      | validating the           |
|                    |                      | implementation of data   |
|                    |                      | origin authentication    |
|                    |                      | are always required to   |
|                    |                      | be assessed.             |
+--------------------+----------------------+--------------------------+

## Lifecycle Security Requirements

+--------------------+----------------------+--------------------------+
| > **Security       | > **Test             | > **Guidance**           |
| > Requirements**   | > Requirements**     |                          |
+====================+======================+==========================+
| > **E.13.1** The   | **E.13.1.a** The     | On-site validation of    |
| > non-PTS approved | tester must evaluate | the processes and        |
| > MSR development, | the non-PTS approved | security controls is not |
| > manufacturing,   | MSR to Module 4 of   | required.                |
| > and distribution | PCI PTS POI v6.x and |                          |
| > processes must   | confirm compliance   |                          |
| > be compliant to  | to all applicable    |                          |
| > the requirements | requirements.        |                          |
| > of PCI PTS POI   |                      |                          |
| > v6.x Module 4.   |                      |                          |
+--------------------+----------------------+--------------------------+

# Appendix F Configuration and Use of the STS Tool

> The NIST STS (Statistical Test Suite) is a reference implementation of
> the statistical tests described in NIST SP 800-22 Revision 1a.
>
> The tester shall use NIST\'s STS tool, version 2.1.2 or later, or its
> mathematical equivalent. The tester shall verify that the compiled
> instance of the STS tool is operating correctly on the testing device
> by testing the NIST-provided sample data and comparing the results
> with those found in NIST SP 800-22 Revision 1a (SP800-22r1a), Appendix
> B. This configuration guidance is for use with STS version 2.1.2,
> though it will likely continue to be applicable to future versions.
>
> The tester should request and obtain a sample of 2^30^ bits from the
> vendor. The tester should exercise care to verify that the
> vendor-supplied data is interpreted correctly by the STS tool (the STS
> tool assumes that binary data is in big-endian formatting on all
> devices).
>
> The STS testing on the data shall be judged as a \"pass\" if it passes
> all of the tests, for both the \"Proportion of Sequences Passing a
> Test\" interpretation approach and \"Uniform Distribution of
> P-Values\" interpretation approach. If the data does not pass all
> tests, and the failure is marginal, the tester should acquire
> additional data from the vendor and repeat the testing, including both
> the initial data and the additional vendor-supplied data.
>
> The STS tool should be configured as per guidance provided in SP
> 800-22 Revision 1a, which is summarized on the next page.
>
> The following settings are consistent with the SP 800-22 Revision 1a
> document:

##### Table 11: Configuration Settings

+---------------+--------+--------------------------------------------+
| > **          | >      | > **Reference in Key Below**               |
| Configuration |  **Set |                                            |
| > Item**      | ting** |                                            |
+===============+========+============================================+
| > Length of   | 1,0    | n must be selected to be consistent with   |
| > bit streams | 00,000 | the requirements of all of the tests to be |
| > (n)         |        | run. The Overlapping Templates, Linear     |
|               |        | Complexity, Random Excursions, and Random  |
|               |        | Excursions Variant tests all require n to  |
|               |        | be greater than or equal to 106 in order   |
|               |        | to produce meaningful results. The         |
|               |        | Discrete Fourier Transform (Spectral) test |
|               |        | requires n to equal 106. (See SP 800-22r1a |
|               |        | Sections 2.8.7, 2.10.7, 2.14.7, 2.15.7,    |
|               |        | and \[NIST 2010\].)                        |
+---------------+--------+--------------------------------------------+
| > Number of   | 1,073  | The number of bit sequences (sample size)  |
| > bit streams |        | must be 1,000 or greater in order for the  |
| > (sample     |        | \"Proportion of Sequences Passing a Test\" |
| > size) (M)   |        | result to be meaningful. (See SP 800-22r1a |
|               |        | Section 4.2.1.) This value will be 1,073   |
|               |        | for the first test, but any additional     |
|               |        | testing (e.g., further testing to resolve  |
|               |        | test failures) will necessarily include    |
|               |        | more bit sequences.                        |
+---------------+--------+--------------------------------------------+
| > Block       | 20,000 | For the Block Frequency test, if n=106,    |
| > Frequency   |        | the test block size should be set between  |
| > block       |        | 104 and 106. (See SP 800-22r1a Section     |
| > length      |        | 2.2.7.)                                    |
+---------------+--------+--------------------------------------------+
| > No          | 9      | The Non-Overlapping test requires          |
| n-Overlapping |        | selection of a template length of 9 or 10  |
| > Templates   |        | in order to produce meaningful results.    |
| > template    |        | (See SP 800-22r1a Sections 2.7.7 and       |
| > length      |        | 2.8.7.) For a template length of 10, the   |
|               |        | MAXNUMOFTEMPLATES constant (in defs.h)     |
|               |        | should be set to at least 284 prior to     |
|               |        | compiling STS, otherwise most 10-bit       |
|               |        | aperiodic templates with a leading 1 bit   |
|               |        | are discarded.                             |
+---------------+--------+--------------------------------------------+
| > Overlapping | 9      | The Overlapping test requires selection of |
| > Template    |        | a template length of 9 or 10 in order to   |
| > length      |        | produce meaningful results. When n=106,    |
|               |        | the template size of 9 comes closest to    |
|               |        | fulfilling the parameter selection         |
|               |        | criteria. (See SP 800-22r1a Section        |
|               |        | 2.8.7.)                                    |
+---------------+--------+--------------------------------------------+
| > Universal   | L=7,   | The Universal test block length (L) and    |
| > block       | Q      | initialization steps (Q) must be           |
| > length (L), | =1,280 | consistent with the table in SP800-22r1a   |
| > number of   |        | Section 2.9.7. For n=106, the only         |
| > i           |        | acceptable values are (L=6, Q=640) and     |
| nitialization |        | (L=7, Q=1280). Note, any parameters passed |
| > steps (Q)   |        | into this test are discarded, and          |
|               |        | reasonable values are internally set. For  |
|               |        | n=106, STS automatically uses the          |
|               |        | parameters recommended here.               |
+---------------+--------+--------------------------------------------+
| > Approximate | 8      | For the Approximate Entropy (ApEn) test,   |
| > Entropy     |        | SP 800-22r1a Section 2.12.7 requires the   |
| > block       |        | block length to be less than \[log2 n\] -  |
| > length      |        | 5. Other analysis \[Hill 2004\] has shown  |
|               |        | that for n=1,000,000, block lengths        |
|               |        | greater than 8 can cause failures more     |
|               |        | often than expected for large scale        |
|               |        | testing.                                   |
+---------------+--------+--------------------------------------------+
| > Serial      | 16     | The Serial Test block length is also set   |
| > block       |        | based on n. If n=106, the block length     |
| > length      |        | must be less than 17. (See SP 800-22r1a    |
|               |        | Section 2.11.7.)                           |
+---------------+--------+--------------------------------------------+
| > Linear      | 1,000  | The Linear Complexity test block length is |
| > Complexity  |        | required to be set to between 500 and      |
| > block       |        | 5,000 (inclusive) and requires that (See   |
| > length      |        | SP 800-22r1a Section 2.10.7.)              |
+---------------+--------+--------------------------------------------+

###### References

> \[Rukhin 2010\] Rukhin, Andrew, et al., \"A Statistical Test Suite for
> Random and Pseudorandom Number Generators for Cryptographic
> Applications," NIST SP 800-22, Revision 1a.
>
> \[Kim 2004\] Kim, Song-Ju, et al., \"Corrections of the NIST
> Statistical Test Suite for Randomness.\" \[Hill 2004\] Hill, Joshua
> (InfoGard Labs), \"ApEn Test Parameter Selection.\"
>
> \[Hamano 2007\] Hamano, K. and Kaneko, T., "Correction of Overlapping
> Template Matching Test Included in NIST Randomness Test Suite," IEICE
> Trans. Fundamentals, vol. E90-A, no. 9, pp. 1788-1792, Sept. 2007.
>
> \[Hamano 2009\] Hamano, Kenji, "Analysis and Application of the
> T-complexity." Ph.D. thesis, The University of Tokyo.
>
> \[NIST 2010\] STS Software Revision History. URL:
> [*http://csrc.nist.gov/groups/ST/toolkit/rng/revision_history_software.html*](http://csrc.nist.gov/groups/ST/toolkit/rng/revision_history_software.html).
> Internet Archive:
>
> *http://web.archive.org/web/20150520193625/<http://csrc.nist.gov/groups/ST/toolkit/rng/revision_history_software.html>*
>
> \[NIST 2014\] Current STS Release Notes. URL:
> [*http://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html*](http://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html).
> Internet Archive:
>
> *http://web.archive.org/web/20150103230340/<http://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html>*
