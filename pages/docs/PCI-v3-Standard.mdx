> ![Final-PCI-SSC-Mark-R.PNG](vertopal_60a238a099614e179dec6351a3c50457/media/image1.png){width="2.252703412073491in"
> height="0.6875in"}
>
> **Payment Card Industry (PCI)**

Point-to-Point Encryption

> **Security Requirements and Testing Procedures**
>
> Version 3.1
>
> September 2021
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image1.png){width="1.1735618985126859in"
> height="0.3575in"}

# Document Changes

+---------+----+----+------------------------------------------------+
| > *     | *  | ** | > **Description**                              |
| *Date** | *V | Re |                                                |
|         | er | vi |                                                |
|         | si | si |                                                |
|         | on | on |                                                |
|         | ** | ** |                                                |
+=========+====+====+================================================+
| > Se    | 1  |    | Initial release of *PCI Point-to-Point         |
| ptember | .0 |    | Encryption: Solution Requirements --           |
| > 2011  |    |    | Encryption, Decryption, and Key Management     |
|         |    |    | within Secure Cryptographic Devices            |
|         |    |    | (Hardware/Hardware).*                          |
+---------+----+----+------------------------------------------------+
| > April | 1  |    | Updated release of PCI P2PE Solution           |
| > 2012  | .1 |    | Requirements to incorporate Testing Procedures |
|         |    |    | and additional guidance and content.           |
|         |    |    |                                                |
|         |    |    | For complete information, see *PCI P2PE        |
|         |    |    | Solution Requirements and Testing Procedures:  |
|         |    |    | Summary of Changes from PCI P2PE Initial       |
|         |    |    | Release.*                                      |
+---------+----+----+------------------------------------------------+
| > June  | 2  |    | Update from P2PE v1.1: For complete            |
| > 2015  | .0 |    | information, see the *Point-to-Point           |
|         |    |    | Encryption Standard -- Summary of Changes from |
|         |    |    | P2PE v.1.1 to v2.0.*                           |
+---------+----+----+------------------------------------------------+
| > July  | 2  | 1  | Update from P2PE v2.0 to P2PE v2.0 Revision    |
| > 2015  | .0 | .1 | 1.1 to replace erroneous footnote in Annex C   |
|         |    |    | and to correct numbering for 1C-1.2.3.         |
+---------+----+----+------------------------------------------------+
| > D     | 3  |    | Updated from P2PE v2.0 r1.1 For complete       |
| ecember | .0 |    | information, see the *Point-to-Point           |
| > 2019  |    |    | Encryption Security Requirements and Testing   |
|         |    |    | Procedures -- Summary of Significant Changes   |
|         |    |    | from P2PE v.2.0 to v3.0*                       |
+---------+----+----+------------------------------------------------+
| > Se    | 3  |    | Alignment with PCI PIN v3.1, updates based on  |
| ptember | .1 |    | a Request For Comment (RFC), and errata. For   |
| > 2021  |    |    | complete information, see the *Point-to-Point  |
|         |    |    | Encryption Security Requirements and Testing   |
|         |    |    | Procedures -- Summary of Significant Changes   |
|         |    |    | from v3.0 to v3.1*                             |
+---------+----+----+------------------------------------------------+

> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image1.png){width="1.1735618985126859in"
> height="0.3575in"}

# Contents

[Document Changes i](#document-changes)

[Introduction: Security Requirements for Point-to-Point Encryption
1](#introduction-security-requirements-for-point-to-point-encryption)

[Purpose of this Document 1](#purpose-of-this-document)

[Types of Solution Providers 1](#types-of-solution-providers)

[*P2PE Solution Provider 1*](#p2pe-solution-provider)

[*Merchant as a Solution Provider/Merchant-managed Solution
1*](#merchant-as-a-solution-providermerchant-managed-solution)

[P2PE at a Glance -- Overview of Domains and Requirements
2](#p2pe-at-a-glance-overview-of-domains-and-requirements)

[Scope of Assessment 4](#scope-of-assessment)

[Definition of Secure Cryptographic Devices (SCDs) to be used in P2PE
Solutions
4](#definition-of-secure-cryptographic-devices-scds-to-be-used-in-p2pe-solutions)

[P2PE Solutions: Hardware Decryption or Hybrid Decryption
4](#p2pe-solutions-hardware-decryption-or-hybrid-decryption)

[SCD Domain Applicability 5](#scd-domain-applicability)

[P2PE Solutions and Use of Third Parties and/or P2PE Component Providers
6](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)

[P2PE Solutions and Use of P2PE Applications and/or P2PE Non-payment
Software
7](#p2pe-solutions-and-use-of-p2pe-applications-andor-p2pe-non-payment-software)

[Scope of Assessment for P2PE Solutions
8](#scope-of-assessment-for-p2pe-solutions)

[Relationship between P2PE and other PCI Standards
9](#relationship-between-p2pe-and-other-pci-standards)

[For Assessors: Sampling for P2PE Solutions
9](#for-assessors-sampling-for-p2pe-solutions)

[Multiple Acquirers 10](#multiple-acquirers)

[P2PE Program Guide 10](#p2pe-program-guide)

[At-a-glance P2PE Implementation Diagram
11](#at-a-glance-p2pe-implementation-diagram)

[Technical References 12](#technical-references)

[ANSI, EMV, ISO, FIPS, NIST, and PCI Standards
12](#ansi-emv-iso-fips-nist-and-pci-standards)

[Domain 1: Encryption Device and Application Management
15](#domain-1-encryption-device-and-application-management)

[Overview 15](#overview)

[Requirement 1A: Account data must be encrypted in equipment that is
resistant to physical and logical compromise 16](#_bookmark24)

[Requirement 1B: Secure logical access to POI devices 19](#_bookmark25)

[Requirement 1C: Use applications that protect PAN and SAD
26](#_bookmark26)

[Requirement 1D: Implement secure application-management processes
29](#_bookmark27)

[Requirement 1E: Component providers ONLY: report status to solution
providers 31](#_bookmark28)

[Domain 2: Application Security 33](#domain-2-application-security)

[Overview 33](#overview-1)

![](vertopal_60a238a099614e179dec6351a3c50457/media/image1.png){width="1.1854166666666666in"
height="0.3611111111111111in"}[Use of a "Test Platform"
34](#use-of-a-test-platform)

[Domain 2 Informative Annex -- Application's Implementation Guide
34](#domain-2-informative-annex-applications-implementation-guide)

[Requirement 2A: Protect PAN and SAD 35](#_bookmark33)

[Requirement 2B: Develop and maintain secure applications
43](#_bookmark34)

[Requirement 2C: Implement secure application-management processes
58](#_bookmark35)

[Domain 2 Informative Annex: Summary of Contents for the *Implementation
Guide* for P2PE Applications 61](#_bookmark36)

[Domain 3: P2PE Solution Management
65](#domain-3-p2pe-solution-management)

[Overview 65](#overview-2)

[Requirement 3A: P2PE solution management 66](#_bookmark39)

[Requirement 3B: Third-party management 72](#_bookmark40)

[Requirement 3C: Creation and maintenance of the P2PE Instruction Manual
for merchants 74](#_bookmark41)

[Domain 4: Decryption Environment 76](#domain-4-decryption-environment)

[Requirement 4A: Use approved decryption devices 77](#_bookmark43)

[Requirement 4B: Secure the decryption environment 80](#_bookmark44)

[Requirement 4C: Monitor the decryption environment and respond to
incidents 86](#_bookmark45)

[At a Glance -- Example P2PE Hybrid Decryption Implementation
90](#_bookmark46)

[Requirement 4D: Implement secure hybrid decryption process --
Applicable for hybrid decryption environments only 91](#_bookmark47)

[Requirement 4E: Component providers ONLY: report status to solution
providers 107](#_bookmark48)

[Domain 5: P2PE Cryptographic Key Operations and Device Management
109](#domain-5-p2pe-cryptographic-key-operations-and-device-management)

[Overview 110](#overview-3)

[Symmetric-Key Distribution using Asymmetric Techniques
111](#symmetric-key-distribution-using-asymmetric-techniques)

[*Remote Key-Distribution Using Asymmetric Techniques Operations
111*](#remote-key-distribution-using-asymmetric-techniques-operations)

[*Certification and Registration Authority Operations
111*](#certification-and-registration-authority-operations)

[Key-Injection Facilities 112](#key-injection-facilities)

[Note for hybrid decryption environments
113](#note-for-hybrid-decryption-environments)

[Definitions and Annex 113](#_bookmark56)

[Control Objective 1: Account data is processed using equipment and
methodologies that ensure they are kept secure 114](#_bookmark57)

[Control Objective 2: Cryptographic keys used for account-data
encryption/decryption and related key management are created using
processes](#_bookmark58) [that ensure it is not possible to predict any
key or determine that certain keys are more probable than other keys
117](#_bookmark58)

[Control Objective 3: Keys are conveyed or transmitted in a secure
manner 127](#_bookmark59)

[Control Objective 4: Key loading to HSMs and POI devices is handled in
a secure manner 140](#_bookmark60)

[Control Objective 5: Keys are used in a manner that prevents or detects
their unauthorized usage 163](#_bookmark61)

![](vertopal_60a238a099614e179dec6351a3c50457/media/image1.png){width="1.1854166666666666in"
height="0.3611111111111111in"}[Control Objective 6: Keys are
administered in a secure manner 178](#_bookmark62)

[Control Objective 7: Equipment used to process account data and keys is
managed in a secure manner 205](#_bookmark63)

[Requirement 5A: Account data is processed using algorithms and
methodologies that ensure they are kept secure 232](#_bookmark64)

[Requirement 5H: For hybrid decryption solutions: Implement secure
hybrid key management 235](#_bookmark65)

[Requirement 5I: Component providers ONLY: report status to solution
providers 238](#_bookmark66)

[Domain 5 Normative Annex C: Minimum and Equivalent Key Sizes and
Strengths for Approved Algorithms
239](#domain-5-normative-annex-c-minimum-and-equivalent-key-sizes-and-strengths-for-approved-algorithms)

[Appendix A: Merchant-Managed Solutions: Separation between Merchant
Encryption and Decryption Environments
242](#appendix-a-merchant-managed-solutions-separation-between-merchant-encryption-and-decryption-environments)

[Overview 242](#overview-4)

[Eligibility Criteria 243](#eligibility-criteria)

[At a Glance -- Example of Separation between Merchant Encryption and
Decryption Environments for Merchant-Managed Solutions
244](#_bookmark72)

[Requirement MM-A: Restrict access between the merchant decryption
environment and all other networks/systems 245](#_bookmark73)

[Requirement MM-B: Restrict traffic between the encryption environment
and any other CDE 249](#_bookmark74)

[Requirement MM-C: Restrict personnel access between encryption
environment and decryption environment 250](#_bookmark75)

# Introduction: Security Requirements for Point-to-Point Encryption

## Purpose of this Document

> This document, *Point-to-Point Encryption: Security Requirements and
> Testing Procedures,* defines both security requirements and testing
> procedures for Point-to-Point Encryption *(*P2PE) solutions and
> components. The objective of this standard is to facilitate the
> development, approval, and deployment of PCI-approved P2PE solutions
> that will increase the protection of account data by encrypting that
> data from the point of interaction (POI) within the encryption
> environment where account data is captured through to the point of
> decrypting that data inside a decryption environment, effectively
> removing clear-text account data between these two points.
>
> The requirements contained within this standard are intended for P2PE
> solution providers and other entities that provide P2PE components or
> P2PE applications for use in P2PE solutions, as well as P2PE assessors
> evaluating these entities. Additionally, merchants benefit from using
> P2PE solutions due to increased protection of account data and
> subsequent reduction in the presence of clear-text account data within
> their environments.

## Types of Solution Providers

### P2PE Solution Provider

> A P2PE solution provider is an entity with a third-party relationship
> with respect to its merchant customers (e.g., a processor, acquirer,
> or payment gateway) that has overall responsibility for the design and
> implementation of a specific P2PE solution and manages P2PE solutions
> for its merchant customers. The solution provider has overall
> responsibility for ensuring that all P2PE requirements are met,
> including any P2PE requirements performed by third-party organizations
> on behalf of the solution provider (e.g., certification authorities or
> key-injection facilities).

### Merchant as a Solution Provider/Merchant-managed Solution

  ---------------------------------------------------------------------------------------------------------------------------------------------
  The terms "merchant as a solution provider" and "merchant-managed solution" apply to merchants who choose to manage     ***For
  their own P2PE solutions on behalf of their own merchant encryption environments rather than outsourcing the solution   merchant-managed
  to a third-party P2PE solution provider.                                                                                solutions, where the
  [Appendix](#appendix-a-merchant-managed-solutions-separation-between-merchant-encryption-and-decryption-environments)   term "merchant" is
  [A](#appendix-a-merchant-managed-solutions-separation-between-merchant-encryption-and-decryption-environments) defines  used in Domains 1, 3,
  the separation needed between encryption environments where the encrypting POI devices are physically located and the   4, and 5 of this
  merchant's account-data decryption environment (and other merchant cardholder data environments) for a merchant-managed document, those
  solution. ***Appendix A is only applicable for merchant-managed solutions (MMS)**.* In addition to meeting requirements requirements refer to
  specified in [Appendix                                                                                                  the merchant's
  A,](#appendix-a-merchant-managed-solutions-separation-between-merchant-encryption-and-decryption-environments)          encryption
  merchants acting as their own solution providers have the same responsibilities of solution providers mentioned         environments and
  throughout this document and are in scope for all other P2PE requirements (in Domains 1, 2, 3, 4, and 5).               represent
                                                                                                                          requirements the
                                                                                                                          merchant as a
                                                                                                                          solution provider is
                                                                                                                          responsible for
                                                                                                                          meeting for, or on
                                                                                                                          behalf of, those
                                                                                                                          merchant encryption
                                                                                                                          environments.***
  ----------------------------------------------------------------------------------------------------------------------- ---------------------

  ---------------------------------------------------------------------------------------------------------------------------------------------

## P2PE at a Glance -- Overview of Domains and Requirements

> The table below presents the five P2PE solution domains that represent
> the core areas where security controls need to be applied and
> validated.
>
> This table provides an overview of each domain and its associated
> high-level requirements. Each requirement identified here has
> corresponding sub-requirements and validation procedures, which are
> presented in detail beginning at [Domain 1: Encryption Device and
> Application](#domain-1-encryption-device-and-application-management)
> [Management.](#domain-1-encryption-device-and-application-management)

+--------------+------------------+-----------------------------------+
| > **Domain** | > **Overview**   | > **P2PE Validation               |
|              |                  | > Requirements**                  |
+==============+==================+===================================+
| > **Domain   | The secure       | **1A** Account data must be       |
| > 1:**       | management of    | encrypted in equipment that is    |
| >            | the PCI-         | resistant to physical and logical |
| >            | approved POI     | compromise.                       |
| **Encryption | devices and the  |                                   |
| > Device and | resident         | **1B** Logically secure POI       |
| >            | software.        | devices.                          |
|  Application |                  |                                   |
| >            |                  | **1C** Use P2PE applications that |
| Management** |                  | protect PAN and SAD.              |
|              |                  |                                   |
|              |                  | **1D** Implement secure           |
|              |                  | application-management processes. |
|              |                  |                                   |
|              |                  | **1E** Component providers        |
|              |                  | *ONLY*: report status to solution |
|              |                  | providers.                        |
+--------------+------------------+-----------------------------------+
| > **Domain   | The secure       | **2A** Protect PAN and SAD.       |
| > 2:         | development of   |                                   |
| >            | payment          | **2B** Develop and maintain       |
|  Application | applications     | secure applications.              |
| > Security** | designed to have |                                   |
|              | access to        | **2C** Implement secure           |
|              | clear-text       | application-management processes. |
|              | account data     |                                   |
|              | intended solely  |                                   |
|              | for installation |                                   |
|              | on PCI- approved |                                   |
|              | POI devices.     |                                   |
+--------------+------------------+-----------------------------------+
| > **Domain   | Overall          | **3A** P2PE solution management.  |
| > 3:**       | management of    |                                   |
| >            | the P2PE         | **3B** Third-party management.    |
| > **P2PE     | solution by the  |                                   |
| > Solution   | solution         | **3C** Creation and maintenance   |
| >            | provider,        | of *P2PE Instruction Manual* for  |
| Management** | including        | merchants.                        |
|              | third-party      |                                   |
|              | relationships,   |                                   |
|              | incident         |                                   |
|              | response, and    |                                   |
|              | the *P2PE        |                                   |
|              | Instruction      |                                   |
|              | Manual* (PIM).   |                                   |
+--------------+------------------+-----------------------------------+
| > **Domain   | The secure       | **4A** Use approved decryption    |
| > 4:**       | management of    | devices.                          |
| >            | the environment  |                                   |
| >            | that receives    | **4B** Secure the decryption      |
| **Decryption | encrypted        | environment.                      |
| > E          | account data and |                                   |
| nvironment** | decrypts it.     | **4C** Monitor the decryption     |
|              |                  | environment and respond to        |
|              |                  | incidents.                        |
|              |                  |                                   |
|              |                  | **4D** Implement secure, hybrid   |
|              |                  | decryption processes.             |
|              |                  |                                   |
|              |                  | **4E** Component providers        |
|              |                  | *ONLY*: report status to solution |
|              |                  | providers.                        |
+--------------+------------------+-----------------------------------+

+--------------+------------------+-----------------------------------+
| > **Domain** | > **Overview**   | > **P2PE Validation               |
|              |                  | > Requirements**                  |
+==============+==================+===================================+
| > **Domain   | Establish and    | **Control Objective 1** Account   |
| > 5:**       | administer key-  | data is processed using equipment |
| >            | management       | and                               |
| > **P2PE     | operations for   |                                   |
| > C          | account- data    | methodologies that ensure they    |
| ryptographic | encryption POI   | are kept secure.                  |
| > Key        | devices and      |                                   |
| > Operations | decryption HSMs. | **Control Objective 2** Account   |
| > and Device |                  | data keys and key-management      |
| >            |                  |                                   |
| Management** |                  | > methodologies are created using |
|              |                  | > processes that ensure it is not |
|              |                  | > possible to predict any key or  |
|              |                  | > determine that certain keys are |
|              |                  | > more probable than other keys.  |
|              |                  |                                   |
|              |                  | **Control Objective 3** Keys are  |
|              |                  | conveyed or transmitted in a      |
|              |                  | secure                            |
|              |                  |                                   |
|              |                  | > manner.                         |
|              |                  |                                   |
|              |                  | **Control Objective 4** Key       |
|              |                  | loading is handled in a secure    |
|              |                  | manner.                           |
|              |                  |                                   |
|              |                  | **Control Objective 5** Keys are  |
|              |                  | used in a manner that prevents or |
|              |                  |                                   |
|              |                  | > detects their unauthorized      |
|              |                  | > usage.                          |
|              |                  | >                                 |
|              |                  | > **Control Objective 6** Keys    |
|              |                  | > are administered in a secure    |
|              |                  | > manner.                         |
|              |                  | >                                 |
|              |                  | > **Control Objective 7**         |
|              |                  | > Equipment used to process       |
|              |                  | > account data and keys           |
|              |                  | >                                 |
|              |                  | > is managed in a secure manner.  |
|              |                  |                                   |
|              |                  | **5A** Account data is processed  |
|              |                  | using algorithms and              |
|              |                  | methodologies that ensure they    |
|              |                  | are kept secure.                  |
|              |                  |                                   |
|              |                  | **5H** For hybrid decryption      |
|              |                  | solutions: Implement secure       |
|              |                  | hybrid-key management.            |
|              |                  |                                   |
|              |                  | **5I** Component providers        |
|              |                  | *ONLY*: report status to solution |
|              |                  | providers.                        |
+--------------+------------------+-----------------------------------+
| > **Appendix | Separate duties  | **MM-A** Restrict access between  |
| > A:**       | and functions    | the merchant decryption           |
| >            | between merchant | environment and all other         |
| > **Merc     | encryption and   | networks/systems.                 |
| hant-managed | decryption       |                                   |
| >            | environments.    | **MM-B** Restrict traffic between |
|  Solutions** |                  | the encryption environment and    |
| >            |                  | any other CDE.                    |
| > *Note that |                  |                                   |
| > this       |                  | **MM-C** Restrict personnel       |
| > appendix   |                  | access between the encryption     |
| > is not     |                  | environment and the merchant      |
| > applicable |                  | decryption environment.           |
| > to         |                  |                                   |
| >            |                  |                                   |
|  third-party |                  |                                   |
| > solution   |                  |                                   |
| >            |                  |                                   |
|  providers.* |                  |                                   |
+--------------+------------------+-----------------------------------+

## Scope of Assessment

> The security requirements are not intended to require an assessment of
> a merchant's encryption environment (excluding merchant-managed
> solutions where the merchant is both the merchant customer and the
> solution provider). P2PE Components, Applications, and Solutions may
> exist initially in the absence of any merchant customers or
> merchant-specific implementation. Where applicable, the entity being
> assessed must be able to demonstrate the capability to meet the
> security objectives as they apply to the implementation.

## Definition of Secure Cryptographic Devices (SCDs) to be used in P2PE Solutions

> Secure cryptographic devices (SCDs) are used for the encryption and
> decryption of account data, signing P2PE Applications, non-payment
> software, and whitelists, as well as for the storage and management of
> cryptographic keys. SCDs include but are not limited to key-loading
> devices (KLDs), point-of-interaction (POI) encryption devices, and
> hardware security modules (HSMs). An SCD used for the acceptance and
> encryption of account data at the point of sale is required to be a
> PCI-approved POI device, which is a device evaluated and approved via
> the PCI PTS program and includes SRED (secure reading and exchange of
> data). HSMs used within the decryption environment for decryption of
> account data and related cryptographic key operations must be approved
> to either *FIPS PUB 140-2* / *140-3* (overall level 3 or higher) or
> the PCI HSM standard.

## P2PE Solutions: Hardware Decryption or Hybrid Decryption

> For PCI P2PE solutions, the encryption environment at the point of
> merchant acceptance consists exclusively of hardware encryption
> performed within PCI-approved POI devices.
>
> PCI P2PE decryption environments require HSMs for *all* management of
> cryptographic keys, and that HSMs be used for decryption of account
> data (hardware decryption); or optionally account-data decryption can
> occur outside an HSM in non-SCD "Host Systems" (hybrid decryption)
> meeting additional hybrid decryption requirements specified in Domains
> 4 and 5, in Sections **4D** and **5H,** respectively.
>
> *Note that hybrid decryption is NOT an option for merchant-managed
> solutions.*

## SCD Domain Applicability

> P2PE solutions require the use of various types of SCDs. To assist in
> evaluating these device types, the following matrix indicates the
> domains each SCD type must be assessed to. The P2PE Standard does not
> require an evaluation of the physical and logical controls (i.e., the
> hardware and firmware of an SCD), which must have already been
> evaluated and approved as part of PCI HSM, *FIPS 140-2* or *140-3*, or
> PCI PTS POI, as applicable.

+--------------+-----------------+-----------------+-----------------+
|              | > **SCD Type    |                 |                 |
|              | > and Usage**   |                 |                 |
+==============+=================+=================+=================+
| > **Domain** | >               | > ***FIPS       | > **SCD for     |
|              |  **PCI-Approved | > 140-2* or     | > Cryptographic |
|              | > POI Device    | > *140-3* Level | > Key           |
|              | > for           | > 3 or 4 or PCI | > Injection,    |
|              | > Account-Data  | > Approved HSM  | > Key           |
|              | > Encryption**  | > for           | > Operations,   |
|              |                 | > Account-Data  | > or            |
|              |                 | > Decryption**  | > Sof           |
|              |                 |                 | tware/Whitelist |
|              |                 |                 | > Signing**     |
+--------------+-----------------+-----------------+-----------------+
| > **Domain   | > Applicable    | > N/A           | > N/A           |
| > 1:**       |                 |                 |                 |
| >            |                 |                 |                 |
| >            |                 |                 |                 |
| **Encryption |                 |                 |                 |
| > Device and |                 |                 |                 |
| >            |                 |                 |                 |
|  Application |                 |                 |                 |
| >            |                 |                 |                 |
| Management** |                 |                 |                 |
+--------------+-----------------+-----------------+-----------------+
| > **Domain   | > N/A           | > N/A           | > N/A           |
| > 2:         |                 |                 |                 |
| >            |                 |                 |                 |
|  Application |                 |                 |                 |
| > Security** |                 |                 |                 |
+--------------+-----------------+-----------------+-----------------+
| > **Domain   | > N/A           | > N/A           | > N/A           |
| > 3:**       |                 |                 |                 |
| >            |                 |                 |                 |
| > **P2PE     |                 |                 |                 |
| > Solution   |                 |                 |                 |
| >            |                 |                 |                 |
| Management** |                 |                 |                 |
+--------------+-----------------+-----------------+-----------------+
| > **Domain   | > N/A           | > Applicable    | > N/A           |
| > 4:**       |                 |                 |                 |
| >            |                 |                 |                 |
| >            |                 |                 |                 |
| **Decryption |                 |                 |                 |
| > Env        |                 |                 |                 |
| ironmen**[]{ |                 |                 |                 |
| #_bookmark11 |                 |                 |                 |
| > .anc       |                 |                 |                 |
| hor}**t^1^** |                 |                 |                 |
+--------------+-----------------+-----------------+-----------------+
| > **Domain   | > Applicable    | > Applicable    | > Applicable    |
| > 5:**       |                 |                 |                 |
| >            |                 |                 |                 |
| > **P2PE     |                 |                 |                 |
| > C          |                 |                 |                 |
| ryptographic |                 |                 |                 |
| > Key        |                 |                 |                 |
| > Operations |                 |                 |                 |
| > and Device |                 |                 |                 |
| > Managem    |                 |                 |                 |
| ent[^1^](#_b |                 |                 |                 |
| ookmark11)** |                 |                 |                 |
+--------------+-----------------+-----------------+-----------------+

> ^1^ For hybrid decryption environments, note that while account-data
> decryption is performed in a Host System that meets requirements
> specified in Domains 4 (Section 4D) and 5 (Section 5H), cryptographic
> key injection and key management must still be performed in a *FIPS
> 140-2* / *140-3* Level 3 or 4 HSM or a PCI- approved HSM.

## P2PE Solutions and Use of Third Parties and/or P2PE Component Providers

> A given P2PE solution may be entirely performed and managed by a
> single solution provider or by a merchant acting as its own solution
> provider (Merchant-Managed Solution, or MMS); or certain services may
> be outsourced to third parties who perform these functions on behalf
> of the solution provider. All third parties that perform P2PE
> functions on behalf of a P2PE solution provider must be validated per
> applicable P2PE solution requirements, and such entities have the
> option of becoming P2PE component providers.
>
> A **"P2PE component provider*" ***is an entity that provides a service
> assessed to a specific set of P2PE requirements and results in a P2PE
> component provider listing on the PCI SSC website. P2PE component
> providers' services are performed on behalf of other P2PE solution
> providers for use in P2PE solutions.
>
> There are two options for third-party entities performing functions on
> behalf of solution providers to validate compliance:

1.  Undergo a P2PE assessment of relevant P2PE requirements on their own
    and submit the applicable P2PE Report on Validation (P-ROV) to PCI
    SSC for review and acceptance. Upon acceptance, the P2PE component
    is listed on PCI SSC's list of *Validated P2PE Components*.

> **Or**,

2.  Have their services reviewed during the course of each of their
    solution-provider or component-provider customers' P2PE assessments.
    Accordingly, a solution can be reviewed via one of the following
    scenarios:

    1.  The solution provider can perform all domains in their entirety.

        -   A merchant as a solution provider (MMS) can perform all
            > domains (*including* Appendix A) in their entirety.

    2.  A solution provider (or a merchant as a solution provider) can
        outsource functions and have them assessed as part of the
        solution provider's P2PE assessment.

    3.  A solution provider (or a merchant as a solution provider) can
        outsource certain P2PE functions to PCI-listed P2PE component
        providers and report use of the PCI-listed P2PE component(s) in
        their P2PE Report on Validation (P-ROV).

> Via requirements specified in Domain 3, solution providers (or
> merchants as solution providers) must manage the overall P2PE solution
> and any third parties used to perform P2PE functions on their behalf,
> whether those third parties are separately listed by PCI SSC as P2PE
> component providers or are assessed as part of the solution provider's
> P2PE assessment.

## P2PE Solutions and Use of P2PE Applications and/or P2PE Non-payment Software

+----------------------------------------+-----------------------------+
| All P2PE applications and P2PE         | ***Note:** P2PE             |
| non-payment software intended for use  | applications and P2PE       |
| on a PCI- approved POI device as part  | non-payment software do not |
| of a P2PE solution must be assessed    | meet the PTS definition of  |
| either to Domain 2 or applicable       | "firmware" and are not      |
| requirements in Domain 1,              | reviewed as part of the PTS |
| respectively. P2PE applications may be | POI assessment. Therefore,  |
| assessed and listed on PCI SSC's list  | both P2PE Applications and  |
| of *Validated P2PE Applications*, for  | P2PE non-payment software   |
| example, if that application may be    | must be assessed as part of |
| used in more than one P2PE solution.   | this Standard.              |
|                                        | Additionally, software      |
| A **"P2PE application"** is any        | meeting the PTS definition  |
| software or other files *with access   | of "firmware" is not        |
| to clear-text account data* that is    | reassessed during a P2PE    |
| intended to be loaded onto a           | assessment (PTS firmware is |
| PCI-approved POI device and used as    | not considered a P2PE       |
| part of a P2PE solution.               | payment application, nor is |
|                                        | it P2PE non-payment         |
|                                        | software).*                 |
+========================================+=============================+
+----------------------------------------+-----------------------------+

> **"P2PE non-payment software"** is any software or other files with
> *no access to clear-text account data* that is intended to be loaded
> onto a PCI- approved POI device and used as part of a P2PE solution.
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} P2PE non-payment software is assessed
> only per designated P2PE Domain 1 Requirements at **1C-2** during the
> assessment of the P2PE solution(s) in which the application will be
> used. *Note that this software is not subject to P2PE Domain 2
> Requirements.*
>
> ***Refer to the P2PE Program Guide for specific requirements relative
> to assessing and listing P2PE applications.***

## Scope of Assessment for P2PE Solutions

> The scope of a P2PE solution assessment covers the five P2PE domains
> either as part of a solution provider's full P2PE assessment, or as
> the cumulative result of one or more independently assessed (and
> PCI-listed) P2PE components or P2PE applications. See the "[P2PE
> Solutions
> and](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)
> [use of Third Parties and/or of P2PE Component
> Providers"](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)
> and "[P2PE Solutions and Use of P2PE Applications and/or P2PE
> Non-payment](#p2pe-solutions-and-use-of-p2pe-applications-andor-p2pe-non-payment-software)
> [Software"](#p2pe-solutions-and-use-of-p2pe-applications-andor-p2pe-non-payment-software)
> sections above for more information.
>
> Here is a high-level summary of the five P2PE domains:

+-------------+--------------------------------------------------------+
| > **Domain  | ![](vertopal_60a238a09961                              |
| > 1 --**    | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
| > Security  | height="0.1527777777777778in"} All PCI-approved POI    |
| > r         | devices included in the P2PE solution (for the         |
| equirements | merchant to use for payment acceptance)                |
| > for the   | ![](vertopal_60a238a09961                              |
| >           | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
|  encryption | height="0.1527777777777778in"} Integration of all      |
| >           | software onto POI devices                              |
| environment |                                                        |
|             | -   P2PE payment applications (subject to a Domain 2   |
|             |     > assessment)                                      |
|             |                                                        |
|             | -   P2PE non-payment software (those with no access to |
|             |     > clear-text account data---e.g., a loyalty or     |
|             |     > advertising application)                         |
+=============+========================================================+
| > **Domain  | ![](vertopal_60a238a09961                              |
| > 2 --**    | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
| > Security  | height="0.1527777777777778in"} For software with       |
| > r         | access to clear-text account data intended for use on  |
| equirements | PTS-approved POI devices                               |
| > for P2PE  |                                                        |
| > a         |                                                        |
| pplications |                                                        |
+-------------+--------------------------------------------------------+
| > **Domain  | ***Note:** This domain cannot be outsourced to a third |
| > 3 --**    | party or a P2PE component provider and MUST be         |
| > Security  | performed by the P2PE solution provider (or merchant   |
| > r         | as a solution provider).*                              |
| equirements |                                                        |
| > for       | ![](vertopal_60a238a09961                              |
| >           | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
|  management | height="0.1527777777777778in"} The solution provider's |
| > of the    | overall management of the P2PE solution including any  |
| > P2PE      | third-party relationships, communications between      |
| > solution  | various P2PE entities, and/or use of P2PE component    |
|             | providers                                              |
|             |                                                        |
|             | ![](vertopal_60a238a09961                              |
|             | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
|             | height="0.1527777777777778in"} The merchant-focused    |
|             | *P2PE Instruction Manual (PIM)* that the solution      |
|             | provider prepares for and distributes to merchants     |
|             | (for their encryption environments), including         |
|             | completion of the PCI-provided *PIM Template*          |
+-------------+--------------------------------------------------------+
| > **Domain  | ![](vertopal_60a238a09961                              |
| > 4 --**    | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
| > Security  | height="0.1527777777777778in"} Management of all       |
| > r         | system components located within or connected to the   |
| equirements | decryption environment, including those used for       |
| > for the   | decryption of account data, and                        |
| >           |                                                        |
|  decryption | ![](vertopal_60a238a09961                              |
| >           | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
| environment | height="0.1527777777777778in"} Maintenance of PCI DSS  |
|             | compliance for the decryption environment              |
+-------------+--------------------------------------------------------+
| > **Domain  | ![](vertopal_60a238a09961                              |
| > 5 --**    | 4e179dec6351a3c50457/media/image2.png){width="0.125in" |
| > Security  | height="0.1527777777777778in"} Secure key              |
| > r         | management---including all HSMs, key-loading devices,  |
| equirements | etc.---used by the solution provider or third party    |
| > for P2PE  | for cryptographic-key operations performed in support  |
| > key       | of account-data encryption POI devices and decryption  |
| -management | HSMs                                                   |
| >           |                                                        |
|  operations |                                                        |
+-------------+--------------------------------------------------------+

## Relationship between P2PE and other PCI Standards

> Various P2PE requirements are based on elements of---or share
> similarities with---other PCI standards, as follows:
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} POI devices (for account-data
> encryption) are approved per PCI PIN Transaction Security (PTS) Point
> of Interaction (POI) requirements
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} HSMs in the decryption environment used
> for account-data decryption and related cryptographic-key operations
> are approved per PCI PTS HSM or *FIPS 140-2* or *140-3* Level 3 (or 4)
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Cryptographic-key operations for both
> encryption and decryption environments using key-management practices
> from the PTS PIN Security Standard
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} The decryption environment is PCI DSS
> compliant
>
> Please note that this standard for point-to-point encryption solutions
> does not supersede the PCI Data Security Standard, PCI PIN Security
> Requirements, or any other PCI Standards, nor do these requirements
> constitute a recommendation from the Council or obligate merchants,
> service providers, or financial institutions to purchase or deploy
> such solutions. As with all other PCI standards, any mandates,
> regulations, or rules regarding these requirements are provided by the
> participating payment brands.

## For Assessors: Sampling for P2PE Solutions

> After considering the overall scope and complexity of the P2PE
> environment being assessed, the assessor may independently select
> representative samples of certain system components in order to assess
> P2PE requirements.
>
> Selected samples must be representative of all variations or types of
> a particular system component. Samples must be of sufficient size to
> provide the assessor with assurance that controls are implemented as
> expected across the entire population. Samples should be varied, where
> possible, with each assessment.
>
> Sampling of system components for assessment purposes does not reduce
> the scope of the solution-provider environment or the applicability of
> P2PE requirements. Whether or not sampling is to be used, P2PE
> requirements apply to the entire solution-provider environment. If
> sampling is used, each sample must be assessed against all applicable
> P2PE requirements. Sampling of the P2PE requirements themselves is not
> permitted.
>
> Any sampling of POI devices and their applications, cryptographic
> keys, and key components must follow these principles:
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} POI devices and applications/software
> must include every unique combination of hardware, firmware, and
> versions and configurations of both P2PE applications and P2PE
> non-payment software used by the solution.
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Samples of keys / key components must
> include all key types and/or functions.
>
> For each instance where sampling is used, the assessor must:
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Document the rationale behind the
> sampling technique and sample size,
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Document any standardized processes and
> controls used to determine sample size,
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Document how it was verified that the
> standardized processes/controls ensure consistency and apply to all
> items in the population, and
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Explain how the sample is appropriate
> and representative of the overall population.
>
> Assessors must revalidate the sampling rationale for each assessment.
> If sampling is to be used, different samples must be selected for each
> assessment.

## Multiple Acquirers

> The P2PE standard outlines the technology and processes needed to
> ensure the security of a solution that protects account data from the
> point of interaction to the point of initial decryption. In some
> instances, multiple acquirers or multiple solution providers may
> manage one or more P2PE solutions on the same merchant POI device.
> P2PE does not preclude these scenarios, as the business processes
> governing this shared environment are outside the responsibility of
> the PCI SSC. Vendors and merchants should be aware that in order for a
> P2PE solution to be listed on the PCI SSC website, each solution must
> be evaluated and tested, either independently or collectively. Once
> listed, merchants can then work with their acquirers to select a
> device and validated solution provider(s) that meet their
> multiple-acquirer needs.

## P2PE Program Guide

> Please refer to the P2PE Program Guide for information about the P2PE
> program, including the following topics:
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} P2PE Component Provider types
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} P2PE Report on Validation submission
> and acceptance processes
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Annual renewal process for solutions
> included on the list of *Validated P2PE Solutions*
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Vendor Release Agreements for vendors
> and providers of P2PE solutions, applications, and solution components
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} The P2PE Delta Change process.
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Notification responsibilities in the
> event a listed P2PE solution is determined to be at fault in a
> compromise

## At-a-glance P2PE Implementation Diagram

> Diagram 1 illustrates a generic P2PE implementation. The remainder of
> this document details the P2PE security requirements and testing
> procedures on a domain-by-domain basis.
>
> ***Note:** This diagram is for illustrative purposes and shows only
> one type of scenario that may occur.*

![](vertopal_60a238a099614e179dec6351a3c50457/media/image3.png){width="6.712385170603675in"
height="4.502520778652668in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image4.png){width="6.461167979002624in"
height="0.37707567804024494in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image5.png){width="3.652227690288714in"
height="1.2657239720034996in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image6.png){width="6.461350612423447in"
height="2.7352963692038497in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image7.png){width="3.921678696412948in"
height="2.549283683289589in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image8.png){width="3.329267279090114in"
height="1.7234820647419073in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image9.png){width="1.1171937882764655in"
height="8.311132983377077e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image10.png){width="8.963910761154856e-2in"
height="0.37692366579177605in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image11.png){width="8.963910761154856e-2in"
height="7.620406824146982e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image12.png){width="8.963910761154856e-2in"
height="7.620406824146982e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image13.png){width="8.963910761154856e-2in"
height="0.37692366579177605in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image14.png){width="0.6236067366579178in"
height="0.3569083552055993in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image15.png){width="8.98665791776028e-2in"
height="0.3791251093613298in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image16.png){width="8.98665791776028e-2in"
height="7.840551181102362e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image17.png){width="8.98665791776028e-2in"
height="7.840551181102362e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image18.png){width="8.98665791776028e-2in"
height="0.3791251093613298in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image19.png){width="1.6960181539807524in"
height="2.080139982502187in"}

**Diagram 1: Example P2PE Implementation at a Glance**

# Technical References

> This list contains the specific standards referenced in the security
> requirements. As the standards referenced may change in order to more
> completely reflect the state of both technology and the threat
> environment at a particular point in time, it is necessary to ensure
> that the current version is used of a particular reference when
> evaluating whether a process, technique, piece of equipment, or policy
> is compliant with a specific requirement*.*

## ANSI, EMV, ISO, FIPS, NIST, and PCI Standards

+-------+--------------------------------------------------------------+
| >     | > **Publication**                                            |
| **Sou |                                                              |
| rce** |                                                              |
+=======+==============================================================+
| > **A | *ANSI X9.24 (Part 1): Retail Financial Services Symmetric    |
| NSI** | Key Management Part 1: Using Symmetric Techniques*           |
|       |                                                              |
|       | *ANSI X9.24 (Part 2): Retail Financial Services Symmetric    |
|       | Key Management Part 2: Using Asymmetric Techniques for the   |
|       | Distribution of Symmetric Keys*                              |
|       |                                                              |
|       | *ANSI X9.24 (Part 3): Retail Financial Services Symmetric    |
|       | Key Management Part 3: Derived Unique Key Per Transaction*   |
|       |                                                              |
|       | *ANSI X9.42: Public-key Cryptography for the Financial       |
|       | Service Industry: Agreement of Symmetric Keys Using Discrete |
|       | Logarithm Cryptography*                                      |
|       |                                                              |
|       | *ANSI X9.44: Key Establishment Using Integer Factorization   |
|       | Cryptography*                                                |
|       |                                                              |
|       | *ANSI X9.63: Public Key Cryptography for the Financial       |
|       | Services Industry: Key Agreement and Key Transport Using     |
|       | Elliptic Curve Cryptography*                                 |
|       |                                                              |
|       | *ANSI X9.102: Symmetric Key Cryptography For the Financial   |
|       | Services Industry---Wrapping of Keys and Associated Data ASC |
|       | X9 TR 31: Interoperable Secure Key Exchange Key Block        |
|       | Specification for Symmetric Algorithms*                      |
|       |                                                              |
|       | *ASC X9 TR 34: Interoperable Method for Distribution of      |
|       | Symmetric Keys using Asymmetric Techniques: Part 1 -- Using  |
|       | Factoring-Based Public Key Cryptography Unilateral Key       |
|       | Transport*                                                   |
|       |                                                              |
|       | *ANSI X9.119 Part 1: Retail Financial Services -             |
|       | Requirements for Protection of Sensitive Payment Card Data - |
|       | Part 1: Using Encryption Method*                             |
|       |                                                              |
|       | *ANSI X9.142: Public Key Cryptography For The Financial      |
|       | Services Industry - The Elliptic Curve Digital Signature     |
|       | Algorithm - ECDSA*                                           |
+-------+--------------------------------------------------------------+
| > **  | *EMV: Integrated Circuit Card Specification for Payment      |
| EMV** | Systems, version 4.2 (June 2008)---Book 2: Security and Key  |
|       | Management*                                                  |
+-------+--------------------------------------------------------------+

+-------+--------------------------------------------------------------+
| >     | > **Publication**                                            |
| **Sou |                                                              |
| rce** |                                                              |
+=======+==============================================================+
| **F   | *FIPS PUB 140--2: Security Requirements for Cryptographic    |
| IPS** | Modules*                                                     |
|       |                                                              |
|       | *FIPS PUB 140--3: Security Requirements for Cryptographic    |
|       | Modules FIPS PUB 186-4: Digital Signature Standard (DSS)*    |
+-------+--------------------------------------------------------------+
| **    | *ISO 9564: Financial services - Personal Identification      |
| ISO** | Number Management and Security ISO 11568: Banking -- Key     |
|       | Management (Retail)*                                         |
|       |                                                              |
|       | *ISO 11770--2: Information Technology -- Security Techniques |
|       | -- Key Management, Part 2: Mechanisms Using Symmetric Key    |
|       | Management Techniques*                                       |
|       |                                                              |
|       | *ISO 11770--3: Information Technology -- Security Techniques |
|       | -- Key Management, Part 3: Mechanisms Using Asymmetric       |
|       | Techniques (RSA and Diffie-Hellman)*                         |
|       |                                                              |
|       | *ISO 13491: Banking -- Secure Cryptographic Devices          |
|       | (Retail)*                                                    |
|       |                                                              |
|       | *ISO TR 14742: Financial services - Recommendations on       |
|       | cryptographic algorithms and their use ISO 16609: Banking -- |
|       | Requirements for message authentication using symmetric      |
|       | techniques ISO 18031: Information technology \-- Security    |
|       | techniques \-- Random bit generation*                        |
|       |                                                              |
|       | *ISO/IEC 18033-3: Information Technology -- Security         |
|       | techniques -- Encryption algorithms -- Part 3: Block Ciphers |
|       | ISO TR 19038: Guidelines on Triple DEA Modes of Operation*   |
|       |                                                              |
|       | *ISO 20038: Banking and related financial services \-- Key   |
|       | wrap using AES*                                              |
+-------+--------------------------------------------------------------+
| **N   | *NIST Special Publication 800-22: A Statistical Test Suite   |
| IST** | for Random and Pseudorandom Number Generators for            |
|       | Cryptographic Applications*                                  |
|       |                                                              |
|       | *NIST Special Publication 800-57: Recommendation for Key     |
|       | Management*                                                  |
|       |                                                              |
|       | *NIST Special Publication 800-63B: Digital Identity          |
|       | Guidelines - Authentication and Lifecycle Management*        |
|       |                                                              |
|       | *NIST Special Publication 800-131: Transitions:              |
|       | Recommendation for Transitioning the Use of Cryptographic    |
|       | Algorithms and Key Lengths*                                  |
+-------+--------------------------------------------------------------+

+-------+--------------------------------------------------------------+
| >     | > **Publication**                                            |
| **Sou |                                                              |
| rce** |                                                              |
+=======+==============================================================+
| **PCI | *Payment Card Industry (PCI) PIN Transaction Security (PTS)  |
| SSC** | Point of Interaction (POI) Modular Security Requirements     |
|       | Payment Card Industry (PCI) PIN Transaction Security (PTS)   |
|       | Point of Interaction (POI) Modular Derived Test Requirements |
|       | Payment Card Industry (PCI) PIN Transaction Security (PTS)   |
|       | Hardware Security Module (HSM) Security Requirements*        |
|       |                                                              |
|       | *Payment Card Industry (PCI) PIN Transaction Security (PTS)  |
|       | Hardware Security Module (HSM) Derived Test Requirements*    |
+-------+--------------------------------------------------------------+

# Domain 1: Encryption Device and Application Management

+--------------+------------------+-----------------------------------+
| > **Domain** | > **Overview**   | > **P2PE Validation               |
|              |                  | > Requirements**                  |
+==============+==================+===================================+
| > **Domain   | The secure       | **1A** Account data must be       |
| > 1:**       | management of    | encrypted in equipment that is    |
| >            | the PCI-         | resistant to physical and logical |
| >            | approved POI     | compromise.                       |
| **Encryption | devices and the  |                                   |
| > Device and | resident         | **1B** Logically secure POI       |
| >            | software         | devices.                          |
|  Application |                  |                                   |
| >            |                  | **1C** Use P2PE applications that |
| Management** |                  | protect PAN and SAD.              |
|              |                  |                                   |
|              |                  | **1D** Implement secure           |
|              |                  | application-management processes. |
|              |                  |                                   |
|              |                  | **1E** Component providers        |
|              |                  | *ONLY*: report status to solution |
|              |                  | providers                         |
+--------------+------------------+-----------------------------------+

> ***Target audience:** P2PE solution providers or those who, on behalf
> of P2PE solution providers, manage the POI devices and their
> applications used in the P2PE solution.*

#### *Overview*

+-------------------------------+--------------------------------------+
| Domain 1 requirements         | ***Note:** Domain 1 includes the     |
| encompass the use of secure   | only requirements applicable to P2PE |
| point-of- interaction (POI)   | non- payment software (software on   |
| devices and P2PE applications | PCI-approved POI devices without     |
| and/or P2PE non-payment       | access to account data). For         |
| software. The POI device must | software that **never has access to  |
| be a PCI-approved POI device  | account data,** only Requirements at |
| with SRED. Domain 1           | **1C-2** are applicable---this will  |
| requirements also include the | validate that this software is not   |
| confirmation that all P2PE    | accessing account data, and is not   |
| applications and P2PE         | bypassing or overriding any security |
| non-payment software are      | features provided by the other       |
| properly reviewed, installed, | approved components of the device.   |
| and configured on the device. | However, requirements in Domain 5    |
|                               | apply to the SCD used for signing    |
| It is not the intent of       | non-payment software as well as the  |
| Domain 1 that solution        | associated cryptographic keys and    |
| providers (or component       | key management.*                     |
| providers) actively manage    |                                      |
| POI devices onsite at         | *For more information, refer to the  |
| merchant locations.           | section entitled "P2PE Solutions and |
|                               | Use of P2PE Applications and/or P2PE |
|                               | Non-payment Software."*              |
+===============================+======================================+
+-------------------------------+--------------------------------------+

> Within this domain, the term "solution provider" refers to whichever
> entity is undergoing the P2PE assessment. This may be a solution
> provider, a component provider, or a merchant as a solution provider.
> Refer to ["P2PE Solutions and use of Third Parties and/or P2PE
> Component
> Providers"](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)
> for more information about validating this Domain as a solution
> provider, an encryption management services component provider, or as
> a merchant as a solution provider (MMS).
>
> For merchant-managed solutions, the term "merchant" as used within
> Domains 1, 3, 4, and 5 of this document refers to the merchant's
> encryption environments, and represents requirements the merchant as a
> solution provider is responsible for meeting for or on behalf of those
> merchant encryption environments.
>
> See ["P2PE Solutions and use of Third Parties and/or P2PE Component
> Providers"](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)
> for more information about validating this Domain as a solution
> provider, a component provider, or a merchant as a solution provider.

+----------------------------+-----------------------------------------+
| []{#_bookmark24            |                                         |
| .anchor}***Requirement 1A: |                                         |
| Account data must be       |                                         |
| encrypted in equipment     |                                         |
| that is resistant to       |                                         |
| physical and logical       |                                         |
| compromise***              |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***1A-1** PCI-approved   |                                         |
| > POI devices with SRED    |                                         |
| > are used for transaction |                                         |
| > acceptance.*             |                                         |
+----------------------------+-----------------------------------------+
| > **1A-1.1** Account-data  | > **1A-1.1** For each POI device type   |
| > encryption operations    | > used in the solution, examine the POI |
| > must be performed using  | > device and review the PCI SSC list of |
| > a POI device approved    | > Approved PTS Devices to verify that   |
| > per the PCI PTS program  | > all of the following POI device       |
| > with SRED (secure        | > characteristics match the PTS         |
| > reading and exchange of  | > listing:                              |
| > data). The PTS approval  |                                         |
| > listing must match the   | -   Model name/number                   |
| > deployed devices in the  |                                         |
| > following                | -   Hardware version number             |
| > characteristics:         |                                         |
|                            | -   Firmware version number(s)          |
| -   Model name and number  |                                         |
|                            | -   SRED listed as a function provided  |
| -   Hardware version       |                                         |
|     > number               |                                         |
|                            |                                         |
| -   Firmware version       |                                         |
|     > number(s)            |                                         |
|                            |                                         |
| -   SRED listed as a       |                                         |
|     > function provided    |                                         |
|                            |                                         |
| > **Note:** The PCI PTS    |                                         |
| > POI approval listing     |                                         |
| > must not be expired.     |                                         |
+----------------------------+-----------------------------------------+
| > **1A-1.1.1** The POI     | > **1A-1.1.1.a** Examine documented     |
| > device's SRED            | > procedures and interview personnel to |
| > capabilities must be     | > verify that procedures are defined to |
| > enabled and active.      | > ensure that SRED capabilities are     |
|                            | > enabled and active on all POI devices |
|                            | > prior to devices being deployed to    |
|                            | > merchant encryption environments.     |
+----------------------------+-----------------------------------------+
|                            | > **1A-1.1.1.b** For all POI device     |
|                            | > types used in the solution, review    |
|                            | > POI device configurations to verify   |
|                            | > that all POI device types used in the |
|                            | > solution have SRED capabilities       |
|                            | > enabled and active (that is, the POI  |
|                            | > devices are operating in "encrypting  |
|                            | > mode") prior to devices being         |
|                            | > deployed to merchant encryption       |
|                            | > environments.                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| > **1A-1.2** POI devices   | > **1A-1.2.a** For all POI device types |
| > must be configured to    | > used in the P2PE solution, identify   |
| > use only SRED-validated  | > and document all account-data capture |
| > account-data capture     | > interfaces.                           |
| > mechanisms.              |                                         |
+============================+=========================================+
|                            | > **1A-1.2.b** For each POI device type |
|                            | > used in the solution, examine the     |
|                            | > device configuration to verify that   |
|                            | > it is configured by default to use    |
|                            | > only SRED-validated account-data      |
|                            | > capture mechanisms for accepting and  |
|                            | > processing P2PE transactions.         |
+----------------------------+-----------------------------------------+
| > **1A-1.2.1** All         | > **1A-1.2.1.a** Examine POI device     |
| > account-data capture     | > configuration and deployment          |
| > mechanisms on the POI    | > procedures to verify they include     |
| > device must be           | > either:                               |
| > SRED-validated, or must  |                                         |
| > be disabled or otherwise | -   Disabling all capture mechanisms    |
| > prevented from being     |     > that are not SRED validated, or   |
| > used for P2PE            |                                         |
| > transactions such that   | -   Implementing configurations that    |
| > they cannot be enabled   |     > prevent all non-SRED validated    |
| > by the merchant.         |     > capture mechanisms from being     |
|                            |     > used for P2PE transactions        |
+----------------------------+-----------------------------------------+
|                            | > **1A-1.2.1.b** Verify that the        |
|                            | > documented procedures include         |
|                            | > ensuring that all non- SRED-validated |
|                            | > capture mechanisms are disabled or    |
|                            | > otherwise prevented from being used   |
|                            | > for P2PE transactions prior to        |
|                            | > devices being deployed to merchant    |
|                            | > encryption environments.              |
+----------------------------+-----------------------------------------+
|                            | > **1A-1.2.1.c** For all POI device     |
|                            | > types, verify:                        |
|                            |                                         |
|                            | -   All non-validated capture           |
|                            |     > mechanisms are either disabled or |
|                            |     > configured to prevent their use   |
|                            |     > for P2PE transactions prior to    |
|                            |     > devices being deployed to         |
|                            |     > merchant encryption environments. |
|                            |                                         |
|                            | -   Disabled capture mechanisms cannot  |
|                            |     > be enabled by the merchant,       |
|                            |     > and/or the configurations that    |
|                            |     > prevent capture mechanisms from   |
|                            |     > being used for P2PE transactions  |
|                            |     > cannot be enabled by the          |
|                            |     > merchant.                         |
+----------------------------+-----------------------------------------+
| > **1A-1.3** If the POI    | > **1A-1.3** For all POI device types   |
| > device implements open   | > that implement open protocols,        |
| > protocols as part of the | > examine device configurations and     |
| > solution, the device     | > review the list of approved PTS       |
| > must also be validated   | > devices at                            |
| > to the PCI PTS Open      | > [www.pcisecuritystandards.org,        |
| > Protocols (OP) module.   | ](http://www.pcisecuritystandards.org/) |
| > Open protocols include   | > to verify that all POI devices that   |
| > the following:           | > implement open protocols used in this |
|                            | > solution are listed. Confirm each     |
| -   Link Layer Protocols   | > such device has a valid SSC listing   |
|                            | > number on the PCI SSC website under   |
| -   IP Protocols           | > "Approved PCI PTS Devices" with "OP"  |
|                            | > listed as a "function provided."      |
| -   Security Protocols     |                                         |
|                            |                                         |
| -   IP Services            |                                         |
+----------------------------+-----------------------------------------+
| > **1A-1.4** Clear-text    | > **1A-1.4.a** Examine documented       |
| > account data must not be | > transaction processes and data flows  |
| > disclosed to any         | > to verify that clear-text account     |
| > component or device      | > data is not disclosed to any          |
| > outside of the           | > component or device outside of the    |
| > PCI-approved POI device. | > PCI-approved POI device.              |
| > *(continued on next      |                                         |
| > page)*                   |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| > **1A-1.4** *(continued)* | > **1A-1.4.b** Using forensic tools     |
|                            | > and/or other data tracing methods,    |
|                            | > inspect a sample of test transactions |
|                            | > to verify that clear-text account     |
|                            | > data is not disclosed to any          |
|                            | > component or device outside of the    |
|                            | > PCI-approved POI device.              |
+============================+=========================================+
| > ***1A-2** Applications   |                                         |
| > on POI devices with      |                                         |
| > access to clear-text     |                                         |
| > account data are         |                                         |
| > assessed per Domain 2    |                                         |
| > before being deployed    |                                         |
| > into a P2PE solution.*   |                                         |
+----------------------------+-----------------------------------------+
| > ***Note:** Applications  |                                         |
| > included in a P2PE       |                                         |
| > solution but not already |                                         |
| > listed on the list of    |                                         |
| > Validated P2PE           |                                         |
| > Applications must        |                                         |
| > undergo an assessment    |                                         |
| > per Domain 2 (in         |                                         |
| > addition to meeting      |                                         |
| > applicable application   |                                         |
| > requirements in Domain   |                                         |
| > 1).*                     |                                         |
+----------------------------+-----------------------------------------+
| > **1A-2.1** All           | > **1A-2.1.a** For applications on the  |
| > applications on POI      | > PCI SSC list of *Validated P2PE       |
| > devices with access to   | > Applications*, review the list and    |
| > clear-text account data  | > compare to applications used in the   |
| > must be assessed         | > solution to verify that the           |
| > according to Domain 2.   | > applications match the P2PE           |
| >                          | > application listing in the following  |
| > The assessment must      | > characteristics:                      |
| > match the application in |                                         |
| > the following            | -   Application name                    |
| > characteristics:         |                                         |
|                            | -   Version number                      |
| -   Application name       |                                         |
|                            |                                         |
| -   Version number         |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1A-2.1.b** For applications not on  |
|                            | > the PCI SSC list of *Validated P2PE   |
|                            | > Applications*, review the application |
|                            | > P-ROV(s) and verify that the          |
|                            | > applications used in the solution     |
|                            | > match the application P-ROV in the    |
|                            | > following characteristics:            |
|                            |                                         |
|                            | -   Application name                    |
|                            |                                         |
|                            | -   Version number                      |
+----------------------------+-----------------------------------------+
| > **1A-2.2** All           | > **1A-2.2.a** For applications on the  |
| > applications on POI      | > PCI SSC list of *Validated P2PE       |
| > devices with access to   | > Applications*, review the list and    |
| > clear-text account data  | > verify all POI device types the       |
| > must only be deployed on | > application is used on are:           |
| > POI device types that    |                                         |
| > are:                     | -   Confirmed per **1A-1.1** as a       |
|                            |     > PTS-approved device(s)            |
| -   Confirmed per          |                                         |
|     > **1A-1.1** as a PTS  | -   Explicitly included in that         |
|     > approved device(s)   |     > application's listing             |
|                            |                                         |
| -   Explicitly included in |                                         |
|     > the Domain 2         |                                         |
|     > assessment for that  |                                         |
|     > application          |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1A-2.2.b** For applications not on  |
|                            | > the PCI SSC list of *Validated P2PE   |
|                            | > Applications*, review the application |
|                            | > P-ROV and verify the POI device types |
|                            | > the application is used on are:       |
|                            |                                         |
|                            | -   Confirmed per **1A-1.1** as a       |
|                            |     > PTS-approved device(s)            |
|                            |                                         |
|                            | -   Explicitly included in that P-ROV   |
|                            |     > as assessed for that application  |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark25            |                                         |
| .anchor}***Requirement 1B: |                                         |
| Secure logical access to   |                                         |
| POI devices***             |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***1B-1** Solution         |                                         |
| provider ensures that      |                                         |
| logical access to POI      |                                         |
| devices deployed at        |                                         |
| merchant encryption        |                                         |
| environment(s) is          |                                         |
| restricted to authorized   |                                         |
| personnel.*                |                                         |
+----------------------------+-----------------------------------------+
| > **1B-1.1** Solution      | > **1B-1.1.a** Examine documented POI   |
| > provider must ensure     | > device configuration procedures and   |
| > merchant logical access  | > documented account privilege          |
| > to POI devices, if       | > assignment rules to verify that       |
| > needed, is restricted as | > merchant logical access to POI        |
| > follows:                 | > devices is restricted as follows:     |
|                            |                                         |
| -   Cannot view or access  | -   Cannot view or access device        |
|     > device configuration |     > configuration settings that could |
|     > settings that could  |     > impact the security controls of   |
|     > impact the security  |     > the device, or allow access to    |
|     > controls of the      |     > cryptographic keys or clear- text |
|     > device, or allow     |     > PAN and/or SAD.                   |
|     > access to            |                                         |
|     > cryptographic keys   | -   Only views transaction-related      |
|     > or clear-text PAN    |     > data.                             |
|     > and/or SAD.          |                                         |
|                            | -   Cannot view or access cryptographic |
| -   Only views             |     > keys.                             |
|     > transaction-related  |                                         |
|     > data.                | -   Cannot view or access clear-text    |
|                            |     > PAN.                              |
| -   Cannot view or access  |                                         |
|     > cryptographic keys.  | -   Cannot view or access SAD.          |
|                            |                                         |
| -   Cannot view or access  | -   Cannot enable disabled device       |
|     > clear-text PAN.      |     > interfaces or disabled            |
|                            |     > data-capture mechanisms           |
| -   Cannot view or access  |                                         |
|     > SAD.                 | -   Does not use the POI vendor's       |
|                            |     > default passwords.                |
| -   Cannot enable disabled |                                         |
|     > device interfaces or |                                         |
|     > disabled             |                                         |
|     > data-capture         |                                         |
|     > mechanisms.          |                                         |
|                            |                                         |
| -   Does not use any POI   |                                         |
|     > vendor default       |                                         |
|     > device passwords.    |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-1.1.b** For a sample of all POI  |
|                            | > device types intended for use in a    |
|                            | > solution, logon to the device using   |
|                            | > an authorized test merchant account.  |
|                            | > Verify that merchant account level    |
|                            | > logical access meets the following:   |
|                            |                                         |
|                            | -   Cannot view or access device        |
|                            |     > configuration settings that could |
|                            |     > impact the security controls of   |
|                            |     > the device, or allow access to    |
|                            |     > cryptographic keys or clear- text |
|                            |     > PAN and/or SAD                    |
|                            |                                         |
|                            | -   Only views transaction-related      |
|                            |     > data.                             |
|                            |                                         |
|                            | -   Cannot view or access cryptographic |
|                            |     > keys.                             |
|                            |                                         |
|                            | -   Cannot view or access clear-text    |
|                            |     > PAN.                              |
|                            |                                         |
|                            | -   Cannot view or access SAD.          |
|                            |                                         |
|                            | -   Cannot enable disabled device       |
|                            |     > interfaces or disabled            |
|                            |     > data-capture mechanisms.          |
|                            |                                         |
|                            | -   Does not use the POI vendor's       |
|                            |     > default passwords.                |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1B: Secure  |                                         |
| logical access to POI      |                                         |
| devices***                 |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1B-1.1.1** Where there | > **1B-1.1.1.a** Review solution        |
| > is a legal or regulatory | > provider's documentation about the    |
| > obligation in a region   | > legal/regulatory obligation that      |
| > for merchants to print   | > requires merchants to have access to  |
| > full PAN on merchant     | > full PANs for receipt printing        |
| > receipts, it is          | > purposes to verify that the           |
| > allowable for the        | > documentation specifies the payment   |
| > merchant to have access  | > application(s) that facilitate        |
| > to full PAN for this     | > printing of PANs for merchants.       |
| > purpose but *ONLY* if    |                                         |
| > the following are met:   |                                         |
|                            |                                         |
| -   The solution provider  |                                         |
|     > must document which  |                                         |
|     > payment              |                                         |
|     > application(s)       |                                         |
|     > facilitates printing |                                         |
|     > of PANs for          |                                         |
|     > merchants.           |                                         |
|                            |                                         |
| -   The P2PE application   |                                         |
|     > that facilitates     |                                         |
|     > this is confirmed    |                                         |
|     > per **1A-2.1** as    |                                         |
|     > assessed to Domain 2 |                                         |
|     > and on PCI SSC's     |                                         |
|     > list of *Validated   |                                         |
|     > P2PE Applications*.  |                                         |
|                            |                                         |
| > ***Note:** Domain 2 (at  |                                         |
| > **2A-3.1.2**) and Domain |                                         |
| > 3 (at **3A- 1.3**) also  |                                         |
| > include requirements     |                                         |
| > that must be met for any |                                         |
| > P2PE application and     |                                         |
| > P2PE solution provider,  |                                         |
| > respectively, that       |                                         |
| > facilitates merchant     |                                         |
| > printing of full PAN     |                                         |
| > where there is a legal   |                                         |
| > or regulatory obligation |                                         |
| > to do so.*               |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-1.1.1.b** Review applications    |
|                            | > confirmed at **1A-2.1** to verify the |
|                            | > application(s) that facilitates       |
|                            | > printing of full PANs on merchant     |
|                            | > receipts is on PCI SSC's list of      |
|                            | > *Validated P2PE Applications.*        |
+----------------------------+-----------------------------------------+
| > **1B-1.2** All           | > **1B-1.2.a** Examine documented       |
| > solution-provider        | > authorizations to verify:             |
| > personnel with logical   |                                         |
| > access to POI devices    | -   All personnel with access to        |
| > deployed in merchant     |     > devices are documented in a       |
| > encryption environments  |     > formal list.                      |
| > must be documented in a  |                                         |
| > formal list and          | -   All personnel with access to        |
| > authorized by solution   |     > devices are authorized by         |
| > provider management. The |     > management.                       |
| > list of authorized       |                                         |
| > personnel is reviewed at | -   The list of authorized personnel is |
| > least annually.          |     > reviewed at least annually.       |
+----------------------------+-----------------------------------------+
|                            | > **1B-1.2.b** For a sample of all POI  |
|                            | > device types, examine account-access  |
|                            | > configurations to verify that only    |
|                            | > personnel documented and authorized   |
|                            | > in the formal list have access to POI |
|                            | > devices.                              |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1B: Secure  |                                         |
| logical access to POI      |                                         |
| devices***                 |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1B-1.2.1** Solution    | > **1B-1.2.1.a** Examine documented     |
| > provider personnel with  | > access-control policies and           |
| > logical access to POI    | > procedures to verify that solution    |
| > devices deployed in      | > provider personnel with logical       |
| > merchant encryption      | > access to POI devices deployed at     |
| > environments must be     | > merchant encryption environments is   |
| > granted based on least   | > assigned according to least privilege |
| > privilege and need to    | > and need to know.                     |
| > know.                    |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-1.2.1.b** For a sample of all    |
|                            | > POI devices and personnel, observe    |
|                            | > configured accounts and permissions,  |
|                            | > and interview responsible personnel   |
|                            | > to verify that the level of logical   |
|                            | > access granted is according to least  |
|                            | > privilege and need to know.           |
+----------------------------+-----------------------------------------+
| ***1B-2** Solution         |                                         |
| provider secures any       |                                         |
| remote access to POI       |                                         |
| devices deployed at        |                                         |
| merchant encryption        |                                         |
| environments.*             |                                         |
+----------------------------+-----------------------------------------+
| > **1B-2.1** Solution      | > **1B-2.1.a** Examine documented       |
| > provider's authorized    | > procedures to verify that either      |
| > personnel must use       | > multi-factor or cryptographic         |
| > multi-factor or          | > authentication must be used for all   |
| > cryptographic            | > remote access to POI devices.         |
| > authentication for all   |                                         |
| > remote access to         |                                         |
| > merchant POI devices.    |                                         |
| >                          |                                         |
| > ***Note:** Authorized    |                                         |
| > solution provider        |                                         |
| > personnel must use       |                                         |
| > multi-factor or          |                                         |
| > cryptographic            |                                         |
| > authentication for all   |                                         |
| > remote access to a       |                                         |
| > terminal management      |                                         |
| > system (TMS) or similar  |                                         |
| > system used to either    |                                         |
| > directly access or to    |                                         |
| > manage merchant POI      |                                         |
| > devices.*                |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-2.1.b** Observe remote-access    |
|                            | > mechanisms and controls to verify     |
|                            | > that either multi- factor or          |
|                            | > cryptographic authentication is       |
|                            | > configured for all remote access to   |
|                            | > POI devices.                          |
+----------------------------+-----------------------------------------+
|                            | > **1B-2.1.c** Interview personnel and  |
|                            | > observe actual remote connection      |
|                            | > attempts to verify that either        |
|                            | > multi-factor or cryptographic         |
|                            | > authentication is used for all remote |
|                            | > access to POI devices.                |
+----------------------------+-----------------------------------------+
| > **1B-2.2** POI devices   | > **1B-2.2.a** Examine documented       |
| > must be configured to    | > device-configuration procedures and   |
| > ensure that remote       | > interview personnel to verify that    |
| > access is only permitted | > devices must be configured to permit  |
| > from the solution        | > remote access only from the solution  |
| > provider's authorized    | > provider's authorized systems.        |
| > systems (which might     |                                         |
| > include a terminal       |                                         |
| > management system (TMS)  |                                         |
| > or similar system).      |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-2.2.b** For all devices used in  |
|                            | > the solution, observe a sample of     |
|                            | > device configurations to verify that  |
|                            | > remote access is permitted only from  |
|                            | > the solution provider's authorized    |
|                            | > systems.                              |
+----------------------------+-----------------------------------------+
| > **1B-2.3** POI devices   | > **1B-2.3.a** Examine documented       |
| > must be configured such  | > POI-configuration procedures and      |
| > that merchants do not    | > interview personnel to verify that    |
| > have remote access to    | > devices must be configured to ensure  |
| > the merchant POI         | > merchants do not have remote access   |
| > devices.                 | > to the POI devices.                   |
+----------------------------+-----------------------------------------+
|                            | > **1B-2.3.b** For all device types     |
|                            | > used in the solution, observe a       |
|                            | > sample of device configurations to    |
|                            | > verify that merchants do not have     |
|                            | > remote access to the POI devices.     |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1B: Secure  |                                         |
| logical access to POI      |                                         |
| devices***                 |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1B-2.4** Solution      | > **1B-2.4** Examine documentation to   |
| > provider must implement  | > verify secure identification and      |
| > secure identification    | > authentication procedures are defined |
| > and authentication       | > for remote access to POI devices      |
| > procedures for remote    | > deployed at merchant encryption       |
| > access to POI devices    | > environments.                         |
| > deployed at merchant     |                                         |
| > encryption environments. |                                         |
+----------------------------+-----------------------------------------+
| > **1B-2.5** Solution      | > **1B-2.5** Examine documentation to   |
| > Provider must maintain   | > verify that all authorized            |
| > individual               | > solution-provider personnel are       |
| > authentication           | > required to have individual           |
| > credentials for all      | > authentication credentials that are   |
| > authorized solution-     | > unique for each merchant (or if       |
| > provider personnel that  | > applicable, per centralized TMS).     |
| > are unique for each      |                                         |
| > merchant, including:     |                                         |
| >                          |                                         |
| > ***Note:** If a          |                                         |
| > centralized              |                                         |
| > terminal-management      |                                         |
| > system (TMS) is utilized |                                         |
| > to manage multiple       |                                         |
| > merchant accounts, it is |                                         |
| > acceptable for the TMS   |                                         |
| > system to only require   |                                         |
| > unique access for each   |                                         |
| > authorized               |                                         |
| > solution-provider        |                                         |
| > employee accessing the   |                                         |
| > TMS instead of requiring |                                         |
| > unique access per        |                                         |
| > merchant.*               |                                         |
+----------------------------+-----------------------------------------+
| > **1B-2.5.1** Tracing all | > **1B-2.5.1.a** Examine POI device     |
| > logical access to POI    | > configurations and authentication     |
| > devices by               | > mechanisms to verify that all logical |
| > solution-provider        | > access to POI devices by              |
| > personnel to an          | > solution-provider personnel can be    |
| > individual user.         | > traced to an individual user.         |
+----------------------------+-----------------------------------------+
|                            | > **1B-2.5.1.b** Observe a sample of    |
|                            | > authorized logical accesses and       |
|                            | > examine access records/logs to verify |
|                            | > that all logical access is traced to  |
|                            | > an individual user.                   |
+----------------------------+-----------------------------------------+
| > **1B-2.5.2** Maintaining | > **1B-2.5.2** Examine documentation to |
| > audit logs of all        | > verify that access records/logs of    |
| > logical access to POI    | > all logical access to POI devices by  |
| > devices by               | > solution-provider personnel are       |
| > solution-provider        | > required to be retained for at least  |
| > personnel and retaining  | > one year.                             |
| > access logs for at least |                                         |
| > one year.                |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1B: Secure  |                                         |
| logical access to POI      |                                         |
| devices***                 |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***1B-3** The solution   |                                         |
| > provider implements      |                                         |
| > procedures to protect    |                                         |
| > POI devices and          |                                         |
| > applications from known  |                                         |
| > vulnerabilities and      |                                         |
| > securely update          |                                         |
| > devices.*                |                                         |
+----------------------------+-----------------------------------------+
| > **1B-3.1** Secure update | > **1B-3.1.a** Examine documented       |
| > processes must be        | > procedures to verify secure update    |
| > implemented for all      | > processes are defined for all         |
| > firmware and software    | > firmware and software updates, and    |
| > updates, including:      | > include:                              |
|                            |                                         |
| -   Integrity check of     | -   Integrity checks of update          |
|     > update               |                                         |
|                            | -   Verification of the origin of the   |
| -   Verification of the    |     > update                            |
|     > origin of the update |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-3.1.b** Observe a sample of      |
|                            | > firmware and software updates, and    |
|                            | > interview personnel to verify:        |
|                            |                                         |
|                            | -   The integrity of the update is      |
|                            |     > checked                           |
|                            |                                         |
|                            | -   The origin of the update is         |
|                            |     > authenticated                     |
+----------------------------+-----------------------------------------+
| > **1B-3.2** An up-to-date | > **1B-3.2.a** Examine documented       |
| > inventory of POI device  | > procedures to verify they include:    |
| > system builds must be    |                                         |
| > maintained and confirmed | -   Procedures for maintaining an       |
| > at least annually and    |     > up-to-date inventory of POI       |
| > upon any changes to the  |     > device system builds              |
| > build.                   |                                         |
| >                          | -   Procedures for confirming all       |
| > ***Note:** A POI system  |     > builds at least annually and upon |
| > build includes at least  |     > any changes to the build          |
| > the following            |                                         |
| > information:*            |                                         |
|                            |                                         |
| -   *Model name and        |                                         |
|     > number*              |                                         |
|                            |                                         |
| -   *Hardware version      |                                         |
|     > number*              |                                         |
|                            |                                         |
| -   *Firmware version      |                                         |
|     > number(s)*           |                                         |
|                            |                                         |
| -   *P2PE Payment          |                                         |
|     > Applications*        |                                         |
|                            |                                         |
| -   *Non-payment Software* |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-3.2.b** Review documented        |
|                            | > inventory of devices, and examine the |
|                            | > inventory of system builds to verify: |
|                            |                                         |
|                            | -   The inventory includes all POI      |
|                            |     > device system builds.             |
|                            |                                         |
|                            | -   The inventory of POI device system  |
|                            |     > builds is up to date.             |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1B: Secure  |                                         |
| logical access to POI      |                                         |
| devices***                 |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1B-3.3** Critical      | > **1B-3.3.a** Examine documented       |
| > software security        | > procedures to verify they include     |
| > updates must be deployed | > defined procedures for deploying      |
| > to POI devices in the    | > critical software security updates to |
| > field within 30 days of  | > POI devices in the field within 30    |
| > receipt from device      | > days of receipt from device or        |
| > vendors or application   | > application vendors.                  |
| > vendors.                 |                                         |
| >                          |                                         |
| > ***Note:** A "critical   |                                         |
| > software security        |                                         |
| > update" is one that      |                                         |
| > addresses an imminent    |                                         |
| > risk to account data,    |                                         |
| > either directly or       |                                         |
| > indirectly.*             |                                         |
| >                          |                                         |
| > ***Note:** These         |                                         |
| > security patches can be  |                                         |
| > deployed via "push" from |                                         |
| > the solution provider or |                                         |
| > vendor, or via "pull"    |                                         |
| > from the POI device or   |                                         |
| > merchant. In all cases,  |                                         |
| > the solution provider is |                                         |
| > ultimately responsible   |                                         |
| > to ensure security       |                                         |
| > patches are installed in |                                         |
| > a timely manner.*        |                                         |
| >                          |                                         |
| > Aligns with 2C-1.2       |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-3.3.b** Examine security update  |
|                            | > deployment records and device logs,   |
|                            | > and interview responsible solution    |
|                            | > provider personnel and to verify that |
|                            | > critical security updates are         |
|                            | > deployed to devices and applications  |
|                            | > in the field within 30 days of        |
|                            | > receipt from device and application   |
|                            | > vendors.                              |
+----------------------------+-----------------------------------------+
| > **1B-3.4** The integrity | > **1B-3.4.a** Examine documented       |
| > of patch and update code | > procedures for device updates to      |
| > must be maintained       | > verify they follow guidance from the  |
| > during delivery and      | > device or application vendor to       |
| > deployment, as defined   | > maintain the integrity of all patch   |
| > by the vendor---e.g., in | > and update code during delivery and   |
| > the POI device vendor\'s | > deployment.                           |
| > security guidance or in  |                                         |
| > the P2PE application's   |                                         |
| > *Implementation Guide*.  |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-3.4.b** Observe processes for    |
|                            | > delivering updates and interview      |
|                            | > responsible personnel to verify that  |
|                            | > the integrity of patch and update     |
|                            | > code is maintained during delivery    |
|                            | > and deployment, and according to      |
|                            | > guidance from the device or           |
|                            | > application vendor.                   |
+----------------------------+-----------------------------------------+
|                            | > **1B-3.4.c** Observe authorized       |
|                            | > personnel attempt to run the update   |
|                            | > process with arbitrary code to verify |
|                            | > that the system will not allow the    |
|                            | > update to occur.                      |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1B: Secure  |                                         |
| logical access to POI      |                                         |
| devices***                 |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***1B-4** Solution       |                                         |
| > provider implements      |                                         |
| > procedures to secure     |                                         |
| > account data when        |                                         |
| > troubleshooting*         |                                         |
+----------------------------+-----------------------------------------+
| > **1B-4.1** Any PAN       | > **1B-4.1.a** Examine the solution     |
| > and/or SAD used for      | > provider's procedures for             |
| > debugging or             | > troubleshooting customer problems and |
| > troubleshooting purposes | > verify the procedures include:        |
| > must be securely         |                                         |
| > deleted. These data      | -   PAN and/or SAD is never output to   |
| > sources must be          |     > merchant environments             |
| > collected in limited     |                                         |
| > amounts and collected    | -   Collection of PAN and/or SAD only   |
| > only when necessary to   |     > when needed to solve a specific   |
| > resolve a problem,       |     > problem                           |
| > encrypted while stored,  |                                         |
| > and deleted immediately  | -   Storage of such data in a specific, |
| > after use.               |     > known location with limited       |
|                            |     > access                            |
|                            |                                         |
|                            | -   Collection of only a limited amount |
|                            |     > of data needed to solve a         |
|                            |     > specific problem                  |
|                            |                                         |
|                            | -   Encryption of PAN and/or SAD while  |
|                            |     > stored                            |
|                            |                                         |
|                            | -   Secure deletion of such data        |
|                            |     > immediately after use             |
+----------------------------+-----------------------------------------+
|                            | > **1B-4.1.b** For a sample of recent   |
|                            | > troubleshooting requests, observe     |
|                            | > data collection and storage           |
|                            | > locations, and interview responsible  |
|                            | > personnel to verify the procedures    |
|                            | > identified at **1B-4.1.a** were       |
|                            | > followed.                             |
+----------------------------+-----------------------------------------+
| > ***1B-5** The P2PE       |                                         |
| > solution provides        |                                         |
| > auditable logs of any    |                                         |
| > changes to critical      |                                         |
| > functions of the POI     |                                         |
| > device(s).*              |                                         |
+----------------------------+-----------------------------------------+
| > **1B-5.1** Any changes   | > **1B-5.1.a** Examine device and/or    |
| > to critical functions of | > system configurations to verify that  |
| > POI devices must be      | > any changes to the critical functions |
| > logged---either on the   | > of the POI devices are logged,        |
| > device or within the     | > including:                            |
| > remote-management        |                                         |
| > systems of the P2PE      | -   Changes to the applications within  |
| > solution provider.       |     > the device                        |
| >                          |                                         |
| > ***Note:** Critical      | -   Changes to the firmware within the  |
| > functions include        |     > device                            |
| > application and firmware |                                         |
| > updates as well as       | -   Changes to any security-sensitive   |
| > changes to               |     > configuration options within the  |
| > security-sensitive       |     > device (including whitelists and  |
| > configuration options,   |     > debug modes)                      |
| > such as whitelists or    |                                         |
| > debug modes.*            |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1B-5.1.b** Observe authorized       |
|                            | > personnel perform authorized changes  |
|                            | > on POI devices, as follows, and       |
|                            | > examine log files to verify that all  |
|                            | > such activities result in a           |
|                            | > correlating log file:                 |
|                            |                                         |
|                            | -   Changes to the applications within  |
|                            |     > the device                        |
|                            |                                         |
|                            | -   Changes to the firmware within the  |
|                            |     > device                            |
|                            |                                         |
|                            | -   Changes to any security-sensitive   |
|                            |     > configuration options within the  |
|                            |     > device (including whitelists and  |
|                            |     > debug modes)                      |
+----------------------------+-----------------------------------------+
|                            | > **1B-5.1.c** Examine documented       |
|                            | > procedures and sample logs to ensure  |
|                            | > access to logs is limited to          |
|                            | > need-to-know personnel and the        |
|                            | > integrity of logs is maintained and   |
|                            | > verified.                             |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark26            |                                         |
| .anchor}***Requirement 1C: |                                         |
| Use applications that      |                                         |
| protect PAN and SAD***     |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***1C-1** Applications are |                                         |
| implemented securely,      |                                         |
| including when using       |                                         |
| shared resources and when  |                                         |
| updating applications and  |                                         |
| application                |                                         |
| functionality.*            |                                         |
+----------------------------+-----------------------------------------+
| > **1C-1.1** Processes for | > **1C-1.1** Review documented policies |
| > any whitelisting         | > and procedures and interview          |
| > functionality must       | > personnel to verify that processes    |
| > include:                 | > for implementing any whitelisting     |
|                            | > functionality include:                |
| -   Implementing           |                                         |
|     > whitelisting         | -   Following the device vendor\'s      |
|     > functionality in     |     > security guidance or the          |
|     > accordance with the  |     > application's                     |
|     > device vendor\'s     |                                         |
|     > security guidance or | > *Implementation Guide*                |
|     > the application's    |                                         |
|     > *Implementation      | -   Cryptographic signing (or similar)  |
|     > Guide*               |     > prior to installation on the POI  |
|                            |     > device by authorized personnel    |
| -   Cryptographic signing  |     > using dual control                |
|     > (or similar) prior   |                                         |
|     > to installation on   | -   Cryptographic authentication of     |
|     > the POI device by    |     > whitelisting functionality by the |
|     > authorized personnel |     > POI device's firmware             |
|     > using dual control   |                                         |
|                            | -   Review of whitelist functionality   |
| -   Cryptographic          |     > to confirm it only outputs        |
|     > authentication by    |     > non-PCI payment brand             |
|     > the POI device's     |     > account/card data                 |
|     > firmware             |                                         |
|                            | -   Approval of functionality by        |
| -   Review of whitelist    |     > authorized personnel prior to     |
|     > functionality to     |     > implementation                    |
|     > confirm it only      |                                         |
|     > outputs non-PCI      | -   Documentation for all new           |
|     > payment brand        |     > installations and updates to      |
|     > account/card data    |     > whitelist functionality that      |
|                            |     > includes the following:           |
| -   Approval of            |                                         |
|     > functionality by     |     -   Description and justification   |
|     > authorized personnel |         > for the functionality         |
|     > prior to             |                                         |
|     > implementation       |     -   The identity of the authorized  |
|                            |         > person who approved the new   |
| -   Documentation for all  |         > installation or updated       |
|     > new installations or |         > functionality prior to        |
|     > updates to whitelist |         > release                       |
|     > functionality that   |                                         |
|     > includes the         |     -   Confirmation that it was        |
|     > following:           |         > reviewed prior to release to  |
|                            |         > only output non-PCI payment   |
|     -   Description and    |         > brand account/card data       |
|         > justification    |                                         |
|         > for the          |                                         |
|         > functionality    |                                         |
|                            |                                         |
|     -   The identity of    |                                         |
|         > the authorized   |                                         |
|         > person who       |                                         |
|         > approved the new |                                         |
|         > installation or  |                                         |
|         > updated          |                                         |
|         > functionality    |                                         |
|         > prior to release |                                         |
|                            |                                         |
|     -   Confirmation that  |                                         |
|         > it was reviewed  |                                         |
|         > prior to release |                                         |
|         > to only output   |                                         |
|         > non-PCI payment  |                                         |
|         > brand            |                                         |
|         > account/card     |                                         |
|         > data             |                                         |
|                            |                                         |
| > Aligns with 2A-3.4       |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1C: Use     |                                         |
| applications that protect  |                                         |
| PAN and SAD***             |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1C-1.1.1** Any         | > **1C-1.1.1.a** Observe application    |
| > whitelisting             | > and device configurations and         |
| > functionality must only  | > interview personnel to verify that    |
| > allow the output of      | > whitelisting functionality only       |
| > clear-text account data  | > allows for the output of non-PCI      |
| > for non-PCI payment      | > payment brand accounts/cards, by      |
| > brand account/card data. | > following guidance in either the      |
|                            | > device vendor\'s security guidance or |
|                            | > the application's *Implementation     |
|                            | > Guide*.                               |
+----------------------------+-----------------------------------------+
|                            | > **1C-1.1.1.b** For all device types   |
|                            | > with whitelisting functionality,      |
|                            | > perform test transactions to verify   |
|                            | > the output of clear-text account data |
|                            | > is only enabled for non- PCI payment  |
|                            | > brand account/card data.              |
+----------------------------+-----------------------------------------+
| > **1C-1.1.2** Any new     | > **1C-1.1.2** Observe the process for  |
| > installations of, or     | > new installations of, or updates to,  |
| > updates, to whitelisting | > whitelisting functionality and        |
| > functionality must be:   | > interview personnel to verify they    |
|                            | > are performed as follows:             |
| -   Cryptographically      |                                         |
|     > signed (or similar)  | -   Cryptographically signed (or        |
|     > prior to             |     > similar) prior to installation on |
|     > installation on the  |     > the POI device only by authorized |
|     > POI device only by   |     > personnel using dual control      |
|     > authorized personnel |                                         |
|     > using dual control.  | -   Cryptographically authenticated by  |
|                            |     > the POI device firmware, in       |
| -   Cryptographically      |     > accordance with the device        |
|     > authenticated by the |     > vendor\'s security guidance or    |
|     > POI device's         |     > the application's *Implementation |
|     > firmware in          |     > Guide*                            |
|     > accordance with the  |                                         |
|     > device vendor\'s     |                                         |
|     > security guidance or |                                         |
|     > the application's    |                                         |
|     > *Implementation      |                                         |
|     > Guide.*              |                                         |
+----------------------------+-----------------------------------------+
| > **1C-1.1.3** Any new     | > **1C-1.1.3** Review records of both   |
| > installations of, or     | > new installations and updated         |
| > updates to, whitelisting | > whitelisting functionality, and       |
| > functionality must       | > confirm they include the following:   |
| > follow change-control    |                                         |
| > procedures that include: | -   Coverage for both new installations |
|                            |     > and updates to such functionality |
| -   Coverage for both new  |                                         |
|     > installations and    | -   Description and justification for   |
|     > updates to such      |     > the functionality.                |
|     > functionality        |                                         |
|                            | -   The identity of the person who      |
| -   Description and        |     > approved the new installation or  |
|     > justification for    |     > update prior to release           |
|     > the functionality    |                                         |
|                            | -   Confirmation that it was reviewed   |
| -   The identity of the    |     > prior to release to only output   |
|     > person who approved  |     > non-PCI payment account/card data |
|     > the new installation |                                         |
|     > or update prior to   |                                         |
|     > release              |                                         |
|                            |                                         |
| -   Confirmation that it   |                                         |
|     > was reviewed prior   |                                         |
|     > to release to only   |                                         |
|     > output non-PCI       |                                         |
|     > payment account/card |                                         |
|     > data                 |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1C: Use     |                                         |
| applications that protect  |                                         |
| PAN and SAD***             |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***1C-2** All              |                                         |
| applications/software      |                                         |
| without a business need do |                                         |
| not have access to         |                                         |
| clear-text account data.*  |                                         |
+----------------------------+-----------------------------------------+
| ***Note:** Requirements at |                                         |
| 1C-2 are the only          |                                         |
| requirements applicable to |                                         |
| applications/software      |                                         |
| (non-payment software) on  |                                         |
| PCI-approved POI devices   |                                         |
| with no access to          |                                         |
| clear-text account data    |                                         |
| (e.g., a loyalty or        |                                         |
| advertising application).  |                                         |
| However, requirements in   |                                         |
| Domain 5 apply to the SCD  |                                         |
| used for signing           |                                         |
| non-payment software as    |                                         |
| well as the associated     |                                         |
| cryptographic keys and key |                                         |
| management.*               |                                         |
+----------------------------+-----------------------------------------+
| > **1C-2.1** Processes     | > **1C-2.1** Review the solution        |
| > must be documented and   | > provider's documented processes and   |
| > implemented to ensure    | > interview responsible personnel to    |
| > that, prior to new       | > confirm the processes include:        |
| > installations or         |                                         |
| > updates, any non-payment | -   Review of the non-payment software  |
| > software:                |     > vendor's documentation to         |
|                            |     > determine all logical interfaces  |
| -   Does not have any      |     > used by the non-payment software  |
|     > logical interfaces   |     > do not allow for the storing,     |
|     > (e.g., application   |     > processing, or transmitting of    |
|     > programming          |     > clear-text account data           |
|     > interfaces \[APIs\]) |                                         |
|     > that allow for the   | -   Documenting how the solution        |
|     > storing, processing, |     > provider confirmed that the       |
|     > or transmitting of   |     > non-payment software has no       |
|     > clear-text account   |     > logical interfaces that allow for |
|     > data.                |     > storing, processing, or           |
|                            |     > transmitting clear-text account   |
| -   Is cryptographically   |     > data                              |
|     > authenticated by the |                                         |
|     > POI device's         | -   Authentication of the non-payment   |
|     > firmware.            |     > software by the POI device's      |
|                            |     > firmware                          |
| -   Requires an SCD with   |                                         |
|     > dual control for the | -   Requiring an SCD with dual control  |
|     > application-signing  |     > to sign the non-payment software  |
|     > process.             |                                         |
|                            | -   Following this process both for new |
|                            |     > installations and for updates     |
+----------------------------+-----------------------------------------+
| > **1C-2.1.1** The         | > **1C-2.1.1** For each POI device type |
| > non-payment software     | > and each non-payment software         |
| > does not have any        | > intended for that POI device type     |
| > logical                  | > that does not have a business need to |
| > interfaces---e.g.,       | > access clear-text account data,       |
| > application programming  | > review the non-payment software       |
| > interfaces (APIs)---that | > vendor's documentation to verify that |
| > allow for storing,       | > the non-payment software has no       |
| > processing, or           | > logical interfaces that allows for    |
| > transmitting clear-text  | > storing, processing, or transmitting  |
| > account data.            | > clear-text account data.              |
+----------------------------+-----------------------------------------+
| > **1C-2.1.2** The         | > **1C-2.1.2** Interview                |
| > non-payment software is  | > solution-provider personnel and       |
| > authenticated within the | > observe the process for new           |
| > POI device using an      | > installations or updates of           |
| > approved security        | > non-payment software to verify that   |
| > mechanism of the POI     | > it is authenticated to the POI device |
| > device.                  | > using an approved security mechanism  |
|                            | > of the POI device.                    |
+----------------------------+-----------------------------------------+
| > **1C-2.1.3** Requires an | > **1C-2.1.3** Interview                |
| > SCD with dual control    | > solution-provider personnel and       |
| > for the                  | > observe processes for new             |
| > application-signing      | > installations or updates of           |
| > process (i.e., signing   | > non-payment software to confirm that  |
| > non-payment software).   | > application signing process is        |
|                            | > performed under dual control using an |
|                            | > SCD.                                  |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| > []{#_bookmark27          |                                         |
| > .anchor}***Requirement   |                                         |
| > 1D: Implement secure     |                                         |
| > application-management   |                                         |
| > processes***             |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***1D-1** Integrity of   |                                         |
| > applications is          |                                         |
| > maintained during        |                                         |
| > installation and         |                                         |
| > updates.*                |                                         |
+----------------------------+-----------------------------------------+
| > **1D-1.1** Processes     | > **1D-1.1.a** Review the solution      |
| > must be documented and   | > provider's documented processes for   |
| > implemented to manage    | > implementing changes to applications, |
| > all changes to           | > and interview solution-provider       |
| > applications, including: | > personnel, and confirm the following  |
|                            | > processes are in place:               |
| -   Following vendor       |                                         |
|     > guidance in the      | -   Guidance in the *Implementation     |
|     > application's        |     > Guide* is followed.               |
|                            |                                         |
| > *Implementation Guide*   | -   All changes to applications include |
|                            |     > documented approval by            |
| -   Documented approval    |     > appropriate authorized            |
|     > for all changes by   |     > solution-provider personnel.      |
|     > appropriate          |                                         |
|     > personnel            | -   All changes to applications are     |
|                            |     > documented as to reason and       |
| -   Documented reason and  |     > impact of the change.             |
|     > impact for all       |                                         |
|     > changes              | -   Functionality testing of all        |
|                            |     > changes on the intended devices   |
| -   Functionality testing  |     > is performed.                     |
|     > of all changes on    |                                         |
|     > the intended         | -   Documentation includes back-out     |
|     > device(s)            |     > procedures for application        |
|                            |     > installations/updates.            |
| -   Documented back-out    |                                         |
|     > procedures for       |                                         |
|     > application          |                                         |
|                            |                                         |
|    > installations/updates |                                         |
|                            |                                         |
| > ***Note:** Modifications |                                         |
| > (e.g., adding an         |                                         |
| > application or a POI     |                                         |
| > device) to a PCI-listed  |                                         |
| > P2PE Solution (or        |                                         |
| > Component) requires an   |                                         |
| > assessment per PCI's     |                                         |
| > "Delta Change" process.  |                                         |
| > See the P2PE Program     |                                         |
| > Guide for more           |                                         |
| > information.*            |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1D-1.1.b** Review records of        |
|                            | > changes to applications and, and      |
|                            | > confirm the following:                |
|                            |                                         |
|                            | -   All *Implementation Guide*          |
|                            |     > requirements were followed.       |
|                            |                                         |
|                            | -   Approval of the change by           |
|                            |     > appropriate parties is            |
|                            |     > documented.                       |
|                            |                                         |
|                            | -   The documentation includes reason   |
|                            |     > and impact of the change.         |
|                            |                                         |
|                            | -   The documentation describes         |
|                            |     > functionality testing that was    |
|                            |     > performed.                        |
|                            |                                         |
|                            | -   Documentation includes back-out     |
|                            |     > procedures for application        |
|                            |     > installations/updates.            |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| > ***Requirement 1D:       |                                         |
| > Implement secure         |                                         |
| > application-management   |                                         |
| > processes***             |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1D-1.2** All new       | > **1D-1.2** Review the solution        |
| > installations and        | > provider's documentation and confirm  |
| > updates to applications  | > their documented processes include    |
| > must be authenticated as | > using the guidance in the             |
| > follows:                 | > application's *Implementation Guide*  |
| >                          | > for any application installations and |
| > Aligns with 2C-2.1       | > updates.                              |
+----------------------------+-----------------------------------------+
| > **1D-1.2.1** All         | > **1D-1.2.1** Confirm the following    |
| > applications must be     | > through interviews with responsible   |
| > cryptographically signed | > solution provider personnel and by    |
| > (or similar) prior to    | > observing an installation/update:     |
| > installation on the POI  |                                         |
| > device only by           | -   Cryptographic signing processes for |
| > authorized personnel     |     > applications are followed as      |
| > using dual control.      |     > specified in the *Implementation  |
|                            |     > Guide*.                           |
|                            |                                         |
|                            | -   Cryptographic signing (or similar)  |
|                            |     > is performed prior to             |
|                            |     > installation only by authorized   |
|                            |     > personnel using dual control.     |
|                            |                                         |
|                            | -   All new installations and updates   |
|                            |     > to applications are signed prior  |
|                            |     > to installation on the device.    |
|                            |                                         |
|                            | -   Cryptographic signing for new       |
|                            |     > installations and updates to      |
|                            |     > applications is done under dual   |
|                            |     > control.                          |
+----------------------------+-----------------------------------------+
| > **1D-1.3** Processes     | > **1D-1.3.a** Review the solution      |
| > must be in place to      | > provider's documentation and confirm  |
| > implement application    | > their documented processes include    |
| > developer guidance on    | > application developer key-management  |
| > key and certificate      | > security guidance.                    |
| > usage from the           |                                         |
| > application's            |                                         |
| > *Implementation Guide*.  |                                         |
| >                          |                                         |
| > Aligns with 2B-3.1.1     |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1D-1.3.b** Interview                |
|                            | > solution-provider personnel to        |
|                            | > confirm that they follow key-         |
|                            | > management security guidance in       |
|                            | > accordance with the *Implementation   |
|                            | > Guide*.                               |
+----------------------------+-----------------------------------------+
| ***1D-2** Maintain         |                                         |
| instructional              |                                         |
| documentation and training |                                         |
| programs for the           |                                         |
| application's              |                                         |
| installation,              |                                         |
| maintenance/upgrades, and  |                                         |
| use.*                      |                                         |
+----------------------------+-----------------------------------------+
| > **1D-2.1** Upon receipt  | > **1D-2.1** Interview                  |
| > from the application     | > solution-provider personnel and       |
| > vendor, a current copy   | > examine documentation (including a    |
| > of the application       | > current copy of the *Implementation   |
| > vendor's *Implementation | > Guide* from the application vendor)   |
| > Guide* must be retained  | > to confirm the following:             |
| > and distributed to any   |                                         |
| > outsourced               | -   The solution provider retains a     |
| > integrators/resellers    |     > current copy of the               |
| > used for the P2PE        |     > *Implementation Guide*.           |
| > solution.                |                                         |
| >                          | -   The solution provider distributes   |
| > Aligns with 2C-3.1.3     |     > the *Implementation Guide* to any |
|                            |     > outsourced integrators/resellers  |
|                            |     > the solution provider uses for    |
|                            |     > the P2PE solution upon obtaining  |
|                            |     > updates from the application      |
|                            |     > vendor.                           |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark28            |                                         |
| .anchor}***Requirement 1E: |                                         |
| Component providers ONLY:  |                                         |
| report status to solution  |                                         |
| providers***               |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***1E-1 For component      |                                         |
| providers of               |                                         |
| encryption-management      |                                         |
| services, maintain and     |                                         |
| monitor critical P2PE      |                                         |
| controls and provide       |                                         |
| reporting to the           |                                         |
| responsible solution       |                                         |
| provider.***               |                                         |
+----------------------------+-----------------------------------------+
| ***Note:** This section is |                                         |
| ONLY applicable for P2PE   |                                         |
| component providers        |                                         |
| undergoing an assessment   |                                         |
| of this domain for         |                                         |
| subsequent PCI listing of  |                                         |
| the component provider's   |                                         |
| encryption management      |                                         |
| services. This section is  |                                         |
| not applicable to, and     |                                         |
| does not need to be        |                                         |
| completed by, P2PE         |                                         |
| solution providers (or     |                                         |
| merchants as solution      |                                         |
| providers) that include    |                                         |
| encryption management      |                                         |
| functions in their P2PE    |                                         |
| solution assessment        |                                         |
| (whether those functions   |                                         |
| are performed by the       |                                         |
| solution provider or are   |                                         |
| outsourced to non-PCI      |                                         |
| listed third parties).*    |                                         |
+----------------------------+-----------------------------------------+
| > **1E-1.1** Track status  | > **1E-1.1.a** Review component         |
| > of the                   | > provider's documented procedures for  |
| > encryption-management    | > providing required reporting to       |
| > services and provide     | > applicable solution providers, and    |
| > reports to solution      | > interview responsible component-      |
| > provider annually and    | > provider personnel, and to confirm    |
| > upon significant         | > that the following processes are      |
| > changes, including at    | > documented and implemented (per       |
| > least the following (per | > merchant location):                   |
| > merchant location):      |                                         |
|                            | -   Types/models of POI devices         |
| -   Types/models of POI    |                                         |
|     > devices              | -   Number of devices deployed and      |
|                            |     > change since last report          |
| -   Number of POI devices  |                                         |
|     > deployed and any     | -   Date of last inventory of POI       |
|     > change in numbers    |     > device system builds              |
|     > since last report    |                                         |
|                            | -   Date list of personnel with logical |
| -   Date of last inventory |     > remote access to deployed         |
|     > of POI device system |     > merchant POI devices was last     |
|     > builds               |     > reviewed/updated                  |
|                            |                                         |
| -   Date when list of      |                                         |
|     > personnel with       |                                         |
|     > logical remote       |                                         |
|     > access to deployed   |                                         |
|     > merchant POI devices |                                         |
|     > was last             |                                         |
|     > reviewed/updated     |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1E-1.1.b** Observe reports provided |
|                            | > to applicable solution providers      |
|                            | > annually and upon significant changes |
|                            | > to the solution, and confirm they     |
|                            | > include at least the following:       |
|                            |                                         |
|                            | -   Types/models of POI devices         |
|                            |                                         |
|                            | -   Number of POI devices deployed and  |
|                            |     > any change in numbers since last  |
|                            |     > report                            |
|                            |                                         |
|                            | -   Date of last inventory of POI       |
|                            |     > device system builds              |
|                            |                                         |
|                            | -   Date when list of personnel with    |
|                            |     > logical remote access to deployed |
|                            |     > merchant POI devices was last     |
|                            |     > reviewed/updated                  |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 1E:         |                                         |
| Component providers ONLY:  |                                         |
| report status to solution  |                                         |
| providers***               |                                         |
+============================+=========================================+
| > **Domain 1               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **1E-1.2** Manage and    | > **1E-1.2.a** Review component         |
| > monitor changes to       | > provider's documented procedures and  |
| > encryption- management   | > interview responsible                 |
| > services and notify the  | > component-provider personnel, and     |
| > solution provider upon   | > confirm that processes include        |
| > occurrence of any of the | > notifying the solution provider upon  |
| > following:               | > occurrence of the following:          |
|                            |                                         |
| -   Critical software      | -   Critical software security updates  |
|     > security updates     |     > deployed to POI devices           |
|     > deployed to POI      |                                         |
|     > devices              | -   Addition and/or removal of POI      |
|                            |     > device types                      |
| -   Addition and/or        |                                         |
|     > removal of POI       | -   Adding, changing, and/or removing   |
|     > device types         |     > P2PE applications on POI devices  |
|                            |     > (with access to clear-text        |
| -   Adding, changing,      |     > account data), including          |
|     > and/or removing P2PE |     > description of change             |
|     > applications on POI  |                                         |
|     > devices (i.e.,       | -   Adding, changing, and/or removing   |
|     > software with access |     > P2PE non-payment software on POI  |
|     > to clear-text        |     > devices (without access to        |
|     > account data),       |     > clear-text account data),         |
|     > including            |     > including description of change   |
|     > description of       |                                         |
|     > change               | -   Updated list of POI devices, P2PE   |
|                            |     > applications, and/or P2PE         |
| -   Adding, changing,      |     > non-payment software              |
|     > and/or removing P2PE |                                         |
|     > non- payment         |                                         |
|     > software on POI      |                                         |
|     > devices (i.e.,       |                                         |
|     > software without     |                                         |
|     > access to clear-text |                                         |
|     > account data),       |                                         |
|     > including            |                                         |
|     > description of       |                                         |
|     > change               |                                         |
|                            |                                         |
| -   Updated list of POI    |                                         |
|     > devices, P2PE        |                                         |
|     > applications, and/or |                                         |
|     > P2PE non-payment     |                                         |
|     > software             |                                         |
|                            |                                         |
| > ***Note:** Adding,       |                                         |
| > changing, or removing    |                                         |
| > POI device types, P2PE   |                                         |
| > applications, and/or     |                                         |
| > P2PE non-payment         |                                         |
| > software may require     |                                         |
| > adherence to PCI SSC's   |                                         |
| > process for making       |                                         |
| > changes. Please refer to |                                         |
| > the P2PE Program Guide   |                                         |
| > for details about        |                                         |
| > obligations when adding, |                                         |
| > changing, or removing    |                                         |
| > elements of a P2PE       |                                         |
| > solution.*               |                                         |
+----------------------------+-----------------------------------------+
|                            | > **1E-1.2.b** Observe reports provided |
|                            | > to applicable solution providers, and |
|                            | > confirm at least the following are    |
|                            | > reported upon occurrence:             |
|                            |                                         |
|                            | -   Critical software security updates  |
|                            |     > deployed to POI devices           |
|                            |                                         |
|                            | -   Addition and/or removal of POI      |
|                            |     > device types                      |
|                            |                                         |
|                            | -   Adding, changing, and/or removing   |
|                            |     > P2PE applications on POI devices  |
|                            |     > (with access to clear-text        |
|                            |     > account data), including          |
|                            |     > description of change             |
|                            |                                         |
|                            | -   Adding, changing, and/or removing   |
|                            |     > P2PE non-payment software         |
|                            |     > (without access to clear-text     |
|                            |     > account data), including          |
|                            |     > description of change             |
|                            |                                         |
|                            | -   Updated list of POI devices, P2PE   |
|                            |     > applications, and/or P2PE         |
|                            |     > non-payment software              |
+----------------------------+-----------------------------------------+

# Domain 2: Application Security

+--------------+------------------+-----------------------------------+
| > **Domain** | > **Overview**   | > **P2PE Validation               |
|              |                  | > Requirements**                  |
+==============+==================+===================================+
| > **Domain   | The secure       | **2A** Protect PAN and SAD.       |
| > 2:         | development of   |                                   |
| >            | payment          | **2B** Develop and maintain       |
|  Application | applications     | secure applications.              |
| > Security** | designed to have |                                   |
|              | access to        | **2C** Implement secure           |
|              | clear-text       | application-management processes. |
|              | account data     |                                   |
|              | intended solely  |                                   |
|              | for installation |                                   |
|              | on PCI-approved  |                                   |
|              | POI devices as   |                                   |
|              | part of a P2PE   |                                   |
|              | solution.        |                                   |
+--------------+------------------+-----------------------------------+

> ***Target audience:** Application vendors designing applications (that
> have access to clear-text account data) for use within PCI-approved
> POI devices as part of a P2PE solution.*

#### *Overview*

> Although point-of-interaction (POI) devices are often considered as
> "hardware" devices, software is often added to POI devices after the
> PIN Transaction Security (PTS) evaluation and approval. (Such a device
> is referred to as a "PCI-approved POI device" after the PTS evaluation
> and approval is complete.) It is vital to the security of these
> devices---and the systems that rely on the operation of these
> devices---that any such software is assessed to confirm its secure
> operation. To this end, P2PE requirements specify both the
> confirmation that a PCI-approved POI device is in use and that P2PE
> applications and P2PE non-payment software are installed and
> configured on the device properly (Domain 1), as well as the
> independent assessment of all P2PE applications (with access to
> clear-text account data) that are resident within the POI device
> (Domain 2).
>
> required to meet requirements specified at **1C-2** and are not
> required to meet Domain 2 requirements.
>
> See ["P2PE Solutions and use of Third Parties and/or P2PE Component
> Providers"](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)
> for more information about P2PE applications and software, and about
> validating P2PE applications per this domain.

#### *Use of a "Test Platform"*

> To facilitate testing applications in accordance with the test
> procedures contained in this standard, it may be necessary for the
> application vendor to provide a test platform. A test platform is
> considered to be special test functionality that is either separate or
> absent from production-level code. The test platform must rely on as
> much underlying intended production-level functionality as possible.
> The test platform is only to serve the purpose of providing a test
> framework that allows for application functionality to be exercised
> outside of a P2PE production-level deployment environment in order to
> verify the application's compliance to the applicable P2PE
> requirements. For example, elevated privileges or access capabilities
> may need to be granted for the purpose of providing run-time
> visibility into various facets of the application\'s functionality.
> Other examples are providing a test function to initiate a test
> transaction or simulating an ECR connection. It is at the P2PE
> assessor's discretion to request any test functionality deemed
> required to verify the application's compliance to any applicable P2PE
> requirements.

#### *Domain 2 Informative Annex -- Application's Implementation Guide*

> There are multiple requirements throughout Domain 2 covering content
> for the application's *Implementation Guide*, which is a required
> document per **2C-3.** All requirements for the *Implementation Guide*
> are summarized in the *Domain 2 Informative Annex*.

+-----------------------------+----------------------------------------+
| []{#_bookmark33             |                                        |
| .anchor}***Requirement 2A:  |                                        |
| Protect PAN and SAD***      |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > ***2A-1** The application |                                        |
| > executes on a             |                                        |
| > PCI-approved POI device   |                                        |
| > with SRED enabled and     |                                        |
| > active.*                  |                                        |
+-----------------------------+----------------------------------------+
| > **2A-1.1** The            | > **2A-1.1** For each POI device type  |
| > application must be       | > used by the application, examine the |
| > intended for use on a POI | > POI device configurations and review |
| > device approved per the   | > the PCI SSC list of Approved PTS     |
| > PCI PTS program, with     | > Devices to verify that all of the    |
| > SRED (secure reading and  | > following POI device characteristics |
| > exchange of data). The    | > match the PTS listing:               |
| > PTS approval listing must |                                        |
| > match the following       | -   Model name/number                  |
| > characteristics:          |                                        |
|                             | -   Hardware version number            |
| -   Model name and number   |                                        |
|                             | -   Firmware version number            |
| -   Hardware version number |                                        |
|                             | -   SRED listed as a function provided |
| -   Firmware version number |                                        |
|                             |                                        |
| -   SRED listed as a        |                                        |
|     > function provided     |                                        |
+-----------------------------+----------------------------------------+
| > **2A-1.2** The            | > **2A-1.2** For each type of POI      |
| > application must only use | > device being assessed as part of the |
| > the PTS SRED- validated   | > application assessment, verify that  |
| > account-data capture      | > the application only uses            |
| > mechanisms of the         | > SRED-validated account data capture  |
| > underlying POI device for | > mechanisms.                          |
| > accepting and processing  |                                        |
| > P2PE transactions.        |                                        |
+-----------------------------+----------------------------------------+
| ***2A-2** The application   |                                        |
| does not store PAN and/or   |                                        |
| SAD for any longer than     |                                        |
| business processes          |                                        |
| require.*                   |                                        |
+-----------------------------+----------------------------------------+
| > **2A-2.1** The            | > **2A-2.1.a** Interview software      |
| > application vendor must   | > personnel and examine the            |
| > maintain current          | > application's design documentation   |
| > documentation for all     | > to verify it documents all flows and |
| > flows and provide a       | > justifies all uses of PAN and/or SAD |
| > business justification    | > input into, processed by, and output |
| > for all uses of PAN       | > from the application.                |
| > and/or SAD input into,    |                                        |
| > processed by, and output  |                                        |
| > from the application.     |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2A-2.1.b** Perform a source-code   |
|                             | > review and verify that PAN and/or    |
|                             | > SAD are only utilized according to   |
|                             | > the documentation.                   |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2A-2.2** The            | > **2A-2.2.a** Examine the             |
| > application must not      | > application's design documentation   |
| > store PAN and/or SAD      | > and verify it includes a description |
| > (even if encrypted) as    | > of the following:                    |
| > follows:                  |                                        |
|                             | -   How it uses PAN and/or SAD for its |
| -   Application must not    |     > application processing           |
|     > store PAN data after  |                                        |
|     > the payment           | -   How it ensures the application     |
|     > transaction is        |     > does not store PAN after the     |
|     > complete.             |     > payment transaction is complete  |
|                             |                                        |
| -   Application must not    | -   How it ensures the application     |
|     > store SAD after       |     > does not store SAD after         |
|     > authorization is      |     > authorization is complete        |
|     > complete.             |                                        |
|                             |                                        |
| > ***Note:** Storage of     |                                        |
| > encrypted PAN data is     |                                        |
| > acceptable during the     |                                        |
| > business process of       |                                        |
| > finalizing the payment    |                                        |
| > transaction if needed     |                                        |
| > (e.g., offline            |                                        |
| > transactions). However,   |                                        |
| > at all times, SAD is not  |                                        |
| > stored after              |                                        |
| > authorization is          |                                        |
| > complete.*                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2A-2.2.b** Perform a source-code   |
|                             | > review to verify that the            |
|                             | > application is designed such that:   |
|                             |                                        |
|                             | -   PAN is not stored after the        |
|                             |     > payment transaction is           |
|                             |     > completed.                       |
|                             |                                        |
|                             | -   SAD is not stored after            |
|                             |     > authorization is completed.      |
+-----------------------------+----------------------------------------+
|                             | > **2A-2.2.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify      |
|                             | > that:                                |
|                             |                                        |
|                             | -   PAN is not stored after the        |
|                             |     > payment transaction is           |
|                             |     > completed.                       |
|                             |                                        |
|                             | -   SAD is not stored after            |
|                             |     > authorization is completed.      |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2A-2.3** The            | > **2A-2.3.a** Examine the             |
| > application must not      | > application's design documentation   |
| > retain PAN and/or SAD in  | > and verify it contains a detailed    |
| > working memory any longer | > description of the function of the   |
| > than strictly necessary.  | > application, including how it        |
|                             | > ensures the application does not     |
|                             | > retain PAN and/or SAD in working     |
|                             | > memory any longer than strictly      |
|                             | > necessary.                           |
+-----------------------------+----------------------------------------+
|                             | > **2A-2.3.b** Perform a source-code   |
|                             | > review and verify that PAN and/or    |
|                             | > SAD is cleared from all working      |
|                             | > memory locations after use,          |
|                             | > including local variables (before    |
|                             | > exiting the function).               |
+-----------------------------+----------------------------------------+
|                             | > **2A-2.3.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify the  |
|                             | > application clears all working       |
|                             | > memory locations utilized for the    |
|                             | > temporal retention of PAN and/or SAD |
|                             | > during processing.                   |
+-----------------------------+----------------------------------------+
| > **2A-2.4** The            | **2A-2.4.a** Examine the application's |
| > application must securely | design documentation and verify it     |
| > delete any PAN and/or SAD | describes the process used by the      |
| > that was stored during    | application to securely delete any PAN |
| > application processing.   | and/or SAD that was stored during      |
|                             | application processing.                |
+-----------------------------+----------------------------------------+
|                             | **2A-2.4.b** Perform a source-code     |
|                             | review and verify that the process     |
|                             | provided by the application vendor     |
|                             | renders all stored PAN and/or SAD      |
|                             | irrecoverable once application         |
|                             | processing is completed, in accordance |
|                             | with industry-accepted standards for   |
|                             | secure deletion of data.               |
+-----------------------------+----------------------------------------+
|                             | **2A-2.4.c** Install and configure the |
|                             | application according to the           |
|                             | application vendor's documentation,    |
|                             | including the application's            |
|                             | *Implementation Guide.* Using an       |
|                             | appropriate "test platform" (if        |
|                             | necessary), perform test transactions  |
|                             | that utilize all functions of the      |
|                             | application that handle account data.  |
|                             | Use forensic tools and/or methods      |
|                             | (commercial tools, scripts, etc.) to   |
|                             | verify that the process provided by    |
|                             | the application renders all PAN and/or |
|                             | SAD data irrecoverable, in accordance  |
|                             | with industry-accepted standards for   |
|                             | secure deletion of data, once the      |
|                             | business process of the application is |
|                             | completed.                             |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > ***2A-3** The application |                                        |
| > does not transmit         |                                        |
| > clear-text PAN and/or SAD |                                        |
| > outside of the POI        |                                        |
| > device, and only uses     |                                        |
| > communication methods     |                                        |
| > included in the scope of  |                                        |
| > the PCI-approved POI      |                                        |
| > device evaluation.*       |                                        |
+-----------------------------+----------------------------------------+
| > **2A-3.1** The            | > **2A-3.1.a** Examine the             |
| > application must not      | > application's design documentation   |
| > output clear-text account | > and verify it contains a description |
| > data outside of the POI   | > of the application's function,       |
| > device.                   | > including that the application does  |
| >                           | > not output clear-text account data   |
| > ***Note:** Output of      | > outside of the POI device.           |
| > clear-text data that is   |                                        |
| > verified as being         |                                        |
| > unrelated to any of the   |                                        |
| > PCI payment brands is     |                                        |
| > acceptable. The security  |                                        |
| > of this process is        |                                        |
| > assessed at Requirement   |                                        |
| > **2A-3.4**.*              |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.1.b** Perform a source-code   |
|                             | > review and verify the application    |
|                             | > never outputs clear-text account     |
|                             | > data outside of the POI device.      |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.1.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify the  |
|                             | > application does not output          |
|                             | > clear-text account data outside of   |
|                             | > the POI device.                      |
+-----------------------------+----------------------------------------+
| > **2A-3.1.1** The output   | > **2A-3.1.1.a** If the application    |
| > of any truncated PANs     | > outputs any truncated PANs, examine  |
| > must adhere to the        | > the application's design             |
| > allowable number of       | > documentation and verify it contains |
| > digits as specified in    | > a description of the application's   |
| > PCI DSS and/or related    | > function, including that any         |
| > FAQs.                     | > truncation of PANs adheres to the    |
| >                           | > allowable number of digits as        |
| > ***Note:** This           | > specified in PCI DSS and/or related  |
| > requirement does not      | > FAQs.                                |
| > supersede stricter        |                                        |
| > requirements in place for |                                        |
| > displays of PAN---e.g.,   |                                        |
| > legal or payment card     |                                        |
| > brand requirements for    |                                        |
| > point-of-sale (POS)       |                                        |
| > receipts.*                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.1.1.b** If the application    |
|                             | > outputs any truncated PANs, perform  |
|                             | > a source-code review and verify that |
|                             | > any truncation of PANs adheres to    |
|                             | > the allowable number of digits as    |
|                             | > specified in PCI DSS and/or related  |
|                             | > FAQs that specify allowable digits.  |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.1.1.c** If the application    |
|                             | > outputs any truncated PANs, install  |
|                             | > and configure the application        |
|                             | > according to the application         |
|                             | > vendor's documentation, including    |
|                             | > the application's *Implementation    |
|                             | > Guide*. Using an appropriate "test   |
|                             | > platform" (if necessary), perform    |
|                             | > test transactions that utilize all   |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify that |
|                             | > any truncation of PANs adheres to    |
|                             | > the allowable number of digits as    |
|                             | > specified in PCI DSS and/or related  |
|                             | > FAQs.                                |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2A-3.1.2** If the       | > **2A-3.1.2.a** If the application    |
| > application facilitates   | > facilitates merchant printing of     |
| > merchant printing of full | > full PANs on receipts due to a legal |
| > PANs on receipts due to a | > or regulatory obligation, examine    |
| > legal or regulatory       | > the application's design             |
| > obligation, this is ONLY  | > documentation and verify it contains |
| > allowable if the          | > a description of the application's   |
| > application includes the  | > function, including that the         |
| > following:                | > printing of full PANs on merchant    |
|                             | > receipts is a legal/regulatory       |
| -   The application only    | > obligation.                          |
|     > transmits clear-text  |                                        |
|     > PAN internally within |                                        |
|     > the POI device to an  |                                        |
|     > integrated printer    |                                        |
|     > that is part of the   |                                        |
|     > PCI-approved POI      |                                        |
|     > device and is not     |                                        |
|     > attached via cabling  |                                        |
|     > or other networking   |                                        |
|     > mechanisms.           |                                        |
|                             |                                        |
| -   The P2PE application    |                                        |
|     > securely deletes the  |                                        |
|     > clear-text PAN after  |                                        |
|     > completion of         |                                        |
|     > printing.             |                                        |
|                             |                                        |
| > ***Note:** Domain 1 (at   |                                        |
| > **1B.1.1.1**) and Domain  |                                        |
| > 3 (at **3A-1.3**) also    |                                        |
| > include requirements that |                                        |
| > must be met for any POI   |                                        |
| > device and for a P2PE     |                                        |
| > solution provider,        |                                        |
| > respectively, that        |                                        |
| > facilitates merchant      |                                        |
| > printing of full PAN      |                                        |
| > where there is a legal or |                                        |
| > regulatory obligation to  |                                        |
| > do so.*                   |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.1.2.b** If the application    |
|                             | > facilitates merchant printing of     |
|                             | > full PANs on receipts due to a legal |
|                             | > or regulatory obligation, perform a  |
|                             | > source-code review and verify the    |
|                             | > following:                           |
|                             |                                        |
|                             | -   The application only transmits     |
|                             |     > clear-text PAN internally within |
|                             |     > the POI device to an integrated  |
|                             |     > printer that is part of the      |
|                             |     > PCI-approved POI device and does |
|                             |     > not include any functionality    |
|                             |     > that sends clear-text PANs to    |
|                             |     > any devices attached via cabling |
|                             |     > or other networking mechanisms.  |
|                             |                                        |
|                             | -   The P2PE application securely      |
|                             |     > deletes the clear-text PAN after |
|                             |     > completion of printing.          |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.1.2.c** If the application    |
|                             | > facilitates merchant printing of     |
|                             | > full PANs on receipts due to a legal |
|                             | > or regulatory obligation, install    |
|                             | > and configure the application        |
|                             | > according to the application         |
|                             | > vendor's documentation, including    |
|                             | > the application's *Implementation    |
|                             | > Guide*. Using an appropriate "test   |
|                             | > platform" (if necessary), perform    |
|                             | > test transactions that utilize all   |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify      |
|                             | > that:                                |
|                             |                                        |
|                             | -   The application only transmits     |
|                             |     > clear-text PAN internally within |
|                             |     > the POI device to an integrated  |
|                             |     > printer that is part of the      |
|                             |     > PCI-approved POI device and is   |
|                             |     > not attached via cabling or      |
|                             |     > other networking mechanisms.     |
|                             |                                        |
|                             | -   The P2PE application securely      |
|                             |     > deletes the clear-text PAN after |
|                             |     > completion of printing.          |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2A-3.2** The            | > **2A-3.2.a** Examine the             |
| > application must not      | > application's *Implementation Guide* |
| > facilitate, via its own   | > required at **2C-3** of this         |
| > logical interface(s),     | > document and determine that it       |
| > sharing of clear-text     | > includes the following:              |
| > account data directly     |                                        |
| > with other applications   | -   A list of all logical interfaces   |
| > (including non-payment    |     > for the application, and the     |
| > software).                |     > function/purpose of each.        |
| >                           |                                        |
| > ***Note:** The            | -   The logical interfaces intended    |
| > application is allowed to |     > for sharing of clear-text        |
| > share clear-text account  |     > account data (e.g., those used   |
| > data directly with the    |     > to pass clear-text data back to  |
| > POI device's              |     > the approved firmware of the POI |
| > SRED-approved firmware.*  |     > device).                         |
|                             |                                        |
|                             | -   The logical interfaces *not*       |
|                             |     > intended for sharing of          |
|                             |     > clear-text account data (e.g.,   |
|                             |     > those for communication with     |
|                             |     > other applications).             |
|                             |                                        |
|                             | > Examine the logical interfaces used  |
|                             | > to communicate with other            |
|                             | > applications and confirm that the    |
|                             | > application cannot share clear-text  |
|                             | > account data with other applications |
|                             | > via these logical interfaces.        |
|                             | >                                      |
|                             | > ***Note:** The application may be    |
|                             | > the only POI-resident application at |
|                             | > the time of assessment, but other    |
|                             | > assessed applications may be added   |
|                             | > to a P2PE solution at a later date;  |
|                             | > or the application may be added to a |
|                             | > solution that includes pre-approved  |
|                             | > applications. The assessor must test |
|                             | > this requirement with this point in  |
|                             | > mind.*                               |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.2.b** Perform a source-code   |
|                             | > review and verify that the           |
|                             | > application cannot directly          |
|                             | > facilitate sharing of clear-text     |
|                             | > account data with other applications |
|                             | > via its logical interfaces.          |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.2.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify that |
|                             | > the application cannot directly      |
|                             | > facilitate sharing of clear-text     |
|                             | > account data with other applications |
|                             | > via its logical interfaces.          |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2A-3.3** The            | > **2A-3.3.a** Examine the POI device  |
| > application must only use | > vendor's security guidance to        |
| > external communication    | > determine which external             |
| > methods included in the   | > communication methods are approved   |
| > PCI-approved POI device   | > via the PCI-approved POI device      |
| > evaluation.               | > evaluation.                          |
| >                           | >                                      |
| > *For example, the POI     | > Review the application's design      |
| > device may provide an IP  | > documentation and verify that it     |
| > stack approved per the    | > contains a description of the        |
| > PTS Open Protocols        | > application's function including the |
| > module, or the device may | > following:                           |
| > provide serial ports or   |                                        |
| > modems approved by the    | -   A list of the external             |
| > PTS evaluation to         |     > communication methods included   |
| > communicate transaction   |     > in the POI device vendor's       |
| > data encrypted by its PCI |     > security guidance                |
| > PTS SRED functions.*      |                                        |
| >                           | -   A list of which approved external  |
| > ***Note:** Using any      |     > communication methods are used   |
| > external communication    |     > by the application               |
| > methods not included in   |                                        |
| > the PCI-approved POI      | -   A description of where external    |
| > device evaluation will    |     > communications are used by the   |
| > invalidate the PTS        |     > application                      |
| > approval and such use is  |                                        |
| > prohibited in P2PE        |                                        |
| > solutions.*               |                                        |
| >                           |                                        |
| > Security of applications  |                                        |
| > where the POI device      |                                        |
| > implements Open Protocols |                                        |
| > is covered at Requirement |                                        |
| > **2B-2.1**.               |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.3.b** Examine the             |
|                             | > application's *Implementation Guide* |
|                             | > required at **2C-3** of this         |
|                             | > document and verify it includes      |
|                             | > guidance that the use of any other   |
|                             | > method for external communication is |
|                             | > not allowed.                         |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.3.c** Perform a source-code   |
|                             | > review and verify that, when         |
|                             | > configured appropriately, the        |
|                             | > application only utilizes the        |
|                             | > external communication methods       |
|                             | > included in the POI device vendor's  |
|                             | > security guidance and does not       |
|                             | > implement its own external           |
|                             | > communication methods (e.g., does    |
|                             | > not implement its own IP stack).     |
+-----------------------------+----------------------------------------+
|                             | > **2A-3.3.d** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify      |
|                             | > that:                                |
|                             |                                        |
|                             | -   The application uses only the      |
|                             |     > external communication methods   |
|                             |     > included in the POI device       |
|                             |     > vendor\'s security guidance for  |
|                             |     > all external communications.     |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2A: Protect  |                                        |
| PAN and SAD***              |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2A-3.4** Any            | > **2A-3.4** For any whitelisting      |
| > whitelisting              | > functionality implemented by the     |
| > functionality implemented | > application, examine the             |
| > by the application must   | > application's *Implementation Guide* |
| > include guidance in the   | > required at **2C-3** of this         |
| > application's             | > document and verify it contains      |
| > *Implementation Guide*    | > details to describe any whitelisting |
| > that includes the         | > functionality and that it provides   |
| > following:                | > instructions as follows:             |
|                             |                                        |
| -   How to configure the    | -   How to configure the application   |
|     > whitelisting          |     > functionality to ensure the      |
|     > functionality to      |     > output of clear- text account    |
|     > ensure the output of  |     > data is prohibited, except for   |
|     > clear-text account    |     > non-PCI payment brand            |
|     > data is prohibited,   |     > account/card data                |
|     > except for non-PCI    |                                        |
|     > payment brand         | -   How to perform cryptographic       |
|     > account/card data     |     > signing (or similar) prior to    |
|                             |     > installation on the POI device   |
| -   How to perform          |     > by authorized personnel using    |
|     > cryptographic signing |     > dual control                     |
|     > (or similar) prior to |                                        |
|     > installation on the   | -   How to establish cryptographically |
|     > POI device by         |     > authentication by the POI        |
|     > authorized personnel  |     > device's firmware                |
|     > using dual control    |                                        |
|                             | -   That review of whitelist           |
| -   How to perform          |     > functionality must be performed  |
|     > cryptographic         |     > to confirm it only outputs       |
|     > authentication by the |     > non-PCI payment brand            |
|     > POI device's firmware |     > account/card data                |
|                             |                                        |
| -   That review of          | -   That such functionality must be    |
|     > whitelist             |     > approved by authorized personnel |
|     > functionality must be |     > prior to implementation          |
|     > performed to confirm  |                                        |
|     > it only outputs       | -   That documentation for all new     |
|     > non-PCI payment brand |     > installations or updates to      |
|     > account/card data     |     > whitelist functionality includes |
|                             |     > the following:                   |
| -   That such functionality |                                        |
|     > must be approved by   |     -   Description and justification  |
|     > authorized personnel  |         > for the functionality        |
|     > prior to              |                                        |
|     > implementation        |     -   Who approved the new           |
|                             |         > installation or updated      |
| -   That all new            |         > functionality prior to       |
|     > installations or      |         > release                      |
|     > updates to whitelist  |                                        |
|     > functionality must    |     -   Confirmation that it was       |
|     > include the           |         > reviewed prior to release to |
|     > following:            |         > only output non-PCI payment  |
|                             |         > brand account/card data      |
|     -   Description and     |                                        |
|         > justification for |                                        |
|         > the functionality |                                        |
|                             |                                        |
|     -   Who approved the    |                                        |
|         > new installation  |                                        |
|         > or updated        |                                        |
|         > functionality     |                                        |
|         > prior to release  |                                        |
|                             |                                        |
|     -   Confirmation that   |                                        |
|         > it was reviewed   |                                        |
|         > prior to release  |                                        |
|         > to only output    |                                        |
|         > non-PCI payment   |                                        |
|         > brand             |                                        |
|         > account/card data |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| []{#_bookmark34             |                                        |
| .anchor}***Requirement 2B:  |                                        |
| Develop and maintain secure |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > ***2B-1** The application |                                        |
| > is developed and tested   |                                        |
| > according to              |                                        |
| > industry-standard         |                                        |
| > software development life |                                        |
| > cycle practices that      |                                        |
| > incorporate information   |                                        |
| > security.*                |                                        |
+-----------------------------+----------------------------------------+
| > **2B-1.1** Applications   | > **2B-1.1.a** Examine the application |
| > must be developed based   | > vendor's software development        |
| > on industry best          | > processes to verify the following:   |
| > practices and in          |                                        |
| > accordance with the POI   | -   Processes are based on industry    |
| > device vendor\'s security |     > standards and/or best practices. |
| > guidance, and information |                                        |
| > security is incorporated  | -   Information security is included   |
| > throughout the software   |     > throughout the software          |
| > development life cycle.   |     > development life cycle.          |
| > These processes must      |                                        |
| > include the following:    | -   Applications are developed in      |
|                             |     > accordance with all applicable   |
|                             |     > P2PE requirements.               |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.1.b** Examine the POI device  |
|                             | > vendor's security guidance, and      |
|                             | > verify that any specified software   |
|                             | > development processes are:           |
|                             |                                        |
|                             | -   Incorporated into the application  |
|                             |     > developer's written software     |
|                             |     > development processes            |
|                             |                                        |
|                             | -   Implemented per the POI device     |
|                             |     > vendor\'s security guidance      |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.1.c** Examine the             |
|                             | > application's *Implementation Guide* |
|                             | > required at 2C-3 of this document    |
|                             | > and verify it provides information   |
|                             | > from the POI device vendor's         |
|                             | > security guidance applicable to the  |
|                             | > solution provider (e.g., application |
|                             | > configuration settings which are     |
|                             | > necessary for the application to     |
|                             | > function with the device).           |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.1.d** Verify each of the      |
|                             | > items at **2B-1.1.1** through        |
|                             | > **2B-1.1.3** by performing the       |
|                             | > following:                           |
|                             |                                        |
|                             | -   Examine software development       |
|                             |     > processes and interview software |
|                             |     > developers.                      |
|                             |                                        |
|                             | -   Examine testing documentation and  |
|                             |     > samples of test data, observe    |
|                             |     > testing processes, and interview |
|                             |     > software-testing personnel.      |
|                             |                                        |
|                             | -   Examine the final application      |
|                             |     > product.                         |
+-----------------------------+----------------------------------------+
| > **2B-1.1.1** Live PANs    | > **2B-1.1.1** Examine the             |
| > must not be used for      | > software-development and testing     |
| > testing or development.   | > procedures and interview responsible |
|                             | > personnel to verify that live PANs   |
|                             | > are not used for testing or          |
|                             | > development.                         |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.1.2** Development, | > **2B-1.1.2** Examine the             |
| > test, and/or custom       | > software-development procedures and  |
| > application               | > interview responsible personnel to   |
| > data/accounts, user IDs,  | > verify that development, test,       |
| > and passwords must be     | > and/or custom application            |
| > removed before            | > data/accounts, user IDs, and         |
| > applications are released | > passwords are removed before an      |
| > for production or         | > application is released for          |
| > released to customers.    | > production or released to customers. |
+-----------------------------+----------------------------------------+
| > **2B-1.2** Application    | > **2B-1.2** Examine written           |
| > code and any non-code     | > software-development procedures and  |
| > configuration mechanisms  | > interview responsible personnel to   |
| > must be reviewed prior to | > verify the application vendor        |
| > every release or update.  | > performs reviews for all application |
| >                           | > code changes and non-code            |
| > The review process        | > configuration mechanisms as follows: |
| > includes the following:   |                                        |
|                             | -   Reviews are performed by an        |
|                             |     > individual, other than the code  |
|                             |     > author, who is knowledgeable in  |
|                             |     > code-review techniques and       |
|                             |     > secure coding practices.         |
|                             |                                        |
|                             | -   Changes to code that manages       |
|                             |     > security-sensitive configuration |
|                             |     > options are reviewed to confirm  |
|                             |     > that they will not result in the |
|                             |     > exposure of PCI payment- brand   |
|                             |     > accounts/cards.                  |
|                             |                                        |
|                             | -   Code reviews ensure code is        |
|                             |     > developed according to secure    |
|                             |     > coding guidelines*.*             |
+-----------------------------+----------------------------------------+
| > **2B-1.2.1** Review of    | > **2B-1.2.1** Examine code review     |
| > code changes by           | > results for a sample of code changes |
| > individuals other than    | > to confirm that code reviews are     |
| > the originating author,   | > performed by an individual other     |
| > and by individuals who    | > than the code author who is          |
| > are knowledgeable in      | > knowledgeable in code-review         |
| > code-review techniques    | > techniques and secure coding         |
| > and secure coding         | > practices.                           |
| > practices.                |                                        |
+-----------------------------+----------------------------------------+
| > **2B-1.2.2** Performing   | > **2B-1.2.2** Examine code-review     |
| > code reviews to ensure    | > results for a sample of code changes |
| > code is developed         | > to verify that code reviews ensure   |
| > according to secure       | > code is developed according to       |
| > coding guidelines*.*      | > secure coding guidelines*.*          |
+-----------------------------+----------------------------------------+
| > **2B-1.2.3** Confirming   | > **2B-1.2.3** Examine change-control  |
| > that appropriate          | > documentation for a sample of code   |
| > corrections are           | > changes to verify that appropriate   |
| > implemented prior to      | > corrections are implemented prior to |
| > release.                  | > release.                             |
+-----------------------------+----------------------------------------+
| > **2B-1.2.4** Review and   | > **2B-1.2.4** Examine change-control  |
| > approval of review        | > documentation for a sample of code   |
| > results by management     | > changes to verify that review        |
| > prior to release.         | > results are reviewed and approved by |
|                             | > management prior to release.         |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.3** All changes to | > **2B-1.3.a** Obtain and examine the  |
| > the application must      | > developer's change-control           |
| > follow change- control    | > procedures for software              |
| > procedures.               | > modifications, and verify that the   |
| >                           | > procedures require the following:    |
| > The procedures must       |                                        |
| > include the following:    | -   Documentation of customer impact   |
|                             |                                        |
|                             | -   Documented approval of change by   |
|                             |     > appropriate authorized parties   |
|                             |                                        |
|                             | -   Functionality testing to verify    |
|                             |     > that the change does not         |
|                             |     > adversely impact the security of |
|                             |     > the device                       |
|                             |                                        |
|                             | -   Back-out or application            |
|                             |     > de-installation procedures       |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.3.b** Examine the             |
|                             | > application's *Implementation Guide* |
|                             | > required at 2C-3 of this document    |
|                             | > and verify it includes the           |
|                             | > following:                           |
|                             |                                        |
|                             | -   Documentation detailing the impact |
|                             |     > of all changes included in the   |
|                             |     > relevant application release     |
|                             |                                        |
|                             | -   Instructions detailing back-out or |
|                             |     > de-installation procedures for   |
|                             |     > the application                  |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.3.c** Examine recent          |
|                             | > application changes and trace those  |
|                             | > changes back to related              |
|                             | > change-control documentation. Verify |
|                             | > that, for each change examined, the  |
|                             | > following was documented according   |
|                             | > to the change-control procedures:    |
+-----------------------------+----------------------------------------+
| > **2B-1.3.1**              | > **2B-1.3.1** Verify that             |
| > Documentation of impact.  | > documentation of customer impact is  |
|                             | > included in the change- control      |
|                             | > documentation for each change.       |
+-----------------------------+----------------------------------------+
| > **2B-1.3.2** Documented   | > **2B-1.3.2** Verify that documented  |
| > approval of the change by | > approval by appropriate authorized   |
| > appropriate authorized    | > parties is present for each change.  |
| > parties.                  |                                        |
+-----------------------------+----------------------------------------+
| > **2B-1.3.3**              | > **2B-1.3.3.a** For each sampled      |
| > Functionality testing to  | > change, verify that functionality    |
| > verify that the change    | > testing was performed to verify that |
| > does not adversely impact | > the change does not adversely impact |
| > the security of the       | > the security of the device.          |
| > device.                   |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.3.3.b** Verify that all       |
|                             | > changes (including patches) are      |
|                             | > tested per secure coding guidance    |
|                             | > before being released.               |
+-----------------------------+----------------------------------------+
| > **2B-1.3.4** Back-out,    | > **2B-1.3.4** Verify that back-out,   |
| > rollback, or application  | > rollback, or application             |
| > de-installation           | > de-installation procedures are       |
| > procedures.               | > prepared for each change.            |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.4** Applications   | > **2B-1.4** Examine software          |
| > must be developed         | > development processes and interview  |
| > according to industry     | > software developers to verify that   |
| > best practices for secure | > secure coding techniques are defined |
| > coding techniques,        | > and include:                         |
| > including (but not        |                                        |
| > limited to):              | -   Developing with least privilege    |
|                             |                                        |
| -   Developing with least   | -   Developing with fail-safe defaults |
|     > privilege.            |                                        |
|                             | -   Developing with defensive          |
| -   Developing with         |     > (protective) techniques          |
|     > fail-safe exception   |     > regarding the logical input      |
|     > handling.             |     > interfaces of the application    |
|                             |                                        |
| -   Developing with         |                                        |
|     > defensive             |                                        |
|     > (protective)          |                                        |
|     > techniques regarding  |                                        |
|     > the logical input     |                                        |
|     > interfaces of the     |                                        |
|     > application.          |                                        |
+-----------------------------+----------------------------------------+
| > **2B-1.4.1** Application  | > **2B-1.4.1.a** Obtain and review     |
| > development processes     | > software development processes for   |
| > must include prevention   | > applications. Verify the process     |
| > of common coding          | > includes prevention of common coding |
| > vulnerabilities.          | > vulnerabilities relevant to the      |
|                             | > programming languages and platforms  |
|                             | > in use.                              |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.4.1.b** Verify that           |
|                             | > applications are not vulnerable to   |
|                             | > common coding vulnerabilities by     |
|                             | > performing manual or automated       |
|                             | > penetration testing that             |
|                             | > specifically attempts to exploit     |
|                             | > vulnerabilities relevant to the      |
|                             | > application (an example of such a    |
|                             | > vulnerability would include buffer   |
|                             | > overflows).                          |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.4.2** Application  | > **2B-1.4.2** Examine written         |
| > risk-assessment           | > software development procedures and  |
| > techniques (e.g.,         | > interview responsible personnel to   |
| > (application              | > verify the vendor uses application   |
| > threat-modeling) must be  | > risk-assessment techniques as part   |
| > used to identify          | > of the software development process, |
| > potential                 | > and that the processes include:      |
| > application-security      |                                        |
| > design flaws and          | -   Coverage of all functions of the   |
| > vulnerabilities during    |     > application, including but not   |
| > the software-development  |     > limited to, security-impacting   |
| > process. Risk-assessment  |     > features and features that cross |
| > processes include the     |     > trust boundaries.                |
| > following:                |                                        |
|                             | -   Assessment of application decision |
| -   Coverage of all         |     > points, process flows, data      |
|     > functions of the      |     > flows, data storage, and trust   |
|     > application,          |     > boundaries.                      |
|     > including but not     |                                        |
|     > limited to,           | -   Identification of all areas within |
|     > security-impacting    |     > applications that interact with  |
|     > features and features |     > account data, as well as any     |
|     > that cross trust      |     > process-oriented outcomes that   |
|     > boundaries            |     > could lead to the exposure of    |
|                             |     > account data.                    |
| -   Assessment of           |                                        |
|     > application decision  | -   A list of potential threats and    |
|     > points, process       |     > vulnerabilities resulting from   |
|     > flows, data flows,    |     > account-data-flow analyses, and  |
|     > data storage, and     |     > assigned risk ratings (e.g.,     |
|     > trust boundaries      |     > high, medium, or low priority)   |
|                             |     > to each.                         |
| -   Identification of all   |                                        |
|     > areas within the      | -   Implementation of appropriate      |
|     > application that      |     > corrections and countermeasures  |
|     > interact with account |     > during the development process.  |
|     > data, as well as any  |                                        |
|     > process- oriented     | -   Documentation of application       |
|     > outcomes that could   |     > risk-assessment results for      |
|     > lead to the exposure  |     > management review and approval.  |
|     > of account data       |                                        |
|                             |                                        |
| -   A list of potential     |                                        |
|     > threats and           |                                        |
|     > vulnerabilities       |                                        |
|     > resulting from        |                                        |
|     > account-data-flow     |                                        |
|     > analyses and assigned |                                        |
|     > risk ratings (e.g.,   |                                        |
|     > high, medium, or low  |                                        |
|     > priority) to each     |                                        |
|                             |                                        |
| -   Implementation of       |                                        |
|     > appropriate           |                                        |
|     > corrections and       |                                        |
|     > countermeasures       |                                        |
|     > during the            |                                        |
|     > development process   |                                        |
|                             |                                        |
| -   Documentation of        |                                        |
|     > application           |                                        |
|     > risk-assessment       |                                        |
|     > results for           |                                        |
|     > management review and |                                        |
|     > approval              |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.5** Application    | > **2B-1.5.a** Verify documented       |
| > vendor must provide       | > software development processes       |
| > training in secure        | > require training in secure           |
| > development practices to  | > development practices for            |
| > application developers,   | > application developers, as           |
| > as applicable for the     | > applicable for the developer's job   |
| > developer's job function  | > function and technology used.        |
| > and technology used,      |                                        |
| > e.g.:                     |                                        |
|                             |                                        |
| -   Secure application      |                                        |
|     > design.               |                                        |
|                             |                                        |
| -   Secure coding           |                                        |
|     > techniques to avoid   |                                        |
|     > common coding         |                                        |
|     > vulnerabilities       |                                        |
|     > (e.g., vendor         |                                        |
|     > guidelines, OWASP Top |                                        |
|     > 10, SANS CWE Top 25,  |                                        |
|     > CERT Secure Coding,   |                                        |
|     > etc.)                 |                                        |
|                             |                                        |
| -   Managing sensitive data |                                        |
|     > in memory             |                                        |
|                             |                                        |
| -   Code reviews            |                                        |
|                             |                                        |
| -   Security testing (e.g., |                                        |
|     > penetration testing   |                                        |
|     > techniques)           |                                        |
|                             |                                        |
| -   Risk-assessment         |                                        |
|     > techniques            |                                        |
|                             |                                        |
| > ***Note:** Training for   |                                        |
| > application developers    |                                        |
| > may be provided in-house  |                                        |
| > or by third parties.      |                                        |
| > Examples of how training  |                                        |
| > may be delivered include  |                                        |
| > on-the-job,               |                                        |
| > instructor-led, and       |                                        |
| > computer-based.*          |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.5.b** Interview a sample of   |
|                             | > developers to verify that they are   |
|                             | > knowledgeable in secure development  |
|                             | > practices and coding techniques, as  |
|                             | > applicable to the technology used.   |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.5.c** Examine records of      |
|                             | > training to verify that all          |
|                             | > application developers receive       |
|                             | > training as applicable for their job |
|                             | > function and technology used.        |
+-----------------------------+----------------------------------------+
| > **2B-1.5.1** Training     | > **2B-1.5.1** Examine training        |
| > must be updated as needed | > materials and interview a sample of  |
| > to address new            | > developers to verify that training   |
| > development technologies  | > is updated as needed to address new  |
| > and methods used.         | > development technologies and methods |
|                             | > used.                                |
+-----------------------------+----------------------------------------+
| > **2B-1.6** Secure         | > **2B-1.6.a** Examine written         |
| > source-control practices  | > software-development procedures and  |
| > must be implemented to    | > interview responsible personnel to   |
| > verify the integrity of   | > verify the vendor maintains secure   |
| > source-code during the    | > source-code control practices to     |
| > development process.      | > verify the integrity of source-code  |
|                             | > during the development process.      |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.6.b** Examine mechanisms and  |
|                             | > observe procedures for securing      |
|                             | > source-code to verify the integrity  |
|                             | > of source-code is maintained during  |
|                             | > the development process.             |
+-----------------------------+----------------------------------------+
| > **2B-1.7** The            | > **2B-1.7** Examine documented        |
| > application vendor must   | > software-development processes to    |
| > document and follow a     | > verify they include the application  |
| > software-versioning       | > vendor's versioning methodology, and |
| > methodology as part of    | > that the versioning methodology must |
| > their system- development | > be in accordance with the P2PE       |
| > lifecycle. The            | > Program Guide.                       |
| > methodology must follow   | >                                      |
| > the procedures in the     | > Verify that the documented           |
| > P2PE Program Guide for    | > versioning methodology is required   |
| > changes to payment        | > to be followed for the application,  |
| > applications and include  | > including all changes to the         |
| > at least the following:   | > application.                         |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.7.1** The vendor's | > **2B-1.7.1.a** Examine recent        |
| > software versioning       | > application changes, the version     |
| > methodology must define   | > numbers assigned, and the            |
| > the specific version      | > change-control documentation that    |
| > elements used, including  | > specifies the type of application    |
| > at least the following:   | > change and verify that the elements  |
|                             | > in the version number match the      |
| -   Details of how the      | > applicable change and the parameters |
|     > elements of the       | > defined in the documented versioning |
|     > version scheme are in | > methodology.                         |
|     > accordance with       |                                        |
|     > requirements          |                                        |
|     > specified in the P2PE |                                        |
|     > Program Guide.        |                                        |
|                             |                                        |
| -   The format of the       |                                        |
|     > version scheme,       |                                        |
|     > including number of   |                                        |
|     > elements, separators, |                                        |
|     > character set, etc.   |                                        |
|     > (consisting of        |                                        |
|     > alphabetic, numeric,  |                                        |
|     > and/or alphanumeric   |                                        |
|     > characters)           |                                        |
|                             |                                        |
| -   Definition of what each |                                        |
|     > element represents in |                                        |
|     > the version scheme    |                                        |
|     > (e.g., type of        |                                        |
|     > change, major, minor, |                                        |
|     > or maintenance        |                                        |
|     > release, wildcard,    |                                        |
|     > etc.)                 |                                        |
|                             |                                        |
| -   Definition of elements  |                                        |
|     > that indicate use of  |                                        |
|     > wildcards             |                                        |
|                             |                                        |
| > ***Note:** Wildcards may  |                                        |
| > only be substituted for   |                                        |
| > elements of the version   |                                        |
| > number that represent     |                                        |
| > non-security impacting    |                                        |
| > changes. Refer to 2B-6.3  |                                        |
| > for additional            |                                        |
| > requirements on the use   |                                        |
| > of wildcards.*            |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.7.1.b** Interview a sample of |
|                             | > developers and verify that they are  |
|                             | > knowledgeable in the version scheme, |
|                             | > including the acceptable use of      |
|                             | > wildcards in the version number.     |
+-----------------------------+----------------------------------------+
| > **2B-1.8** The versioning | > **2B-1.8.a** Examine the software    |
| > methodology must indicate | > vendor's documented versioning       |
| > the type and impact of    | > methodology to verify the version    |
| > all application changes   | > methodology includes:                |
| > in accordance with the    |                                        |
| > P2PE Program Guide,       | -   Description of all types and       |
| > including:                |     > impacts of application changes   |
|                             |     > (e.g., changes that have no      |
| -   Description of all      |     > impact, low impact, or high      |
|     > types and impacts of  |     > impact to the application)       |
|     > application changes   |                                        |
|     > (e.g., changes that   | -   Specific identification and        |
|     > have no impact, low   |     > definition of changes that:      |
|     > impact, or high       |                                        |
|     > impact to the         |     -   Have no impact on              |
|     > application)          |         > functionality of the         |
|                             |         > application or its           |
| -   Specific identification |         > dependencies                 |
|     > and definition of     |                                        |
|     > changes that:         |     -   Have impact on application     |
|                             |         > functionality but no impact  |
|     -   Have no impact on   |         > on security or P2PE          |
|         > functionality of  |         > requirements                 |
|         > the application   |                                        |
|         > or its            |     -   Have impact to any security    |
|         > dependencies      |         > functionality or P2PE        |
|                             |         > requirement                  |
|     -   Have impact on      |                                        |
|         > application       | -   How each type of change ties to a  |
|         > functionality but |     > specific version number.         |
|         > no impact on      |                                        |
|         > security or P2PE  |                                        |
|         > requirements      |                                        |
|                             |                                        |
|     -   Have impact to any  |                                        |
|         > security          |                                        |
|         > functionality or  |                                        |
|         > P2PE requirement  |                                        |
|                             |                                        |
| -   How each type of change |                                        |
|     > ties to a specific    |                                        |
|     > version number        |                                        |
|     > *(continued on next   |                                        |
|     > page)*                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.8.b** Verify that the         |
|                             | > versioning methodology is in         |
|                             | > accordance with the P2PE Program     |
|                             | > Guide requirements.                  |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.8.c** Interview personnel and |
|                             | > observe processes for each type of   |
|                             | > change to verify that the documented |
|                             | > methodology is being followed for    |
|                             | > all types of changes.                |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.8** *(continued)*  | > **2B-1.8.d** Select a sample of      |
|                             | > recent payment application changes   |
|                             | > and review the change-control        |
|                             | > documentation that specifies the     |
|                             | > type of application change to verify |
|                             | > that the version assigned to the     |
|                             | > change matches the type of change    |
|                             | > according to the documented          |
|                             | > methodology.                         |
+-----------------------------+----------------------------------------+
| > **2B-1.9** The versioning | > **2B-1.9.a** Examine the software    |
| > methodology must          | > vendor's documented versioning       |
| > specifically identify     | > methodology to verify that it        |
| > whether wildcards are     | > includes specific identification of  |
| > used and, if so, how they | > how wildcards are used, including:   |
| > are used. The following   |                                        |
| > must be included:         | -   Details of how wildcards are used  |
|                             |     > in the versioning methodology.   |
| -   Details of how          |                                        |
|     > wildcards are used in | -   Wildcards are never used for any   |
|     > the versioning        |     > change that has an impact on the |
|     > methodology           |     > security of the application      |
|                             |     > and/or the POI device.           |
| -   Wildcards are never     |                                        |
|     > used for any change   | -   Any element of the version number  |
|     > that has an impact on |     > used to represent a              |
|     > the security of the   |     > non-security-impacting change    |
|     > application and/or    |     > (including a wildcard element)   |
|     > the POI device.       |     > must never be used to represent  |
|                             |     > a security impacting change.     |
| -   Any element of the      |                                        |
|     > version number used   | -   Any elements to the right of a     |
|     > to represent a        |     > wildcard cannot be used for a    |
|                             |     > security-impacting change.       |
|    > non-security-impacting |     > Version elements reflecting a    |
|     > change (including a   |     > security-impacting change must   |
|     > wildcard element)     |     > appear "to the left of" the      |
|     > must never be used to |     > first wildcard element.          |
|     > represent a security  |                                        |
|     > impacting change.     |                                        |
|                             |                                        |
| -   Wildcard elements must  |                                        |
|     > not precede version   |                                        |
|     > elements that could   |                                        |
|     > represent             |                                        |
|     > security-impacting    |                                        |
|     > changes. Any version  |                                        |
|     > elements that appear  |                                        |
|     > after a wildcard      |                                        |
|     > element must not be   |                                        |
|     > used to represent     |                                        |
|     > security-impacting    |                                        |
|     > changes.              |                                        |
|                             |                                        |
| > ***Note:** Wildcards may  |                                        |
| > only be used in           |                                        |
| > accordance with the P2PE  |                                        |
| > Program Guide.*           |                                        |
| >                           |                                        |
| > *(continued on next       |                                        |
| > page)*                    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.9.b** Verify that any use of  |
|                             | > wildcards is in accordance with the  |
|                             | > P2PE Program Guide                   |
|                             | > requirements---e.g., elements that   |
|                             | > appear after a wildcard element      |
|                             | > cannot be used for a security        |
|                             | > impacting change.                    |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.9.c** Interview personnel and |
|                             | > observe processes for each type of   |
|                             | > change to verify that:               |
|                             |                                        |
|                             | -   Wildcards are never used for any   |
|                             |     > change that has an impact on     |
|                             |     > security or any P2PE             |
|                             |     > requirements.                    |
|                             |                                        |
|                             | -   Elements of the version number     |
|                             |     > used to represent                |
|                             |     > non-security-impacting changes   |
|                             |     > (including a wildcard element)   |
|                             |     > are never be used to represent a |
|                             |     > security impacting change.       |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.9** *(continued)*  | > **2B-1.9.d** Select a sample of      |
|                             | > recent payment application changes   |
|                             | > and review the change-control        |
|                             | > documentation that specifies the     |
|                             | > type of application change. Verify   |
|                             | > that:                                |
|                             |                                        |
|                             | -   Wildcards are not used for any     |
|                             |     > change that has an impact on     |
|                             |     > security or any P2PE             |
|                             |     > requirements.                    |
|                             |                                        |
|                             | -   Elements of the version number     |
|                             |     > used to represent                |
|                             |     > non-security-impacting changes   |
|                             |     > (including a wildcard element)   |
|                             |     > are not used to represent a      |
|                             |     > security impacting change        |
+-----------------------------+----------------------------------------+
| > **2B-1.10** The vendor's  | > **2B-1.10** Verify the application's |
| > published versioning      | > *Implementation Guide* required at   |
| > methodology must be       | > **2C-3** of this document includes a |
| > communicated to customers | > description of the vendor's          |
| > and integrators/          | > published versioning methodology for |
| > resellers.                | > customers and integrators/resellers, |
|                             | > and includes the following:          |
|                             |                                        |
|                             | -   Details of versioning scheme,      |
|                             |     > including the format of the      |
|                             |     > version scheme (number of        |
|                             |     > elements, separators, character  |
|                             |     > set, etc.)                       |
|                             |                                        |
|                             | -   Details of how security-impacting  |
|                             |     > changes will be indicated by the |
|                             |     > version scheme                   |
|                             |                                        |
|                             | -   Details of how other types of      |
|                             |     > changes will affect the version  |
|                             |                                        |
|                             | -   Details of any wildcard elements   |
|                             |     > that are used, including         |
|                             |     > confirmation that they will      |
|                             |     > never be used to represent a     |
|                             |     > security-impacting change        |
+-----------------------------+----------------------------------------+
| > **2B-1.11** If an         | > **2B-1.11.a** Examine the documented |
| > internal version mapping  | > version methodology to verify it     |
| > to published versioning   | > includes a mapping of internal       |
| > scheme is used, the       | > versions to published external       |
| > versioning methodology    | > versions.                            |
| > must include mapping of   |                                        |
| > internal versions to the  |                                        |
| > external versions.        |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.11.b** Examine recent changes |
|                             | > to confirm internal version mapping  |
|                             | > to published versioning scheme match |
|                             | > according to the type of change.     |
+-----------------------------+----------------------------------------+
| > **2B-1.12** Software      | > **2B-1.12.a** Examine documented     |
| > vendor must have a        | > software development processes and   |
| > process in place to       | > the versioning methodology to verify |
| > review application        | > there is a process in place to       |
| > updates for conformity    | > review application updates for       |
| > with the versioning       | > conformity with the versioning       |
| > methodology prior to      | > methodology prior to release.        |
| > release.                  |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.12.b** Interview software     |
|                             | > developers and observe processes to  |
|                             | > verify that application updates are  |
|                             | > reviewed for conformity with the     |
|                             | > versioning methodology prior to      |
|                             | > release.                             |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-1.13** Software      | > **2B-1.13.a** Examine software       |
| > vendor must implement a   | > release processes to verify that     |
| > process to document and   | > final release of the application and |
| > authorize the final       | > any application updates are formally |
| > release of the            | > approved and documented, including a |
| > application and any       | > signature by an authorized party to  |
| > application updates.      | > formally approve the release and     |
| > Documentation must        | > confirmation that all applicable     |
| > include:                  | > secure development processes were    |
|                             | > followed by the vendor.              |
| -   Signature by an         |                                        |
|     > authorized party to   |                                        |
|     > formally approve      |                                        |
|     > release of the        |                                        |
|     > application or        |                                        |
|     > application update    |                                        |
|                             |                                        |
| -   Confirmation that       |                                        |
|     > secure development    |                                        |
|     > processes were        |                                        |
|     > followed by the       |                                        |
|     > vendor                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-1.13.b** For a sample of recent |
|                             | > releases of application and          |
|                             | > application updates, review approval |
|                             | > documentation to verify it includes: |
|                             |                                        |
|                             | -   Formal approval and signature by   |
|                             |     > an authorized party              |
|                             |                                        |
|                             | -   Confirmation that that all secure  |
|                             |     > development processes were       |
|                             |     > followed                         |
+-----------------------------+----------------------------------------+
| > ***2B-2** The application |                                        |
| > is implemented securely,  |                                        |
| > including the secure use  |                                        |
| > of any resources shared   |                                        |
| > between different         |                                        |
| > applications.*            |                                        |
+-----------------------------+----------------------------------------+
| > **2B-2.1** Where the      | > **2B-2.1.a** Examine documented      |
| > application relies on the | > processes (including design          |
| > Open Protocol             | > documentation) and verify the        |
| > functionality of the POI  | > application is developed in          |
| > device firmware, the      | > accordance with the POI device       |
| > application must be       | > vendor's security guidance.          |
| > developed in accordance   |                                        |
| > with the POI device       |                                        |
| > vendor\'s security        |                                        |
| > guidance.                 |                                        |
| >                           |                                        |
| > ***Note:** POI device     |                                        |
| > vendor security guidance  |                                        |
| > is intended for           |                                        |
| > application developers,   |                                        |
| > system integrators, and   |                                        |
| > end-users of the platform |                                        |
| > to meet the PCI PTS POI   |                                        |
| > Open Protocol             |                                        |
| > requirements as part of a |                                        |
| > PCI-approved POI device   |                                        |
| > evaluation.*              |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-2.1.b** Review the              |
|                             | > application's *Implementation Guide* |
|                             | > required at **2C-3** of this         |
|                             | > document and confirm that it         |
|                             | > includes the following in accordance |
|                             | > with the POI device vendor\'s        |
|                             | > security guidance:                   |
|                             |                                        |
|                             | -   Any instructions on how to         |
|                             |     > securely configure any           |
|                             |     > configurable options, as         |
|                             |     > applicable to the application's  |
|                             |     > specific business processing     |
|                             |                                        |
|                             | -   Any guidance that the POI device   |
|                             |     > vendor intended for integrators/ |
|                             |     > resellers, solution providers,   |
|                             |     > and/or end-users                 |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-2.1.1** The          | > **2B-2.1.1** Perform a source-code   |
| > application must not      | > review and verify that the           |
| > circumvent, bypass, or    | > application:                         |
| > add additional services   |                                        |
| > or protocols to the Open  | -   Was developed according to the POI |
| > Protocols of the POI      |     > device vendor's security         |
| > device firmware as        |     > guidance with respect to the     |
| > approved and documented   |     > documented Open Protocols        |
| > in the POI device         |                                        |
| > vendor's security         | -   Does not circumvent, bypass, or    |
| > guidance. This includes   |     > add additional services or       |
| > the use of:               |     > protocols to the Open Protocols  |
|                             |     > of the POI device firmware as    |
| -   Link Layer protocols    |     > approved and documented in the   |
|                             |     > POI device\'s vendor security    |
| -   IP protocols            |     > guidance. This includes the use  |
|                             |     > of:                              |
| -   Security protocols      |                                        |
|                             |     -   Link Layer protocols           |
| -   IP services             |                                        |
|                             |     -   IP protocols                   |
| > ***Note:** The PCI PTS    |                                        |
| > POI Open Protocol         |     -   Security protocols             |
| > requirements ensures that |                                        |
| > open protocols and        |     -   IP services                    |
| > services in POI devices   |                                        |
| > do not have               |                                        |
| > vulnerabilities that can  |                                        |
| > be remotely exploited and |                                        |
| > yield access to sensitive |                                        |
| > data or resources in the  |                                        |
| > device. The POI device    |                                        |
| > vendor defines what       |                                        |
| > protocols and services    |                                        |
| > are supported by the      |                                        |
| > device and provides       |                                        |
| > guidance to their use.*   |                                        |
| >                           |                                        |
| > *Adding or enabling       |                                        |
| > additional services or    |                                        |
| > protocols, or failing to  |                                        |
| > follow the issued POI     |                                        |
| > device vendor's security  |                                        |
| > guidance, will invalidate |                                        |
| > the approval status of    |                                        |
| > that device for that      |                                        |
| > implementation.*          |                                        |
+-----------------------------+----------------------------------------+
| > **2B-2.2** The            | > **2B-2.2.a** Review the POI device   |
| > application-development   | > vendor\'s security guidance and the  |
| > process must include      | > application's                        |
| > secure integration with   | >                                      |
| > any resources shared with | > *Implementation Guide*.              |
| > or between applications.  | >                                      |
| >                           | > Confirm that the application's       |
| > *(continued on next       | > *Implementation Guide* required at   |
| > page)*                    | > **2C-3** of this document is in      |
|                             | > accordance with any applicable       |
|                             | > information in the POI device        |
|                             | > vendor\'s security guidance, and     |
|                             | > includes the following:              |
|                             |                                        |
|                             | -   A list of shared resources.        |
|                             |                                        |
|                             | -   A description of how the           |
|                             |     > application connects to and/or   |
|                             |     > uses shared resources            |
|                             |                                        |
|                             | -   Instructions for how the           |
|                             |     > application should be configured |
|                             |     > to ensure secure integration     |
|                             |     > with shared resources            |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-2.2** *(continued)*  | > **2B-2.2.b** Perform a source-code   |
|                             | > review and verify that any           |
|                             | > connection to, or use of, shared     |
|                             | > resources is done securely and in    |
|                             | > accordance with the POI device       |
|                             | > vendor's security guidance.          |
+-----------------------------+----------------------------------------+
|                             | > **2B-2.2.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify that |
|                             | > any connections to, or use of,       |
|                             | > shared resources are handled         |
|                             | > securely and in accordance with the  |
|                             | > POI device vendor's security         |
|                             | > guidance.                            |
+-----------------------------+----------------------------------------+
| > **2B-2.3** Applications   | > **2B-2.3** Perform a source-code     |
| > do not bypass or render   | > review and verify that applications  |
| > ineffective any           | > do not bypass or render ineffective  |
| > application segregation   | > any application segregation that is  |
| > that is enforced by the   | > enforced by the POI device, in       |
| > POI device.               | > accordance with the POI device       |
|                             | > vendor's security guidance.          |
+-----------------------------+----------------------------------------+
| > **2B-2.4** Applications   | > **2B-2.4** Perform a source-code     |
| > do not bypass or render   | > review and verify that applications  |
| > ineffective any OS        | > do not bypass or render ineffective  |
| > hardening implemented by  | > any OS hardening which is            |
| > the POI device.           | > implemented by the POI device, in    |
|                             | > accordance with the device vendor's  |
|                             | > security guidance.                   |
+-----------------------------+----------------------------------------+
| > **2B-2.5** Applications   | > **2B-2.5** Perform a source-code     |
| > do not bypass or render   | > review and verify that applications  |
| > ineffective any           | > do not bypass or render ineffective  |
| > encryption or             | > any encryption or account-data       |
| > account-data security     | > security methods implemented by the  |
| > methods implemented by    | > POI device, in accordance with the   |
| > the POI device.           | > device vendor's security guidance.   |
+-----------------------------+----------------------------------------+
| > **2B-2.6** If the         | > **2B-2.6** If the application        |
| > application provides      | > provides configuration/update        |
| > configuration/update      | > functionality at the terminal,       |
| > functionality             | > perform a functional test of the     |
| > at-the-terminal (e.g.,    | > application loaded on each           |
| > using an on-screen menu   | > applicable POI device type and       |
| > system), the application  | > verify that the application does not |
| > must not bypass or render | > bypass or render ineffective any     |
| > ineffective any           | > applicable controls contained within |
| > applicable controls       | > this standard.                       |
| > contained within this     |                                        |
| > standard.                 |                                        |
| >                           |                                        |
| > ***Note:** Some           |                                        |
| > applications may provide  |                                        |
| > administrative or other   |                                        |
| > privileged functions at   |                                        |
| > the terminal, such as the |                                        |
| > ability to load           |                                        |
| > whitelists or change      |                                        |
| > other application         |                                        |
| > configurations. Any such  |                                        |
| > functions provided in     |                                        |
| > this way must meet all    |                                        |
| > applicable P2PE           |                                        |
| > requirements.*            |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > ***2B-3** The application |                                        |
| > vendor uses secure        |                                        |
| > protocols, provides       |                                        |
| > guidance on their use,    |                                        |
| > and performs integration  |                                        |
| > testing on the final      |                                        |
| > application.*             |                                        |
+-----------------------------+----------------------------------------+
| > **2B-3.1** The            | > **2B-3.1** Through observation and   |
| > application developer's   | > review of the application            |
| > process must include full | > developer's system development       |
| > documentation, and        | > documentation, confirm the           |
| > integration testing of    | > application developer's process      |
| > the application and       | > includes full documentation and      |
| > intended platforms,       | > integration testing of the           |
| > including the following:  | > application and intended platforms,  |
|                             | > including the following:             |
+-----------------------------+----------------------------------------+
| > **2B-3.1.1** The          | > **2B-3.1.1** Review the              |
| > application developer     | > application's *Implementation Guide* |
| > must provide security     | > required at 2C-3 of this document,   |
| > guidance describing how   | > and confirm it includes security     |
| > cryptographic keys and/or | > guidance for solution providers,     |
| > certificates have to be   | > describing how cryptographic keys    |
| > used.                     | > and/or certificates have to be used  |
| >                           | > and managed.                         |
| > *Examples of guidance     |                                        |
| > include which             |                                        |
| > cryptographic             |                                        |
| > certificates to load, how |                                        |
| > to load account-data keys |                                        |
| > (through the firmware of  |                                        |
| > the device), when to roll |                                        |
| > keys, etc.*               |                                        |
+-----------------------------+----------------------------------------+
| > **2B-3.1.2** The          | > **2B-3.1.2** Interview application   |
| > application developer     | > developers to confirm that final     |
| > must perform final        | > integration testing, which includes  |
| > integration testing on    | > identification and correction of any |
| > the device, which         | > residual vulnerabilities stemming    |
| > includes identification   | > from the integration with the        |
| > and correction of any     | > vendor's platform, was performed.    |
| > residual vulnerabilities  |                                        |
| > stemming from the         |                                        |
| > integration with the      |                                        |
| > vendor's platform.        |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***2B-4** Applications do   |                                        |
| not implement any           |                                        |
| account-data encryption     |                                        |
| functions in lieu of SRED   |                                        |
| encryption. All such        |                                        |
| functions are performed by  |                                        |
| the approved SRED firmware  |                                        |
| of the POI device.*         |                                        |
+-----------------------------+----------------------------------------+
| > **2B-4.1** The            | > **2B-4.1.a** Examine the             |
| > application must not      | > application's *Implementation Guide* |
| > directly encrypt          | > required at 2C-3 of this document    |
| > clear-text account data.  | > and verify the description of the    |
| > The application must not  | > application's function includes the  |
| > implement any             | > following:                           |
| > account-data encryption   |                                        |
| > functions that bypass or  | -   Confirmation that the application  |
| > are intended to be used   |     > does not perform encryption of   |
| > instead of the approved   |     > clear-text account-data, nor     |
| > SRED encryption functions |     > does it replace the POI device's |
| > of the POI device's       |     > SRED encryption                  |
| > firmware.                 |                                        |
| >                           | -   A description of the purpose and   |
| > ***Note:** The            |     > encryption method for any        |
| > application may provide   |     > encryption provided by the       |
| > additional encryption on  |     > application in addition to SRED  |
| > the SRED-encrypted        |     > encryption                       |
| > account data; however it  |                                        |
| > cannot bypass or replace  |                                        |
| > the SRED encryption of    |                                        |
| > the clear-text account    |                                        |
| > data.*                    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2B-4.1.b** Perform a source-code   |
|                             | > review to verify that any            |
|                             | > application functionality            |
|                             | > facilitating the encryption of       |
|                             | > account data utilizes the approved   |
|                             | > cryptographic algorithm(s) and       |
|                             | > associated key-management functions  |
|                             | > of the POI device's SRED firmware    |
|                             | > and is not implemented within the    |
|                             | > application itself.                  |
+-----------------------------+----------------------------------------+
|                             | > **2B-4.1.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify the  |
|                             | > application does not perform         |
|                             | > encryption of account-data nor does  |
|                             | > it replace the SRED encryption       |
|                             | > performed by the underlying POI      |
|                             | > device's firmware.                   |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2B: Develop  |                                        |
| and maintain secure         |                                        |
| applications***             |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **2B-4.2** The            | > **2B-4.2.a** Examine the             |
| > application must not be   | > application's *Implementation Guide* |
| > able to decrypt SRED-     | > required at 2C-3 of this document    |
| > encrypted account         | > and verify the description of the    |
| > datai.e., the            | > application's function includes the  |
| > application must not be   | > following:                           |
| > able to recover the       |                                        |
| > original clear-text       | -   Confirmation that the application  |
| > account data from the     |     > is not capable of decrypting any |
| > encrypted account data.   |     > clear-text account data          |
|                             |     > encrypted by the SRED functions  |
|                             |     > of the underlying POI firmware.  |
+-----------------------------+----------------------------------------+
|                             | > **2B-4.2.b** Perform a source-code   |
|                             | > review to verify that the            |
|                             | > application is not capable of        |
|                             | > decrypting any clear-text account    |
|                             | > data encrypted by the SRED functions |
|                             | > of the underlying POI firmware.      |
+-----------------------------+----------------------------------------+
|                             | > **2B-4.2.c** Install and configure   |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Using an     |
|                             | > appropriate "test platform" (if      |
|                             | > necessary), perform test             |
|                             | > transactions that utilize all        |
|                             | > functions of the application that    |
|                             | > handle account data. Use forensic    |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify the  |
|                             | > application is not capable of        |
|                             | > decrypting any clear-text account    |
|                             | > data encrypted by the SRED functions |
|                             | > of the underlying POI firmware.      |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| []{#_bookmark35             |                                        |
| .anchor}***Requirement 2C:  |                                        |
| Implement secure            |                                        |
| application-management      |                                        |
| processes***                |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***2C-1** New               |                                        |
| vulnerabilities are         |                                        |
| discovered and applications |                                        |
| are tested for those        |                                        |
| vulnerabilities on an       |                                        |
| ongoing basis.*             |                                        |
+-----------------------------+----------------------------------------+
| > **2C-1.1** Software       | > **2C-1.1.a** Obtain and examine      |
| > developers must establish | > processes to identify new            |
| > and implement a process   | > vulnerabilities and test             |
| > to identify and test      | > applications for vulnerabilities     |
| > their applications for    | > that may affect the application.     |
| > security vulnerabilities  | > Verify the processes include the     |
| > and implementation errors | > following:                           |
| > prior to every release    |                                        |
| > (including updates or     | -   Using outside sources for security |
| > patches) using manual or  |     > vulnerability information        |
| > automated vulnerability   |                                        |
| > assessment processes.     | -   Periodic testing of applications   |
|                             |     > for new vulnerabilities          |
+-----------------------------+----------------------------------------+
|                             | > **2C-1.1.b** Interview responsible   |
|                             | > software vendor personnel to confirm |
|                             | > the following:                       |
|                             |                                        |
|                             | -   New vulnerabilities are identified |
|                             |     > using outside sources of         |
|                             |     > security vulnerability           |
|                             |     > information                      |
|                             |                                        |
|                             | -   All applications are tested for    |
|                             |     > vulnerabilities                  |
+-----------------------------+----------------------------------------+
| > **2C-1.2** Software       | > **2C-1.2.a** Obtain and examine      |
| > vendors must establish    | > processes to develop and deploy      |
| > and implement a process   | > application security upgrades.       |
| > to develop and deploy     | > Verify that processes include the    |
| > critical security updates | > timely development and deployment of |
| > to address discovered     | > critical security updates to         |
| > security vulnerabilities  | > customers.                           |
| > in a timely manner.       |                                        |
| >                           |                                        |
| > ***Note:** A "critical    |                                        |
| > security update" is one   |                                        |
| > that addresses an         |                                        |
| > imminent risk to account  |                                        |
| > data.*                    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2C-1.2.b** Interview responsible   |
|                             | > software-vendor personnel to confirm |
|                             | > that application security updates    |
|                             | > are developed and critical security  |
|                             | > updates are deployed in a timely     |
|                             | > manner.                              |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2C:          |                                        |
| Implement secure            |                                        |
| application-management      |                                        |
| processes***                |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***2C-2** Applications are  |                                        |
| installed and updates are   |                                        |
| implemented on the          |                                        |
| PCI-approved POI devices    |                                        |
| only via trusted and        |                                        |
| cryptographically           |                                        |
| authenticated processes     |                                        |
| using an approved security  |                                        |
| mechanism evaluated for the |                                        |
| PCI-approved POI devices.*  |                                        |
+-----------------------------+----------------------------------------+
| > **2C-2.1** Ensure that    | > **2C-2.1** To confirm that all       |
| > all application           | > application installations and        |
| > installations and updates | > updates are cryptographically        |
| > are cryptographically     | > authenticated, verify the following: |
| > authenticated as follows: |                                        |
+-----------------------------+----------------------------------------+
| > **2C-2.1.1** All          | > **2C-2.1.1.a** Examine the           |
| > application installations | > application's *Implementation Guide* |
| > and updates on a POI      | > required at **2C-3** of this         |
| > device are                | > document and verify that it includes |
| > cryptographically         | > the following:                       |
| > authenticated using the   |                                        |
| > approved security         | -   A description of how the           |
| > mechanisms of the POI     |     > application is cryptographically |
| > device's firmware.        |     > authenticated using the approved |
|                             |     > security mechanisms of the POI   |
|                             |     > device's firmware for any        |
|                             |     > application installations and    |
|                             |     > updates                          |
|                             |                                        |
|                             | -   Instructions for how to use the    |
|                             |     > approved security mechanisms to  |
|                             |     > perform application              |
|                             |     > installations and updates        |
|                             |                                        |
|                             | -   A statement that application       |
|                             |     > installations and updates cannot |
|                             |     > occur except by using the        |
|                             |     > approved security mechanisms of  |
|                             |     > the POI device's firmware        |
+-----------------------------+----------------------------------------+
|                             | > **2C-2.1.1.b** Perform a source-code |
|                             | > review to verify that the            |
|                             | > application only allows              |
|                             | > installations and updates using the  |
|                             | > approved security mechanisms of the  |
|                             | > POI device's firmware.               |
+-----------------------------+----------------------------------------+
|                             | > **2C-2.1.1.c** Install and configure |
|                             | > the application according to the     |
|                             | > application vendor's documentation,  |
|                             | > including the application's          |
|                             | > *Implementation Guide*. Use forensic |
|                             | > tools and/or methods (commercial     |
|                             | > tools, scripts, etc.) to verify      |
|                             | > that, by following the               |
|                             | > *Implementation Guide,* the          |
|                             | > application only allows              |
|                             | > installations and updates using the  |
|                             | > approved security mechanisms of the  |
|                             | > POI device's firmware.               |
+-----------------------------+----------------------------------------+
|                             | > **2C-2.1.1.d** After the application |
|                             | > is installed and configured in       |
|                             | > accordance with the *Implementation  |
|                             | > Guide,* attempt to perform an        |
|                             | > installation and an update using     |
|                             | > non-approved security mechanisms,    |
|                             | > and verify that the POI device will  |
|                             | > not allow the installation or update |
|                             | > to occur.                            |
+-----------------------------+----------------------------------------+
| > **2C-2.1.2** The          | > **2C-2.1.2** Examine the             |
| > application developer     | > application's *Implementation Guide* |
| > includes guidance for     | > required at **2C-3** of this         |
| > whoever signs the         | > document and verify that it includes |
| > application, including    | > the following:                       |
| > requirements for using an |                                        |
| > SCD with dual control for | -   Instructions for how to sign the   |
| > the application-signing   |     > application                      |
| > process.                  |                                        |
|                             | -   Instructions how to use an SCD     |
|                             |     > with dual control for the        |
|                             |     > application-signing process      |
|                             |                                        |
|                             | -   A statement that all applications  |
|                             |     > must be signed via the           |
|                             |     > instructions provided in the     |
|                             |     > *Implementation Guide*           |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 2C:          |                                        |
| Implement secure            |                                        |
| application-management      |                                        |
| processes***                |                                        |
+=============================+========================================+
| > **Domain 2 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > ***2C-3** Maintain        |                                        |
| > instructional             |                                        |
| > documentation and         |                                        |
| > training programs for the |                                        |
| > application's             |                                        |
| > installation,             |                                        |
| > maintenance/upgrades, and |                                        |
| > use.*                     |                                        |
+-----------------------------+----------------------------------------+
| > **2C-3.1** The process to | > **2C-3.1** Examine the               |
| > develop, maintain, and    | > *Implementation Guide* and related   |
| > disseminate an            | > processes, and verify the guide is   |
| > *Implementation Guide*    | > disseminated to all relevant         |
| > for the application's     | > application installers and users     |
| > installation,             | > (including customers, resellers, and |
| > maintenance, upgrades and | > integrators).                        |
| > general use includes the  |                                        |
| > following:                |                                        |
+-----------------------------+----------------------------------------+
| > **2C-3.1.1** Addresses    | > **2C-3.1.1** Verify the              |
| > all requirements in P2PE  | > *Implementation Guide* covers all    |
| > Domain 2 wherever the     | > related requirements in P2PE Domain  |
| > *Implementation Guide* is | > 2.                                   |
| > referenced.               |                                        |
+-----------------------------+----------------------------------------+
| > **2C-3.1.2** Review of    | > **2C-3.1.2.a** Verify the            |
| > the *Implementation       | > *Implementation Guide* is reviewed   |
| > Guide* at least annually  | > at least annually and upon changes   |
| > and upon changes to the   | > to the application or the P2PE       |
| > application or the P2PE   | > Domain 2 requirements.               |
| > Domain 2 requirements,    |                                        |
| > and update as needed to   |                                        |
| > keep the documentation    |                                        |
| > current with:             |                                        |
|                             |                                        |
| -   Any changes to the      |                                        |
|     > application (e.g.,    |                                        |
|     > device                |                                        |
|     > changes/upgrades and  |                                        |
|     > major and minor       |                                        |
|     > software changes)     |                                        |
|                             |                                        |
| -   Any changes to the      |                                        |
|     > *Implementation       |                                        |
|     > Guide*                |                                        |
|                             |                                        |
| > requirements in this      |                                        |
| > document                  |                                        |
+-----------------------------+----------------------------------------+
|                             | > **2C-3.1.2.b** Verify the            |
|                             | > *Implementation Guide* is updated as |
|                             | > needed to keep the documentation     |
|                             | > current with:                        |
|                             |                                        |
|                             | -   Any changes to the application     |
|                             |     > (e.g., device changes/upgrades   |
|                             |     > and major and minor software     |
|                             |     > changes)                         |
|                             |                                        |
|                             | -   Any changes to the *Implementation |
|                             |     > Guide* requirements in this      |
|                             |     > document                         |
+-----------------------------+----------------------------------------+
| > **2C-3.1.3** Distribution | > **2C-3.1.3** Verify the              |
| > to all new and existing   | > *Implementation Guide* is            |
| > application installers    | > distributed to new application       |
| > (e.g., solution           | > installers, and re-distributed to    |
| > providers,                | > all application installers every     |
| > integrator/resellers,     | > time the guide is updated.           |
| > etc.), and                |                                        |
| > re-distribution to all    |                                        |
| > existing application      |                                        |
| > installers every time the |                                        |
| > guide is updated.         |                                        |
+-----------------------------+----------------------------------------+
| > **2C-3.2** Develop and    | > **2C-3.2** Examine the training      |
| > implement training and    | > materials and communication program, |
| > communication programs to | > and confirm the materials cover all  |
| > ensure application        | > items noted for the *Implementation  |
| > installers (e.g.,         | > Guide* throughout P2PE Domain 2.     |
| > solution providers or     |                                        |
| > integrators/resellers)    |                                        |
| > know how to implement the |                                        |
| > application according to  |                                        |
| > the *Implementation       |                                        |
| > Guide*.                   |                                        |
+-----------------------------+----------------------------------------+
| > **2C-3.2.1** Review the   | > **2C-3.2.1** Examine the training    |
| > training materials for    | > materials for resellers and          |
| > application installers on | > integrators and verify the materials |
| > an annual basis and       | > are reviewed on an annual basis and  |
| > whenever new application  | > when new application versions are    |
| > versions are released.    | > released, and updated as needed.     |
| > Update as needed to       |                                        |
| > ensure materials are      |                                        |
| > current with the          |                                        |
| > *Implementation Guide*.   |                                        |
+-----------------------------+----------------------------------------+

> []{#_bookmark36 .anchor}**Domain 2 Informative Annex: Summary of
> Contents for the *Implementation Guide* for P2PE Applications**
>
> This Annex summarizes required content for each application's
> *Implementation Guide,* as required for applications assessed to P2PE
> Domain 2, and describes and contains only those Domain 2 requirements
> that have related *Implementation Guide* topics. It is intended only
> as a summary reference for required *Implementation Guide* contents
> and does not specify any additional requirements.

+----+---------------------------+-------------------------------------+
| ** |                           | **Required Content for the          |
| Do |                           | *Implementation Guide***            |
| ma |                           |                                     |
| in |                           |                                     |
| 2  |                           |                                     |
| R  |                           |                                     |
| eq |                           |                                     |
| ui |                           |                                     |
| re |                           |                                     |
| me |                           |                                     |
| nt |                           |                                     |
| ** |                           |                                     |
+====+===========================+=====================================+
| 2A | The application must not  | > ![](verto                         |
| -3 | facilitate, via its own   | pal_60a238a099614e179dec6351a3c5045 |
| .2 | logical interface(s),     | 7/media/image2.png){width="0.125in" |
|    | sharing of clear-text     | > height="0.1527777777777778in"} A  |
|    | account data directly     | > list of all logical interfaces    |
|    | with other applications   | > for the application, and the      |
|    | (including non-payment    | > function/purpose of each.         |
|    | software).                | >                                   |
|    |                           | > ![](verto                         |
|    |                           | pal_60a238a099614e179dec6351a3c5045 |
|    |                           | 7/media/image2.png){width="0.125in" |
|    |                           | > height="0.1527777777777778in"}    |
|    |                           | > The logical interfaces intended   |
|    |                           | > for sharing of clear-text account |
|    |                           | > data (e.g., those used to pass    |
|    |                           | > clear-text data back to the       |
|    |                           | > approved firmware of the POI      |
|    |                           | > device)                           |
|    |                           | >                                   |
|    |                           | > ![](verto                         |
|    |                           | pal_60a238a099614e179dec6351a3c5045 |
|    |                           | 7/media/image2.png){width="0.125in" |
|    |                           | > height="0.1527777777777778in"}    |
|    |                           | > The logical interfaces not        |
|    |                           | > intended for sharing of           |
|    |                           | > clear-text account data (e.g.,    |
|    |                           | > those for communication with      |
|    |                           | > other applications)               |
+----+---------------------------+-------------------------------------+
| 2A | The application only uses | Guidance that use of any other      |
| -3 | external communication    | methods for external communications |
| .3 | methods included in the   | is not allowed.                     |
|    | PCI-approved POI device   |                                     |
|    | evaluation and has not    |                                     |
|    | implemented its own       |                                     |
|    | external communication    |                                     |
|    | stack.                    |                                     |
+----+---------------------------+-------------------------------------+

+----+---------------------------+-------------------------------------+
| ** |                           | **Required Content for the          |
| Do |                           | *Implementation Guide***            |
| ma |                           |                                     |
| in |                           |                                     |
| 2  |                           |                                     |
| R  |                           |                                     |
| eq |                           |                                     |
| ui |                           |                                     |
| re |                           |                                     |
| me |                           |                                     |
| nt |                           |                                     |
| ** |                           |                                     |
+====+===========================+=====================================+
| 2A | Any whitelisting          | Details to describe any             |
| -3 | functionality implemented | whitelisting functionality          |
| .4 | by the application must   | implemented by the application as   |
|    | include guidance in the   | follows:                            |
|    | application's             |                                     |
|    | *Implementation Guide*    | -   How to configure the            |
|    | that includes the         |     > application functionality to  |
|    | following:                |     > ensure the output of clear-   |
|    |                           |     > text account data is          |
|    | -   How to configure the  |     > prohibited, except for        |
|    |     whitelisting          |     > non-PCI payment brand         |
|    |     functionality to      |     > account/card data             |
|    |     ensure the output of  |                                     |
|    |     clear-text account    | -   How to perform cryptographic    |
|    |     data is prohibited,   |     > signing (or similar) prior to |
|    |     except for non-PCI    |     > installation on the POI       |
|    |     payment brand         |     > device by authorized          |
|    |     account/card data.    |     > personnel using dual control. |
|    |                           |                                     |
|    | -   How to perform        | -   How to establish                |
|    |     cryptographic signing |     > cryptographically             |
|    |     (or similar) prior to |     > authentication by the POI     |
|    |     installation on the   |     > device's firmware             |
|    |     POI device by         |                                     |
|    |     authorized personnel  | -   That review of whitelist        |
|    |     using dual control.   |     > functionality must be         |
|    |                           |     > performed to confirm it only  |
|    | -   How to perform        |     > outputs non-PCI payment brand |
|    |     cryptographic         |     > account/card data.            |
|    |     authentication by the |                                     |
|    |     POI device's firmware | -   That such functionality must be |
|    |                           |     > approved by authorized        |
|    | -   That review of        |     > personnel prior to            |
|    |     whitelist             |     > implementation                |
|    |     functionality to      |                                     |
|    |     confirm it only       | -   That documentation for all new  |
|    |     outputs non-PCI       |     > installations or updates to   |
|    |     payment brand         |     > whitelist functionality       |
|    |     account/card data.    |     > includes the following:       |
|    |                           |                                     |
|    | -   That such             | -   Description and justification   |
|    |     functionality must be |     > for the functionality         |
|    |     approved by           |                                     |
|    |     authorized personnel  | -   Who approved the new            |
|    |     prior to              |     > installation or updated       |
|    |     implementation        |     > functionality prior to        |
|    |                           |     > release                       |
|    | -   That documentation    |                                     |
|    |     for all new           | -   Confirmation that it was        |
|    |     installations or      |     > reviewed prior to release to  |
|    |     updates to whitelist  |     > only output non-PCI payment   |
|    |     functionality that    |     > brand account/card data       |
|    |     includes the          |                                     |
|    |     following:            |                                     |
|    |                           |                                     |
|    | -   Description and       |                                     |
|    |     justification for the |                                     |
|    |     functionality         |                                     |
|    |                           |                                     |
|    | -   Who approved the new  |                                     |
|    |     installation or       |                                     |
|    |     updated functionality |                                     |
|    |     prior to release      |                                     |
|    |                           |                                     |
|    | -   Confirmation that it  |                                     |
|    |     was reviewed prior to |                                     |
|    |     release to only       |                                     |
|    |     output non-PCI        |                                     |
|    |     payment brand         |                                     |
|    |     account/card data     |                                     |
+----+---------------------------+-------------------------------------+
| 2B | Applications must be      | Information from the POI device     |
| -1 | developed based on        | vendor's security guidance          |
| .1 | industry best practices   | applicable to the solution provider |
|    | and in accordance with    | (e.g., application configuration    |
|    | the POI device vendor's   | settings which are necessary for    |
|    | security guidance, and    | the application to function with    |
|    | information security is   | the device).                        |
|    | incorporated throughout   |                                     |
|    | the software development  |                                     |
|    | life cycle.               |                                     |
+----+---------------------------+-------------------------------------+
| 2B | All changes to the        | -   Documentation detailing the     |
| -1 | application must follow   |     > impact of all changes         |
| .3 | change-control            |     > included in the relevant      |
|    | procedures.               |     > application release           |
|    |                           |                                     |
|    |                           | -   Instructions detailing back out |
|    |                           |     > or de-installation procedures |
|    |                           |     > for the application           |
+----+---------------------------+-------------------------------------+

+----+---------------------------+-------------------------------------+
| ** |                           | **Required Content for the          |
| Do |                           | *Implementation Guide***            |
| ma |                           |                                     |
| in |                           |                                     |
| 2  |                           |                                     |
| R  |                           |                                     |
| eq |                           |                                     |
| ui |                           |                                     |
| re |                           |                                     |
| me |                           |                                     |
| nt |                           |                                     |
| ** |                           |                                     |
+====+===========================+=====================================+
| 2  | The vendor's published    | A description of the vendor's       |
| B- | versioning methodology    | published versioning methodology,   |
| 1. | must be communicated to   | including the following:            |
| 10 | customers and             |                                     |
|    | integrators/resellers.    | -   Details of versioning scheme,   |
|    |                           |     > including the format of the   |
|    |                           |     > version scheme (number of     |
|    |                           |     > elements, separators,         |
|    |                           |     > character set, etc.)          |
|    |                           |                                     |
|    |                           | -   Details of how                  |
|    |                           |     > security-impacting changes    |
|    |                           |     > will be indicated by the      |
|    |                           |     > version scheme                |
|    |                           |                                     |
|    |                           | -   Details of how other types of   |
|    |                           |     > changes will affect the       |
|    |                           |     > version                       |
|    |                           |                                     |
|    |                           | -   Details of any wildcard         |
|    |                           |     > elements that are used,       |
|    |                           |     > including confirmation that   |
|    |                           |     > they will never be used to    |
|    |                           |     > represent a                   |
|    |                           |     > security-impacting change     |
+----+---------------------------+-------------------------------------+
| 2B | Where the application     | -   Any instructions on how to      |
| -2 | relies on the Open        |     > securely configure any        |
| .1 | Protocol functionality of |     > configurable options, as      |
|    | the POI device firmware,  |     > applicable to the             |
|    | the application must be   |     > application's specific        |
|    | developed in accordance   |     > business processing.          |
|    | with the POI device       |                                     |
|    | vendor's security         | -   Any guidance that the POI       |
|    | guidance.                 |     > device vendor intended for    |
|    |                           |     > integrators/ resellers,       |
|    |                           |     > solution providers, and/or    |
|    |                           |     > end-users.                    |
+----+---------------------------+-------------------------------------+
| 2B | The application           | Includes the following, in          |
| -2 | development process must  | accordance with the POI device      |
| .2 | include secure            | vendor's security guidance:         |
|    | integration with any      |                                     |
|    | shared resources.         | -   A list of shared resources      |
|    |                           |                                     |
|    |                           | -   A description of how the device |
|    |                           |     > connects to and/or uses       |
|    |                           |     > shared resources              |
|    |                           |                                     |
|    |                           | -   Instructions for how the        |
|    |                           |     > application should be         |
|    |                           |     > configured to ensure secure   |
|    |                           |     > integration with shared       |
|    |                           |     > resources                     |
+----+---------------------------+-------------------------------------+
| 2B | The application developer | Security guidance for solution      |
| -3 | must provide security     | providers, describing how           |
| .1 | guidance describing how   | cryptographic keys and/or           |
| .1 | cryptographic keys and/or | certificates have to be used and    |
|    | certificates have to be   | managed.                            |
|    | used.                     |                                     |
+----+---------------------------+-------------------------------------+
| 2B | The application must not  | The description of the              |
| -4 | directly encrypt          | application's function that         |
| .1 | clear-text account data.  | includes the following:             |
|    | The application must not  |                                     |
|    | implement any             | -   Confirmation that the           |
|    | account-data encryption   |     > application does not perform  |
|    | functions that bypass or  |     > its own encryption of         |
|    | are intended to be used   |     > clear-text account data, nor  |
|    | instead of the approved   |     > does it replace the POI       |
|    | SRED encryption functions |     > device's SRED encryption.     |
|    | of the POI device's       |                                     |
|    | firmware.                 | -   A description of the purpose    |
|    |                           |     > and encryption method for any |
|    |                           |     > encryption provided by the    |
|    |                           |     > application in addition to    |
|    |                           |     > SRED encryption.              |
+----+---------------------------+-------------------------------------+

+----+---------------------------+-------------------------------------+
| ** |                           | **Required Content for the          |
| Do |                           | *Implementation Guide***            |
| ma |                           |                                     |
| in |                           |                                     |
| 2  |                           |                                     |
| R  |                           |                                     |
| eq |                           |                                     |
| ui |                           |                                     |
| re |                           |                                     |
| me |                           |                                     |
| nt |                           |                                     |
| ** |                           |                                     |
+====+===========================+=====================================+
| 2  | All application           | -   A description of how the        |
| C- | installations and updates |     > application uses the approved |
|    | are cryptographically     |     > security protocol of the POI  |
| 2  | authenticated using the   |     > device's firmware for any     |
| .1 | approved security         |     > application installations and |
| .1 | mechanisms of the POI     |     > updates                       |
|    | device's firmware.        |                                     |
|    |                           | -   Instructions for how to use the |
|    |                           |     > approved security protocol to |
|    |                           |     > perform application           |
|    |                           |     > installations and updates     |
|    |                           |                                     |
|    |                           | -   A statement that application    |
|    |                           |     > installations and updates     |
|    |                           |     > cannot occur except by using  |
|    |                           |     > the approved security         |
|    |                           |     > protocol of the POI device's  |
|    |                           |     > firmware                      |
+----+---------------------------+-------------------------------------+
| 2  | The application developer | -   Instructions for how to sign    |
| C- | includes guidance for     |     > the application               |
|    | whoever signs the         |                                     |
| 2  | application, including    | -   Instructions how to implement   |
| .1 | requirements for using an |     > the dual control for the      |
| .2 | SCD with dual control for |     > application-signing process   |
|    | the application-signing   |                                     |
|    | process.                  | -   A statement that all            |
|    |                           |     > applications must be signed   |
|    |                           |     > via the instructions provided |
|    |                           |     > in the *Implementation        |
|    |                           |     > Guide.*                       |
+----+---------------------------+-------------------------------------+

# Domain 3: P2PE Solution Management

+--------------+------------------+-----------------------------------+
| > **Domain** | > **Overview**   | > **P2PE Validation               |
|              |                  | > Requirements**                  |
+==============+==================+===================================+
| > **Domain   | Overall          | **3A** P2PE solution management   |
| > 3:**       | management of    |                                   |
| >            | the P2PE         | **3B** Third-party management     |
| > **P2PE     | solution by the  |                                   |
| > Solution   | solution         | **3C** Creation and maintenance   |
| >            | provider,        | of *P2PE Instruction Manual* for  |
| Management** | including        | merchants                         |
|              | third-party      |                                   |
|              | relationships,   |                                   |
|              | incident         |                                   |
|              | response, and    |                                   |
|              | the *P2PE        |                                   |
|              | Instruction      |                                   |
|              | Manual* (PIM).   |                                   |
+--------------+------------------+-----------------------------------+

> ***Target Audience:** The solution provider (or merchant as a solution
> provider for merchant-managed solutions), who maintains ultimate
> responsibility of the P2PE solution.*

#### *Overview*

> The effective management and integration of the essential elements
> comprising the P2PE solution ultimately results in the absence of
> clear-text account data within the merchant's encryption
> environment---e.g., merchant stores, shops, retail premises, etc.
> Domain 3 is critical to the P2PE solution due to the fact that P2PE
> solutions consist of numerous devices/products (POI devices,
> Applications, HSMs) operating in various environments (encryption,
> decryption, and key-injection), and all of these devices, products,
> and environments must be successfully integrated together and managed.

  -----------------------------------------------------------------------
  Additionally, requirements in Domain 3      ***Note:** For
  include providing detailed instructions for merchant-managed solutions,
  the merchant in the *P2PE Instruction       the merchant as a solution
  Manual* (PIM)*.* The PIM Template is        provider must prepare the
  provided as a separate document so that the P2PE Instruction Manual
  solution provider can easily 1) determine   (PIM) for its encryption
  required content for the PIM, and 2)        environments.*
  transfer that content to the template to    
  produce the PIM deliverable for merchants.  
  The PIM provides merchants pertinent        
  guidance to effectively and securely manage 
  their encryption environments and devices   
  within their purview: e.g., the secure      
  installation of POI devices, monitoring POI 
  devices for signs of tampering, and         
  appropriate incident response procedures    
  for security incidents.                     
  ------------------------------------------- ---------------------------
                                              *For merchant-managed
                                              solutions, the term
                                              "merchant" as used within
                                              Domains 1, 3, 4, and 5 of
                                              this document refers to the
                                              merchant's encryption
                                              environments and represents
                                              requirements the merchant
                                              as a solution provider is
                                              responsible for meeting
                                              for, or on behalf of, those
                                              merchant encryption
                                              environments.*

  -----------------------------------------------------------------------

+-----------------------------+----------------------------------------+
| []{#_bookmark39             |                                        |
| .anchor}***Requirement 3A:  |                                        |
| P2PE solution management*** |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***3A-1** The solution      |                                        |
| provider maintains          |                                        |
| documentation detailing the |                                        |
| P2PE solution architecture  |                                        |
| and data flows.*            |                                        |
+-----------------------------+----------------------------------------+
| > **3A-1.1** Current        | > **3A-1.1.a** Interview relevant      |
| > documentation must be     | > personnel and review documentation   |
| > maintained to describe or | > to verify that procedures exist for  |
| > illustrate the            | > maintaining documentation that       |
| > architecture of the       | > describes and/or illustrates the     |
| > overall P2PE solution and | > architecture of the overall P2PE     |
| > include the following:    | > solution.                            |
|                             |                                        |
| -   Identification of all   |                                        |
|     > parts of the overall  |                                        |
|     > solution managed by   |                                        |
|     > the solution provider |                                        |
|                             |                                        |
| -   Identification of any   |                                        |
|     > parts of the overall  |                                        |
|     > solution outsourced   |                                        |
|     > to third-party        |                                        |
|     > service providers     |                                        |
|                             |                                        |
| -   Identification of P2PE  |                                        |
|     > controls covered by   |                                        |
|     > each third- party     |                                        |
|     > service provider.     |                                        |
+-----------------------------+----------------------------------------+
|                             | > **3A-1.1.b** Interview relevant      |
|                             | > personnel and review documentation   |
|                             | > that describes and/or illustrates    |
|                             | > the architecture of the overall P2PE |
|                             | > solution to verify that the document |
|                             | > is current.                          |
+-----------------------------+----------------------------------------+
|                             | > **3A-1.1.c** Interview relevant      |
|                             | > personnel and review documentation   |
|                             | > that describes and/or illustrates    |
|                             | > the architecture of the overall P2PE |
|                             | > solution to verify that the          |
|                             | > document:                            |
|                             |                                        |
|                             | -   Identifies all components of the   |
|                             |     > overall solution managed by the  |
|                             |     > solution provider.               |
|                             |                                        |
|                             | -   Identifies all components of the   |
|                             |     > overall solution that have been  |
|                             |     > outsourced to third-party        |
|                             |     > solution providers.              |
|                             |                                        |
|                             | -   Identifies all P2PE controls       |
|                             |     > covered by each third-party      |
|                             |     > service provider.                |
+-----------------------------+----------------------------------------+
| > **3A-1.2** Current        | > **3A-1.2** Examine the data-flow     |
| > documentation (including  | > diagram and interview personnel to   |
| > a data-flow diagram) must | > verify the diagram:                  |
| > include details of the    |                                        |
| > account-data flow from    | -   Shows all account-data flows       |
| > the POI device (the point |     > across systems and networks from |
| > the card data is captured |     > the point the card data is       |
| > and encrypted) through to |     > captured through to the point    |
| > the point the encrypted   |     > the card data exits the          |
| > card data is decrypted    |     > decryption environment.          |
| > and the clear-text data   |                                        |
| > exits the decryption      | -   Is kept current and updated as     |
| > environment.              |     > needed upon changes to the       |
|                             |     > environment.                     |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 3A: P2PE     |                                        |
| solution management***      |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **3A-1.3** Where there is | > **3A-1.3.a** Review solution         |
| > a legal or regulatory     | > provider's documentation about the   |
| > obligation in a region    | > legal/regulatory obligation that     |
| > for merchants to print    | > requires merchants to have access to |
| > full PAN on merchant      | > full PANs for receipt printing       |
| > receipts, it is allowable | > purposes to verify that the          |
| > for the merchant to have  | > documentation includes at least the  |
| > access to full PAN for    | > following details about the          |
| > this purpose but the      | > legal/regulatory obligation:         |
| > solution provider must    |                                        |
| > document specifics about  | -   What specifically is required      |
| > the legal or regulatory   |                                        |
| > obligation including at   | -   Which legal/regulatory entity      |
| > least the following:      |     > requires it                      |
|                             |                                        |
| -   What specifically is    | -   To which region/country it applies |
|     > required              |                                        |
|                             |                                        |
| -   Which legal/regulatory  |                                        |
|     > entity requires it    |                                        |
|                             |                                        |
| -   To which region/country |                                        |
|     > it applies            |                                        |
|                             |                                        |
| *Note that Domain 1 (at     |                                        |
| **1B-1.1.1**) and Domain 2  |                                        |
| (at **2A-3.1.2**) also      |                                        |
| include requirements that   |                                        |
| must be met for any POI     |                                        |
| device and any P2PE         |                                        |
| application, respectively,  |                                        |
| that facilitates merchant   |                                        |
| printing of full PAN where  |                                        |
| there is a legal or         |                                        |
| regulatory obligation to do |                                        |
| so.*                        |                                        |
+-----------------------------+----------------------------------------+
|                             | > **3A-1.3.b** Perform independent     |
|                             | > review of, or conduct interviews     |
|                             | > with responsible solution provider   |
|                             | > personnel, to verify that the        |
|                             | > exception to facilitate merchants'   |
|                             | > access to full PANs is based on a    |
|                             | > legal/regulatory obligation and not  |
|                             | > solely for convenience.              |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 3A: P2PE     |                                        |
| solution management***      |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***3A-2** The solution      |                                        |
| provider manages and        |                                        |
| monitors status reporting   |                                        |
| from P2PE component         |                                        |
| providers.*                 |                                        |
+-----------------------------+----------------------------------------+
| > **3A-2.1** Where P2PE     | > **3A-2.1** Where component providers |
| > component providers are   | > are used, interview responsible      |
| > used, a methodology must  | > personnel, review documentation, and |
| > be implemented to manage  | > observe processes to verify the      |
| > and monitor status        | > solution provider has implemented a  |
| > reporting from P2PE       | > methodology for managing and         |
| > component providers,      | > monitoring status reporting from     |
| > including:                | > P2PE component providers, including  |
|                             | > processes for:                       |
| -   Ensuring reports are    |                                        |
|     > received from all     | -   Ensuring reports are received from |
|     > P2PE component        |     > all P2PE component providers as  |
|     > providers as          |     > specified in the "*Component     |
|     > specified in the      |     > providers ONLY: report status to |
|     > "*Component providers |     > solution providers*" sections of |
|     > ONLY: report status   |     > this Standard (as applicable to  |
|     > to solution           |     > the component provider)          |
|     > providers*" sections  |                                        |
|     > of this Standard (as  | -   Confirming reports include at      |
|     > applicable to the     |     > least the details specified in   |
|     > component provider)   |     > the "*Component providers ONLY:  |
|                             |     > report status to solution        |
| -   Confirming reports      |     > providers*" sections of this     |
|     > include at least the  |     > Standard (as applicable to the   |
|     > details specified in  |     > component provider), and any     |
|     > the "*Component       |     > additional details as agreed     |
|     > providers ONLY:       |     > between a component provider and |
|     > report status to      |     > the solution provider            |
|     > solution providers*"  |                                        |
|     > sections of this      | -   Following up with the component    |
|     > Standard (as          |     > provider to resolve any          |
|     > applicable to the     |     > questions or changes in expected |
|     > component provider),  |     > performance of the component     |
|     > and any additional    |     > provider                         |
|     > details as agreed     |                                        |
|     > between a component   |                                        |
|     > provider and the      |                                        |
|     > solution provider     |                                        |
|                             |                                        |
| -   Following up with the   |                                        |
|     > component provider to |                                        |
|     > resolve any questions |                                        |
|     > or changes in         |                                        |
|     > expected performance  |                                        |
|     > of the component      |                                        |
|     > provider              |                                        |
+-----------------------------+----------------------------------------+
| > **3A-2.2** Processes must | > **3A-2.2.a** Interview responsible   |
| > be implemented to ensure  | > personnel and review documentation   |
| > P2PE controls are         | > to verify the solution provider has  |
| > maintained when changes   | > a formal process for ensuring P2PE   |
| > to the P2PE solution      | > controls are maintained when changes |
| > occur including, but not  | > to the P2PE solution occur,          |
| > limited to:               | > including procedures for addressing  |
|                             | > the following:                       |
| -   Changes in third-party  |                                        |
|     > service providers     | -   Changes in third-party service     |
|                             |     > providers                        |
| -   Changes in overall      |                                        |
|     > solution architecture | -   Changes in overall solution        |
|                             |     > architecture                     |
+-----------------------------+----------------------------------------+
|                             | > **3A-2.2.b** For a sample of         |
|                             | > changes, verify changes were         |
|                             | > documented and the solution updated  |
|                             | > accordingly.                         |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 3A: P2PE     |                                        |
| solution management***      |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***3A-3** Solution provider |                                        |
| implements processes to     |                                        |
| respond to notifications    |                                        |
| from merchants, component   |                                        |
| providers, and/or other     |                                        |
| third parties, and provide  |                                        |
| notifications about any     |                                        |
| suspicious activity         |                                        |
| involving the P2PE          |                                        |
| solution.*                  |                                        |
+-----------------------------+----------------------------------------+
| > **3A-3.1** Processes must | > **3A-3.1** Examine documented        |
| > be implemented to respond | > procedures and interview personnel   |
| > to notifications from     | > to verify processes are implemented  |
| > merchants, component      | > to respond to notifications from     |
| > providers, and other      | > merchants, component providers, and  |
| > third parties about any   | > other third parties about any        |
| > suspicious activity, and  | > suspicious activity and provide      |
| > provide immediate         | > immediate notification to all        |
| > notification to all       | > applicable parties, including but    |
| > applicable parties of     | > not limited to:                      |
| > suspicious activity       |                                        |
| > including but not limited | -   Physical device breaches           |
| > to:                       |                                        |
|                             | -   Tampered, missing, or substituted  |
| -   Physical device         |     > devices                          |
|     > breaches              |                                        |
|                             | -   Unauthorized logical alterations   |
| -   Tampered, missing, or   |     > to devices (e.g., configuration, |
|     > substituted devices   |     > access controls, whitelists)     |
|                             |                                        |
| -   Unauthorized logical    | -   Failure of any device security     |
|     > alterations to        |     > control                          |
|     > devices (e.g.,        |                                        |
|     > configuration, access | -   Unauthorized use of sensitive      |
|     > controls, whitelists) |     > functions (e.g., key-management  |
|                             |     > functions)                       |
| -   Failure of any device   |                                        |
|     > security control      | -   Encryption/decryption failures     |
|                             |                                        |
| -   Unauthorized use of     |                                        |
|     > sensitive functions   |                                        |
|     > (e.g., key-           |                                        |
|     > management functions) |                                        |
|                             |                                        |
| -   Encryption/decryption   |                                        |
|     > failures              |                                        |
|                             |                                        |
| > ***Note:** "immediate"    |                                        |
| > means promptly or as soon |                                        |
| > as possible.*             |                                        |
+-----------------------------+----------------------------------------+
| > **3A-3.2** Upon detection | > **3A-3.2** Review documented         |
| > of any suspicious         | > procedures and interview responsible |
| > activity defined at       | > personnel to verify that upon        |
| > **3A-3.1**, the POI       | > detection of any suspicious activity |
| > device must be            | > defined at **3A-3.1**, POI devices   |
| > immediately removed, shut | > are immediately removed, shut down,  |
| > down, or taken offline    | > or taken offline.                    |
| > until the integrity of    |                                        |
| > the device is verified    |                                        |
| > and the P2PE encryption   |                                        |
| > mechanism is restored.    |                                        |
+-----------------------------+----------------------------------------+
| > **3A-3.2.1** The POI      | > **3A-3.2.1** Examine documented      |
| > device must not be        | > procedures and interview personnel   |
| > re-enabled until it is    | > to verify the POI devices must not   |
| > confirmed that the issue  | > be re-enabled until it is confirmed  |
| > has been resolved and     | > that either the issue has been       |
| > P2PE encryption           | > resolved and P2PE encryption         |
| > functionality is restored | > functionality is restored and re-    |
| > and re-enabled.           | > enabled.                             |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 3A: P2PE     |                                        |
| solution management***      |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **3A-3.3** The solution   | > **3A-3.3** Examine documented        |
| > provider must maintain a  | > procedures and related records, and  |
| > record, at minimum of one | > interview personnel to verify they   |
| > year, of all suspicious   | > maintain records of all suspicious   |
| > activity, to include the  | > activity, including the following    |
| > following:                | > details:                             |
|                             |                                        |
| -   Identification of       | -   Identification of affected         |
|     > affected device(s),   |     > device(s), including make,       |
|     > including make,       |     > model, and serial number         |
|     > model, and serial     |                                        |
|     > number                | -   Identification of affected         |
|                             |     > merchant, including specific     |
| -   Identification of       |     > sites/locations if applicable    |
|     > affected merchant,    |                                        |
|     > including specific    | -   Date/time of incident              |
|     > sites/locations if    |                                        |
|     > applicable            | -   Duration of device downtime        |
|                             |                                        |
| -   Date/time of incident   | -   Date/time that issue was resolved  |
|                             |                                        |
| -   Duration of device      | -   Details of whether any account     |
|     > downtime              |     > data was transmitted from the    |
|                             |     > POI device(s) during the time    |
| -   Date/time that the      |     > that encryption was              |
|     > issue was resolved    |     > malfunctioning or disabled       |
|                             |                                        |
| -   Details of whether any  |                                        |
|     > account data was      |                                        |
|     > transmitted from the  |                                        |
|     > POI device(s) during  |                                        |
|     > the time that         |                                        |
|     > encryption was        |                                        |
|     > malfunctioning or     |                                        |
|     > disabled              |                                        |
+-----------------------------+----------------------------------------+
| > **3A-3.4** Procedures     | > **3A-3.4.a** Examine documented      |
| > must incorporate any      | > incident-response plans to verify    |
| > applicable incident       | > they incorporate procedures defined  |
| > response procedures       | > by all applicable PCI payment        |
| > defined by the PCI        | > brands, including timeframes for     |
| > payment brands, including | > reporting incidents.                 |
| > timeframes for reporting  |                                        |
| > incidents.                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **3A-3.4.b** Interview responsible   |
|                             | > personnel to verify that any         |
|                             | > response procedures defined by all   |
|                             | > applicable PCI payment brands,       |
|                             | > including timeframes for reporting   |
|                             | > incidents, are known and             |
|                             | > implemented.                         |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 3A: P2PE     |                                        |
| solution management***      |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **3A-3.5** Processes must | > **3A-3.5.a** Interview responsible   |
| > be implemented to ensure  | > personnel and review documentation   |
| > any P2PE control failures | > to verify the solution provider has  |
| > are addressed including,  | > a formal process for any P2PE        |
| > but not limited to:       | > control failures, including          |
|                             | > procedures for addressing the        |
| -   Identification that a   | > following:                           |
|     > failure has occurred  |                                        |
|                             | -   Identification that a failure has  |
| -   Identifying the root    |     > occurred                         |
|     > cause                 |                                        |
|                             | -   Identifying the root cause         |
| -   Determining remediation |                                        |
|     > needed to address     | -   Determining remediation needed to  |
|     > root cause            |     > address root cause               |
|                             |                                        |
| -   Identifying and         | -   Identifying and addressing any     |
|     > addressing any        |     > security issues that occurred    |
|     > security issues that  |     > during the failure               |
|     > occurred during the   |                                        |
|     > failure               | -   Implementing controls to prevent   |
|                             |     > cause from recurring             |
| -   Updating the solution   |                                        |
|     > and/or controls to    |                                        |
|     > prevent cause from    |                                        |
|     > recurring             |                                        |
+-----------------------------+----------------------------------------+
|                             | > **3A-3.5.b** For a sample of P2PE    |
|                             | > control failures, interview          |
|                             | > personnel and review supporting      |
|                             | > document to verify that:             |
|                             |                                        |
|                             | -   Identification occurred.           |
|                             |                                        |
|                             | -   Corrective actions were            |
|                             |     > implemented and documented.      |
|                             |                                        |
|                             | -   The solution and/or control was    |
|                             |     > updated accordingly.             |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| []{#_bookmark40             |                                        |
| .anchor}***Requirement 3B:  |                                        |
| Third-party management***   |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***3B-1** The solution      |                                        |
| provider facilitates and    |                                        |
| maintains formal agreements |                                        |
| with all third parties      |                                        |
| contracted to perform P2PE  |                                        |
| functions on behalf of the  |                                        |
| solution provider.*         |                                        |
+-----------------------------+----------------------------------------+
| > **3B-1.1** Solution       | > **3B-1.1.a** Examine documented      |
| > provider must have formal | > procedures to verify the solution    |
| > agreements in place with  | > provider has a formalized process in |
| > all third parties that    | > place to establish agreements with   |
| > perform P2PE functions on | > all third parties performing         |
| > behalf of the solution    | > services or functions governed by    |
| > provider, including:      | > any other domain within this         |
|                             | > standard. The formalized agreement   |
| -   All functions each      | > must include:                        |
|     > third party is        |                                        |
|     > responsible for       | -   All functions each third party is  |
|                             |     > responsible for                  |
| -   Agreement to maintain   |                                        |
|     > P2PE controls for     | -   Maintaining P2PE controls for      |
|     > which they are        |     > which they are responsible       |
|     > responsible           |                                        |
|                             | -   Notification and documentation of  |
| -   Notification and        |     > any changes affecting the third  |
|     > documentation of any  |     > party governed by P2PE           |
|     > changes affecting the |     > requirements                     |
|     > third party governed  |                                        |
|     > by P2PE requirements  | -   Notification of any                |
|                             |     > security-related incidents       |
| -   Notification of any     |                                        |
|     > security-related      | -   Defining and maintaining           |
|     > incidents             |     > appropriate service level        |
|                             |     > agreements (SLAs)                |
| -   Defining and            |                                        |
|     > maintaining           | -   Maintaining compliance with        |
|     > appropriate service   |     > applicable P2PE and/or PCI DSS   |
|     > level agreements      |     > requirements as needed           |
|     > (SLAs)                |                                        |
|                             | -   Agreement to provide proof of      |
| -   Maintaining compliance  |     > compliance with P2PE             |
|     > with applicable P2PE  |     > requirements and/or PCI DSS      |
|     > and/or PCI DSS        |     > requirements as needed           |
|     > requirements as       |                                        |
|     > needed                | -   Agreement to provide reports to    |
|                             |     > solution provider as required in |
| -   Agreement to provide    |     > the "*Component providers ONLY:  |
|     > proof of compliance   |     > report status to solution        |
|     > with P2PE             |     > providers*" section of the       |
|     > requirements and/or   |     > applicable P2PE Domain           |
|     > PCI DSS requirements  |                                        |
|     > as needed             |                                        |
|                             |                                        |
| -   Agreement to provide    |                                        |
|     > reports to solution   |                                        |
|     > provider as required  |                                        |
|     > in the "*Component    |                                        |
|     > providers ONLY:       |                                        |
|     > report status to      |                                        |
|     > solution providers*"  |                                        |
|     > section of the        |                                        |
|     > applicable P2PE       |                                        |
|     > Domain                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **3B-1.1.b** If the solution         |
|                             | > provider utilizes any third parties, |
|                             | > examine the business agreements and  |
|                             | > verify the elements delineated in    |
|                             | > **3B-1.1.a** are present and         |
|                             | > adequately accounted for.            |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Requirement 3B:          |                                        |
| Third-party management***   |                                        |
+=============================+========================================+
| > **Domain 3 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| > **3B-1.2** For all third  | > **3B-1.2** Verify formal agreements  |
| > parties that have been    | > established for all third parties    |
| > contracted by the         | > managing SCDs on behalf of the       |
| > solution provider to      | > solution provider require:           |
| > manage any of the SCD     |                                        |
| > types used in the P2PE    | -   Notification of any changes that   |
| > solution, the solution    |     > require a Delta Change per the   |
| > provider must establish   |     > P2PE Program Guide               |
| > formal agreements with    |                                        |
| > the third parties to      | -   Details of the change, including   |
| > ensure those third        |     > the reason for the change        |
| > parties provide the       |                                        |
| > Solution Provider with    | -   Updated list of any dependencies   |
| > the following:            |     > included in the Delta Change     |
|                             |     > (e.g., POI devices, P2PE         |
| -   Notification of any     |     > applications, and/or HSMs) used  |
|     > changes that require  |     > in the solution                  |
|     > a Delta Change per    |                                        |
|     > the P2PE Program      | -   Evidence of adherence to PCI's     |
|     > Guide                 |     > process for *P2PE Delta Changes* |
|                             |                                        |
| -   Details of the change,  |                                        |
|     > including the reason  |                                        |
|     > for the change        |                                        |
|                             |                                        |
| -   Updated list of any     |                                        |
|     > dependencies included |                                        |
|     > in the Delta Change   |                                        |
|     > (e.g., POI devices,   |                                        |
|     > P2PE applications,    |                                        |
|     > and/or HSMs) used in  |                                        |
|     > the solution          |                                        |
|                             |                                        |
| -   Evidence of adherence   |                                        |
|     > to PCI's process for  |                                        |
|     > *P2PE Delta Changes*  |                                        |
+-----------------------------+----------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark41            |                                         |
| .anchor}***Requirement 3C: |                                         |
| Creation and maintenance   |                                         |
| of the* P2PE Instruction   |                                         |
| Manual *for merchants***   |                                         |
+============================+=========================================+
| > **Domain 3               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **3C-1** Solution provider |                                         |
| develops, maintains, and   |                                         |
| disseminates a *P2PE       |                                         |
| Instruction Manual* (PIM)  |                                         |
| to merchants.              |                                         |
+----------------------------+-----------------------------------------+
| > **3C-1.1** The PIM must  | > **3C-1.1.a** Examine the *P2PE        |
| > be developed,            | > Instruction Manual* (PIM) to verify   |
| > maintained, distributed  | > it covers all related instructions,   |
| > to merchants, and        | > guidance and requirements as          |
| > provided to merchants    | > specified in the *PIM Template*.      |
| > upon request. Content    |                                         |
| > for the PIM must be in   |                                         |
| > accordance with the      |                                         |
| > mandatory *PIM           |                                         |
| > Template*.               |                                         |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.1.b** Examine documented       |
|                            | > procedures to verify mechanisms are   |
|                            | > defined to distribute the PIM to all  |
|                            | > merchants using the P2PE solution,    |
|                            | > and to provide the PIM to merchants   |
|                            | > upon request.                         |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.1.c** Interview responsible    |
|                            | > personnel and observe processes to    |
|                            | > verify PIM is distributed to all      |
|                            | > merchants using the P2PE solution and |
|                            | > that the PIM is provided to merchants |
|                            | > upon request.                         |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.1.d** Examine the PIM to       |
|                            | > verify that all devices specified in  |
|                            | > the PIM are PCI- approved POI devices |
|                            | > that were assessed as part of this    |
|                            | > P2PE solution assessment.             |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.1.e** Examine the PIM to       |
|                            | > verify the following:                 |
|                            |                                         |
|                            | -   All P2PE applications specified in  |
|                            |     > the PIM are assessed for this     |
|                            |     > solution (per Domain 1).          |
|                            |                                         |
|                            | -   All P2PE applications specified in  |
|                            |     > the PIM are *either* PCI-listed   |
|                            |     > P2PE applications or assessed to  |
|                            |     > Domain 2 as part of this P2PE     |
|                            |     > solution assessment.              |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.1.f** Examine the PIM to       |
|                            | > verify that all P2PE non-payment      |
|                            | > software specified in the PIM were    |
|                            | > assessed as part of this P2PE         |
|                            | > solution assessment (per Requirement  |
|                            | > **1C-2**).                            |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.1.g** Configure each POI       |
|                            | > device type, settings, etc. in        |
|                            | > accordance with all instructions in   |
|                            | > the PIM and confirm the following:    |
|                            |                                         |
|                            | -   The PIM provides accurate           |
|                            |     > instructions.                     |
|                            |                                         |
|                            | -   The PIM instructions facilitate a   |
|                            |     > securely installed P2PE solution. |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 3C:         |                                         |
| Creation and maintenance   |                                         |
| of the* P2PE Instruction   |                                         |
| Manual *for merchants***   |                                         |
+============================+=========================================+
| > **Domain 3               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **3C-1.2** Review *P2PE    | **3C-1.2.a** Examine documented         |
| Instruction Manual* (PIM)  | procedures to verify they include:      |
| at least annually and upon |                                         |
| changes to the solution or | -   PIM must be reviewed at least       |
| the P2PE requirements.     |     > annually and upon changes to the  |
| Update PIM as needed to    |     > solution or changes to the P2PE   |
| keep the documentation     |     > requirements                      |
| current with:              |                                         |
|                            | -   PIM must be updated as needed to    |
| -   Any changes to the     |     > keep the document current with:   |
|     > P2PE solution        |                                         |
|     > (including additions | > ![](vertopal_60a2                     |
|     > or removals of POI   | 38a099614e179dec6351a3c50457/media/imag |
|     > device types, P2PE   | e20.png){width="7.443569553805775e-2in" |
|     > applications, and/or | > height="1.128390201224847e-2in"}Any   |
|     > P2PE non-payment     | > changes to the P2PE solution          |
|     > software), and       | > (including additions or removals of   |
|                            | > POI device types, P2PE applications,  |
| -   Any changes to the     | > and/or P2PE non-payment software),    |
|     > requirements in this | > and                                   |
|     > document.            | >                                       |
|                            | > ![](vertopal_60a2                     |
|                            | 38a099614e179dec6351a3c50457/media/imag |
|                            | e20.png){width="7.443569553805775e-2in" |
|                            | > height="1.128390201224847e-2in"}Any   |
|                            | > changes to the P2PE requirements.     |
+----------------------------+-----------------------------------------+
|                            | **3C-1.2.b** Observe processes for      |
|                            | reviewing and updating the PIM, and     |
|                            | interview responsible personnel to      |
|                            | verify:                                 |
|                            |                                         |
|                            | -   PIM is reviewed at least annually   |
|                            |     > and upon changes to the solution  |
|                            |     > or changes to the PCI P2PE        |
|                            |     > requirements                      |
|                            |                                         |
|                            | -   PIM is updated as needed to keep    |
|                            |     > the document current with:        |
|                            |                                         |
|                            | > ![](vertopal_60a2                     |
|                            | 38a099614e179dec6351a3c50457/media/imag |
|                            | e20.png){width="7.443569553805775e-2in" |
|                            | > height="1.128390201224847e-2in"}Any   |
|                            | > changes to the P2PE solution          |
|                            | > (including additions or removals of   |
|                            | > POI device types, P2PE applications,  |
|                            | > and/or P2PE non-payment software),    |
|                            | > and                                   |
|                            | >                                       |
|                            | > ![](vertopal_60a2                     |
|                            | 38a099614e179dec6351a3c50457/media/imag |
|                            | e20.png){width="7.443569553805775e-2in" |
|                            | > height="1.128390201224847e-2in"}Any   |
|                            | > changes to the P2PE requirements.     |
+----------------------------+-----------------------------------------+
| > **3C-1.2.1** Communicate | > **3C-1.2.1.a** Examine documented     |
| > PIM updates to affected  | > procedures to verify they include     |
| > merchants, and provide   | > communicating PIM updates to affected |
| > merchants with an        | > merchants and providing an updated    |
| > updated PIM as needed.   | > PIM as needed.                        |
+----------------------------+-----------------------------------------+
|                            | > **3C-1.2.1.b** Observe processes for  |
|                            | > reviewing and updating the PIM, and   |
|                            | > interview responsible personnel to    |
|                            | > verify PIM updates are communicated   |
|                            | > to affected merchants and an updated  |
|                            | > PIM is provided to merchants as       |
|                            | > needed.                               |
+----------------------------+-----------------------------------------+

# Domain 4: Decryption Environment

+----------+------------------+---------------------------------------+
| > **     | > **Overview**   | > **P2PE Validation Requirements**    |
| Domain** |                  |                                       |
+==========+==================+=======================================+
| >        | The secure       | **4A** Use approved decryption        |
| **Domain | management of    | devices.                              |
| > 4:**   | the environment  |                                       |
| >        | that receives    | **4B** Secure the decryption          |
| > **De   | encrypted        | environment.                          |
| cryption | account data and |                                       |
| > Envir  | decrypts it.     | **4C** Monitor the decryption         |
| onment** |                  | environment and respond to incidents. |
|          |                  |                                       |
|          |                  | **4D** Implement secure, hybrid       |
|          |                  | decryption processes.                 |
|          |                  |                                       |
|          |                  | **4E** Component providers *ONLY*:    |
|          |                  | report status to solution providers   |
+----------+------------------+---------------------------------------+

> ***Target Audience:** P2PE solution providers, or those who, on behalf
> of P2PE solution providers, manage the P2PE decryption environment.*

+-------------------------------------------+--------------------------+
| Within a P2PE solution, the decryption    | ***Note:** References to |
| environment is where incoming encrypted   | "devices" within this    |
| account data is decrypted back to its     | section are always to be |
| original clear-text. This environment     | interpreted as           |
| therefore consists of the secure          | referencing decryption   |
| cryptographic devices (and a Host System  | devices, such as HSMs,   |
| for hybrid environments) and              | unless specifically      |
| cryptographic keys involved in the        | noted. For hybrid        |
| account-data decryption process.          | decryption environments, |
| Requirements in Domain 4 entail securing  | references to            |
| all decryption systems and associated     | "**decryption devices    |
| cryptographic keys, along with            | and systems"** within    |
| implementing monitoring and response      | this section are always  |
| procedures.                               | to be interpreted as     |
|                                           | referencing HSMs and the |
| Within this domain, the term "solution    | Host System, unless      |
| provider" refers to whichever entity is   | specifically noted. This |
| undergoing the P2PE assessment. This may  | section is not intended  |
| be a solution provider, a component       | to include requirements  |
| provider, or a merchant as a solution     | to be assessed against   |
| provider (MMS). See ["P2PE Solutions and  | encrypting devices, such |
| use of Third                              | as POI devices.*         |
| Parties](#p2pe-solutions-and-use-of-thir  |                          |
| d-parties-andor-p2pe-component-providers) | ***Note:** All           |
| [and/or P2PE Component                    | decryption devices,      |
| Pr                                        | including HSMs and       |
| oviders"](#p2pe-solutions-and-use-of-thir | related key-management   |
| d-parties-andor-p2pe-component-providers) | SCDs, must additionally  |
| for more information about validating     | meet all requirements    |
| this Domain as a solution provider, a     | specified in Domain 5.*  |
| decryption-environment component          |                          |
| provider, or as a merchant as a solution  | ***Note:** For           |
| provider.                                 | merchant-managed         |
|                                           | solutions, the term      |
| **Note for hybrid decryption              | "merchant" as used       |
| environments:**                           | within Domains 1, 3, 4,  |
|                                           | and 5 of this document   |
| Hybrid decryption environments require    | refers to merchant       |
| HSMs for cryptographic key-management     | personnel in the         |
| functions but allow for non-SCD Host      | encryption environments, |
| Systems to be used for account-data       | and represents           |
| decryption. Unlike a P2PE solution with a | requirements the         |
| hardware decryption environment (in which | merchant as a solution   |
| cryptographic key management and          | provider is responsible  |
| account-data decryption are performed     | for meeting for, or on   |
| entirely within a hardware security       | behalf of, those         |
| module, or HSM), a hybrid decryption      | merchant encryption      |
| environment (which requires HSMs for      | environments.*           |
| cryptographic key-management functions)   |                          |
| allows for the decryption of account data |                          |
|                                           |                          |
| outside of an HSM in non-SCDs on a Host   |                          |
| System. These environments must meet all  |                          |
+===========================================+==========================+
+-------------------------------------------+--------------------------+

> requirements specified in Domains 4 and 5, including the additional
> requirements specified in Section **4D** (as well as those specified
> in Domain 5 in section **5H**).
>
> *A Host System is defined as a combination of software and hardware
> components used to of decrypt account data. May also be used for
> transaction processing using non-SCD host systems.*

+------------------------------+---------------------------------------+
| > []{#_bookmark43            |                                       |
| > .anchor}***Requirement 4A: |                                       |
| > Use approved decryption    |                                       |
| > devices***                 |                                       |
+==============================+=======================================+
| > **Domain 4 Requirements**  | > **Testing Procedures**              |
+------------------------------+---------------------------------------+
| > ***4A-1** Use approved     |                                       |
| > decryption devices*        |                                       |
+------------------------------+---------------------------------------+
| > **4A-1.1** All hardware    | > **4A-1.1.a** For all HSMs used in   |
| > security modules (HSMs)    | > the decryption environment, examine |
| > must be either:            | > approval documentation (e.g., FIPS  |
|                              | > certification or PTS approval) and  |
| -   *FIPS 140-2* or *140-3*  | > review the list of approved devices |
|     > Level 3 (overall) or   | > to verify that all HSMs used in the |
|     > higher certified, or   | > solution are either:                |
|                              |                                       |
| -   PCI PTS HSM approved     | -   Listed on the *NIST Cryptographic |
|                              |     > Module Validation Program*      |
| > ***Note:** HSM approval    |     > (CMVP) list, with a valid       |
| > listings must be           |     > listing number, and approved to |
| > currentHSMs must have a   |     > *FIPS 140-2* or *140-3* Level 3 |
| > non-expired PCI PTS HSM    |     > (overall), or higher. Refer to  |
| > approval or a non-expired  |     > [http://c                       |
| > FIPS 140-2 or 140-3        | src.nist.gov](http://csrc.nist.gov/). |
| > certificate (i.e., the     |                                       |
| > FIPS 140 HSM certificates  | -   Listed on the PCI SSC website,    |
| > must not be listed as      |     > with a valid PCI SSC listing    |
| > historical or revoked).*   |     > number, as Approved PCI PTS     |
|                              |     > Devices under the approval      |
|                              |     > class "HSM."                    |
+------------------------------+---------------------------------------+
|                              | > **4A-1.1.b** Examine documented     |
|                              | > procedures and interview personnel  |
|                              | > to verify that all account-data     |
|                              | > decryption operations are performed |
|                              | > only by the FIPS-approved and/or    |
|                              | > PTS-approved HSMs identified in     |
|                              | > **4A-1.1.a.**                       |
+------------------------------+---------------------------------------+
| > **4A-1.1.1** The approval  | > **4A-1.1.1.a** For all PCI-approved |
| > listing must match the     | > HSMs used in the solution, examine  |
| > deployed devices in the    | > HSM devices and review the *PCI SSC |
| > following characteristics: | > list of Approved PTS Devices* to    |
|                              | > verify that all of the following    |
| -   Vendor name              | > device characteristics match the    |
|                              | > PCI PTS listing for each HSM:       |
| -   Model name and number    |                                       |
|                              | -   Vendor name                       |
| -   Hardware version number  |                                       |
|                              | -   Model name/number                 |
| -   Device firmware version  |                                       |
|     > number                 | -   Hardware version number           |
|                              |                                       |
| -   For PCI-approved HSMs,   | -   Device firmware version number    |
|     > any applications,      |                                       |
|     > including application  | -   Any applications, including       |
|     > version number,        |     > application version number,     |
|     > resident within the    |     > resident within the device      |
|     > device which were      |     > which were included in the PTS  |
|     > included in the PTS    |     > assessment                      |
|     > assessment             |                                       |
|                              |                                       |
| > *(continued on next page)* |                                       |
+------------------------------+---------------------------------------+

+------------------------------+---------------------------------------+
| ***Requirement 4A: Use       |                                       |
| approved decryption          |                                       |
| devices***                   |                                       |
+==============================+=======================================+
| > **Domain 4 Requirements**  | > **Testing Procedures**              |
+------------------------------+---------------------------------------+
| > **4A-1.1.1** *(continued)* | > **4A-1.1.1.b** For all              |
| >                            | > FIPS-approved HSMs used in the      |
| > ***Note:** If the solution | > solution, examine HSM devices and   |
| > provider has applied a     | > review the NIST Cryptographic       |
| > vendor security patch      | > Module Validation Program (CMVP)    |
| > resulting in an updated    | > list to verify that all of the      |
| > HSM firmware version, and  | > following device characteristics    |
| > the PCI SSC or NIST        | > match the *FIPS 140-2* or *140-3*   |
| > validation of that updated | > Level 3 (or higher) approval        |
| > firmware version has not   | > listing for each HSM:               |
| > yet been completed         |                                       |
| > (resulting in a mismatch   | -   Vendor name                       |
| > between the HSM firmware   |                                       |
| > version in use and the     | -   Model name/number                 |
| > listed, validated one),    |                                       |
| > the solution provider must | -   Hardware version number           |
| > obtain documentation from  |                                       |
| > the vendor regarding the   | -   Firmware version number           |
| > update that includes       |                                       |
| > confirmation the update    |                                       |
| > has been submitted for     |                                       |
| > evaluation per the process |                                       |
| > specified by either PCI    |                                       |
| > SSC or NIST (as applicable |                                       |
| > to the HSM).*              |                                       |
+------------------------------+---------------------------------------+
|                              | > **4A-1.1.1.c** If the solution      |
|                              | > provider has applied a vendor       |
|                              | > security patch that resulted in an  |
|                              | > updated HSM firmware version, and   |
|                              | > the PCI SSC or NIST validation of   |
|                              | > that updated firmware version has   |
|                              | > not yet been completed, obtain the  |
|                              | > vendor documentation and verify it  |
|                              | > includes confirmation that the      |
|                              | > update has been submitted for       |
|                              | > evaluation per the process          |
|                              | > specified by PCI SSC or NIST (as    |
|                              | > applicable to the HSM).             |
+------------------------------+---------------------------------------+
| > **4A-1.1.2** If            | > **4A-1.1.2.a** Examine FIPS         |
| > FIPS-approved HSMs are     | > approval documentation (security    |
| > used, the HSM must use the | > policy) and HSM operational         |
| > FIPS-approved              | > procedures to verify that the FIPS  |
| > cryptographic primitives,  | > approval covers the cryptographic   |
| > data- protection           | > primitives, data-protection         |
| > mechanisms, and            | > mechanisms, and key-management used |
| > key-management processes   | > for account- data decryption and    |
| > for account-data           | > related processes.                  |
| > decryption and related     |                                       |
| > processes.                 |                                       |
| >                            |                                       |
| > ***Note:** Solution        |                                       |
| > providers operating HSMs   |                                       |
| > in non-FIPS mode or adding |                                       |
| > non-FIPS validated         |                                       |
| > software must complete a   |                                       |
| > written confirmation that  |                                       |
| > includes the following:*   |                                       |
|                              |                                       |
| -   *Description of why the  |                                       |
|     > HSM is operated in     |                                       |
|     > non-FIPS mode*         |                                       |
|                              |                                       |
| -   *Purpose and description |                                       |
|     > of any non-FIPS        |                                       |
|     > validated software     |                                       |
|     > added to the HSM*      |                                       |
|                              |                                       |
| -   *A statement that        |                                       |
|     > nothing has been       |                                       |
|     > changed on, or added   |                                       |
|     > to, the HSM that       |                                       |
|     > impacts the security   |                                       |
|     > of the HSM,            |                                       |
|     > cryptographic          |                                       |
|     > key-management         |                                       |
|     > processes, or P2PE     |                                       |
|     > requirements*          |                                       |
|                              |                                       |
| -   *Note that adding any    |                                       |
|     > software may           |                                       |
|     > invalidate the FIPS    |                                       |
|     > approval.*             |                                       |
+------------------------------+---------------------------------------+
|                              | > **4A-1.1.2.b** If the HSM is        |
|                              | > operated in non-FIPS mode or        |
|                              | > non-FIPS validated software has     |
|                              | > been added to the HSM, review the   |
|                              | > solution provider's written         |
|                              | > confirmation and confirm that it    |
|                              | > includes the following:             |
|                              |                                       |
|                              | -   Description of why the HSM is     |
|                              |     > operated in non-FIPS mode       |
|                              |                                       |
|                              | -   Purpose and description of any    |
|                              |     > non-FIPs validated software     |
|                              |     > added to the HSM                |
|                              |                                       |
|                              | -   A statement that nothing has been |
|                              |     > changed on, or added to, the    |
|                              |     > HSM that impacts the security   |
|                              |     > of the HSM, cryptographic       |
|                              |     > key-management processes, or    |
|                              |     > P2PE requirements               |
+------------------------------+---------------------------------------+

+------------------------------+---------------------------------------+
| > ***Requirement 4A: Use     |                                       |
| > approved decryption        |                                       |
| > devices***                 |                                       |
+==============================+=======================================+
| > **Domain 4 Requirements**  | > **Testing Procedures**              |
+------------------------------+---------------------------------------+
| > **4A-1.1.3** If PCI        | > **4A-1.1.3** Examine HSM            |
| > PTS-approved HSMs are      | > configurations for all P2PE         |
| > used, the HSM must be      | > solution functions to verify that   |
| > configured to operate in   | > HSMs are configured to operate      |
| > accordance with the        | > according to the security policy    |
| > security policy that was   | > that was included as part of the    |
| > included in the PTS HSM    | > PTS approval. In addition, review   |
| > approval, for all P2PE     | > the PCI approval listing(s) for any |
| > operations (including      | > implementation-specific notes and   |
| > algorithms, data           | > if present, verify they are         |
| > protection, key            | > accounted for.                      |
| > management, etc.).         |                                       |
| >                            |                                       |
| > ***Note:** PCI HSMs        |                                       |
| > require that the           |                                       |
| > decryption-device          |                                       |
| > manufacturer make          |                                       |
| > available a security       |                                       |
| > policy document to end     |                                       |
| > users, providing           |                                       |
| > information on how the     |                                       |
| > device must be installed,  |                                       |
| > maintained, and configured |                                       |
| > to meet the compliance     |                                       |
| > requirements under which   |                                       |
| > it was approved.*          |                                       |
+------------------------------+---------------------------------------+

+----------------------------+----------------------------------------+---+
| []{#_bookmark44            |                                        |   |
| .anchor}***Requirement 4B: |                                        |   |
| Secure the decryption      |                                        |   |
| environment***             |                                        |   |
+============================+========================================+===+
| > **Domain 4               | > **Testing Procedures**               |   |
| > Requirements**           |                                        |   |
+----------------------------+----------------------------------------+---+
| ***4B-1** Maintain         |                                        |   |
| processes for securely     |                                        |   |
| managing the decryption    |                                        |   |
| environment.*              |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.1** Current       | > **4B-1.1.a** Review documentation to |   |
| > documentation must be    | > verify that a procedure exists to    |   |
| > maintained that          | > maintain a document that             |   |
| > describes or illustrates | > describes/illustrates the            |   |
| > the configuration of the | > configuration of the decryption      |   |
| > decryption environment,  | > environment, including the flow of   |   |
| > including the flow of    | > data and interconnectivity between   |   |
| > data and                 | > incoming transaction data from POI   |   |
| > interconnectivity        | > devices, all systems within the      |   |
| > between incoming         | > decryption environment, and any      |   |
| > transaction data from    | > outbound connections.                |   |
| > POI devices, all systems |                                        |   |
| > within the decryption    |                                        |   |
| > environment, and any     |                                        |   |
| > outbound connections.    |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.1.b** Interview responsible   |   |
|                            | > personnel and review                 |   |
|                            | > solution-provider documentation to   |   |
|                            | > verify that it describes/illustrates |   |
|                            | > the configuration of the decryption  |   |
|                            | > environment, including the flow of   |   |
|                            | > data and interconnectivity between   |   |
|                            | > incoming transaction data from POI   |   |
|                            | > devices, all systems within the      |   |
|                            | > decryption environment, and any      |   |
|                            | > outbound connections.                |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.2** Procedures    | > **4B-1.2.a** Examine documented      |   |
| > must be implemented to   | > procedures to verify secure          |   |
| > provide secure           | > administration by authorized         |   |
| > administration of        | > personnel is defined for decryption  |   |
| > decryption devices by    | > devices including:                   |   |
| > authorized personnel,    |                                        |   |
| > including but not        | -   Assigning administrative roles and |   |
| > limited to:              |     > responsibilities only to         |   |
|                            |     > specific, authorized personnel   |   |
| -   Assigning              |                                        |   |
|     > administrative roles | -   Management of user interface       |   |
|     > and responsibilities |                                        |   |
|     > only to specific,    | -   Password/smart card management     |   |
|     > authorized personnel |                                        |   |
|                            | -   Console/remote administration      |   |
| -   Management of user     |                                        |   |
|     > interface            | -   Access to physical keys            |   |
|                            |                                        |   |
| -   Password/smart card    | -   Use of HSM commands                |   |
|     > management           |                                        |   |
|                            |                                        |   |
| -   Console and            |                                        |   |
|     > non-console          |                                        |   |
|     > administration       |                                        |   |
|                            |                                        |   |
| -   Access to physical     |                                        |   |
|     > keys                 |                                        |   |
|                            |                                        |   |
| -   Use of HSM commands    |                                        |   |
|                            |                                        |   |
| > *(continued on next      |                                        |   |
| > page)*                   |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.2.b** Observe authorized      |   |
|                            | > personnel performing                 |   |
|                            | > device-administration operations to  |   |
|                            | > verify secure administration         |   |
|                            | > procedures are implemented for the   |   |
|                            | > following:                           |   |
|                            |                                        |   |
|                            | -   Management of user interface       |   |
|                            |                                        |   |
|                            | -   Password/smart card management     |   |
|                            |                                        |   |
|                            | -   Console/remote administration      |   |
|                            |                                        |   |
|                            | -   Access to physical keys            |   |
|                            |                                        |   |
|                            | -   Use of HSM commands                |   |
+----------------------------+----------------------------------------+---+

+----------------------------+----------------------------------------+---+
| ***Requirement 4B: Secure  |                                        |   |
| the decryption             |                                        |   |
| environment***             |                                        |   |
+============================+========================================+===+
| > **Domain 4               | > **Testing Procedures**               |   |
| > Requirements**           |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.2** *(continued)* | > **4B-1.2.c** Observe personnel       |   |
|                            | > performing decryption-device         |   |
|                            | > administration and examine           |   |
|                            | > files/records that assign            |   |
|                            | > administrative roles and             |   |
|                            | > responsibilities to verify that only |   |
|                            | > authorized and assigned personnel    |   |
|                            | > perform decryption-device            |   |
|                            | > administration operations.           |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.3** Only          | > **4B-1.3.a** Examine documented      |   |
| > authorized               | > procedures and processes to verify   |   |
| > users/processes have the | > that only authorized users/processes |   |
| > ability to make function | > have the ability to make functions   |   |
| > calls to the HSM---e.g., | > calls to the HSM--- e.g., via the    |   |
| > via the HSM's            | > HSM's application program interfaces |   |
| > application program      | > (APIs).                              |   |
| > interfaces (APIs).       |                                        |   |
| >                          |                                        |   |
| > *For example, require    |                                        |   |
| > authentication for use   |                                        |   |
| > of the HSMs APIs and     |                                        |   |
| > secure all               |                                        |   |
| > authentication           |                                        |   |
| > credentials from         |                                        |   |
| > unauthorized access.     |                                        |   |
| > Where an HSM is unable   |                                        |   |
| > to authenticate use of   |                                        |   |
| > the API, limit the       |                                        |   |
| > exposure of the HSM to a |                                        |   |
| > trusted host via a       |                                        |   |
| > dedicated physical link  |                                        |   |
| > that authorizes access   |                                        |   |
| > on behalf of the HSM     |                                        |   |
| > over the trusted channel |                                        |   |
| > (e.g., high-speed serial |                                        |   |
| > or dedicated Ethernet).* |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.3.b** Interview responsible   |   |
|                            | > personnel and observe HSM system     |   |
|                            | > configurations and processes to      |   |
|                            | > verify that only authorized          |   |
|                            | > users/processes have the ability to  |   |
|                            | > make function calls to the HSM       |   |
|                            | > (e.g., via the HSM's application     |   |
|                            | > program interfaces \[APIs\]).        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.4** POI devices   | > **4B-1.4.a** Examine documented      |   |
| > must be authenticated by | > policies and procedures to verify    |   |
| > the decryption           | > they require POI devices be          |   |
| > environment and upon     | > authenticated upon connection to the |   |
| > request by the solution  | > decryption environment and upon      |   |
| > provider.                | > request by the solution provider.    |   |
| >                          |                                        |   |
| > ***Note:** The intent is |                                        |   |
| > to ensure the decryption |                                        |   |
| > environment can          |                                        |   |
| > authenticate each unique |                                        |   |
| > POI device within a P2PE |                                        |   |
| > solution with which it   |                                        |   |
| > is communicating.*       |                                        |   |
| >                          |                                        |   |
| > *This authentication may |                                        |   |
| > occur via use of         |                                        |   |
| > cryptographic keys or    |                                        |   |
| > certificates, uniquely   |                                        |   |
| > associated with each POI |                                        |   |
| > device and decryption    |                                        |   |
| > system.*                 |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.4.b** Verify documented       |   |
|                            | > procedures are defined for the       |   |
|                            | > following:                           |   |
|                            |                                        |   |
|                            | -   Procedures and/or mechanisms for   |   |
|                            |     > authenticating POI devices by    |   |
|                            |     > the decryption environment       |   |
|                            |                                        |   |
|                            | -   Procedures and/or mechanisms for   |   |
|                            |     > authenticating POI devices upon  |   |
|                            |     > request by the solution provider |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.4.c** Interview responsible   |   |
|                            | > personnel and observe a sample of    |   |
|                            | > device authentications to verify the |   |
|                            | > following:                           |   |
|                            |                                        |   |
|                            | -   POI devices are authenticated by   |   |
|                            |     > the decryption environment.      |   |
|                            |                                        |   |
|                            | -   POI devices are authenticated upon |   |
|                            |     > request by the solution          |   |
|                            |     > provider.                        |   |
+----------------------------+----------------------------------------+---+

+----------------------------+----------------------------------------+---+
| ***Requirement 4B: Secure  |                                        |   |
| the decryption             |                                        |   |
| environment***             |                                        |   |
+============================+========================================+===+
| > **Domain 4               | > **Testing Procedures**               |   |
| > Requirements**           |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.5** Inspections   | > **4B-1.5.a** Examine documented      |   |
| > of decryption devices by | > procedure to verify that inspection  |   |
| > authorized personnel     | > of devices is required at least      |   |
| > must be performed at     | > quarterly to detect signs of         |   |
| > least quarterly to       | > tampering or modification, and that  |   |
| > detect tampering or      | > inspection procedures include:       |   |
| > modification of devices. |                                        |   |
| > Inspections to include:  | -   The device itself                  |   |
|                            |                                        |   |
| -   The device itself      | -   Cabling/connection points          |   |
|                            |                                        |   |
| -   Cabling/connection     | -   Physically connected devices       |   |
|     > points               |                                        |   |
|                            |                                        |   |
| -   Physically connected   |                                        |   |
|     > devices              |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.5.b** Interview personnel     |   |
|                            | > performing inspections and observe   |   |
|                            | > inspection processes to verify that  |   |
|                            | > inspections include:                 |   |
|                            |                                        |   |
|                            | -   The device itself                  |   |
|                            |                                        |   |
|                            | -   Cabling/connection points          |   |
|                            |                                        |   |
|                            | -   Physically connected devices       |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.5.c** Interview personnel     |   |
|                            | > performing inspections and review    |   |
|                            | > supporting documentation to verify   |   |
|                            | > that inspections are performed at    |   |
|                            | > least quarterly.                     |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.6** Decryption    | > **4B-1.6.a** Review the "Description |   |
| > environment must be      | > of Scope of Work and Approach Taken" |   |
| > secured according to PCI | > section of the solution provider's   |   |
| > DSS.                     | > current PCI DSS Report on Compliance |   |
| >                          | > (ROC) to verify the PCI DSS          |   |
| > ***Note:** For           | > assessment scope fully covers the    |   |
| > merchant-managed         | > P2PE decryption environment.         |   |
| > solutions, PCI DSS       |                                        |   |
| > validation of the        |                                        |   |
| > decryption environment   |                                        |   |
| > is managed by the        |                                        |   |
| > merchant in accordance   |                                        |   |
| > with their acquirer      |                                        |   |
| > and/or payment brand.    |                                        |   |
| > This requirement is      |                                        |   |
| > therefore not applicable |                                        |   |
| > to P2PE assessments      |                                        |   |
| > where merchants are the  |                                        |   |
| > P2PE solution provider.* |                                        |   |
| >                          |                                        |   |
| > ***Note:** The QSA       |                                        |   |
| > (P2PE) should NOT        |                                        |   |
| > challenge or re-         |                                        |   |
| > evaluate the PCI DSS     |                                        |   |
| > environment (or its      |                                        |   |
| > compliance) where a      |                                        |   |
| > completed and current    |                                        |   |
| > ROC exists.*             |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.6.b** Review PCI DSS ROC      |   |
|                            | > and/or Attestation of Compliance     |   |
|                            | > (AOC) to verify that all applicable  |   |
|                            | > PCI DSS requirements are "in place"  |   |
|                            | > for the P2PE decryption environment. |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.6.c** Review PCI DSS ROC      |   |
|                            | > and/or Attestation of Compliance     |   |
|                            | > (AOC) to verify that the PCI DSS     |   |
|                            | > assessment of the P2PE decryption    |   |
|                            | > environment was:                     |   |
|                            |                                        |   |
|                            | -   Performed by a QSA                 |   |
|                            |                                        |   |
|                            | -   Performed within the previous 12   |   |
|                            |     > months                           |   |
+----------------------------+----------------------------------------+---+

+----------------------------+----------------------------------------+---+
| ***Requirement 4B: Secure  |                                        |   |
| the decryption             |                                        |   |
| environment***             |                                        |   |
+============================+========================================+===+
| > **Domain 4               | > **Testing Procedures**               |   |
| > Requirements**           |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.7** Processes are | > **4B-1.7.a** Review documented       |   |
| > implemented to ensure    | > processes and interview personnel to |   |
| > that clear- text account | > confirm that clear-text account data |   |
| > data is never sent back  | > is never sent back to the encryption |   |
| > to the encryption        | > environment.                         |   |
| > environment.             |                                        |   |
| >                          |                                        |   |
| > ***Note:** Output of     |                                        |   |
| > clear-text data that is  |                                        |   |
| > verified as being        |                                        |   |
| > unrelated to any of the  |                                        |   |
| > PCI payment brands is    |                                        |   |
| > acceptable. The security |                                        |   |
| > of this process when it  |                                        |   |
| > occurs from the          |                                        |   |
| > decryption environment   |                                        |   |
| > is assessed at           |                                        |   |
| > Requirement **4B-1.9***  |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.7.b** Observe process flows   |   |
|                            | > and data flows to verify that there  |   |
|                            | > is no process, application, or other |   |
|                            | > mechanism that sends clear-text      |   |
|                            | > account data back into the           |   |
|                            | > encryption environment.              |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.8** Any truncated | > **4B-1.8.a** Review documented       |   |
| > PANs sent back to the    | > processes and interview personnel to |   |
| > encryption environment   | > confirm that any truncated PANs sent |   |
| > must adhere to the       | > back to the encryption environment   |   |
| > allowable number of      | > adhere to the allowable number of    |   |
| > digits as specified in   | > digits as specified in PCI DSS       |   |
| > PCI DSS and/or related   | > and/or related FAQs                  |   |
| > FAQs that specify        |                                        |   |
| > allowable digits.        |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.8.b** Observe process flows   |   |
|                            | > and data flows to verify that there  |   |
|                            | > is no process, application, or other |   |
|                            | > mechanism that sends more digits of  |   |
|                            | > truncated PANs back to the           |   |
|                            | > encryption environment than is       |   |
|                            | > specified in PCI DSS and/or related  |   |
|                            | > FAQs.                                |   |
+----------------------------+----------------------------------------+---+

+----------------------------+----------------------------------------+---+
| ***Requirement 4B: Secure  |                                        |   |
| the decryption             |                                        |   |
| environment***             |                                        |   |
+============================+========================================+===+
| > **Domain 4               | > **Testing Procedures**               |   |
| > Requirements**           |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.9** Any           | > **4B-1.9** Review documented         |   |
| > whitelisting             | > policies and procedures to verify    |   |
| > functionality            | > that that any whitelisting           |   |
| > implemented in the       | > functionality implemented in the     |   |
| > decryption environment   | > decryption environment *that         |   |
| > *that transmits data to  | > transmits data to the encryption     |   |
| > the encryption           | > environment* ensures the that the    |   |
| > environment* must ensure | > *ONLY* allowed output of clear-text  |   |
| > that the *ONLY* allowed  | > account data is for non-PCI payment  |   |
| > output of clear-text     | > brand account/card data, and         |   |
| > account data is for      | > includes the following:              |   |
| > non-PCI payment brand    |                                        |   |
| > account/card data, and   | -   Cryptographic signing (or similar) |   |
| > includes the following:  |     > prior to installation by         |   |
|                            |     > authorized personnel using dual  |   |
| -   Cryptographic signing  |     > control.                         |   |
|     > (or similar) prior   |                                        |   |
|     > to installation by   | -   Cryptographic authentication by    |   |
|     > authorized personnel |     > the HSM                          |   |
|     > using dual control   |                                        |   |
|                            | -   Review of whitelist functionality  |   |
| -   Cryptographic          |     > to confirm it only outputs       |   |
|     > authentication by    |     > non-PCI payment brand            |   |
|     > the HSM              |     > account/card data.               |   |
|                            |                                        |   |
| -   Review of whitelist    | -   Approval of functionality by       |   |
|     > functionality to     |     > authorized personnel prior to    |   |
|     > confirm it only      |     > implementation                   |   |
|     > outputs non-PCI      |                                        |   |
|     > payment brand        | -   Documentation for all new          |   |
|     > account/card data    |     > installations or updates to      |   |
|                            |     > whitelist functionality that     |   |
| -   Approval of            |     > includes the following:          |   |
|     > functionality by     |                                        |   |
|     > authorized personnel |     -   Description and justification  |   |
|     > prior to             |         > for the functionality        |   |
|     > implementation       |                                        |   |
|                            |     -   Who approved the new           |   |
| -   Documentation for all  |         > installation or updated      |   |
|     > new installations or |         > functionality prior to       |   |
|     > updates to whitelist |         > release                      |   |
|     > functionality that   |                                        |   |
|     > includes the         |     -   Confirmation that it was       |   |
|     > following:           |         > reviewed prior to release to |   |
|                            |         > only output non-PCI payment  |   |
|     -   Description and    |         > brand account/card data      |   |
|         > justification    |                                        |   |
|         > for the          |                                        |   |
|         > functionality    |                                        |   |
|                            |                                        |   |
|     -   Who approved the   |                                        |   |
|         > new installation |                                        |   |
|         > or updated       |                                        |   |
|         > functionality    |                                        |   |
|         > prior to release |                                        |   |
|                            |                                        |   |
|     -   Confirmation that  |                                        |   |
|         > it was reviewed  |                                        |   |
|         > prior to release |                                        |   |
|         > to only output   |                                        |   |
|         > non-PCI payment  |                                        |   |
|         > brand            |                                        |   |
|         > account/card     |                                        |   |
|         > data             |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.9.1** Any         | > **4B-1.9.1.a** Observe application   |   |
| > whitelisting             | > and system configurations and        |   |
| > functionality            | > interview personnel to verify that   |   |
| > implemented in the       | > whitelisting functionality           |   |
| > decryption environment   | > implemented in the decryption        |   |
| > *that transmits data to  | > environment *that transmits data to  |   |
| > the encryption           | > the encryption environment* only     |   |
| > environment* must allow  | > allows the output of clear- text     |   |
| > *ONLY* the output of     | > account data for non-PCI payment     |   |
| > clear-text account data  | > brand account/card data.             |   |
| > for non-PCI payment      |                                        |   |
| > brand account/card data. |                                        |   |
+----------------------------+----------------------------------------+---+
|                            | > **4B-1.9.1.b** Perform test          |   |
|                            | > transactions to verify that any      |   |
|                            | > whitelisting functionality           |   |
|                            | > implemented in the decryption        |   |
|                            | > environment *that transmits data to  |   |
|                            | > the encryption environment* only     |   |
|                            | > allows output clear-text account for |   |
|                            | > non-PCI payment brand account/card   |   |
|                            | > data.                                |   |
+----------------------------+----------------------------------------+---+

+----------------------------+----------------------------------------+---+
| ***Requirement 4B: Secure  |                                        |   |
| the decryption             |                                        |   |
| environment***             |                                        |   |
+============================+========================================+===+
| > **Domain 4               | > **Testing Procedures**               |   |
| > Requirements**           |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.9.2** Any new     | > **4B-1.9.2** Observe the process for |   |
| > installations of, or     | > new installations or updates to      |   |
| > updates to, whitelisting | > whitelisting functionality and       |   |
| > functionality            | > interview personnel to verify that   |   |
| > implemented in the       | > additions or updates to whitelisting |   |
| > decryption environment   | > functionality implemented in the     |   |
| > *that transmits data to  | > decryption environment *that         |   |
| > the encryption           | > transmits data to the encryption     |   |
| > environment* must be:    | > environment* are performed as        |   |
|                            | > follows:                             |   |
| -   Cryptographically      |                                        |   |
|     > signed (or similar)  | -   Cryptographically signed (or       |   |
|     > prior to             |     > similar) prior to installation   |   |
|     > installation only by |     > only by authorized personnel     |   |
|     > authorized personnel |     > using dual control               |   |
|     > using dual control   |                                        |   |
|                            | -   Cryptographically authenticated by |   |
| -   Cryptographically      |     > the HSM                          |   |
|     > authenticated by the |                                        |   |
|     > HSM                  |                                        |   |
+----------------------------+----------------------------------------+---+
| > **4B-1.9.3** Any new     | > **4B-1.9.3** Review records of both  |   |
| > installations of, or     | > new and updated whitelisting         |   |
| > updates to, whitelisting | > functionality implemented in the     |   |
| > functionality            | > decryption environment *that         |   |
| > implemented in the       | > transmits data to the encryption     |   |
| > decryption environment   | > environment*, and confirm the        |   |
| > *that transmits data to  | > following:                           |   |
| > the encryption           |                                        |   |
| > environment* must follow | -   Both new installations and updates |   |
| > change-control           |     > to whitelisting functionality    |   |
| > procedures that include: |     > are documented.                  |   |
|                            |                                        |   |
| -   Coverage for both new  | -   The documentation includes         |   |
|     > installations and    |     > description and justification.   |   |
|     > updates to such      |                                        |   |
|     > functionality        | -   The documentation includes who     |   |
|                            |     > approved it prior to             |   |
| -   Description and        |     > implementation.                  |   |
|     > justification for    |                                        |   |
|     > the functionality    | -   The documentation includes         |   |
|                            |     > confirmation that it was         |   |
| -   Who approved the new   |     > reviewed prior to release to     |   |
|     > installation or      |     > only output non-PCI payment      |   |
|     > update prior to      |     > account/card data.               |   |
|     > release              |                                        |   |
|                            |                                        |   |
| -   Confirmation that it   |                                        |   |
|     > was reviewed prior   |                                        |   |
|     > to release to only   |                                        |   |
|     > output non-PCI       |                                        |   |
|     > payment account/card |                                        |   |
|     > data.                |                                        |   |
+----------------------------+----------------------------------------+---+

+---------------------------+------------------------------------------+
| []{#_bookmark45           |                                          |
| .anchor}***Requirement    |                                          |
| 4C: Monitor the           |                                          |
| decryption environment    |                                          |
| and respond to            |                                          |
| incidents***              |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***4C-1** Perform logging |                                          |
| and monitor the           |                                          |
| decryption environment    |                                          |
| for suspicious activity   |                                          |
| and implement             |                                          |
| notification processes.*  |                                          |
+---------------------------+------------------------------------------+
| > **4C-1.1** Changes to   | > **4C-1.1** Examine system              |
| > the critical functions  | > configurations and correlating log     |
| > of the decryption       | > files to verify that any changes to    |
| > devices must be logged. | > the critical functions of decryption   |
| > Logs must be kept for   | > devices are logged, including:         |
| > one year, at a minimum. |                                          |
| >                         | -   Changes to the applications          |
| > ***Note:** Critical     |                                          |
| > functions include but   | -   Changes to the firmware              |
| > are not limited to      |                                          |
| > application and         | -   Changes to any security-sensitive    |
| > firmware updates,       |     > configurations                     |
| > key-injection, as well  |                                          |
| > as changes to           |                                          |
| > security-sensitive      |                                          |
| > configurations.*        |                                          |
+---------------------------+------------------------------------------+
| > **4C-1.2** Mechanisms   | > **4C-1.2.a** Examine documented        |
| > must be implemented to  | > procedures to verify mechanisms are    |
| > detect and respond to   | > defined to detect and respond to       |
| > suspicious activity,    | > potential security incidents,          |
| > including but not       | > including:                             |
| > limited to:             |                                          |
|                           | -   Physical breach                      |
| -   Physical breach       |                                          |
|                           | -   Tampered, missing, or substituted    |
| -   Tampered, missing, or |     > devices                            |
|     > substituted devices |                                          |
|                           | -   Unauthorized logical alterations     |
| -   Unauthorized logical  |     > (e.g., configurations, access      |
|     > alterations (e.g.,  |     > controls)                          |
|     > configurations,     |                                          |
|     > access controls)    | -   Unauthorized use of sensitive        |
|                           |     > functions (e.g., key-management    |
| -   Unauthorized use of   |     > functions)                         |
|     > sensitive functions |                                          |
|     > (e.g.,              | -   Disconnect/reconnect of devices      |
|     > key-management      |                                          |
|     > functions)          | -   Failure of any device security       |
|                           |     > control                            |
| -   Disconnect/reconnect  |                                          |
|     > of devices          | -   Encryption/decryption failures       |
|                           |                                          |
| -   Failure of any device | -   Unauthorized use of the HSM API      |
|     > security control    |                                          |
|                           |                                          |
| -   Encryption/decryption |                                          |
|     > failures            |                                          |
|                           |                                          |
| -   Unauthorized use of   |                                          |
|     > the HSM API         |                                          |
+---------------------------+------------------------------------------+
|                           | > **4C-1.2.b** Interview personnel and   |
|                           | > observe implemented mechanisms to      |
|                           | > verify mechanisms are implemented to   |
|                           | > detect and respond to suspicious       |
|                           | > activity, including:                   |
|                           |                                          |
|                           | -   Physical breach                      |
|                           |                                          |
|                           | -   Tampered, missing, or substituted    |
|                           |     > devices                            |
|                           |                                          |
|                           | -   Unauthorized logical alterations     |
|                           |     > (configuration, access controls)   |
|                           |                                          |
|                           | -   Unauthorized use of sensitive        |
|                           |     > functions (e.g., key-management    |
|                           |     > functions)                         |
|                           |                                          |
|                           | -   Disconnect/reconnect of devices      |
|                           |                                          |
|                           | -   Failure of any device security       |
|                           |     > control                            |
|                           |                                          |
|                           | -   Encryption/decryption failures       |
|                           |                                          |
|                           | -   Unauthorized use of the HSM API      |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4C:        |                                          |
| Monitor the decryption    |                                          |
| environment and respond   |                                          |
| to incidents***           |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4C-1.3** Mechanisms   | > **4C-1.3** Examine documented          |
| > must be implemented to  | > procedures to verify controls are      |
| > detect encryption       | > defined for the following:             |
| > failures, including at  |                                          |
| > least the following:    | -   Procedures are defined to detect     |
| >                         |     > encryption failures, and include   |
| > ***Note:** Although     |     > **4C-1.3.1**                       |
| > Domain 4 is concerned   |                                          |
| > with the decryption     | > through **4C-1.3.4** below.            |
| > environment, not the    |                                          |
| > encryption environment, | -   Procedures include immediate         |
| > all traffic received    |     > notification upon detection of a   |
| > into the decryption     |     > cryptographic failure, for each    |
| > environment must be     |     > **4C-1.3.1** through **4C-1.3.4**  |
| > actively monitored to   |     > below.                             |
| > confirm that the POI    |                                          |
| > devices in the          |                                          |
| > merchant's encryption   |                                          |
| > environment is not      |                                          |
| > outputting clear-text   |                                          |
| > account data through    |                                          |
| > some error or           |                                          |
| > misconfiguration.*      |                                          |
+---------------------------+------------------------------------------+
| > **4C-1.3.1** Checking   | > **4C-1.3.1.a** Observe implemented     |
| > for incoming clear-text | > processes to verify controls are in    |
| > account data.           | > place to check for incoming clear-text |
|                           | > account data.                          |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.1.b** Observe implemented     |
|                           | > controls and notification mechanisms   |
|                           | > to verify mechanisms detect and        |
|                           | > provide immediate notification upon    |
|                           | > detection of incoming clear-text       |
|                           | > account data.                          |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.1.c** Interview personnel to  |
|                           | > verify that designated personnel are   |
|                           | > immediately notified upon detection of |
|                           | > incoming clear-text account data.      |
+---------------------------+------------------------------------------+
| > **4C-1.3.2** Detecting  | > **4C-1.3.2.a** Observe implemented     |
| > and reviewing any       | > processes to verify controls are in    |
| > cryptographic errors    | > place to detect and review any         |
| > reported by the HSM     | > cryptographic errors reported by the   |
|                           | > HSM.                                   |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.2.b** Observe implemented     |
|                           | > controls and notification mechanisms   |
|                           | > to verify that mechanisms detect and   |
|                           | > provide immediate notification of      |
|                           | > cryptographic errors reported by the   |
|                           | > HSM.                                   |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.2.c** Interview personnel to  |
|                           | > verify that designated personnel are   |
|                           | > immediately notified upon detection of |
|                           | > cryptographic errors reported by the   |
|                           | > HSM.                                   |
+---------------------------+------------------------------------------+
| > **4C-1.3.3** Detecting  | > **4C-1.3.3.a** Observe implemented     |
| > and reviewing any       | > processes to verify controls are in    |
| > unexpected transaction  | > place to detect and review any         |
| > data received.          | > unexpected transaction data received.  |
| >                         |                                          |
| > *For example,           |                                          |
| > transaction data        |                                          |
| > received without an     |                                          |
| > expected authentication |                                          |
| > data block (such as a   |                                          |
| > MAC or signature, or a  |                                          |
| > malformed message).*    |                                          |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.3.b** Observe implemented     |
|                           | > controls and notification mechanisms   |
|                           | > to verify that mechanisms detect and   |
|                           | > provide immediate notification for any |
|                           | > unexpected transaction data received.  |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.3.c** Interview personnel to  |
|                           | > verify that designated personnel are   |
|                           | > immediately notified upon detection of |
|                           | > any unexpected transaction data        |
|                           | > received.                              |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4C:        |                                          |
| Monitor the decryption    |                                          |
| environment and respond   |                                          |
| to incidents***           |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4C-1.3.4** Reviewing  | > **4C-1.3.4.a** Observe implemented     |
| > data sent by any POI    | > processes to verify controls are in    |
| > devices that are        | > place to review data sent by any POI   |
| > causing an unusually    | > devices that are causing an unusually  |
| > high rate of            | > high rate of transaction authorization |
| > transaction             | > rejections.                            |
| > authorization           |                                          |
| > rejections.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.4.b** Observe implemented     |
|                           | > controls and notification mechanisms   |
|                           | > to verify that mechanisms detect and   |
|                           | > provide immediate notification upon    |
|                           | > detection of POI devices that are      |
|                           | > causing an unusually high rate of      |
|                           | > transaction authorization rejections.  |
+---------------------------+------------------------------------------+
|                           | > **4C-1.3.4.c** Interview personnel to  |
|                           | > verify that designated personnel are   |
|                           | > immediately notified upon detection of |
|                           | > POI devices that are causing an        |
|                           | > unusually high rate of transaction     |
|                           | > authorization rejections.              |
+---------------------------+------------------------------------------+
| > **4C-1.4** All          | > **4C-1.4.a** Examine documented        |
| > suspicious activity     | > procedures to verify they include      |
| > must be identified and  | > procedures for identifying the source  |
| > a record maintained for | > and maintaining a record, of all       |
| > one year, at a minimum, | > suspicious activity, to include at     |
| > to include at least the | > least the following:                   |
| > following:              |                                          |
|                           | -   Identification of affected           |
| -   Identification of     |     > device(s), including make, model,  |
|     > affected device(s), |     > and serial number                  |
|     > including make,     |                                          |
|     > model, and serial   | -   Identification of affected merchant, |
|     > number              |     > including specific sites/locations |
|                           |     > if applicable                      |
| -   Identification of     |                                          |
|     > affected merchant,  | -   Date/time of incident                |
|     > including specific  |                                          |
|     > sites/locations if  | -   Duration of device downtime          |
|     > applicable          |                                          |
|                           | -   Date/time the issue was resolved     |
| -   Date/time of incident |                                          |
|                           | -   Details of whether any account data  |
| -   Duration of device    |     > was transmitted from the POI       |
|     > downtime            |     > device during the time that        |
|                           |     > encryption was malfunctioning or   |
| -   Date/time the issue   |     > disabled                           |
|     > was resolved        |                                          |
|                           |                                          |
| -   Details of whether    |                                          |
|     > any account data    |                                          |
|     > was transmitted     |                                          |
|     > from the POI device |                                          |
|     > during any          |                                          |
|     > identified time     |                                          |
|     > that encryption was |                                          |
|     > malfunctioning or   |                                          |
|     > disabled            |                                          |
+---------------------------+------------------------------------------+
|                           | > **4C-1.4.b** Observe implemented       |
|                           | > controls and interview responsible     |
|                           | > personnel to verify that the source of |
|                           | > any suspicious activity is identified, |
|                           | > and records are maintained to include  |
|                           | > the following:                         |
|                           |                                          |
|                           | -   Identification of affected           |
|                           |     > device(s), including make, model,  |
|                           |     > and serial number                  |
|                           |                                          |
|                           | -   Identification of affected merchant  |
|                           |     > and specific sites/locations if    |
|                           |     > applicable                         |
|                           |                                          |
|                           | -   Date/time of incident                |
|                           |                                          |
|                           | -   Duration of device downtime          |
|                           |                                          |
|                           | -   Date/time the issue was resolved     |
|                           |                                          |
|                           | -   Details of whether any account data  |
|                           |     > was transmitted from the POI       |
|                           |     > device during the time that        |
|                           |     > encryption was malfunctioning or   |
|                           |     > disabled                           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4C:        |                                          |
| Monitor the decryption    |                                          |
| environment and respond   |                                          |
| to incidents***           |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **4C-1.5** Implement      | **4C-1.5.a** Examine documented          |
| mechanisms to provide     | procedures to verify mechanisms are      |
| immediate notification of | defined to provide immediate             |
| suspicious activity to    | notification of suspicious activity to   |
| applicable parties,       | applicable parties, including merchants, |
| including merchants,      | processors, acquirers, and any P2PE      |
| processors, acquirers,    | solution providers (if decryption        |
| and any P2PE solution     | services are being performed on behalf   |
| providers (if decryption  | of other P2PE solution providers).       |
| services are being        |                                          |
| performed on behalf of    |                                          |
| other P2PE solution       |                                          |
| providers).               |                                          |
+---------------------------+------------------------------------------+
|                           | **4C-1.5.b** Interview personnel and     |
|                           | observe implemented mechanisms to verify |
|                           | that immediate notification of           |
|                           | suspicious activity is provided to       |
|                           | applicable parties, including merchants, |
|                           | processors, acquirers, and any P2PE      |
|                           | solution providers (if decryption        |
|                           | services are being performed on behalf   |
|                           | of other P2PE solution providers).       |
+---------------------------+------------------------------------------+

> []{#_bookmark46 .anchor}**At a Glance -- Example P2PE Hybrid
> Decryption Implementation**
>
> **Note:** This diagram is for illustrative purposes only.
>
> **P2PE Solution**
>
> Key Management and
>
> Hardware Security Module (FIPS 140-2 or PCI HSM Approved)
>
> **Secure Decryption Environment**
>
> Host System
>
> Transaction
>
> Remote/Local Cryptographic Key Loading
>
> Account
>
> Data Decryption
>
> Processing
>
> **Merchant Encryption Environment**
>
> Account Data Application 1
>
> Account Data Application 2
>
> Non-account Data Application 3
>
> **POI Device**
>
> Customer presentment of payment card
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image21.png){width="7.758912948381452in"
> height="5.113525809273841in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image22.png){width="4.221646981627297in"
> height="1.4629735345581802in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image23.png){width="7.468739063867017in"
> height="3.1643963254593177in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image24.png){width="4.533106955380577in"
> height="2.946408573928259in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image25.png){width="3.848333333333333in"
> height="1.9918941382327209in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image26.png){width="0.5159711286089239in"
> height="9.579943132108486e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image27.png){width="0.7288167104111986in"
> height="9.579943132108486e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image28.png){width="0.10361439195100612in"
> height="8.834317585301837e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image29.png){width="0.10361439195100612in"
> height="8.825568678915136e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image30.png){width="0.12203958880139983in"
> height="7.36078302712161e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image31.png){width="0.10387795275590551in"
> height="9.088692038495189e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image32.png){width="0.10387795275590551in"
> height="9.088692038495189e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image33.png){width="2.0014949693788275in"
> height="2.205748031496063in"}Plain-text account data Encrypted (or
> truncated)
>
> Communications w/o account data
>
> Transaction account data flow (encrypted or truncated data only)
>
> Assessed to PCI PTS POI (SRED) Assessed to P2PE Domain 1 Assessed to
> P2PE Domain 2
>
> PCI DSS validation as required by the merchant\'s acquirer or payment
> brand
>
> Assessed to P2PE Domain 3
>
> Assessed to P2PE Domain 4 (includes PCI DSS compliance) Assessed to
> P2PE Domain 5

+---------------------------+------------------------------------------+
| []{#_bookmark47           |                                          |
| .anchor}***Requirement    |                                          |
| 4D: Implement secure      |                                          |
| hybrid decryption process |                                          |
| -- Applicable for hybrid  |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***4D-1** Configure the   |                                          |
| Host System securely.*    |                                          |
+---------------------------+------------------------------------------+
| > **4D-1.1** The solution | > **4D-1.1.a** Interview responsible     |
| > provider must maintain  | > personnel and review documentation to  |
| > current documentation   | > verify that a procedure exists to      |
| > that describes, or      | > maintain a document that               |
| > illustrates, the        | > describes/illustrates the              |
| > configuration of the    | > configuration of the Host System,      |
| > Host System, including  | > including the flow of data and         |
| > the flow of data and    | > interconnectivity between all systems  |
| > interconnectivity       | > within the decryption environment.     |
| > between all systems     |                                          |
| > within the decryption   |                                          |
| > environment.            |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.1.b** Interview responsible     |
|                           | > personnel and review solution provider |
|                           | > documentation that                     |
|                           | > describes/illustrates the              |
|                           | > configuration of the Host System,      |
|                           | > including the flow of data and         |
|                           | > interconnectivity between all systems  |
|                           | > within that environment, to verify     |
|                           | > that the document is current.          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.1.c** Review the solution       |
|                           | > provider documentation that            |
|                           | > describes/illustrates the              |
|                           | > configuration of the Host System,      |
|                           | > including the flow of data and         |
|                           | > interconnectivity between all systems, |
|                           | > to verify that it accurately           |
|                           | > represents the decryption environment. |
+---------------------------+------------------------------------------+
| > **4D-1.2** The Host     | > **4D-1.2.a** Inspect network and       |
| > System must be          | > system configuration settings to       |
| > isolated, or dedicated, | > verify the host processing system is   |
| > to processing payment   | > isolated, or dedicated, to processing  |
| > transactions with only  | > payment transactions, with only        |
| > necessary services,     | > necessary services, protocols, daemons |
| > protocols, daemons etc. | > etc. enabled.                          |
| > enabled:                |                                          |
|                           |                                          |
| -   The necessary         |                                          |
|     > services,           |                                          |
|     > protocols, daemons  |                                          |
|     > etc. must be        |                                          |
|     > documented and      |                                          |
|     > justified,          |                                          |
|     > including           |                                          |
|     > description of the  |                                          |
|     > enabled security    |                                          |
|     > features for these  |                                          |
|     > services etc.       |                                          |
|                           |                                          |
| -   Functions not related |                                          |
|     > to transaction      |                                          |
|     > processing must be  |                                          |
|     > disabled, or        |                                          |
|     > isolated (e.g.,     |                                          |
|     > using logical       |                                          |
|     > partitions), from   |                                          |
|     > transaction         |                                          |
|     > processing          |                                          |
|                           |                                          |
| > ***Note:** "Isolated"   |                                          |
| > means that the Host     |                                          |
| > System must not be      |                                          |
| > accessed, modified or   |                                          |
| > intercepted by other    |                                          |
| > processes.*             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.2.b** Review the documented     |
|                           | > record of services, protocols, daemons |
|                           | > etc. that are required by the Host     |
|                           | > System and verify that each service    |
|                           | > includes justification and a           |
|                           | > description of the enabled security    |
|                           | > feature.                               |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-1.3** The Host     | > **4D-1.3.a** Examine network diagrams  |
| > System and HSM must     | > to verify the Host System(s) and       |
| > reside on a network     | > HSM(s) are located on a network that   |
| > that is dedicated to    | > is segmented from other networks that  |
| > decryption operations   | > are not required for decryption        |
| > and transaction         | > operations or transaction processing.  |
| > processing and must be  |                                          |
| > segmented from any      |                                          |
| > other network, or       |                                          |
| > system, that is not     |                                          |
| > performing or           |                                          |
| > supporting decryption   |                                          |
| > operations or           |                                          |
| > transaction processing. |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.3.b** Inspect network and       |
|                           | > system configurations to verify the    |
|                           | > Host System(s) and HSM(s) are located  |
|                           | > on a network that is segmented from    |
|                           | > other networks not required for        |
|                           | > decryption operations or transaction   |
|                           | > processing.                            |
+---------------------------+------------------------------------------+
| > **4D-1.4** All          | > **4D-1.4.a** Examine documented        |
| > application software    | > policies and procedures to verify that |
| > installed on the Host   | > all application software installed on  |
| > System must be          | > the Host System must have a business   |
| > authorized and have a   | > justification and be duly authorized.  |
| > business justification. |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.4.b** Examine change-control    |
|                           | > and system-configuration records to    |
|                           | > verify that all application software   |
|                           | > installed on the Host System is        |
|                           | > authorized.                            |
+---------------------------+------------------------------------------+
|                           | > **4D-1.4.c** Inspect Host System and   |
|                           | > compare with system configuration      |
|                           | > standards to verify that all software  |
|                           | > installed on the Host System has a     |
|                           | > defined business justification.        |
+---------------------------+------------------------------------------+
| > **4D-1.5** A process,   | > **4D-1.5.a** Examine documented        |
| > either automated or     | > policies and procedures to verify that |
| > manual, must be in      | > a process is defined to prevent and/or |
| > place to prevent and/or | > detect and alert, any unauthorized     |
| > detect and alert, any   | > changes to applications/software.      |
| > unauthorized changes to |                                          |
| > applications/software   |                                          |
| > on the Host System.     |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.5.b** Interview personnel and   |
|                           | > observe system configurations to       |
|                           | > verify that controls are implemented   |
|                           | > to prevent and/or detect and alert     |
|                           | > personnel, upon any unauthorized       |
|                           | > changes to applications/software.      |
+---------------------------+------------------------------------------+
|                           | > **4D-1.5.c** Examine output from the   |
|                           | > implemented process to verify that any |
|                           | > unauthorized changes to                |
|                           | > applications/software are either       |
|                           | > prevented or detected with an alert    |
|                           | > generated that is immediately          |
|                           | > investigated.                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-1.6** The Host     | > **4D-1.6.a** Inspect Host System       |
| > System must perform a   | > configuration settings, and examine    |
| > self-test when it is    | > vendor/solution provider documentation |
| > powered up to ensure    | > to verify that the Host System         |
| > its integrity before    | > performs a self-test when it is        |
| > use. The self-test must | > powered up to ensure its integrity     |
| > include:                | > before use. Verify the self-test       |
|                           | > includes the following:                |
| -   Testing integrity of  |                                          |
|     > cryptographic       | -   Testing integrity of cryptographic   |
|     > functions           |     > functions                          |
|                           |                                          |
| -   Testing integrity of  | -   Testing integrity of                 |
|     > firmware            |     > software/firmware                  |
|                           |                                          |
| -   Testing integrity of  | -   Testing integrity of any security    |
|     > any security        |     > functions critical to the secure   |
|     > functions critical  |     > operation of the Host System       |
|     > to the secure       |                                          |
|     > operation of the    |                                          |
|     > Host System         |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.6.b** Review logs/audit trails  |
|                           | > from when the Host System has          |
|                           | > previously been powered-up and         |
|                           | > interview personnel, to verify that    |
|                           | > the Host System performs a self- test  |
|                           | > to ensure its integrity before use.    |
|                           | > Verify the self-tests included the     |
|                           | > tests described in **4D-1.6.a**.       |
+---------------------------+------------------------------------------+
| > **4D-1.7** The Host     | > **4D-1.7.a** Inspect Host System       |
| > System must perform a   | > configuration settings and examine     |
| > self-test when a        | > vendor/solution provider documentation |
| > security-impacting      | > to verify that the Host System         |
| > function or operation   | > performs a self-test when a            |
| > is modified (e.g., an   | > security-impacting function or         |
| > integrity check of the  | > operation is modified.                 |
| > software/firmware must  |                                          |
| > be performed upon       |                                          |
| > loading of a            |                                          |
| > software/firmware       |                                          |
| > update).                |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.7.b** Interview personnel and   |
|                           | > examine logs/records for when a        |
|                           | > security-impacting function, or        |
|                           | > operation, has been modified to verify |
|                           | > that the Host System performs a        |
|                           | > self-test.                             |
+---------------------------+------------------------------------------+
| > **4D-1.8** The Host     | > **4D-1.8.a** Inspect Host System       |
| > System must enter an    | > configuration settings and examine     |
| > error state and         | > vendor/solution provider documentation |
| > generate an alert upon  | > to verify that the host enters an      |
| > any of the following    | > error state and generates an alert in  |
| > events:                 | > the event of the following:            |
|                           |                                          |
| -   Failure of a          | -   Failure of a cryptographic operation |
|     > cryptographic       |                                          |
|     > operation           | -   Failure of a system self-test, as    |
|                           |     > described in Requirements          |
| -   Failure of a system   |     > **4D-1.6** and **4D-1.7**          |
|     > self-test, as       |                                          |
|     > described in        | -   Failure of a security function or    |
|     > Requirements        |     > mechanism                          |
|     > **4D-1.6** and      |                                          |
|     > **4D-1.7**          |                                          |
|                           |                                          |
| -   Failure of a security |                                          |
|     > function or         |                                          |
|     > mechanism           |                                          |
|                           |                                          |
| > ***Note:** An "error    |                                          |
| > state" identifies the   |                                          |
| > Host System has         |                                          |
| > encountered an issue    |                                          |
| > that requires a         |                                          |
| > response action. To     |                                          |
| > prevent potential       |                                          |
| > damage or compromise,   |                                          |
| > the system must cease   |                                          |
| > cryptographic           |                                          |
| > operations until the    |                                          |
| > issue is resolved and   |                                          |
| > the host is returned to |                                          |
| > a normal processing     |                                          |
| > state.*                 |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.8.b** Interview personnel and   |
|                           | > examine logs/records of actual or test |
|                           | > alerts to verify that alerts are       |
|                           | > generated and received when the Host   |
|                           | > System enters an error state under one |
|                           | > of the following conditions:           |
|                           |                                          |
|                           | -   Failure of a cryptographic operation |
|                           |                                          |
|                           | -   Failure of a system self-test, as    |
|                           |     > described in Requirements          |
|                           |     > **4D-1.6** and **4D-1.7**          |
|                           |                                          |
|                           | -   Failure of a security function or    |
|                           |     > mechanism                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-1.9** Alerts       | > **4D-1.9.a** Review documented         |
| > generated from the Host | > procedures to verify alerts generated  |
| > System must be          | > from the Host System must be           |
| > documented and result   | > documented and result in notification  |
| > in notification to      | > to authorized personnel and initiate a |
| > authorized personnel    | > response procedure.                    |
| > and initiate a response |                                          |
| > procedure.              |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.9.b** Examine system            |
|                           | > configurations and records of          |
|                           | > documented alert events to verify      |
|                           | > alerts generated from the Host System  |
|                           | > are documented.                        |
+---------------------------+------------------------------------------+
|                           | > **4D-1.9.c** Examine a sample of       |
|                           | > documented alert events and interview  |
|                           | > personnel assigned with                |
|                           | > security-response duties to verify     |
|                           | > alerts initiate a response procedure.  |
+---------------------------+------------------------------------------+
| > **4D-1.10** The Host    | > **4D-1.10.a** Examine documented       |
| > System must not perform | > procedures to verify that              |
| > any cryptographic       | > controls/processes are in place to     |
| > operations under any of | > ensure that the Host System does not   |
| > the following           | > perform any cryptographic operations:  |
| > conditions:             |                                          |
|                           | -   While in an error state, as          |
| -   While in an error     |     > described in Requirement           |
|     > state, as described |     > **4D-1.8**                         |
|     > in Requirement      |                                          |
|     > **4D-1.8**          | -   During self-tests, as described in   |
|                           |     > Requirements **4D-1.6** and        |
| -   During self-tests, as |     > **4D-1.7**                         |
|     > described in        |                                          |
|     > Requirements        | -   During diagnostics of cryptographic  |
|                           |     > operations                         |
| > **4D-1.6** and          |                                          |
| > **4D-1.7**              |                                          |
|                           |                                          |
| -   During diagnostics of |                                          |
|     > cryptographic       |                                          |
|     > operations          |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.10.b** Inspect Host System      |
|                           | > configuration settings and interview   |
|                           | > personnel to verify that controls      |
|                           | > and/or procedures are in place to      |
|                           | > ensure that the Host System does not   |
|                           | > perform any cryptographic operations:  |
|                           |                                          |
|                           | -   While in an error state, as          |
|                           |     > described in Requirement           |
|                           |     > **4D-1.8**                         |
|                           |                                          |
|                           | -   During self-tests, as described in   |
|                           |     > Requirements **4D-1.6** and        |
|                           |     > **4D-1.7**                         |
|                           |                                          |
|                           | -   During diagnostics of cryptographic  |
|                           |     > operations                         |
+---------------------------+------------------------------------------+
| > **4D-1.11** All source  | > **4D-1.11.a** Inspect configuration    |
| > code and executable     | > documentation to verify that access    |
| > code for cryptographic  | > controls are defined to ensure all     |
| > software and firmware   | > source code and executable code for    |
| > on the Host System must | > cryptographic software and firmware is |
| > be protected from       | > protected from unauthorized disclosure |
| > unauthorized disclosure | > and unauthorized modification.         |
| > and unauthorized        |                                          |
| > modification.           |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.11.b** Observe access controls  |
|                           | > for cryptographic software and         |
|                           | > firmware to verify that all source     |
|                           | > code and executable code is protected  |
|                           | > from unauthorized disclosure and       |
|                           | > unauthorized modification.             |
+---------------------------+------------------------------------------+
| > **4D-1.12** The         | > **4D-1.12.a** Review solution provider |
| > clear-text              | > documentation, including data-flow     |
| > data-decryption keys    | > diagrams, to verify that clear-text    |
| > must not be accessible  | > decryption keys are not accessible to  |
| > to any processes or     | > any processes or functions not         |
| > functions not directly  | > directly required for decryption       |
| > required for decryption | > operations.                            |
| > operations.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.12.b** Inspect Host System      |
|                           | > configurations and access controls and |
|                           | > to verify that clear-text decryption   |
|                           | > keys are not accessible to any         |
|                           | > processes or functions not directly    |
|                           | > required for decryption operations.    |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **4D-1.13** The           | **4D-1.13.a** Examine documented         |
| clear-text                | key-management policies and procedures   |
| data-decryption keys must | to verify clear-text data-decryption     |
| only be accessible to     | keys must only be accessible to          |
| authorized personnel with | authorized personnel with a defined      |
| a defined job- related    | job-related need to access the keys.     |
| need to access the keys   |                                          |
+---------------------------+------------------------------------------+
|                           | **4D-1.13.b** Inspect Host System        |
|                           | configuration settings and verify that   |
|                           | clear-text data- decryption keys are     |
|                           | only accessible to authorized personnel  |
|                           | with a defined job-related need to       |
|                           | access the keys.                         |
+---------------------------+------------------------------------------+
| **4D-1.14** The Host      | **4D-1.14.a** Examine documented         |
| System must not write     | configuration procedures to verify that  |
| clear-text cryptographic  | the Host System must not write           |
| keys to persistent        | clear-text cryptographic keys to         |
| storage (e.g., hard       | persistent storage (e.g., hard drives,   |
| drives, removable         | removable storage, flash drives etc.)    |
| storage, flash drives     | except for the following:                |
| etc.) except for the      |                                          |
| following:                | -   Memory swap/page file purposes       |
|                           |                                          |
| -   Memory "swap/page"    | -   Core dumps of memory required for    |
|     > file purposes       |     > trouble-shooting                   |
|                           |                                          |
| -   "Core dumps" of       |                                          |
|     > memory required for |                                          |
|     > troubleshooting     |                                          |
|                           |                                          |
| In the above              |                                          |
| circumstances, the        |                                          |
| following conditions      |                                          |
| apply:                    |                                          |
+---------------------------+------------------------------------------+
|                           | **4D-1.14.b** Examine Host System        |
|                           | configuration settings and interview     |
|                           | personnel to verify that clear-text      |
|                           | cryptographic keys are not written to    |
|                           | persistent storage except in the         |
|                           | following circumstances:                 |
|                           |                                          |
|                           | -   Memory swap/page file purposes       |
|                           |                                          |
|                           | -   Core dumps of memory required for    |
|                           |     > trouble-shooting                   |
+---------------------------+------------------------------------------+
|                           | **4D-1.14.c** Verify documented          |
|                           | procedures include Requirements          |
|                           | **4D-1.14.1** through **4D-**            |
|                           |                                          |
|                           | **1.14.5** below.                        |
+---------------------------+------------------------------------------+
| > **4D-1.14.1** The       | > **4D-1.14.1.a** Review Host System     |
| > locations must be       | > configuration standards to verify that |
| > predefined and          | > storage locations of any swap/page     |
| > documented.             | > files and core dumps are defined.      |
+---------------------------+------------------------------------------+
|                           | > **4D-1.14.1.b** Examine Host System    |
|                           | > configuration settings to verify that  |
|                           | > the Host System only outputs swap/page |
|                           | > files and core dumps to the documented |
|                           | > storage locations.                     |
+---------------------------+------------------------------------------+
| > **4D-1.14.2** Storage   | > **4D-1.14.2** Examine Host System      |
| > can only be made to a   | > configuration settings and storage     |
| > dedicated hard drive    | > locations to verify that swap/page     |
| > (on its own bus) within | > files and core dumps are written to a  |
| > the host.               | > dedicated hard drive on its own bus on |
|                           | > the Host System.                       |
+---------------------------+------------------------------------------+
| > **4D-1.14.3** The       | > **4D-1.14.3.a** Examine backup         |
| > swap/page files and/or  | > configuration settings for the Host    |
| > core dumps must never   | > System and storage locations to verify |
| > be backed up or copied. | > that swap/page files and core dumps    |
| > *(continued on next     | > are not backed up.                     |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-1.14.3**           | > **4D-1.14.3.b** Examine the            |
| > *(continued)*           | > configurations of storage locations to |
|                           | > verify that swap/page files and core   |
|                           | > dumps cannot be copied off the storage |
|                           | > locations.                             |
+---------------------------+------------------------------------------+
| > **4D-1.14.4** Access    | > **4D-1.14.4.a** Examine documented     |
| > to, and the use of, any | > procedures to verify that controls are |
| > tools used for          | > defined to ensure that the access to,  |
| > trouble-shooting or     | > and use of, any tools used for         |
| > forensics must be       | > trouble-shooting or forensics, are     |
| > controlled and          | > controlled and authorized by           |
| > authorized by           | > management.                            |
| > management.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.14.4.b** Observe the process    |
|                           | > for accessing the tools used for       |
|                           | > trouble-shooting or forensics, and     |
|                           | > verify that they are controlled and    |
|                           | > authorized by management in accordance |
|                           | > with the documented procedure.         |
+---------------------------+------------------------------------------+
|                           | > **4D-1.14.4.c** Observe the process    |
|                           | > for using the tools used for           |
|                           | > trouble-shooting or forensics, and     |
|                           | > verify that they are controlled and    |
|                           | > authorized by management in accordance |
|                           | > with the documented procedure.         |
+---------------------------+------------------------------------------+
| > **4D-1.14.5** All files | > **4D-1.14.5.a** Review documented      |
| > must be securely        | > procedures to verify that it defines a |
| > deleted in accordance   | > process for securely deleting          |
| > with industry-accepted  | > swap/page files and core dumps at the  |
| > standards for secure    | > required times:                        |
| > deletion of data:       |                                          |
|                           | -   Core dumps must be securely deleted  |
| -   Core dumps must be    |     > immediately after analysis.        |
|     > securely deleted    |                                          |
|     > immediately after   | -   Memory swap/page files must be       |
|     > analysis.           |     > securely deleted upon system shut  |
|                           |     > down or reset.                     |
| -   Memory swap/page      |                                          |
|     > files must be       |                                          |
|     > securely deleted    |                                          |
|     > upon system shut    |                                          |
|     > down or reset.      |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-1.14.5.b** Verify, through the    |
|                           | > use of forensic tools and/or methods,  |
|                           | > that the secure procedure removes      |
|                           | > swap/page files and core dumps, in     |
|                           | > accordance with industry- accepted     |
|                           | > standards for secure deletion of data. |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***4D-2** Access controls |                                          |
| for the Host System are   |                                          |
| configured securely.*     |                                          |
+---------------------------+------------------------------------------+
| > **4D-2.1** Host user    | > **4D-2.1.a** Examine documented        |
| > passwords must be       | > policies and procedures to verify that |
| > changed at least every  | > the Host System                        |
| > 30 days.                | >                                        |
| >                         | > \(s\) user passwords must be changed   |
| > ***Note:** This         | > at least every 30 days.                |
| > requirement applies to  |                                          |
| > all user roles          |                                          |
| > associated to persons   |                                          |
| > with access to the Host |                                          |
| > System.*                |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.1.b** Inspect Host System       |
|                           | > configuration settings to verify that  |
|                           | > user password parameters are set to    |
|                           | > require users to change passwords at   |
|                           | > least every 30 days.                   |
+---------------------------+------------------------------------------+
| > **4D-2.2** User         | > **4D-2.2.a** Examine documented        |
| > passwords must meet the | > policies and procedures to verify that |
| > following:              | > user passwords must:                   |
|                           |                                          |
| -   Consist of eight      | -   Consist of eight characters in       |
|     > characters in       |     > length,                            |
|     > length,             |                                          |
|                           | -   Consist of a combination of numeric, |
| -   Consist of a          |     > alphabetic, and special            |
|     > combination of      |     > characters, or                     |
|     > numeric,            |                                          |
|     > alphabetic, and     | -   Have equivalent strength/complexity. |
|     > special characters, |                                          |
|     > or                  |                                          |
|                           |                                          |
| -   Have equivalent       |                                          |
|                           |                                          |
|    > strength/complexity. |                                          |
|                           |                                          |
| > ***Note:** For          |                                          |
| > information on          |                                          |
| > variability and         |                                          |
| > equivalency of password |                                          |
| > strength/complexity     |                                          |
| > (also referred to as    |                                          |
| > entropy) for            |                                          |
| > passwords/passphrases   |                                          |
| > of different formats,   |                                          |
| > refer to industry       |                                          |
| > standards (e.g., the    |                                          |
| > current version of NIST |                                          |
| > SP 800-63.).*           |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.2.b** Inspect Host System (s)   |
|                           | > configuration settings to verify that  |
|                           | > user passwords:                        |
|                           |                                          |
|                           | -   Consist of eight characters in       |
|                           |     > length,                            |
|                           |                                          |
|                           | -   Consist of a combination of numeric, |
|                           |     > alphabetic, and special            |
|                           |     > characters, or                     |
|                           |                                          |
|                           | -   Have equivalent strength/complexity. |
+---------------------------+------------------------------------------+
| > **4D-2.3** Where log-on | > **4D-2.3.a** If log-on security tokens |
| > security tokens (e.g.,  | > are used, observe the security tokens  |
| > smart cards) are used   | > in use to verify that they have an     |
| > to access the Host      | > associated usage-authentication        |
| > System, the security    | > mechanism, such as a biometric or      |
| > tokens must have an     | > associated PIN or password/passphrase  |
| > associated              | > to enable their usage.                 |
| > usage-authentication    |                                          |
| > mechanism, such as a    |                                          |
| > biometric or associated |                                          |
| > PIN or                  |                                          |
| > password/passphrase to  |                                          |
| > enable their usage. The |                                          |
| > PIN or                  |                                          |
| > password/passphrase     |                                          |
| > must be at least ten    |                                          |
| > alphanumeric characters |                                          |
| > in length, or           |                                          |
| > equivalent.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.3.b** Examine                   |
|                           | > token-configuration settings to verify |
|                           | > parameters are set to require that     |
|                           | > PINs or password/passphrases be at     |
|                           | > least ten alphanumeric characters in   |
|                           | > length, or equivalent.                 |
+---------------------------+------------------------------------------+
| > **4D-2.4** User         | > **4D-2.4.a** Examine documented        |
| > accounts must be locked | > policies and procedures to verify that |
| > out of the Host System  | > authentication parameters on the Host  |
| > after not more than     | > System must be set to require that a   |
| > five failed attempts.   | > user's account be locked out after not |
|                           | > more than five invalid logon attempts. |
+---------------------------+------------------------------------------+
|                           | > **4D-2.4.b** Inspect Host System       |
|                           | > configuration settings to verify that  |
|                           | > authentication parameters are set to   |
|                           | > require that a user's account be       |
|                           | > locked out after not more than five    |
|                           | > invalid logon attempts.                |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-2.5** The Host     | > **4D-2.5.a** Examine documented        |
| > System must enforce     | > access-control procedures to verify    |
| > role-based access       | > they define, as a minimum, the         |
| > control to include, at  | > following roles:                       |
| > a minimum, the          |                                          |
| > following roles:        | -   Host System operator role -- for     |
|                           |     > day-to-day non-sensitive           |
| -   Host System operator  |     > operations of the Host System.     |
|     > role -- for         |                                          |
|     > day-to-day non-     | -   Host System administrator role --    |
|     > sensitive           |     > configuration of host OS, security |
|     > operations of the   |     > controls, software and user        |
|     > Host System         |     > accounts                           |
|                           |                                          |
| -   Host System           | -   Cryptographic administrator role --  |
|     > administrator role  |     > configuration of cryptographic     |
|     > -- configuration of |     > management functions               |
|     > host OS, security   |                                          |
|     > controls, software  | -   Host System security role --         |
|     > and user accounts   |     > auditing of host functions         |
|                           |                                          |
| -   Cryptographic         |                                          |
|     > administrator role  |                                          |
|     > -- configuration of |                                          |
|     > cryptographic       |                                          |
|     > management          |                                          |
|     > functions           |                                          |
|                           |                                          |
| -   Host System security  |                                          |
|     > role -- auditing of |                                          |
|     > host functions      |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.5.b** Inspect the Host System   |
|                           | > configuration settings to verify that  |
|                           | > role-based access control is enforced  |
|                           | > and the following roles, at a minimum, |
|                           | > are defined:                           |
|                           |                                          |
|                           | -   Host System operator role -- for     |
|                           |     > day-to-day non-sensitive           |
|                           |     > operations of the Host System      |
|                           |                                          |
|                           | -   Host System administrator role --    |
|                           |     > configuration of host OS, security |
|                           |     > controls, software and user        |
|                           |     > accounts                           |
|                           |                                          |
|                           | -   Cryptographic administrator role --  |
|                           |     > configuration of cryptographic     |
|                           |     > management functions               |
|                           |                                          |
|                           | -   Host System security role --         |
|                           |     > auditing of host functions         |
+---------------------------+------------------------------------------+
|                           | > **4D-2.5.c** Interview a sample of     |
|                           | > users for each role to verify the      |
|                           | > assigned role is appropriate for their |
|                           | > job function.                          |
+---------------------------+------------------------------------------+
| > **4D-2.6** The          |                                          |
| > segregation of duties   |                                          |
| > must be enforced        |                                          |
| > between roles, through  |                                          |
| > automated or manual     |                                          |
| > processes, to ensure    |                                          |
| > that no one person is   |                                          |
| > able to control end-to- |                                          |
| > end processes; or be in |                                          |
| > a position to           |                                          |
| > compromise the security |                                          |
| > of the Host System.     |                                          |
|                           |                                          |
| The following conditions  |                                          |
| must be applied:          |                                          |
+---------------------------+------------------------------------------+
| > **4D-2.6.1** A Host     | > **4D-2.6.1.a** Examine documented      |
| > System user must not be | > procedures to verify that a Host       |
| > permitted to audit      | > System user is not permitted to audit  |
| > their own activity on   | > their own activity on the Host System. |
| > the Host System.        |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.6.1.b** Interview audit         |
|                           | > personnel to verify that a Host System |
|                           | > user is not permitted to audit their   |
|                           | > own activity on the Host System.       |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-2.6.2** A Host     | > **4D-2.6.2.a** Review documented       |
| > System administrator    | > policies and procedures to verify a    |
| > must use their          | > Host System administrator is not       |
| > operator-level account  | > permitted to use their                 |
| > when performing non-    | > administrative-level account when      |
| > administrative          | > performing non-administrative          |
| > functions.              | > functions.                             |
+---------------------------+------------------------------------------+
|                           | > **4D-2.6.2.b** Interview and observe a |
|                           | > Host System administrator to verify    |
|                           | > they use their operator-level account  |
|                           | > when performing non-administrative     |
|                           | > functions.                             |
+---------------------------+------------------------------------------+
| > **4D-2.7** Changes to a | > **4D-2.7.a** Examine documented        |
| > Host System user's      | > policies and procedures to verify that |
| > account access          | > changes to a user's access privileges  |
| > privileges must be      | > are managed:                           |
| > managed:                |                                          |
|                           | -   Using a formal change-control        |
| -   Using a formal        |     > procedure.                         |
|     > change-control      |                                          |
|     > procedure.          | -   Requiring the participation of at    |
|                           |     > least two persons. Therefore, the  |
| -   Requiring the         |     > party making the change cannot     |
|     > participation of at |     > authorize the change on their own. |
|     > least two persons.  |                                          |
|     > Therefore, the      | -   Ensuring all changes to access       |
|     > party making the    |     > privileges result in an audit log. |
|     > change cannot       |                                          |
|     > authorize the       |                                          |
|     > change on their     |                                          |
|     > own.                |                                          |
|                           |                                          |
| -   Ensuring all changes  |                                          |
|     > to access           |                                          |
|     > privileges result   |                                          |
|     > in an audit log.    |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.7.b** Observe the process       |
|                           | > required to change a user's access     |
|                           | > privileges and verify that it is       |
|                           | > managed:                               |
|                           |                                          |
|                           | -   Using a formal change-control        |
|                           |     > procedure.                         |
|                           |                                          |
|                           | -   Requiring the participation of at    |
|                           |     > least two persons. Therefore, the  |
|                           |     > party making the change cannot     |
|                           |     > authorize the change on their own. |
|                           |                                          |
|                           | -   Ensuring all changes to access       |
|                           |     > privileges result in an audit log. |
+---------------------------+------------------------------------------+
|                           | > **4D-2.7.c** Inspect the Host System   |
|                           | > configuration settings and, for a      |
|                           | > sample of user accounts, verify that   |
|                           | > any changes to their access privileges |
|                           | > have been formally documented in the   |
|                           | > audit log.                             |
+---------------------------+------------------------------------------+
| > **4D-2.8** All physical | > **4D-2.8.a** Examine documented        |
| > and logical access      | > policies and procedures to verify that |
| > privileges must be      | > access privileges are reviewed, as a   |
| > reviewed at least       | > minimum, on a quarterly basis to       |
| > quarterly to ensure     | > ensure that the access privileges for  |
| > that personnel with     | > personnel authorized to access the     |
| > access to the           | > decryption environment, the Host       |
| > decryption environment, | > System and Host System software        |
| > the Host System and     | > required by their position and job     |
| > Host System software    | > function, are correctly assigned.      |
| > require that access for |                                          |
| > their position and job  |                                          |
| > function.               |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.8.b** Examine records and       |
|                           | > interview personnel to verify that     |
|                           | > access privileges are reviewed, as a   |
|                           | > minimum, on a quarterly basis.         |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-2.9** Tamper       | > **4D-2.9.a** Review Host System        |
| > detection mechanisms    | > documentation to verify that tamper    |
| > must be implemented on  | > detection mechanisms are defined for   |
| > the host, to include an | > the Host System, including the         |
| > alert generation upon   | > generation of an alert upon opening of |
| > opening of the Host     | > the Host System case, covers and/or    |
| > System case, covers     | > doors.                                 |
| > and/or doors.           |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-2.9.b** Observe tamper-detection  |
|                           | > mechanisms on the Host System to       |
|                           | > verify that a tamper detection         |
|                           | > mechanism is implemented and includes  |
|                           | > the generation of an alert upon        |
|                           | > opening of the Host System case,       |
|                           | > covers and/or doors.                   |
+---------------------------+------------------------------------------+
|                           | > **4D-2.9.c** Review records of alerts  |
|                           | > and interview personnel to verify an   |
|                           | > alert is generated upon opening of the |
|                           | > Host System, covers and/or doors.      |
+---------------------------+------------------------------------------+
| ***4D-3** Non-console     |                                          |
| access to the Host System |                                          |
| is configured securely.*  |                                          |
+---------------------------+------------------------------------------+
| ***Note:** The term       |                                          |
| "non-console access"      |                                          |
| refers to any authorized  |                                          |
| access to the Host System |                                          |
| that is performed by a    |                                          |
| person who is not         |                                          |
| physically present at the |                                          |
| host processing system    |                                          |
| located within the secure |                                          |
| room.*                    |                                          |
+---------------------------+------------------------------------------+
| > **4D-3.1** All          | > **4D-3.1.a** For a sample of systems   |
| > non-console access to   | > that are authorized to connect to the  |
| > the Host System must    | > Host System via a non-console          |
| > use strong cryptography | > connection, inspect configuration      |
| > and security protocols  | > settings to verify that access to the  |
|                           | > Host System is provided through the    |
|                           | > use of strong cryptography and         |
|                           | > security protocols                     |
+---------------------------+------------------------------------------+
|                           | > **4D-3.1.b** Inspect the configuration |
|                           | > settings of system components to       |
|                           | > verify that all traffic transmitted    |
|                           | > over the secure channel uses strong    |
|                           | > cryptography.                          |
+---------------------------+------------------------------------------+
| > **4D-3.2** Non-console  | > **4D-3.2.a** Inspect the configuration |
| > access to the Host      | > settings of the secure channel, to     |
| > System must not provide | > verify that split tunneling is         |
| > access to any other     | > prohibited.                            |
| > service, or channel,    |                                          |
| > outside of that used to |                                          |
| > connect to the Host,    |                                          |
| > e.g., "split            |                                          |
| > tunneling."             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-3.2.b** Observe a Host System     |
|                           | > administrator log on to the device     |
|                           | > which provides non-console access to   |
|                           | > the Host System to verify that split   |
|                           | > tunneling is prohibited.               |
+---------------------------+------------------------------------------+
| > **4D-3.3** All          | > **4D-3.3.a** Inspect the configuration |
| > non-console access to   | > settings of the Host System and/or the |
| > the Host System must    | > device permitted to connect to the     |
| > use multi-factor        | > Host System, to verify that            |
| > authentication.         | > multi-factor authentication is         |
|                           | > required for non-console access to the |
|                           | > Host System.                           |
+---------------------------+------------------------------------------+
|                           | > **4D-3.3.b** Observe a Host System     |
|                           | > administrator log on to the device     |
|                           | > that provides non- console access to   |
|                           | > the Host System to verify that         |
|                           | > multi-factor authentication is         |
|                           | > required.                              |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-3.4** Non-console  | > **4D-3.4.a** Examine documented        |
| > connections to the Host | > policies and procedures to verify that |
| > System must only be     | > a process is defined to authorize      |
| > permitted from          | > systems for non-console access, and    |
| > authorized systems.     | > not permit access until such times     |
|                           | > that authorization has been granted.   |
+---------------------------+------------------------------------------+
|                           | > **4D-3.4.b** For a sample of systems,  |
|                           | > examine device configurations to       |
|                           | > verify that non- console access is     |
|                           | > permitted only from the authorized     |
|                           | > systems.                               |
+---------------------------+------------------------------------------+
| > **4D-3.5** Non-console  | > **4D-3.5** Verify that non-console     |
| > access to the Host      | > access to the Host System is only      |
| > System must only be     | > permitted from a PCI DSS compliant     |
| > permitted directly from | > environment, including **4D-3.5.1**    |
| > within a PCI DSS        | > through **4D-3.5.2**                   |
| > compliant environment.  | >                                        |
|                           | > Review solution provider               |
|                           | > documentation, including data-flow     |
|                           | > diagrams, and perform the following:   |
+---------------------------+------------------------------------------+
| > **4D-3.5.1** The        | > **4D-3.5.1** Review solution provider  |
| > authorized system       | > documentation, including PCI DSS ROC   |
| > (e.g., workstation)     | > and/or Attestation of Compliance       |
| > from which non-console  | > (AOC), data-flow diagrams, policies    |
| > access originates must  | > and, system configuration standards,   |
| > meet all applicable PCI | > to verify that the system authorized   |
| > DSS requirements. For   | > for non-console access meets all       |
| > example, system         | > applicable PCI DSS requirements.       |
| > hardening, patching,    |                                          |
| > anti-virus protection,  |                                          |
| > a local firewall etc.   |                                          |
+---------------------------+------------------------------------------+
| > **4D-3.5.2** The        | > **4D-3.5.2** Review solution provider  |
| > network/system that     | > documentation, including PCI DSS ROC   |
| > facilitates non-        | > and/or Attestation of Compliance       |
| > console access to the   | > (AOC), data-flow diagrams, policies    |
| > Host System must:       | > and, system configuration standards,   |
|                           | > to verify that the network/system that |
| -   Originate from and be | > facilitates non-console access to the  |
|     > managed by the      | > Host System must:                      |
|     > solution provider   |                                          |
|                           | -   Originate from and be managed by the |
| -   Meet all applicable   |     > solution provider.                 |
|     > PCI DSS             |                                          |
|     > requirements        | -   Meet all applicable PCI DSS          |
|                           |     > requirements.                      |
+---------------------------+------------------------------------------+
| > **4D-3.6** Users with   | > **4D-3.6.a** Examine documented        |
| > access to non-console   | > policies and procedures to verify that |
| > connections to the Host | > non-console access to the Host System  |
| > System must be          | > must only be provided to authorized    |
| > authorized to use       | > users.                                 |
| > non-console             |                                          |
| > connections.            |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-3.6.b** Examine a sample of       |
|                           | > access-control records and compare     |
|                           | > them to Host System settings to verify |
|                           | > that non-console access to the Host    |
|                           | > System is only provided to authorized  |
|                           | > users.                                 |
+---------------------------+------------------------------------------+
| > **4D-3.7** Non-console  | > **4D-3.7.a** Review documented         |
| > sessions to the Host    | > policies and procedures to verify that |
| > System must be          | > the system parameters are set to       |
| > terminated by the Host  | > terminate non-console sessions after   |
| > after 15 minutes of     | > 15 minutes of inactivity.              |
| > inactivity.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-3.7.b** Inspect the system        |
|                           | > configuration settings to verify that  |
|                           | > the system parameters are set to       |
|                           | > terminate non-console sessions after   |
|                           | > 15 minutes of inactivity.              |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***4D-4** The physical    |                                          |
| environment of the Host   |                                          |
| System is secured.*       |                                          |
+---------------------------+------------------------------------------+
| ***Note:** Where "secure  |                                          |
| room" is referred to in   |                                          |
| this section, these       |                                          |
| controls can be met at    |                                          |
| **room level, rack level, |                                          |
| or a combination of       |                                          |
| both**. Whichever way the |                                          |
| requirements are applied, |                                          |
| they should ensure that   |                                          |
| access the Host System is |                                          |
| appropriately secured,    |                                          |
| whether in a secure room  |                                          |
| or a secure rack. For     |                                          |
| example, access to        |                                          |
| systems in a rack should  |                                          |
| be limited to those with  |                                          |
| a direct need to access   |                                          |
| that rack.*               |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.1** The Host     | > **4D-4.1** Observe the physically      |
| > System must be located  | > secure room where the Host System is   |
| > within a physically     | > located and interview personnel to     |
| > secure room that is     | > verify that all systems therein are    |
| > dedicated to decryption | > designated to decryption operations    |
| > operations and          | > and transaction processing.            |
| > transaction processing. |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.2** All          | > **4D-4.2.a** Examine documented        |
| > individuals must be     | > policies and procedures to verify that |
| > identified and          | > all individuals must be identified and |
| > authenticated before    | > authenticated before being granted     |
| > being granted access to | > access to the secure room.             |
| > the secure room---e.g., |                                          |
| > badge-control system,   |                                          |
| > biometrics.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.2.b** Examine physical access   |
|                           | > controls to verify that all            |
|                           | > individuals are identified and         |
|                           | > authenticated before being granted     |
|                           | > access to the secure room.             |
+---------------------------+------------------------------------------+
|                           | > **4D-4.2.c** Observe authorized        |
|                           | > personnel entering the secure room to  |
|                           | > verify that all individuals are        |
|                           | > identified and authenticated before    |
|                           | > being granted access.                  |
+---------------------------+------------------------------------------+
| > **4D-4.3** All physical | > **4D-4.3.a** Examine documented        |
| > access to the secure    | > policies and procedures to verify all  |
| > room must be monitored  | > physical access to the secure room     |
| > and logs must be        | > must be monitored and logs must be     |
| > maintained as follows:  | > maintained. Policies and procedures    |
|                           | > must require the following:            |
| -   Logs must be retained |                                          |
|     > for a minimum of    | -   Logs are retained for a minimum of   |
|     > three years.        |     > three years.                       |
|                           |                                          |
| -   Logs must be          | -   Logs are regularly reviewed by an    |
|     > regularly reviewed  |     > authorized person who does not     |
|     > by an authorized    |     > have access to the secure room or  |
|     > person who does not |     > to the systems therein.            |
|     > have access to the  |                                          |
|     > secure room or to   | -   Log reviews are documented.          |
|     > the systems         |                                          |
|     > therein.            | -   Logs include at a minimum:           |
|                           |                                          |
| -   Log reviews must be   |     -   Access to the room from a badge  |
|     > documented.         |         > access system                  |
|                           |                                          |
| -   Logs must include but |     -   Access to the room from a manual |
|     > not be limited to:  |         > sign-in sheet                  |
|                           |                                          |
|     -   Logs of access to |                                          |
|         > the room from a |                                          |
|         > badge access    |                                          |
|         > system          |                                          |
|                           |                                          |
|     -   Logs of access to |                                          |
|         > the room from a |                                          |
|         > manual sign-in  |                                          |
|         > sheet           |                                          |
|                           |                                          |
| > *(continued on next     |                                          |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.3**              | > **4D-4.3.b** Examine a sample of logs  |
| > *(continued)*           | > used to record physical access to the  |
|                           | > secure room to verify the following:   |
|                           |                                          |
|                           | -   Logs are being retained for a        |
|                           |     > minimum of three years.            |
|                           |                                          |
|                           | -   Logs include at a minimum:           |
|                           |                                          |
|                           |     -   Access to the room from a badge  |
|                           |         > access system                  |
|                           |                                          |
|                           |     -   Access to the room from a manual |
|                           |         > sign-in sheet                  |
+---------------------------+------------------------------------------+
|                           | > **4D-4.3.c** Interview personnel       |
|                           | > responsible for reviewing logs used to |
|                           | > record physical access to the secure   |
|                           | > room, to verify the following:         |
|                           |                                          |
|                           | -   Logs are regularly reviewed.         |
|                           |                                          |
|                           | -   Log reviews are documented.          |
|                           |                                          |
|                           | -   The person performing the review     |
|                           |     > does not have access to the secure |
|                           |     > room or to the systems therein.    |
+---------------------------+------------------------------------------+
| > **4D-4.4** Dual access  | > **4D-4.4.a** Inspect physical access   |
| > must be required for    | > controls to verify that dual access is |
| > the secure room housing | > enforced.                              |
| > the Host System.        |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.4.b** Observe authorized        |
|                           | > personnel entering the secure room to  |
|                           | > verify that dual access is enforced.   |
+---------------------------+------------------------------------------+
| > **4D-4.5** Physical     | > **4D-4.5.a** Examine documented        |
| > access must be only     | > policies and procedures to verify that |
| > permitted to designated | > physical access to the secure room is  |
| > personnel with defined  | > only permitted to designated personnel |
| > business needs and      | > with defined business needs and        |
| > duties.                 | > duties.                                |
+---------------------------+------------------------------------------+
|                           | > **4D-4.5.b** Examine the list of       |
|                           | > designated personnel and interview     |
|                           | > responsible personnel to verify that   |
|                           | > only personnel with defined business   |
|                           | > needs and duties are permitted access  |
|                           | > to the secure room.                    |
+---------------------------+------------------------------------------+
|                           | > **4D-4.5.c** Examine physical access   |
|                           | > controls to verify that physical       |
|                           | > access to the secure room is only      |
|                           | > permitted to pre-designated personnel  |
|                           | > with defined business needs and        |
|                           | > duties.                                |
+---------------------------+------------------------------------------+
| > **4D-4.6** The secure   | > **4D-4.6.a** Inspect CCTV              |
| > room must be monitored  | > configuration and review a sample of   |
| > via CCTV on a 24-hour   | > recordings to verify that CCTV         |
| > basis. This must        | > monitoring is in place on a 24-hour    |
| > include, as a minimum,  | > basis, and covers, as a minimum, the   |
| > the following areas:    | > following areas:                       |
| >                         |                                          |
| > *(continued on next     | -   All entrances and exists             |
| > page)*                  |                                          |
|                           | -   Access to the Host System and HSM(s) |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.6**              | > **4D-4.6.b** If CCTV is                |
| > *(continued)*           | > motion-activated, observe system       |
|                           | > configurations for the motion-         |
| -   All entrances and     | > activated systems to verify they are   |
|     > exists              | > separate from the intrusion-detection  |
|                           | > system.                                |
| -   Access to the Host    |                                          |
|     > System and HSM(s)   |                                          |
|                           |                                          |
| > ***Note:**              |                                          |
| > Motion-activated        |                                          |
| > systems that are        |                                          |
| > separate from the       |                                          |
| > intrusion-detection     |                                          |
| > system may be used.*    |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.7** Surveillance | > **4D-4.7** Observe CCTV camera         |
| > cameras must not be     | > positioning and examine a sample of    |
| > configured to allow the | > recordings to verify that CCTV cameras |
| > monitoring of computer  | > do not monitor any computer screens,   |
| > screens, keyboards, PIN | > PIN pads, keyboards, or other systems  |
| > pads, or other systems  | > which may expose sensitive data.       |
| > which may expose        |                                          |
| > sensitive data.         |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.8** CCTV         | > **4D-4.8.a** Examine a sample of       |
| > recorded images must be | > recordings to verify that at least the |
| > securely archived for   | > most recent 45 days of images are      |
| > at least 45 days.       | > securely archived.                     |
| >                         |                                          |
| > If digital-recording    |                                          |
| > mechanisms are used,    |                                          |
| > they must have          |                                          |
| > sufficient storage      |                                          |
| > capacity and redundancy |                                          |
| > to prevent the loss of  |                                          |
| > information necessary   |                                          |
| > to reconstruct events   |                                          |
| > for the most recent     |                                          |
| > 45-day period.          |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.8.b** If digital-recording      |
|                           | > mechanisms are used, examine system    |
|                           | > configurations to verify that the      |
|                           | > systems have sufficient redundancy to  |
|                           | > prevent the loss of information        |
|                           | > necessary to reconstruct events for    |
|                           | > the most recent 45-day period.         |
+---------------------------+------------------------------------------+
| > **4D-4.9** Personnel    | > **4D-4.9.a** Examine documented access |
| > with access to the      | > policies and procedures to verify that |
| > secure room must not    | > personnel with access to the secure    |
| > have access to the      | > room are not permitted to have access  |
| > media (e.g., VCR tapes, | > to the media containing recorded       |
| > digital recording       | > surveillance data for that             |
| > systems, etc.) with the | > environment.                           |
| > recorded surveillance   |                                          |
| > data.                   |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.9.b** Examine access lists for  |
|                           | > the secure room as well as access      |
|                           | > controls to the media containing       |
|                           | > surveillance data, to verify that      |
|                           | > personnel with access to the secure    |
|                           | > room do not have access to the media   |
|                           | > containing recorded surveillance data  |
+---------------------------+------------------------------------------+
| > **4D-4.10** Continuous  | > **4D-4.10.a** Observe the secure room  |
| > or motion-activated,    | > to verify that continuous or           |
| > appropriate lighting    | > motion-activated lighting is provided  |
| > must be provided for    | > for the cameras monitoring the secure  |
| > the cameras.            | > room.                                  |
| >                         |                                          |
| > ***Note:** Visible      |                                          |
| > spectrum lighting may   |                                          |
| > not be necessary if the |                                          |
| > cameras do not require  |                                          |
| > such lighting to        |                                          |
| > capture images (e.g.,   |                                          |
| > when infrared cameras   |                                          |
| > are used).*             |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.10.b** Examine a sample of      |
|                           | > recorded CCTV images to verify that    |
|                           | > appropriate lighting is provided when  |
|                           | > persons are present in the secure      |
|                           | > room.                                  |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.11** A 24/7      | > **4D-4.11.a** Examine security         |
| > physical                | > policies and procedures to verify they |
| > intrusion-detection     | > require:                               |
| > system must be in place |                                          |
| > for the secure room     | -   Continuous (24/7) physical           |
| > (e.g., motion detectors |     > intrusion-detection monitoring of  |
| > when unoccupied). This  |     > the secure room                    |
| > must be connected to    |                                          |
| > the alarm system and    | -   The physical intrusion-detection     |
| > automatically activated |     > must be connected to the alarm     |
| > whenever all authorized |     > system and automatically activated |
| > personnel have exited   |     > whenever all authorized personnel  |
| > the secure room.        |     > have exited the secure room.       |
+---------------------------+------------------------------------------+
|                           | > **4D-4.11.b** Observe the physical     |
|                           | > intrusion-detection system to verify   |
|                           | > that it:                               |
|                           |                                          |
|                           | -   Provides continuous (24/7)           |
|                           |     > monitoring of the secure room      |
|                           |                                          |
|                           | -   It is connected to the alarm system  |
|                           |     > and automatically activated        |
|                           |     > whenever all authorized personnel  |
|                           |     > have exited the secure room.       |
+---------------------------+------------------------------------------+
| > **4D-4.12** Any windows | > **4D-4.12.a** Observe all windows in   |
| > in the secure room must | > the secure room to verify they are     |
| > be locked, protected by | > locked and protected by alarmed        |
| > alarmed sensors, or     | > sensors.                               |
| > otherwise similarly     |                                          |
| > secured.                |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.12.b** Examine the              |
|                           | > configuration of window sensors to     |
|                           | > verify that the alarm mechanism is     |
|                           | > active.                                |
+---------------------------+------------------------------------------+
| > **4D-4.13** Any windows | > **4D-4.13** Observe all windows in the |
| > must be covered,        | > secure areas to verify they are        |
| > rendered opaque, or     | > covered, rendered opaque, or           |
| > positioned to prevent   | > positioned to prevent unauthorized     |
| > unauthorized            | > observation of the secure room.        |
| > observation of the      |                                          |
| > secure room.            |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.14**             | > **4D-4.14** Inspect uninterruptible    |
| > Access-control and      | > power source (UPS) system              |
| > monitoring systems must | > configurations to verify that all      |
| > be connected to an      | > access-control and monitoring systems  |
| > uninterruptible power   | > are powered through the UPS.           |
| > source (UPS) to prevent |                                          |
| > outages.                |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.15** All alarm   | > **4D-4.15.a** Examine security         |
| > events must be logged.  | > policies and procedures to verify they |
|                           | > require that all alarm events are      |
|                           | > logged.                                |
+---------------------------+------------------------------------------+
|                           | > **4D-4.15.b** Examine security-system  |
|                           | > configurations and documented alarm    |
|                           | > events to verify that all alarm events |
|                           | > are logged.                            |
+---------------------------+------------------------------------------+
| > **4D-4.16** Documented  | > **4D-4.16.a** Examine security         |
| > alarm events must be    | > policies and procedures to verify      |
| > signed off by an        | > alarm events must be signed off by an  |
| > authorized person who   | > authorized person other than the       |
| > was not involved in the | > individual who was involved in the     |
| > event.                  | > event.                                 |
+---------------------------+------------------------------------------+
|                           | > **4D-4.16.b** For a sample of          |
|                           | > documented alarm events, interview     |
|                           | > personnel who signed off on the event  |
|                           | > to verify that person was not involved |
|                           | > in the event.                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 4D:        |                                          |
| Implement secure hybrid   |                                          |
| decryption process --     |                                          |
| Applicable for hybrid     |                                          |
| decryption environments   |                                          |
| only***                   |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.17** Use of an   | > **4D-4.17** Examine security system    |
| > emergency entry or exit | > configurations to verify that an alarm |
| > mechanism must cause an | > event is generated upon use of any     |
| > alarm event.            | > emergency entry or exit mechanism.     |
+---------------------------+------------------------------------------+
| > **4D-4.18** Authorized  | > **4D-4.18.a** Examine documented       |
| > personnel must respond  | > policies and procedures to verify they |
| > to all physical         | > define that all alarm events are       |
| > intrusion alarms within | > responded to by authorized personnel   |
| > 30 minutes.             | > within 30 minutes.                     |
+---------------------------+------------------------------------------+
|                           | > **4D-4.18.b** Examine documented alarm |
|                           | > events and interview personnel to      |
|                           | > verify alarm events were responded by  |
|                           | > authorized personnel within 30         |
|                           | > minutes.                               |
+---------------------------+------------------------------------------+
| > **4D-4.19** A process   | > **4D-4.19.a** Examine documented       |
| > for synchronizing the   | > procedures to verify that mechanisms   |
| > time and date stamps of | > are defined for synchronizing the time |
| > the access-control,     | > and date stamps of the access,         |
| > intrusion-detection and | > intrusion-detection, and monitoring    |
| > monitoring (camera)     | > (camera) systems.                      |
| > systems must be         |                                          |
| > implemented.            |                                          |
| >                         |                                          |
| > ***Note:** This may be  |                                          |
| > done by either          |                                          |
| > automated or manual     |                                          |
| > mechanisms.*            |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.19.b** Examine system           |
|                           | > configurations for access,             |
|                           | > intrusion-detection, and monitoring    |
|                           | > (camera) systems to verify that time   |
|                           | > and date stamps are synchronized.      |
+---------------------------+------------------------------------------+
|                           | > **4D-4.19.c** Examine a sample of logs |
|                           | > from the access, intrusion-detection,  |
|                           | > and monitoring (camera) systems to     |
|                           | > verify log time and date stamps are    |
|                           | > synchronized.                          |
+---------------------------+------------------------------------------+
| > **4D-4.19.1** If a      | > **4D-4.19.1.a** If a manual            |
| > manual synchronization  | > synchronization process is             |
| > process is used,        | > implemented, interview responsible     |
| > synchronization must    | > personnel and examine records of       |
| > occur at least          | > synchronization to verify the          |
| > quarterly, and          | > mechanism is performed at least        |
| > documentation of the    | > quarterly.                             |
| > synchronization must be |                                          |
| > retained for at least a |                                          |
| > one-year period.        |                                          |
+---------------------------+------------------------------------------+
|                           | > **4D-4.19.1.b** Examine records of the |
|                           | > synchronization process to verify that |
|                           | > documentation is retained for at least |
|                           | > one year.                              |
+---------------------------+------------------------------------------+
| > **4D-4.20** The         | > **4D-4.20** Observe authorized         |
| > entrance to the secure  | > personnel entering the secure room to  |
| > room must include a     | > verify that a mechanism is in place to |
| > mechanism to ensure the | > ensure the door is not left open.      |
| > door is not left open.  | >                                        |
| >                         | > *Examples include:*                    |
| > *For example:*          |                                          |
|                           | -   *A door that is contact monitored    |
| -   *A door that is       |     > and fitted with automatic closing  |
|     > contact monitored   |     > or locking devices.*               |
|     > and fitted with     |                                          |
|     > automatic closing   | -   *An airlock entrance system.*        |
|     > or locking          |                                          |
|     > devices.*           |                                          |
|                           |                                          |
| -   *An airlock entrance  |                                          |
|     > system.*            |                                          |
+---------------------------+------------------------------------------+
| > **4D-4.21** An audible  | > **4D-4.21.a** Examine secure room      |
| > alarm must sound if the | > entry mechanisms to verify that an     |
| > entrance to the secure  | > audible alarm is configured to sound   |
| > room remains open for   | > if the entrance remains open for more  |
| > more than 30 seconds.   | > than 30 seconds.                       |
+---------------------------+------------------------------------------+
|                           | > **4D-4.21.b** Observe authorized       |
|                           | > personnel entering the secure room and |
|                           | > request the door is held open. Verify  |
|                           | > that an audible alarm sounds if the    |
|                           | > entrance remains open for more than 30 |
|                           | > seconds.                               |
+---------------------------+------------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark48            |                                         |
| .anchor}***Requirement 4E: |                                         |
| Component providers ONLY:  |                                         |
| report status to solution  |                                         |
| providers***               |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***4E-1 For component      |                                         |
| providers of               |                                         |
| decryption-management      |                                         |
| services, maintain and     |                                         |
| monitor critical P2PE      |                                         |
| controls and provide       |                                         |
| reporting to the           |                                         |
| responsible solution       |                                         |
| provider.***               |                                         |
+----------------------------+-----------------------------------------+
| ***Note:** This section is |                                         |
| ONLY applicable for P2PE   |                                         |
| component providers        |                                         |
| undergoing an assessment   |                                         |
| for subsequent PCI listing |                                         |
| of the component           |                                         |
| provider's                 |                                         |
| decryption-management      |                                         |
| services. This section is  |                                         |
| not applicable to, and     |                                         |
| does not need to be        |                                         |
| completed by, P2PE         |                                         |
| solution providers (or     |                                         |
| merchants as solution      |                                         |
| providers) that include    |                                         |
| decryption-management      |                                         |
| functions in their P2PE    |                                         |
| solution assessment        |                                         |
| (whether those functions   |                                         |
| are performed by the       |                                         |
| solution provider or are   |                                         |
| outsourced to non-PCI      |                                         |
| listed third parties).*    |                                         |
+----------------------------+-----------------------------------------+
| > **4E-1.1** Track status  | > **4E-1.1.a** Review component         |
| > of the                   | > provider's documented procedures for  |
| > decryption-management    | > providing required reporting to       |
| > service and provide      | > applicable solution providers, and    |
| > reports to solution      | > interview responsible component-      |
| > provider annually and    | > provider personnel, and to confirm    |
| > upon significant         | > that the following processes are      |
| > changes, including at    | > documented and implemented:           |
| > least the following:     |                                         |
|                            | -   Providing reports annually and upon |
| -   Types/models of HSMs   |     > significant changes               |
|                            |                                         |
| -   Number of HSMs         | -   Types/models of HSMs                |
|     > deployed and any     |                                         |
|     > change in numbers    | -   Number of HSMs deployed and         |
|     > since the last       |     > description of any changes since  |
|     > report               |     > last report                       |
|                            |                                         |
| -   Date of last physical  | -   Date of last physical inspection of |
|     > inspection of HSMs   |     > HSMs                              |
|                            |                                         |
| -   Date/status of last    | -   Date/status of last PCI DSS         |
|     > PCI DSS assessment   |     > assessment                        |
|                            |                                         |
| -   Details of any         | -   Details of any suspicious activity  |
|     > suspicious activity  |     > that occurred, per **4C-1.2**     |
|     > that occurred, per   |                                         |
|                            |                                         |
| > **4C-1.2**               |                                         |
+----------------------------+-----------------------------------------+
|                            | > **4E-1.1.b** Observe reports provided |
|                            | > to applicable solution providers      |
|                            | > annually and upon significant changes |
|                            | > to the solution, and confirm they     |
|                            | > include at least the following:       |
|                            |                                         |
|                            | -   Types/models of HSMs                |
|                            |                                         |
|                            | -   Number of HSMs deployed and         |
|                            |     > description of any changes since  |
|                            |     > last report                       |
|                            |                                         |
|                            | -   Date of last physical inspection of |
|                            |     > HSMs                              |
|                            |                                         |
|                            | -   Date/status of last PCI DSS         |
|                            |     > assessment                        |
|                            |                                         |
|                            | -   Details of any suspicious activity  |
|                            |     > that occurred, per **4C-1.2**     |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 4E:         |                                         |
| Component providers ONLY:  |                                         |
| report status to solution  |                                         |
| providers***               |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **4E-1.2** Manage and    | > **4E-1.2.a** Review component         |
| > monitor changes to       | > provider's documented procedures and  |
| > decryption- management   | > interview responsible                 |
| > services and notify the  | > component-provider personnel, and     |
| > solution provider upon   | > confirm that processes include        |
| > occurrence of any of the | > notifying the solution provider upon  |
| > following:               | > occurrence of the following:          |
|                            |                                         |
| -   Addition and/or        | -   Critical infrastructure changes,    |
|     > removal of HSM       |     > including to the PCI DSS          |
|     > types.               |     > environment                       |
|                            |                                         |
| -   Critical               | -   Changes to PCI DSS compliance       |
|     > infrastructure       |     > status                            |
|     > changes, including   |                                         |
|     > to the PCI DSS       | -   Additions and/or removal of HSM     |
|     > environment          |     > types                             |
|                            |                                         |
| -   Changes to PCI DSS     |                                         |
|     > compliance status    |                                         |
|                            |                                         |
| > ***Note:** Adding or     |                                         |
| > removing HSM types may   |                                         |
| > require adherence to PCI |                                         |
| > SSC's process for P2PE   |                                         |
| > Delta Changes. Please    |                                         |
| > refer to the P2PE        |                                         |
| > Program Guide for        |                                         |
| > details about            |                                         |
| > obligations when adding, |                                         |
| > changing, or removing    |                                         |
| > elements of a P2PE       |                                         |
| > solution.*               |                                         |
+----------------------------+-----------------------------------------+
|                            | > **4E-1.2.b** Observe reports provided |
|                            | > to applicable solution providers, and |
|                            | > confirm at least the following are    |
|                            | > reported upon occurrence:             |
|                            |                                         |
|                            | -   Critical infrastructure changes,    |
|                            |     > including to the PCI DSS          |
|                            |     > environment                       |
|                            |                                         |
|                            | -   Changes to PCI DSS compliance       |
|                            |     > status                            |
|                            |                                         |
|                            | -   Additions and/or removal of HSM     |
|                            |     > types.                            |
+----------------------------+-----------------------------------------+

# Domain 5: P2PE Cryptographic Key Operations and Device Management

+--------------+------------------+-----------------------------------+
| > **Domain** | > **Overview**   | > **P2PE Validation               |
|              |                  | > Requirements**                  |
+==============+==================+===================================+
| > **Domain   | Establish and    | **Control Objective 1** Account   |
| > 5:**       | administer key-  | data is processed using equipment |
| >            | management       | and                               |
| > **P2PE     | operations for   |                                   |
| > C          | account- data    | methodologies that ensure they    |
| ryptographic | encryption POI   | are kept secure.                  |
| > Key        | devices and      |                                   |
| > Operations | decryption HSMs. | **Control Objective 2**           |
| > and Device |                  | Account-data keys and             |
| >            |                  | key-management                    |
| Management** |                  |                                   |
|              |                  | > methodologies are created using |
|              |                  | > processes that ensure it is not |
|              |                  | > possible to predict any key or  |
|              |                  | > determine that certain keys are |
|              |                  | > more probable than other keys.  |
|              |                  |                                   |
|              |                  | **Control Objective 3** Keys are  |
|              |                  | conveyed or transmitted in a      |
|              |                  | secure                            |
|              |                  |                                   |
|              |                  | > manner.                         |
|              |                  |                                   |
|              |                  | **Control Objective 4** Key       |
|              |                  | loading is handled in a secure    |
|              |                  | manner.                           |
|              |                  |                                   |
|              |                  | **Control Objective 5** Keys are  |
|              |                  | used in a manner that prevents or |
|              |                  |                                   |
|              |                  | > detects their unauthorized      |
|              |                  | > usage.                          |
|              |                  |                                   |
|              |                  | **Control Objective 6** Keys are  |
|              |                  | administered in a secure manner.  |
|              |                  |                                   |
|              |                  | **Control Objective 7** Equipment |
|              |                  | used to process account data and  |
|              |                  |                                   |
|              |                  | > keys is managed in a secure     |
|              |                  | > manner.                         |
|              |                  |                                   |
|              |                  | **5A** Account data is processed  |
|              |                  | using algorithms and              |
|              |                  | methodologies that ensure they    |
|              |                  | are kept secure.                  |
|              |                  |                                   |
|              |                  | **5H** For hybrid decryption      |
|              |                  | solutions: Implement secure       |
|              |                  | hybrid-key management.            |
|              |                  |                                   |
|              |                  | **5I** Component providers        |
|              |                  | *ONLY*: report status to solution |
|              |                  | providers.                        |
+--------------+------------------+-----------------------------------+

> ***Target Audience:** P2PE solution providers or those who, on behalf
> of P2PE solution providers, manage cryptographic key operations for
> POI devices, HSMs, and SCDs.*

#### *Overview*

> Domain 5 covers the requirements for the use of strong cryptographic
> keys and secure key-management functions for all account-data
> encryption POI devices and decryption HSMs, including related
> key-management SCDs. Examples include POI devices, HSMs,
> key-injection/loading devices (KLDs) and signing devices.
> Implementation of these procedures is fundamental to the security of a
> P2PE solution. Domain 5 includes detailed key-management procedures
> including encryption methodologies, key generation, key distribution,
> key loading, key usage, key administration, equipment management, and
> hybrid decryption-key management (for hybrid decryption solutions
> only).
>
> These requirements apply to all methods of key management that are
> utilized by the P2PE solution, including both asymmetric and symmetric
> methods (examples of symmetric key-management methods include fixed
> key, DUKPT, and master key/session key). Whenever encryption is being
> utilized, some form of key management must be performed, and it is
> this key management that must be compliant to the requirements of this
> domain.
>
> Domain 5 requirements address secure cryptographic key-management
> operations for the encryption environment and the decryption
> environment, as well as environments performing symmetric-key
> distribution using asymmetric keys (remote key distribution),
> certification authority/registration authority and key-injection or
> key-generation.
>
> The requirements in this domain apply to all key types, including keys
> used to secure account data, any key-encrypting keys used to encrypt
> these keys, and any keys that have a direct bearing on the security of
> the P2PE solution (e.g., keys used to protect the integrity of a
> whitelist). If the solution uses a multi-tier "key hierarchy," all
> keys up to and including the top-level "master key" must be assessed
> to meet these requirements.
>
> Vendor-controlled secret and private keys used in connection with the
> following activities are also in scope:
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} When used in connection with
> vendor-operated PKIs used for remote key loading using asymmetric
> techniques. This applies specifically to the distribution of acquirer
> keys to transaction-originating devices (POIs) for use in connection
> with account-data encryption, whether the actual distribution of
> acquirer keys occurs from the transaction-processing host or is
> distributed directly by the vendor. This includes:

-   Root and Subordinate Certification Authority keys and keys used in
    > connection with associated Registration Authority activities

-   Device-specific key pairs used for that purpose

-   Keys associated with protection of the aforementioned keys during
    > storing, loading, and usage

-   The generation of the aforementioned keys

> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} When used in connection with KIF
> activities for loading and/or distribution of acquirer keys to
> transaction-originating devices (POIs) for use in connection with
> account-data encryption.
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} When used for the protection of account
> data when conveyed between non-integrated PCI-listed POI
> devices---e.g., an SCR and a PIN pad.
>
> Additionally, acquirer keys generated on behalf of the acquirer are in
> scope.

#### *Symmetric-Key Distribution using Asymmetric Techniques*

> Domain 5 also contains requirements that apply to remote
> key-establishment and distribution applications. Remote
> key-distribution schemes can be used for initial key loading
> only---i.e., establishment of a TDEA key hierarchy, such as a terminal
> master key. Standard symmetric-key- exchange mechanisms should be used
> for subsequent TMK, DEK, or other symmetric-key exchanges, except
> where a device requires a new key initialization due to unforeseen
> loss of the existing TMK. Using asymmetric techniques for routine key
> exchange can result in unnecessary exposure to man-in-the-middle
> attacks and should not be used. These requirements pertain to two
> distinct areas:

##### Remote Key-Distribution Using Asymmetric Techniques Operations:

> Characteristics of the actual key-distribution methodology
> implemented. These requirements apply to all entities implementing
> remote key- distribution using asymmetric techniques for the
> distribution of keys to POI devices for use in connection with
> account-data encryption. If the key loading is not performed remotely
> and authentication is provided by another method---such as properly
> implemented dual control and key-loading device(s)---even if these
> systems involve the use of certificates, the remote key-establishment
> and distribution applications requirements will not apply. "Remotely"
> means whenever the key-loading device and the POI device are neither
> co-located nor connected via a direct mechanism, such as a cable. This
> includes:

-   The distribution of symmetric keys using asymmetric techniques from
    > a key-distribution host (KDH) to many key-receiving devices
    > (KRDsi.e., POI devices); or

-   The exchange of keys between peers, where one is administratively
    > designated as the KDH and one as the KRD (e.g., the transaction
    > processing host).

> *ANSI TR-34* presents a methodology that is compliant with these
> requirements. TR34 describes a method for transporting a symmetric key
> from one SCD to another over an uncontrolled channel. A typical
> example usage of TR34 would be to load individual initial symmetric
> transport keys from a Key Distribution Host (KDH) to a population of
> PEDs. TR34 makes use of asymmetric cryptography to protect this key
> transport, which means that both the Key-Distribution Host, and the
> Key-Receiving Devices (e.g., PEDs), must have appropriate credentials
> in the form of certificates, public and private keys, and must have a
> common relationship with a Certificate Authority (CA). The CA can be
> an independent party from both the Key-Receiving Device (KRD) vendor
> and the KDH, or the KRD vendor can be the CA.

##### Certification and Registration Authority Operations:

> Operations of Certification and Registration Authority platforms used
> in connection with remote key-distribution implementations. These
> requirements apply only to the entities operating Certification and/or
> Registration Authorities.
>
> Certification Authority requirements apply to all entities (P2PE
> solution providers, P2PE component providers, and entities performing
> these functions on behalf of solution providers or component
> providers) signing public keys to be used for remote distribution of
> cryptographic keys, whether in X.509 certificate-based schemes or
> other designs, to allow for the required authentication of these
> signed public keys. For purposes of these requirements, a certificate
> is any digitally signed value containing a public key, where the term
> "digitally signed" refers to any cryptographic method used that
> enforces the integrity and authenticity of a block of data through the
> cryptographic processing of that block of data with a private key. The
> CA requirements apply only to methods that allow for the distribution
> and use of
>
> such signed public keys to multiple systems, and as such do not apply
> to systems that apply symmetric cryptography to keys for
> authentication (such as through the use of MACs).
>
> The Certification Authority requirements are not intended to be
> applied to devices that sign their own keys, nor to key-loading
> systems where the key loading is not performed remotely and
> authentication is provided by another method---such as properly
> implemented dual control and key-loading device(s)---even if these
> systems involve the use of certificates.
>
> Unless otherwise specified, the term Certification Authority (CA)
> refers to any CA in the hierarchy, Root or SubCa.

#### *Key-Injection Facilities*

> The term key-injection facility (KIF) describes those entities that
> perform key injection of POI devices used for account-data encryption
> and key injection of HSMs used for decryption. Key injection may be
> performed by the solution provider or by a third party such as a POI
> terminal manufacturer or vendor. Domain 5 contains requirements that
> apply to key-injection facilities, or other entities that are
> performing KIF-related services for others, such as key generation or
> key loading*.*
>
> Key-injection systems that allow clear-text secret and/or private keys
> and/or their components to appear in unprotected memory (e.g., within
> a computer and outside of the secure boundary of a secure
> cryptographic device) are inherently less secure. Any such systems are
> subject to additional controls as delineated in the criteria in this
> domain.

#### *Note for hybrid decryption environments:*

+------------------------------------------+---------------------------+
| Hybrid decryption environments require   | *Within this domain, the  |
| HSMs for cryptographic key-management    | term "Solution Provider"  |
| functions but allow for non-SCD Host     | refers to whichever       |
| Systems to be used for account-data      | entity is undergoing the  |
| decryption. Unlike a P2PE solution with  | P2PE assessment. This may |
| a hardware decryption environment (in    | be the solution provider, |
| which cryptographic key management and   | a component provider, or  |
| account-data decryption are performed    | the merchant as a         |
| entirely within a hardware security      | solution provider.*       |
| module, or HSM), a hybrid decryption     |                           |
| environment (which requires HSMs for     | *For merchant-managed     |
| cryptographic key-management functions)  | solutions, the term       |
| allows for the decryption of account     | "merchant" as used within |
| data outside of an HSM in non-SCDs on a  | Domains 1, 3, 4, and 5 of |
| Host System. These environments must     | this document refers to   |
| meet all requirements in Domains 4 and   | merchant personnel in the |
| 5, including the additional requirements | encryption environments,  |
| specified in section **5I** (as well as  | and represents            |
| those specified in Domain 4 in section   | requirements the merchant |
| **4D**). See ["P2PE Solutions and use of | as a solution provider is |
| Third Parties and/or P2PE                | responsible for meeting   |
| Com                                      | for, or on behalf of,     |
| ponent](#p2pe-solutions-and-use-of-third | those merchant encryption |
| -parties-andor-p2pe-component-providers) | environments.*            |
| [Prov                                    |                           |
| iders"](#p2pe-solutions-and-use-of-third |                           |
| -parties-andor-p2pe-component-providers) |                           |
| for more information about validating    |                           |
| this Domain as a solution provider,      |                           |
| key-management component provider, or    |                           |
| merchant as a solution provider.         |                           |
+==========================================+===========================+
+------------------------------------------+---------------------------+

> []{#_bookmark56 .anchor}***Definitions and Annex***
>
> For the purposes of this document:
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Secret Key = Symmetric key (also known
> as a shared secret key).
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Private Key = Asymmetric key used only
> for decryption operations or for creating digital signatures. No one
> private key should be used for both purposes (except for
> transaction-originating SCDs).
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Public Key = Asymmetric key used only
> for encryption operations or for verifying digital signatures. No one
> public key should be used for both purposes (except for
> transaction-originating SCDs). This annex provides the minimum and
> equivalent key sizes and strengths for the encryption of data and
> other cryptographic keys.

+---------------------------+------------------------------------------+
| []{#_bookmark57           |                                          |
| .anchor}***Control        |                                          |
| Objective 1: Account data |                                          |
| is processed using        |                                          |
| equipment and             |                                          |
| methodologies that ensure |                                          |
| they are kept secure***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 1:**     |                                          |
| > Account data is         |                                          |
| > processed in equipment  |                                          |
| > that conforms to        |                                          |
| > requirements for secure |                                          |
| > cryptographic devices   |                                          |
| > (SCDs). Account data    |                                          |
| > never appears in the    |                                          |
| > clear outside of an     |                                          |
| > SCD.*                   |                                          |
+---------------------------+------------------------------------------+
| > **1-1 *Not used in      |                                          |
| > P2PE***                 |                                          |
+---------------------------+------------------------------------------+
| > **1-2** Key-injection   | **1-2** Examine documented procedures    |
| > facilities must only    | and system documentation to verify that  |
| > inject keys into        | key- injection platforms and systems     |
| > equipment that conforms | used for managing cryptographic keys are |
| > to the requirements for | required to conform to the requirements  |
| > SCDs.                   | for SCDs.                                |
+---------------------------+------------------------------------------+
| **1-3** All hardware      | **1-3** For all HSM brands/models used,  |
| security modules (HSMs)   | examine approval documentation (e.g.,    |
| must be either:           | FIPS certification or PTS approval) and  |
|                           | examine the list of approved devices to  |
| -   *FIPS 140-2* or *FIPS | verify that all HSMs are either:         |
|     > 140-3* Level 3 or   |                                          |
|     > higher certified,   | -   Listed on the *NIST Cryptographic    |
|     > or                  |     > Module Validation Program* (CMVP)  |
|                           |     > list, with a valid listing number, |
| -   PCI approved          |     > and approved to *FIPS 140-2* or    |
|                           |     > *FIPS 140-3* Level 3, or higher.   |
| ***Note:** HSM approval   |     > Refer                              |
| listings must be          |     > [http:                             |
| currentHSMs must have a  | //csrc.nist.gov.](http://csrc.nist.gov/) |
| non-expired PCI PTS HSM   |                                          |
| approval or a non-        | -   Listed on the PCI SSC website, with  |
| expired FIPS 140-2 or     |     > a valid SSC listing number, as     |
| FIPS 140-3 certificate    |     > Approved PCI PTS Devices under the |
| (i.e., the FIPS 140 HSM   |     > approval class "HSM." Refer to     |
| certificates must not be  |                                          |
| listed as historical or   | > [https://www.pcisecuritystandards.org] |
| revoked).*                | (https://www.pcisecuritystandards.org/). |
|                           |                                          |
| ***Note:** PCI-approved   |                                          |
| HSMs may have their       |                                          |
| approvals restricted      |                                          |
| whereby the approval is   |                                          |
| valid only when the HSM   |                                          |
| is deployed in controlled |                                          |
| environments or more      |                                          |
| robust (e.g., secure)     |                                          |
| environments as defined   |                                          |
| in ISO 13491-2 and in the |                                          |
| device's PCI HSM Security |                                          |
| Policy. This information  |                                          |
| is noted in the           |                                          |
| Additional Information    |                                          |
| column of approved PTS    |                                          |
| devices.*                 |                                          |
|                           |                                          |
| ***Note:** Key-injection  |                                          |
| platforms and systems     |                                          |
| must include hardware     |                                          |
| devices for managing      |                                          |
| (e.g., generating and     |                                          |
| storing) the keys that    |                                          |
| conform to the            |                                          |
| requirements for SCDs.    |                                          |
| This includes SCDs used   |                                          |
| in key-injection          |                                          |
| facilities (e.g.,         |                                          |
| modified PEDs). A PED     |                                          |
| used for key injection    |                                          |
| must be validated and     |                                          |
| approved to the KLD       |                                          |
| approval class, or it     |                                          |
| must be managed in        |                                          |
| accordance with           |                                          |
| Requirement 13-9.*        |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 1:   |                                          |
| Account data is processed |                                          |
| using equipment and       |                                          |
| methodologies that ensure |                                          |
| they are kept secure***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **1-4** The approval      | **1-4.a** For all PCI-approved HSMs      |
| listing must match the    | used, examine HSM devices and examine    |
| deployed devices in the   | the *PCI SSC list of Approved PCI PTS    |
| following                 | Devices* to verify that all of the       |
| characteristics:          | following device characteristics match   |
|                           | the PCI PTS listing for each HSM:        |
| -   Vendor name           |                                          |
|                           | -   Vendor name                          |
| -   Model name and number |                                          |
|                           | -   Model name/number                    |
| -   Hardware version      |                                          |
|     > number              | -   Hardware version number              |
|                           |                                          |
| -   Firmware version      | -   Firmware version number              |
|     > number              |                                          |
|                           | -   The PCI PTS HSM number               |
| -   The PCI PTS HSM or    |                                          |
|     > *FIPS 140* Approval | -   Any applications, including          |
|     > Number              |     > application version number,        |
|                           |     > resident within the device which   |
| -   For PCI-approved      |     > were included in the PTS           |
|     > HSMs, any           |     > assessment                         |
|     > applications,       |                                          |
|     > including           | -   Review the PCI approval listing(s)   |
|     > application version |     > for any implementation-specific    |
|     > number, resident    |     > notes and if present, verify they  |
|     > within the device   |     > are accounted for.                 |
|     > which were included |                                          |
|     > in the PTS          |                                          |
|     > assessment          |                                          |
+---------------------------+------------------------------------------+
|                           | **1-4.b** For all FIPS-approved HSMs     |
|                           | used, examine HSM devices and review the |
|                           | *NIST Cryptographic Module Validation    |
|                           | Program* (CMVP) list to verify that all  |
|                           | of the following device characteristics  |
|                           | match the *FIPS 140-2* or *FIPS 140-3*   |
|                           | Level 3 (or higher) approval listing for |
|                           | each HSM:                                |
|                           |                                          |
|                           | -   Vendor name                          |
|                           |                                          |
|                           | -   Model name/number                    |
|                           |                                          |
|                           | -   Hardware version number              |
|                           |                                          |
|                           | -   Firmware version number              |
|                           |                                          |
|                           | -   The FIPS 140 Approval Number         |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 1:   |                                          |
| Account data is processed |                                          |
| using equipment and       |                                          |
| methodologies that ensure |                                          |
| they are kept secure***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **1-5** The documentation | **1-5.a** Interview relevant personnel   |
| should indicate how       | and examine documentation to verify that |
| personnel interaction and | procedures exist for maintaining         |
| inventory management of   | documentation that describes and/or      |
| KIF components are        | illustrates the architecture of the KIF. |
| integrated into the flow. |                                          |
| The KIF platform provider |                                          |
| must:                     |                                          |
|                           |                                          |
| -   Maintain current      |                                          |
|     > documentation that  |                                          |
|     > describes or        |                                          |
|     > illustrates the     |                                          |
|     > architecture of the |                                          |
|     > KIF, including all  |                                          |
|     > KIF functionality.  |                                          |
|                           |                                          |
| -   Maintain              |                                          |
|     > documentation       |                                          |
|     > detailing the flow  |                                          |
|     > of keys from the    |                                          |
|     > key generation,     |                                          |
|     > through the         |                                          |
|     > functionality to    |                                          |
|     > the destination     |                                          |
|     > device.             |                                          |
+---------------------------+------------------------------------------+
|                           | **1-5.b** Interview relevant personnel   |
|                           | and examine documentation that describes |
|                           | and/or illustrates the architecture of   |
|                           | the KIF to verify that all KIF           |
|                           | components, key-management flows, and    |
|                           | personnel interaction with               |
|                           | key-management flows are identified and  |
|                           | documented.                              |
+---------------------------+------------------------------------------+
|                           | **1-5.c** Examine the key-management     |
|                           | flows and interview personnel to verify: |
|                           |                                          |
|                           | -   Documentation shows all              |
|                           |     > key-management flows across        |
|                           |     > functions and networks from the    |
|                           |     > point the key is generated through |
|                           |     > to the point the key is injected   |
|                           |     > into the POI.                      |
|                           |                                          |
|                           | -   Documentation is kept current and    |
|                           |     > updated as needed upon changes to  |
|                           |     > the KIF architecture               |
+---------------------------+------------------------------------------+
| ***Note:** PIN            |                                          |
| requirements 2, 3, and 4  |                                          |
| are all PIN-specific and  |                                          |
| are therefore omitted     |                                          |
| from P2PE.*               |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| []{#_bookmark58           |                                          |
| .anchor}***Control        |                                          |
| Objective 2:              |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 5:** All |                                          |
| > keys, key components,   |                                          |
| > and key shares are      |                                          |
| > generated using an      |                                          |
| > approved random or      |                                          |
| > pseudo-random           |                                          |
| > function.*              |                                          |
+---------------------------+------------------------------------------+
| 1.  Keys must be          | **5-1.a** Examine key-management policy  |
|     generated so that it  | documentation to verify that it requires |
|     is not feasible to    | that all devices used to generate        |
|     determine that        | cryptographic keys meet one of the       |
|     certain keys are more | following:                               |
|     probable than other   |                                          |
|     keys from the set of  | -   An approved key-generation function  |
|     all possible keys.    |     > of a PCI-approved HSM or POI       |
|     Generation of         |     > device                             |
|     cryptographic keys or |                                          |
|     key components must   | -   An approved key-generation function  |
|     occur within an SCD.  |     > of a *FIPS 140-2 or FIPS 140-3*    |
|     They must be          |     > Level 3 (or higher) HSM            |
|     generated by one of   |                                          |
|     the following:        | -   An SCD that has an approved random   |
|                           |     > number generator that has been     |
|     -   An approved       |     > certified by an independent        |
|         > key-generation  |     > qualified laboratory according to  |
|         > function of a   |     > *NIST SP 800-22*.                  |
|         > PCI- approved   |                                          |
|         > HSM or POI      |                                          |
|         > device          |                                          |
|                           |                                          |
|     -   An approved       |                                          |
|         > key-generation  |                                          |
|         > function of a   |                                          |
|         > *FIPS 140-2 or  |                                          |
|         > FIPS 140-3*     |                                          |
|         > Level 3 (or     |                                          |
|         > higher) HSM     |                                          |
|                           |                                          |
|     -   An SCD that has   |                                          |
|         > an approved     |                                          |
|         > random number   |                                          |
|         > generator that  |                                          |
|         > has been        |                                          |
|         > certified by an |                                          |
|         > independent     |                                          |
|         > laboratory to   |                                          |
|         > comply with     |                                          |
|         > *NIST SP800-22* |                                          |
|                           |                                          |
| > ***Note:** Random       |                                          |
| > number generation is    |                                          |
| > critical to the         |                                          |
| > security and integrity  |                                          |
| > of all cryptographic    |                                          |
| > systems. All            |                                          |
| > cryptographic key       |                                          |
| > generation relies upon  |                                          |
| > good quality, randomly  |                                          |
| > generated values.*      |                                          |
+---------------------------+------------------------------------------+
|                           | **5-1.b** Examine certification letters  |
|                           | or technical documentation to verify     |
|                           | that all devices used to generate        |
|                           | cryptographic keys or key components     |
|                           | meet one of the following:               |
|                           |                                          |
|                           | -   An approved key-generation function  |
|                           |     > of a PCI--approved HSM or POI      |
|                           |     > device                             |
|                           |                                          |
|                           | -   An approved key-generation function  |
|                           |     > of a *FIPS 140-2 or FIPS 140-3*    |
|                           |     > Level 3 (or higher) HSM            |
|                           |                                          |
|                           | -   An SCD that has an approved random   |
|                           |     > number generator that has been     |
|                           |     > certified by an independent        |
|                           |     > qualified laboratory according to  |
|                           |     > *NIST SP 800-22*                   |
+---------------------------+------------------------------------------+
|                           | **5-1.c** Examine procedures to be used  |
|                           | for future generations and logs of past  |
|                           | key generation to verify devices used    |
|                           | for key-generation are those as noted    |
|                           | above, including validation of firmware  |
|                           | used.                                    |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 6:**     |                                          |
| > Compromise of the       |                                          |
| > key-generation process  |                                          |
| > must not be possible    |                                          |
| > without collusion       |                                          |
| > between at least two    |                                          |
| > trusted individuals.*   |                                          |
+---------------------------+------------------------------------------+
| **6-1** Implement         | **6-1** Perform the following:           |
| security controls,        |                                          |
| including dual control    |                                          |
| and tamper detection, to  |                                          |
| prevent the unauthorized  |                                          |
| disclosure of keys or key |                                          |
| components.               |                                          |
+---------------------------+------------------------------------------+
| > **6-1.1** Any           | > **6-1.1.a** Examine documented         |
| > clear-text output of    | > procedures to verify the following.    |
| > the key-generation      |                                          |
| > process must be managed | -   Any key-generation process with      |
| > under dual control.     |     > clear-text output is performed     |
| > Only the assigned       |     > under dual control                 |
| > custodian can have      |                                          |
| > direct access to the    | -   Any output of a clear-text component |
| > clear-text of any key   |     > or share is overseen by only the   |
| > component/share. Each   |     > assigned key custodian(s) for that |
| > custodian's access to   |     > component/share                    |
| > clear- text output is   |                                          |
| > limited to the          | -   Each custodian's access to           |
| > individual              |     > clear-text output is limited to    |
| > component(s)/share(s)   |     > the individual                     |
| > assigned to that        |     > component(s)/share(s) assigned to  |
| > custodian, and not the  |     > that custodian, and not the entire |
| > entire key.             |     > key.                               |
+---------------------------+------------------------------------------+
|                           | > **6-1.1.b** Observe key-generation     |
|                           | > process demonstration and interview    |
|                           | > responsible personnel to verify:       |
|                           |                                          |
|                           | -   Any key-generation process with      |
|                           |     > clear-text output is performed     |
|                           |     > under dual control.                |
|                           |                                          |
|                           | -   Any output of clear-text component   |
|                           |     > or share is overseen by only the   |
|                           |     > assigned key custodian(s) for the  |
|                           |     > component/share.                   |
|                           |                                          |
|                           | -   Each custodian's access to           |
|                           |     > clear-text output is limited to    |
|                           |     > the individual                     |
|                           |     > component(s)/share(s) assigned to  |
|                           |     > that custodian and not the entire  |
|                           |     > key.                               |
+---------------------------+------------------------------------------+
| > **6-1.2** There must be | > **6-1.2.a** Examine documented         |
| > no point in the         | > procedures for all key-generation      |
| > key-generation process  | > methods and observe demonstrations of  |
| > where a single          | > the key-generation process from        |
| > individual has the      | > end-to-end to verify there is no point |
| > ability to determine,   | > in the process where a single person   |
| > obtain, or ascertain    | > has the ability to determine, obtain,  |
| > any part of a           | > or ascertain any part of a clear-text  |
| > clear-text key or all   | > key or all the components for a key.   |
| > the components for a    |                                          |
| > key.                    |                                          |
| >                         |                                          |
| > ***Note:** Key shares   |                                          |
| > derived using a         |                                          |
| > recognized secret-      |                                          |
| > sharing algorithm or    |                                          |
| > full-length key         |                                          |
| > components are not      |                                          |
| > considered key parts    |                                          |
| > and do not provide any  |                                          |
| > information regarding   |                                          |
| > the actual              |                                          |
| > cryptographic key.*     |                                          |
+---------------------------+------------------------------------------+
|                           | > **6-1.2.b** Examine key-generation     |
|                           | > logs to verify that:                   |
|                           |                                          |
|                           | -   The documented procedures were       |
|                           |     > followed, and                      |
|                           |                                          |
|                           | -   At least two individuals performed   |
|                           |     > the key-generation processes.      |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **6-1.3** Devices used  | > **6-1.3** Examine documented           |
| > for the generation of   | > procedures for all key-generation      |
| > clear-text key          | > methods. Verify procedures require     |
| > components that are     | > that:                                  |
| > output in the clear     |                                          |
| > must either be powered  | -   Key-generation devices that generate |
| > off when not in use or  |     > clear-text key components are      |
| > require                 |     > powered off when not in use or     |
| > re-authentication       |     > require re-authentication whenever |
| > whenever key generation |     > key generation is invoked; or      |
| > is invoked.             |                                          |
| >                         | -   If the device used for key           |
| > Logically partitioned   |     > generation is logically            |
| > devices used            |     > partitioned for concurrent use in  |
| > concurrently for other  |     > other processes, the               |
| > processes---e.g.,       |     > key-generation capabilities are    |
| > providing services      |     > enabled for execution of the       |
| > simultaneously to host  |     > procedure and disabled when the    |
| > systems, such as for    |     > procedure is complete.             |
| > transaction             |                                          |
| > processing---must have  |                                          |
| > key-generation          |                                          |
| > capabilities disabled   |                                          |
| > when not in use and     |                                          |
| > other activities are    |                                          |
| > continuing.             |                                          |
+---------------------------+------------------------------------------+
| > **6-1.4**               | > **6-1.4.a** Examine documented         |
| > Key-generation          | > procedures for all key-generation      |
| > equipment used for      | > methods to verify they include         |
| > generation of           | > inspections of the key-generation      |
| > clear-text key          | > equipment for evidence of tampering    |
| > components must not     | > prior to use. Verify procedures        |
| > show any signs of       | > include a validation step to ensure no |
| > tampering (e.g.,        | > unauthorized mechanism exists that     |
| > unknown cables) and     | > might disclose a clear-text key or key |
| > must be inspected prior | > component (e.g., a tapping device).    |
| > to the initialization   |                                          |
| > of key-generation       |                                          |
| > activities.             |                                          |
| >                         |                                          |
| > Ensure there isn't any  |                                          |
| > mechanism that might    |                                          |
| > disclose a clear-text   |                                          |
| > key or key component    |                                          |
| > (e.g., a tapping        |                                          |
| > device) between the     |                                          |
| > key-generation device   |                                          |
| > and the device or       |                                          |
| > medium receiving the    |                                          |
| > key or key component.   |                                          |
| >                         |                                          |
| > ***Note:** This does    |                                          |
| > not apply to logically  |                                          |
| > partitioned devices     |                                          |
| > located in data centers |                                          |
| > that are concurrently   |                                          |
| > used for other          |                                          |
| > purposes, such as       |                                          |
| > transaction             |                                          |
| > processing.*            |                                          |
+---------------------------+------------------------------------------+
|                           | > **6-1.4.b** Observe key-generation     |
|                           | > set-up processes for all key types to  |
|                           | > verify that key- generation equipment  |
|                           | > is inspected prior to use, to ensure   |
|                           | > equipment does not show any signs of   |
|                           | > tampering. Verify procedures include a |
|                           | > validation step to ensure no           |
|                           | > unauthorized mechanism exists that     |
|                           | > might disclose a clear-text key or key |
|                           | > component (e.g., a tapping device).    |
+---------------------------+------------------------------------------+
| > **6-1.5** Physical      | > **6-1.5.a** Examine documentation to   |
| > security controls must  | > verify that physical security controls |
| > be used to prevent      | > (e.g., partitions or barriers) are     |
| > unauthorized personnel  | > defined to ensure the key component    |
| > from accessing the area | > cannot be observed or accessed by      |
| > during key-generation   | > unauthorized personnel.                |
| > processes where         |                                          |
| > clear-text keying       |                                          |
| > material is in use. It  |                                          |
| > must not be feasible to |                                          |
| > observe any clear-text  |                                          |
| > keying material either  |                                          |
| > directly or via camera  |                                          |
| > monitoring.             |                                          |
+---------------------------+------------------------------------------+
|                           | > **6-1.5.b** During the demonstration   |
|                           | > for 6-1.1.b, observe the physical      |
|                           | > security controls (e.g., partitions or |
|                           | > barriers) used, and validate that they |
|                           | > ensure the key-generation process      |
|                           | > cannot be observed or accessed by      |
|                           | > unauthorized personnel directory or    |
|                           | > via camera monitoring (including those |
|                           | > on cellular devices).                  |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **6-2** Multi-use/purpose | **6-2.a** Examine documented procedures  |
| computing systems must    | to verify that multi-purpose computing   |
| not be used for key       | systems are not permitted for key        |
| generation where any      | generation where any clear-text secret   |
| clear-text secret key or  | or private key or component thereof      |
| private key, or key       | appears in memory outside the            |
| component thereof,        | tamper-protected boundary of an SCD.     |
| appears in memory outside |                                          |
| the tamper-protected      |                                          |
| boundary of an SCD.       |                                          |
|                           |                                          |
| *For example, it is not   |                                          |
| permitted for the         |                                          |
| cryptographic key to be   |                                          |
| passed through the memory |                                          |
| of a computer unless it   |                                          |
| has been specifically     |                                          |
| tasked for the sole       |                                          |
| purpose of key            |                                          |
| generation/loading.       |                                          |
| Computers that have been  |                                          |
| specifically purposed and |                                          |
| used solely for key       |                                          |
| generation/loading are    |                                          |
| permitted for use if all  |                                          |
| other requirements can be |                                          |
| met, including those of   |                                          |
| **Requirement 5** and the |                                          |
| controls defined in       |                                          |
| **Requirement 13**.*      |                                          |
|                           |                                          |
| *Additionally, this       |                                          |
| requirement excludes from |                                          |
| its scope computers used  |                                          |
| only for administration   |                                          |
| of SCDs, or key-          |                                          |
| generation devices that   |                                          |
| do not have the ability   |                                          |
| to access clear-text      |                                          |
| cryptographic keys or     |                                          |
| components.*              |                                          |
|                           |                                          |
| *Single-purpose computers |                                          |
| with an installed SCD or  |                                          |
| a modified PED where      |                                          |
| clear keying material is  |                                          |
| injected directly from a  |                                          |
| secure port on the        |                                          |
| key-generating SCD to the |                                          |
| target (e.g., a POI       |                                          |
| device) meet this         |                                          |
| requirement.*             |                                          |
|                           |                                          |
| *Where the components     |                                          |
| pass through memory of    |                                          |
| the PC,*                  |                                          |
|                           |                                          |
| ***Requirement 13** must  |                                          |
| be met.*                  |                                          |
|                           |                                          |
| *SCDs used for key        |                                          |
| generation must meet      |                                          |
| **Requirement 5-1.***     |                                          |
|                           |                                          |
| ***Note:** See            |                                          |
| **Requirement 5** and     |                                          |
| **Requirement 13 ***      |                                          |
+---------------------------+------------------------------------------+
|                           | **6-2.b** Observe the generation process |
|                           | and examine documentation for each type  |
|                           | of key to verify that multi-purpose      |
|                           | computing systems are not used for key   |
|                           | generation where any clear-text secret   |
|                           | or private key or component thereof      |
|                           | appears in memory outside the            |
|                           | tamper-protected boundary of an SCD      |
|                           | except where Requirement 5 and           |
|                           | Requirement 13 are met.                  |
+---------------------------+------------------------------------------+
|                           | **6-2.c** Where single-purpose computers |
|                           | with an installed SCD or a modified PED  |
|                           | are used, verify that either:            |
|                           |                                          |
|                           | -   Clear keying material is injected    |
|                           |     > directly from a secure port on the |
|                           |     > SCD to the target (e.g., a POI     |
|                           |     > device), or                        |
|                           |                                          |
|                           | -   Where clear keying material passes   |
|                           |     > through memory of the PC, the PC   |
|                           |     > requirements of **Requirement 13** |
|                           |     > are met.                           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **6-3** Printed key       | **6-3.a** Examine documented procedures  |
| components must be        | for printed key components and verify    |
| printed within blind      | that they require printed key components |
| mailers or sealed in      | to be printed within blind mailers or    |
| tamper-evident and        | sealed in tamper- evident and            |
| authenticable packaging   | authenticable packaging immediately      |
| immediately after         | after printing such that:                |
| printing or transcription |                                          |
| to ensure that:           | -   Only approved key custodians can     |
|                           |     > observe the key component.         |
| -   Only approved key     |                                          |
|     > custodians can      | -   Tampering can be visually detected.  |
|     > observe the key     |                                          |
|     > component.          |                                          |
|                           |                                          |
| -   Tampering can be      |                                          |
|     > visually detected.  |                                          |
|                           |                                          |
| Printers used for this    |                                          |
| purpose must not be used  |                                          |
| for other purposes, must  |                                          |
| not be networked (i.e.,   |                                          |
| locally connected only),  |                                          |
| and must be managed under |                                          |
| dual control. Location    |                                          |
| must be a secure room     |                                          |
| that meets the following  |                                          |
| requirements:             |                                          |
|                           |                                          |
| **Note:** Printed key     |                                          |
| components includes       |                                          |
| manual (handwritten)      |                                          |
| capture.                  |                                          |
+---------------------------+------------------------------------------+
|                           | **6-3.b** Observe blind mailers,         |
|                           | tamper-evident and authenticable         |
|                           | packaging, or other sealed containers    |
|                           | used for key components to verify that   |
|                           | components cannot be read from within    |
|                           | and that tampering can be visually       |
|                           | detected.                                |
+---------------------------+------------------------------------------+
|                           | **6-3.c** Observe processes for printing |
|                           | key components to verify that:           |
|                           |                                          |
|                           | -   Key components are printed within    |
|                           |     > blind mailers or sealed in         |
|                           |     > tamper-evident and authenticable   |
|                           |     > packaging (that is able to be      |
|                           |     > authenticated) immediately after   |
|                           |     > printing, such that no one but the |
|                           |     > authorized custodian ever has      |
|                           |     > physical access to the output;     |
|                           |                                          |
|                           | -   Printers are not networked; and      |
|                           |                                          |
|                           | -   Printers used for this purpose are   |
|                           |     > not used for other purposes and    |
|                           |     > are used only under dual control.  |
+---------------------------+------------------------------------------+
| > **6-3.1** The room must | **6-3.1** Inspect the secure room        |
| > have walls made of      | designated for printing clear-text key   |
| > solid materials. The    | components to verify that the walls are  |
| > walls do not have to    | made of solid materials and extend from  |
| > extend from true floor  | floor to ceiling.                        |
| > to true ceiling but do  |                                          |
| > need to extend from     |                                          |
| > floor to ceiling.       |                                          |
+---------------------------+------------------------------------------+
| > **6-3.2** Any windows   | **6-3.2.a** Observe all windows in the   |
| > into the secure room    | secure room to verify they are:          |
| > must be:                |                                          |
|                           | -   Locked and protected by alarmed      |
| -   Locked and protected  |     > sensors.                           |
|     > by alarmed sensors. |                                          |
|                           | -   Covered, rendered opaque, or         |
| -   Covered, rendered     |     > positioned to prevent unauthorized |
|     > opaque, or          |     > observation of the secure room.    |
|     > positioned to       |                                          |
|     > prevent             |                                          |
|     > unauthorized        |                                          |
|     > observation of the  |                                          |
|     > secure room.        |                                          |
+---------------------------+------------------------------------------+
|                           | **6-3.2.b** Examine configuration of     |
|                           | window sensors to verify that the alarm  |
|                           | mechanism is active.                     |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **6-3.3** An electronic | **6-3.3.a** Observe authorized personnel |
| > access control system   | entering the secure room to verify that  |
| > (for example, badge     | a badge- control system is in place that |
| > and/or biometrics) must | enforces the following requirements:     |
| > be in place that:       |                                          |
|                           | -   Dual access for entry to the secure  |
| -   Enforces dual-access  |     > room                               |
|     > requirements for    |                                          |
|     > entry into the      | -   Anti-pass-back                       |
|     > secure room, and    |                                          |
|     > anti-pass-back      |                                          |
|     > requirements.       |                                          |
|                           |                                          |
| -   Supports generation   |                                          |
|     > of an alarm when    |                                          |
|     > one person remains  |                                          |
|     > alone in the secure |                                          |
|     > room for more than  |                                          |
|     > 30 seconds.         |                                          |
+---------------------------+------------------------------------------+
|                           | **6-3.3.b** Examine alarm mechanisms and |
|                           | interview alarm-response personnel to    |
|                           | verify that the badge-control system     |
|                           | supports generation of an alarm when one |
|                           | person remains alone in the secure room  |
|                           | for more than 30 seconds.                |
+---------------------------+------------------------------------------+
| > **6-3.4** CCTV cameras  | **6-3.4** Inspect CCTV configuration and |
| > must record all         | examine a sample of recordings to verify |
| > activity, including     | that CCTV monitoring includes the        |
| > recording events during | ability to record events during dark     |
| > dark periods through    | periods, and verify that, if             |
| > the use of infrared     | motion-activated, recording continues    |
| > CCTV cameras or         | for at least a minute after the last     |
| > automatic activation of | pixel of activity subsides.              |
| > floodlights in case of  |                                          |
| > any detected activity.  |                                          |
| > This recording may be   |                                          |
| > motion-activated, in    |                                          |
| > which case the          |                                          |
| > recording must continue |                                          |
| > for at least a minute   |                                          |
| > after the last pixel of |                                          |
| > activity subsides.      |                                          |
+---------------------------+------------------------------------------+
| > **6-3.5** Monitoring    | **6-3.5** Inspect configuration of       |
| > must be supported on a  | monitoring systems and interview         |
| > continuous (24/7) basis | monitoring personnel to verify that      |
| > such that alarms can be | monitoring is supported on a continuous  |
| > resolved by authorized  | (24/7) basis and alarms can be resolved  |
| > personnel.              | by authorized personnel.                 |
+---------------------------+------------------------------------------+
| > **6-3.6** The CCTV      | **6-3.6.a** Inspect location of the CCTV |
| > server and digital      | server and digital storage to verify     |
| > storage must be secured | they are located in a secure location    |
| > in a separate secure    | that is separate from the secure room.   |
| > location that is not    |                                          |
| > accessible to personnel |                                          |
| > who have access to the  |                                          |
| > secure room.            |                                          |
+---------------------------+------------------------------------------+
|                           | **6-3.6.b** Inspect access-control       |
|                           | configurations for the CCTV              |
|                           | server/storage secure location and the   |
|                           | key-injection secure room to identify    |
|                           | all personnel who have access to each    |
|                           | area. Compare access lists to verify     |
|                           | that personnel with access to the secure |
|                           | room do not have access to the CCTV      |
|                           | server/storage secure location.          |
+---------------------------+------------------------------------------+
| > **6-3.7** The CCTV      | **6-3.7** Inspect CCTV positioning and   |
| > cameras must be         | examine a sample of recordings to verify |
| > positioned to monitor:  | that CCTV cameras are positioned to      |
|                           | monitor:                                 |
| -   The entrance door,    |                                          |
|                           | -   The entrance door,                   |
| -   Any safes that are    |                                          |
|     > present, and        | -   Any safes that are present, and      |
|                           |                                          |
| -   Any equipment that is | -   Any equipment that is used.          |
|     > used.               |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **6-3.8** CCTV cameras  | > **6-3.8** Inspect CCTV positioning and |
| > must be positioned so   | > examine a sample of recordings to      |
| > they do not monitor any | > verify that CCTV cameras do not        |
| > combination locks, PIN  | > monitor any combination locks, PIN     |
| > pads, or keyboards used | > pads, or keyboards used to enter       |
| > to enter                | > passwords/authentication codes or      |
| >                         | > other authentication credentials.      |
|  passwords/authentication |                                          |
| > codes or other          |                                          |
| > authentication          |                                          |
| > credentials.            |                                          |
+---------------------------+------------------------------------------+
| > **6-3.9** Images        | **6-3.9.a** If digital-recording         |
| > recorded from the CCTV  | mechanisms are used, examine system      |
| > system must be securely | configurations to verify that the        |
| > archived for a period   | systems have sufficient redundancy to    |
| > of no less than 45      | prevent the loss of information          |
| > days. If                | necessary to reconstruct events for the  |
| > digital-recording       | most recent 45-day period.               |
| > mechanisms are used,    |                                          |
| > they must have          |                                          |
| > sufficient storage      |                                          |
| > capacity and redundancy |                                          |
| > to prevent the loss of  |                                          |
| > information necessary   |                                          |
| > to reconstruct events   |                                          |
| > for the most recent     |                                          |
| > 45-day period.          |                                          |
+---------------------------+------------------------------------------+
|                           | **6-3.9.b** Examine storage of captured  |
|                           | recordings to verify that at least the   |
|                           | most recent 45 days of images are        |
|                           | securely archived.                       |
+---------------------------+------------------------------------------+
| **6-4** Any residue that  | **6-4.a** Examine documented procedures  |
| may contain clear-text    | to identify all locations where key      |
| keys or components must   | residue may exist. Verify procedures     |
| be destroyed or securely  | ensure the following:                    |
| deleted--- depending on   |                                          |
| media---immediately after | -   Any residue that may contain         |
| generation of that key to |     > clear-text keys or components is   |
| prevent disclosure of a   |     > destroyed or securely deleted      |
| key or the disclosure of  |     > immediately after generation.      |
| a key component to an     |                                          |
| unauthorized individual.  | -   Specific direction as to the method  |
|                           |     > of destruction is included in the  |
| > *Examples of where such |     > procedure.                         |
| > key residue may exist   |                                          |
| > include (but are not    | -   If a key is generated in a separate  |
| > limited to):*           |     > device before being exported into  |
|                           |     > the end-use device, confirm that   |
| -   *Printing material,   |     > the key and all related critical   |
|     including ribbons and |     > security parameters (e.g., secret  |
|     paper waste*          |     > seeds) are deleted (zeroized) from |
|                           |     > the generation and/or injection    |
| -   *Memory storage of a  |     > device immediately after the       |
|     key-loading device,   |     > transfer to the device(s) that     |
|     after loading the key |     > will use the key.                  |
|     to a different device |                                          |
|     or system*            | > Examine logs of past destructions and  |
|                           | > deletions to verify that procedures    |
| -   *Other types of       | > are followed.                          |
|     displaying or         |                                          |
|     recording (e.g.,      |                                          |
|     printer memory,       |                                          |
|     printer drum).*       |                                          |
+---------------------------+------------------------------------------+
|                           | **6-4.b** Observe the destruction        |
|                           | process of each identified type of key   |
|                           | residue and verify the following:        |
|                           |                                          |
|                           | -   Any residue that may contain         |
|                           |     > clear-text keys or components is   |
|                           |     > destroyed or securely deleted      |
|                           |     > immediately after generation.      |
|                           |                                          |
|                           | -   The method of destruction is         |
|                           |     > consistent with Requirement 24.    |
|                           |                                          |
|                           | -   If a key is generated in a separate  |
|                           |     > device before being exported into  |
|                           |     > the end-use device, confirm that   |
|                           |     > the key and all related critical   |
|                           |     > security parameters (e.g., secret  |
|                           |     > seeds) are deleted (zeroized) from |
|                           |     > the generation and/or injection    |
|                           |     > device immediately after the       |
|                           |     > transfer to the device(s) that     |
|                           |     > will use the key.                  |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **6-5** Asymmetric-key    | **6-5.a** Examine documented procedures  |
| pairs must either be:     | for asymmetric-key generation to confirm |
|                           | that procedures are defined to ensure    |
| -   Generated by the      | that asymmetric-key pairs are either:    |
|     > device that will    |                                          |
|     > use the key pair;   | -   Generated by the device that will    |
|     > or                  |     > use the key pair, or               |
|                           |                                          |
| -   If generated          | -   If generated externally, the key     |
|     > externally, the key |     > pair and all related critical      |
|     > pair and all        |     > security parameters are deleted    |
|     > related critical    |     > (zeroized) immediately after the   |
|     > security parameters |     > transfer to the device that will   |
|     > (e.g., secret       |     > use the key pair.                  |
|     > seeds) must be      |                                          |
|     > deleted (zeroized)  |                                          |
|     > immediately after   |                                          |
|     > the transfer to the |                                          |
|     > device that will    |                                          |
|     > use the key pair.   |                                          |
+---------------------------+------------------------------------------+
|                           | **6-5.b** Observe key-generation         |
|                           | processes to verify that asymmetric-key  |
|                           | pairs are either:                        |
|                           |                                          |
|                           | -   Generated by the device that will    |
|                           |     > use the key pair, or               |
|                           |                                          |
|                           | -   If generated externally, the key     |
|                           |     > pair and all related critical      |
|                           |     > security parameters are deleted    |
|                           |     > (e.g., zeroized) immediately after |
|                           |     > the transfer to the device that    |
|                           |     > will use the key pair.             |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **6-6** Policy and        | **6-6.a** Examine documented policy and  |
| procedures must exist to  | procedures to verify that they include   |
| ensure that clear- text   | language that prohibits transmitting     |
| private or secret keys or | clear-text private or secret keys or     |
| their components/shares   | their components/shares across insecure  |
| are not transmitted       | channels, including but not limited to:  |
| across insecure channels. |                                          |
| Preclusions include but   | -   Dictating verbally keys or           |
| are not limited to:       |     > components                         |
|                           |                                          |
| -   Dictating verbally    | -   Recording key or component values on |
|     > keys or components  |     > voicemail                          |
|                           |                                          |
| -   Recording key or      | -   Faxing, e-mailing, or otherwise      |
|     > component values on |     > electronically conveying           |
|     > voicemail           |     > clear-text keys or components      |
|                           |                                          |
| -   Faxing, e-mailing, or | -   Conveying clear-text private key     |
|     > otherwise           |     > shares or secret key               |
|     > electronically      |     > components/shares without          |
|     > conveying           |     > containing them within             |
|     > clear-text private  |     > tamper-evident and authenticable   |
|     > or secret keys or   |     > packaging                          |
|     > components          |                                          |
|                           | -   Writing key or component values into |
| -   Conveying clear-text  |     > startup instructions               |
|     > private key shares  |                                          |
|     > or secret key       | -   Affixing key or component values to  |
|     > components/shares   |     > or inside devices                  |
|     > without containing  |                                          |
|     > them within         | -   Writing key or component values in   |
|     > tamper-evident and  |     > procedure manual                   |
|     > authenticable       |                                          |
|     > packaging           |                                          |
|                           |                                          |
| -   Writing key or        |                                          |
|     > component values    |                                          |
|     > into startup        |                                          |
|     > instructions        |                                          |
|                           |                                          |
| -   Affixing (e.g.,       |                                          |
|     > taping) key or      |                                          |
|     > component values to |                                          |
|     > or inside devices   |                                          |
|                           |                                          |
| -   Writing key or        |                                          |
|     > component values in |                                          |
|     > procedure manuals   |                                          |
+---------------------------+------------------------------------------+
|                           | **6-6.b** From observation of            |
|                           | key-management processes verify that     |
|                           | clear-text private or secret keys or     |
|                           | their components are not transmitted     |
|                           | across insecure channels, including but  |
|                           | not limited to:                          |
|                           |                                          |
|                           | -   Dictating verbally keys or           |
|                           |     > components                         |
|                           |                                          |
|                           | -   Recording key or component values on |
|                           |     > voicemail                          |
|                           |                                          |
|                           | -   Faxing, e-mailing, or otherwise      |
|                           |     > electronically conveying           |
|                           |     > clear-text keys or components      |
|                           |                                          |
|                           | -   Conveying clear-text private or      |
|                           |     > secret key components without      |
|                           |     > containing them within             |
|                           |     > tamper-evident, authenticable      |
|                           |     > packaging                          |
|                           |                                          |
|                           | -   Writing key or component values into |
|                           |     > startup instructions               |
|                           |                                          |
|                           | -   Affixing key or component values to  |
|                           |     > or inside devices                  |
|                           |                                          |
|                           | -   Writing key or component values in   |
|                           |     > procedure manual                   |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 2:   |                                          |
| Cryptographic keys used   |                                          |
| for account-data          |                                          |
| encryption/decryption and |                                          |
| related key management    |                                          |
| are created using         |                                          |
| processes that ensure it  |                                          |
| is not possible to        |                                          |
| predict any key or        |                                          |
| determine that certain    |                                          |
| keys are more probable    |                                          |
| than other keys***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 7:**     |                                          |
| > Documented procedures   |                                          |
| > must exist and must be  |                                          |
| > demonstrably in use for |                                          |
| > all key-generation      |                                          |
| > processes.*             |                                          |
+---------------------------+------------------------------------------+
| **7-1** Written           | **7-1.a** Examine documented             |
| key-generation policies   | key-generation procedures to confirm     |
| and procedures must       | that they include all aspects of         |
| exist, and all affected   | key-generation operations and address    |
| parties (key custodians,  | all keys in scope.                       |
| supervisory staff,        |                                          |
| technical management,     |                                          |
| etc.) must be aware of    |                                          |
| these procedures.         |                                          |
| Procedures for creating   |                                          |
| all keys must be          |                                          |
| documented.               |                                          |
+---------------------------+------------------------------------------+
|                           | **7-1.b** Interview those responsible    |
|                           | for the key-generation processes         |
|                           | (including key custodians, supervisory   |
|                           | staff, technical management, etc.) to    |
|                           | verify that the documented procedures    |
|                           | are known and understood by all affected |
|                           | parties.                                 |
+---------------------------+------------------------------------------+
|                           | **7-1.c** Observe key-generation         |
|                           | ceremonies, whether actual or for        |
|                           | demonstration purposes, and verify that  |
|                           | the documented procedures are            |
|                           | demonstrably in use.                     |
+---------------------------+------------------------------------------+
| **7-2** Logs must exist   | **7-2.a** Examine documented             |
| for the generation of     | key-generation procedures to verify that |
| higher-level keys, such   | key-generation events for higher-level   |
| as KEKs exchanged with    | keys (e.g., KEKs shared with other       |
| other organizations, and  | organizations or otherwise manually      |
| MFKs and BDKs. The        | loaded as components and MFKs and BDKs)  |
| minimum log contents      | are logged.                              |
| include date and time,    |                                          |
| object name/identifier,   |                                          |
| purpose, name and         |                                          |
| signature of              |                                          |
| individual(s) involved,   |                                          |
| and tamper-evident        |                                          |
| package number(s) and     |                                          |
| serial number(s) of       |                                          |
| device(s) involved.       |                                          |
+---------------------------+------------------------------------------+
|                           | **7-2.b** Observe demonstrations for the |
|                           | generation of higher-level keys to       |
|                           | verify that all key-generation events    |
|                           | are logged.                              |
+---------------------------+------------------------------------------+
|                           | **7-2.c** Examine logs of key generation |
|                           | to verify that exchanges of higher-level |
|                           | keys with other organizations have been  |
|                           | recorded and that all required elements  |
|                           | were captured.                           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| []{#_bookmark59           |                                          |
| .anchor}***Control        |                                          |
| Objective 3: Keys are     |                                          |
| conveyed or transmitted   |                                          |
| in a secure manner***     |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 8:**       |                                          |
| Secret or private keys    |                                          |
| must be transferred by:*  |                                          |
|                           |                                          |
| a)  *Physically           |                                          |
|     > forwarding the key  |                                          |
|     > as at least two     |                                          |
|     > separate key shares |                                          |
|     > or full-length      |                                          |
|     > components (hard    |                                          |
|     > copy, smart card,   |                                          |
|     > SCD) using          |                                          |
|     > different           |                                          |
|     > communication       |                                          |
|     > channels, or*       |                                          |
|                           |                                          |
| b)  *Transmitting the key |                                          |
|     > in ciphertext       |                                          |
|     > form.*              |                                          |
|                           |                                          |
| > *Public keys must be    |                                          |
| > conveyed in a manner    |                                          |
| > that protects their     |                                          |
| > integrity and           |                                          |
| > authenticity.*          |                                          |
| >                         |                                          |
| > *It is the              |                                          |
| > responsibility of both  |                                          |
| > the sending and         |                                          |
| > receiving parties to    |                                          |
| > ensure these keys are   |                                          |
| > managed securely during |                                          |
| > transport.*             |                                          |
+---------------------------+------------------------------------------+
| ***Keys conveyed to** a   |                                          |
| key-injection facility    |                                          |
| (or applicable entity     |                                          |
| providing key-management  |                                          |
| services) must be         |                                          |
| conveyed in compliance    |                                          |
| with these requirements.  |                                          |
| Such keys can include,    |                                          |
| but are not limited to:*  |                                          |
|                           |                                          |
| -   *Derived Unique Key   |                                          |
|     > Per Transaction     |                                          |
|     > (DUKPT) Base        |                                          |
|     > Derivation Keys     |                                          |
|     > (BDKs) used in the  |                                          |
|     > DUKPT               |                                          |
|     > key-management      |                                          |
|     > method;*            |                                          |
|                           |                                          |
| -   *Key-encryption keys  |                                          |
|     > used to encrypt the |                                          |
|     > BDKs when the BDKs  |                                          |
|     > are conveyed        |                                          |
|     > between entities    |                                          |
|     > (e.g., from the BDK |                                          |
|     > owner to a device   |                                          |
|     > manufacturer that   |                                          |
|     > is performing       |                                          |
|     > key-injection on    |                                          |
|     > their behalf, or    |                                          |
|     > from a merchant to  |                                          |
|     > a third party that  |                                          |
|     > is performing       |                                          |
|     > key-injection on    |                                          |
|     > their behalf);*     |                                          |
|                           |                                          |
| -   *Terminal master keys |                                          |
|     > (TMKs) used in the  |                                          |
|     > master key/session  |                                          |
|     > key key-management  |                                          |
|     > method;*            |                                          |
|                           |                                          |
| -   *PIN-encryption keys  |                                          |
|     > used in the         |                                          |
|     > fixed-transaction   |                                          |
|     > key method;*        |                                          |
|                           |                                          |
| -   *Public keys used in  |                                          |
|     > remote              |                                          |
|     > key-establishment   |                                          |
|     > and distribution    |                                          |
|     > applications;*      |                                          |
|                           |                                          |
| -   *Private asymmetric   |                                          |
|     > keys for use in     |                                          |
|     > remote key-loading  |                                          |
|     > systems.*           |                                          |
|                           |                                          |
| ***Keys conveyed from** a |                                          |
| key-injection facility    |                                          |
| (including facilities     |                                          |
| that are device           |                                          |
| manufacturers) must be    |                                          |
| conveyed in compliance    |                                          |
| with these requirements.  |                                          |
| Such keys can include,    |                                          |
| but are not limited to:*  |                                          |
|                           |                                          |
| -   *Digitally signed     |                                          |
|     > HSM-authentication  |                                          |
|     > public key(s)       |                                          |
|     > signed by a device  |                                          |
|     > manufacturer's      |                                          |
|     > private key and     |                                          |
|     > subsequently loaded |                                          |
|     > into the HSM for    |                                          |
|     > supporting certain  |                                          |
|     > key-establishment   |                                          |
|     > and distribution    |                                          |
|     > applications        |                                          |
|     > protocols (if       |                                          |
|     > applicable);*       |                                          |
|                           |                                          |
| -   *Device               |                                          |
|     > manufacturer's      |                                          |
|     > authentication key  |                                          |
|     > loaded into the HSM |                                          |
|     > for supporting      |                                          |
|     > certain             |                                          |
|     > key-establishment   |                                          |
|     > and distribution    |                                          |
|     > applications        |                                          |
|     > protocols (if       |                                          |
|     > applicable).*       |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| 1.  Keys must be          | **8-1.a** Determine whether keys are     |
|     > transferred either  | transmitted encrypted, as clear-text     |
|     > encrypted, as two   | components/shares, or within an SCD.     |
|     > or more full-length |                                          |
|     > clear-text          |                                          |
|     > components, key     |                                          |
|     > shares, or within   |                                          |
|     > an SCD.             |                                          |
|                           |                                          |
| > Clear-text key          |                                          |
| > components/shares must  |                                          |
| > be conveyed in SCDs or  |                                          |
| > using tamper-evident,   |                                          |
| > authenticable           |                                          |
| > packaging.              |                                          |
|                           |                                          |
| -   Where key components  |                                          |
|     > are transmitted in  |                                          |
|     > clear-text using    |                                          |
|     > pre-numbered,       |                                          |
|     > tamper-evident,     |                                          |
|     > authenticable       |                                          |
|     > mailers:            |                                          |
|                           |                                          |
| > ![](vertopal_60a238a    |                                          |
| 099614e179dec6351a3c50457 |                                          |
| /media/image34.png){width |                                          |
| ="7.443569553805775e-2in" |                                          |
| >                         |                                          |
|  height="6.36482939632545 |                                          |
| 9e-3in"}Components/shares |                                          |
| > must be conveyed using  |                                          |
| > at least two separate   |                                          |
| > communication channels, |                                          |
| > such as different       |                                          |
| > courier services.       |                                          |
| >                         |                                          |
| > Components/shares       |                                          |
| > sufficient to form the  |                                          |
| > key must not be         |                                          |
| > conveyed using the same |                                          |
| > communication channel.  |                                          |
| >                         |                                          |
| > ![](vertopal_60a238a    |                                          |
| 099614e179dec6351a3c50457 |                                          |
| /media/image34.png){width |                                          |
| ="7.443569553805775e-2in" |                                          |
| > height="6.3648          |                                          |
| 29396325459e-3in"}Details |                                          |
| > of the serial number of |                                          |
| > the package are         |                                          |
| > conveyed separately     |                                          |
| > from the package        |                                          |
| > itself.                 |                                          |
| >                         |                                          |
| > ![](vertopal_60a238a    |                                          |
| 099614e179dec6351a3c50457 |                                          |
| /media/image34.png){width |                                          |
| ="7.443569553805775e-2in" |                                          |
| > height="6.3648293       |                                          |
| 96325459e-3in"}Documented |                                          |
| > procedures exist and    |                                          |
| > are followed to require |                                          |
| > that the serial numbers |                                          |
| > be verified prior to    |                                          |
| > the usage of the keying |                                          |
| > material.               |                                          |
| >                         |                                          |
| > *(continued on next     |                                          |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+
|                           | **8-1.b** If key components are          |
|                           | transmitted in clear-text using          |
|                           | pre-numbered, tamper-evident,            |
|                           | authenticable packaging, perform the     |
|                           | following:                               |
|                           |                                          |
|                           | -   Examine documented procedures for    |
|                           |     > sending components in              |
|                           |     > tamper-evident, authenticable      |
|                           |     > packaging to verify that:          |
|                           |                                          |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}They   |
|                           | > define how the details of the package  |
|                           | > serial number are to be transmitted.   |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}There  |
|                           | > is a requirement that the package      |
|                           | > serial number is to be sent separately |
|                           | > from the package itself.               |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}Each   |
|                           | > component is to be sent to/from only   |
|                           | > the custodian(s) authorized for the    |
|                           | > component.                             |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}At     |
|                           | > least two communication channels are   |
|                           | > used to send the components of a given |
|                           | > key (not just separation by sending on |
|                           | > different days).                       |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}Prior  |
|                           | > to the use of the components, the      |
|                           | > serial numbers are to be confirmed.    |
|                           |                                          |
|                           | -   Confirm through observation,         |
|                           |     > interview, and inspection of the   |
|                           |     > records of past key transfers that |
|                           |     > the process used to transport      |
|                           |     > clear-text key components using    |
|                           |     > pre- numbered, tamper-evident,     |
|                           |     > authenticable packaging, is        |
|                           |     > sufficient to ensure:              |
|                           |                                          |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}The    |
|                           | > package serial number was transmitted  |
|                           | > as prescribed.                         |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}The    |
|                           | > details of the serial number of the    |
|                           | > package were transmitted separately    |
|                           | > from the package itself.               |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}At     |
|                           | > least two communication channels were  |
|                           | > used to send the components of a given |
|                           | > key (not just separation by sending on |
|                           | > different days).                       |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}Each   |
|                           | > component was sent to/from only the    |
|                           | > custodian(s) authorized for the        |
|                           | > component                              |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}Prior  |
|                           | > to the use of the component, the       |
|                           | > serial number was confirmed.           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| 1.  *(continued)*         | **8-1.c** Where SCDs are used to convey  |
|                           | components/shares:                       |
|     -   Where SCDs are    |                                          |
|         > used for        | -   Examine documented procedures to     |
|         > conveying       |     > verify that the mechanism to       |
|                           |     > obtain the keying material (e.g.,  |
|      > components/shares, |     > PIN) is conveyed using a separate  |
|         > the mechanisms  |     > communication channel from the     |
|         > or data (e.g.,  |     > associated SCD.                    |
|         > PIN) to obtain  |                                          |
|         > the key         | -   Examine documented procedures to     |
|         > component/share |     > verify that each SCD is inspected  |
|         > from the SCD    |     > to ensure that there are not any   |
|         > must be         |     > signs of tampering.                |
|         > conveyed using  |                                          |
|         > a separate      | -   Examine the chain-of-custody         |
|         > communication   |     > document for the SCDs and any      |
|         > from the SCD    |     > transport logs to ensure the       |
|         > channel, or it  |     > movement of each device is tracked |
|         > must be         |     > and that there is evidence that    |
|         > conveyed in the |     > the SCDs and dual-control          |
|         > same manner as  |     > mechanisms were separated          |
|         > a paper         |     > sufficiently to ensure that no one |
|         > component. SCDs |     > person gained access to the SCDs   |
|         > must be         |     > and both SCD enablers.             |
|         > inspected for   |                                          |
|         > signs of        |                                          |
|         > tampering.      |                                          |
|                           |                                          |
|     -   Where an SCD      |                                          |
|         > (i.e., HSM or   |                                          |
|         > KLD) is         |                                          |
|         > conveyed with   |                                          |
|         > pre-loaded      |                                          |
|         > secret and/or   |                                          |
|         > private keys,   |                                          |
|         > the SCD must    |                                          |
|         > require dual    |                                          |
|         > control         |                                          |
|         > mechanisms to   |                                          |
|         > become          |                                          |
|         > operational.    |                                          |
|         > Those           |                                          |
|         > mechanisms must |                                          |
|         > not be conveyed |                                          |
|         > using the same  |                                          |
|         > communication   |                                          |
|         > channel as the  |                                          |
|         > SCD. SCDs must  |                                          |
|         > be inspected    |                                          |
|         > for signs of    |                                          |
|         > tampering.      |                                          |
|                           |                                          |
| > ***Note:**              |                                          |
| > Components/shares of    |                                          |
| > encryption keys must be |                                          |
| > conveyed using          |                                          |
| > different communication |                                          |
| > channels, such as       |                                          |
| > different courier       |                                          |
| > services. It is not     |                                          |
| > sufficient to send key  |                                          |
| > components/shares for a |                                          |
| > specific key on         |                                          |
| > different days using    |                                          |
| > the same communication  |                                          |
| > channel.*               |                                          |
+---------------------------+------------------------------------------+
|                           | **8-1.d** Where an SCD is conveyed with  |
|                           | pre-loaded secret and/or private keys,   |
|                           | perform the following:                   |
|                           |                                          |
|                           | -   Examine documented procedures to     |
|                           |     > verify that the SCD requires       |
|                           |     > dual-control mechanisms to become  |
|                           |     > operational.                       |
|                           |                                          |
|                           | -   Examine the documented procedures to |
|                           |     > ensure the method of shipment of   |
|                           |     > the SCD and dual-control           |
|                           |     > mechanisms (e.g., smart cards or   |
|                           |     > passphrases) are separated in a    |
|                           |     > way that ensures there is no       |
|                           |     > opportunity for one person to gain |
|                           |     > access to the SCD and both         |
|                           |     > authorization mechanisms (e.g.,    |
|                           |     > both smartcards, etc.).            |
|                           |                                          |
|                           | -   Examine documented procedures to     |
|                           |     > verify that the SCD is inspected   |
|                           |     > to ensure there are no signs of    |
|                           |     > tampering.                         |
|                           |                                          |
|                           | -   Examine records of key transfers and |
|                           |     > interview responsible personnel to |
|                           |     > verify the mechanisms that make    |
|                           |     > the SCD operational are conveyed   |
|                           |     > using separate communication       |
|                           |     > channels.                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **8-2** A person with   | **8-2.a** Examine documented procedures  |
| > access to one component | to verify they include controls to       |
| > or share of a secret or | ensure that no single person can gain    |
| > private key, or to the  | access to components or shares of this   |
| > media conveying this    | key or to any other medium containing    |
| > value, must not have    | other components or shares of this key   |
| > access to other         | that are sufficient to form the          |
| > components or shares of | necessary threshold to derive the key.   |
| > this key or to any      | Verify procedures include:               |
| > other medium containing |                                          |
| > other components or     | -   Designation of person(s) permitted   |
| > shares of this key that |     > to convey/receive keys.            |
| > are sufficient to form  |                                          |
| > the necessary threshold | -   Reminder that any person with access |
| > to derive the key.      |     > to one component/share of a key    |
| >                         |     > must not have access to other      |
| > ***Note:** An m-of-n    |     > components/shares of this key, or  |
| > scheme is a component-  |     > to any other medium conveying any  |
| > or share- allocation    |     > other component or shares          |
| > scheme where m is the   |     > sufficient to form the necessary   |
| > number of shares or     |     > threshold to derive the key.       |
| > components necessary to |                                          |
| > form the key, and n is  | -   Steps to ensure any person with      |
| > the number of the total |     > access to the media conveying a    |
| > set of shares or        |     > component/share of a key could not |
| > components related to   |     > have access to other               |
| > the key. Management of  |     > components/shares of this key, or  |
| > the shares or           |     > to any other medium conveying any  |
| > components must be      |     > other component of this key that   |
| > sufficient to ensure    |     > is sufficient to form the          |
| > that no one person can  |     > necessary threshold to derive the  |
| > gain access to enough   |     > key, without detection.            |
| > of the item to form the |                                          |
| > key alone*              |                                          |
| >                         |                                          |
| > *E.g., in an m-of-n     |                                          |
| > scheme (which must use  |                                          |
| > a recognized            |                                          |
| > secret-sharing scheme   |                                          |
| > such as Shamir), such   |                                          |
| > that any three key      |                                          |
| > components or shares    |                                          |
| > (i.e., m = 3) can be    |                                          |
| > used to derive the key, |                                          |
| > no single individual    |                                          |
| > can have access to more |                                          |
| > than two                |                                          |
| > components/shares.*     |                                          |
+---------------------------+------------------------------------------+
|                           | **8-2.b** Observe key-transfer processes |
|                           | and interview personnel to verify that   |
|                           | controls are implemented to ensure that  |
|                           | no single person can gain access to      |
|                           | components or shares of this key or to   |
|                           | any other medium containing other        |
|                           | components or shares of this key that    |
|                           | are sufficient to form the necessary     |
|                           | threshold to derive the key. Verify the  |
|                           | implemented controls ensure the          |
|                           | following:                               |
|                           |                                          |
|                           | -   Only designated custodians can       |
|                           |     > send/receive the component or      |
|                           |     > share.                             |
|                           |                                          |
|                           | -   There is a clear understanding that  |
|                           |     > an individual with access to a key |
|                           |     > component or key share does not    |
|                           |     > have access to other               |
|                           |     > components/shares of this key or   |
|                           |     > to any other medium conveying any  |
|                           |     > other components or shares of this |
|                           |     > key that are sufficient to form    |
|                           |     > the necessary threshold to derive  |
|                           |     > the key.                           |
|                           |                                          |
|                           | -   There is sufficient evidence to show |
|                           |     > that a person with access to the   |
|                           |     > media conveying a key component or |
|                           |     > key share could not have access to |
|                           |     > other components/shares of this    |
|                           |     > key or to any other medium         |
|                           |     > conveying any other components or  |
|                           |     > shares of this key that are        |
|                           |     > sufficient to form the necessary   |
|                           |     > threshold to derive the key        |
|                           |     > without detection.                 |
+---------------------------+------------------------------------------+
|                           | **8-2.c** Examine records of past key    |
|                           | transfers to verify that the method used |
|                           | did not allow for any personnel to have  |
|                           | access to components or shares           |
|                           | sufficient to form the key.              |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **8-3** E-mail must not | **8-3** Validate through interviews,     |
| > be used for the         | observation, and log inspection that     |
| > conveyance of secret or | e-mail, SMS, fax, telephone, or similar  |
| > private keys or their   | communication is not used as means to    |
| > components/shares, even | convey secret or private keys or key     |
| > if encrypted, unless    | components/shares.                       |
| > the key (or             |                                          |
| > component/share) has    |                                          |
| > already been encrypted  |                                          |
| > in accordance with      |                                          |
| > these                   |                                          |
| > requirements---i.e., in |                                          |
| > an SCD. This is due to  |                                          |
| > the existence of these  |                                          |
| > key values in memory    |                                          |
| > just prior to           |                                          |
| > encryption or           |                                          |
| > subsequent to           |                                          |
| > decryption. In          |                                          |
| > addition, corporate     |                                          |
| > e-mail systems allow    |                                          |
| > the recovery by support |                                          |
| > staff of the clear-     |                                          |
| > text of any encrypted   |                                          |
| > text or files conveyed  |                                          |
| > through those systems.  |                                          |
| >                         |                                          |
| > Other similar           |                                          |
| > mechanisms, such as     |                                          |
| > SMS, fax, or telephone  |                                          |
| > must not be used to     |                                          |
| > convey clear-text key   |                                          |
| > values.                 |                                          |
+---------------------------+------------------------------------------+
| > **8-4** Public keys     | **8-4** For all methods used to convey   |
| > must be conveyed in a   | public keys, perform the following:      |
| > manner that protects    |                                          |
| > their integrity and     |                                          |
| > authenticity.           |                                          |
| >                         |                                          |
| > Examples of acceptable  |                                          |
| > methods include:        |                                          |
|                           |                                          |
| -   Use of public-key     |                                          |
|     > certificates as     |                                          |
|     > defined within this |                                          |
|     > Domain that are     |                                          |
|     > created by a        |                                          |
|     > trusted CA that     |                                          |
|     > meets the           |                                          |
|     > applicable          |                                          |
|     > requirements of     |                                          |
|     > this Domain         |                                          |
|                           |                                          |
| -   Validating a hash of  |                                          |
|     > the public key sent |                                          |
|     > by a separate       |                                          |
|     > channel (e.g.,      |                                          |
|     > mail)               |                                          |
|                           |                                          |
| -   Using a MAC (message  |                                          |
|     > authentication      |                                          |
|     > code) created using |                                          |
|     > the algorithm       |                                          |
|     > defined in *ISO     |                                          |
|     > 16609*              |                                          |
|                           |                                          |
| -   Conveyance within an  |                                          |
|     > SCD                 |                                          |
|                           |                                          |
| -   Encrypted             |                                          |
|                           |                                          |
| > *(continued on next     |                                          |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+
|                           | **8-4.a** Examine documented procedures  |
|                           | for conveying public keys to verify that |
|                           | methods are defined to convey public     |
|                           | keys in a manner that protects their     |
|                           | integrity and authenticity, such as:     |
|                           |                                          |
|                           | -   Use of public-key certificates       |
|                           |     > created by a trusted CA that meets |
|                           |     > the applicable requirements of     |
|                           |     > this Domain                        |
|                           |                                          |
|                           | -   Validation of a hash of the public   |
|                           |     > key sent by a separate channel     |
|                           |     > (e.g., mail)                       |
|                           |                                          |
|                           | -   Using a MAC (message authentication  |
|                           |     > code) created using the algorithm  |
|                           |     > defined in *ISO 16609*             |
|                           |                                          |
|                           | -   Conveyance within an SCD             |
|                           |                                          |
|                           | -   Encrypted                            |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **8-4** *(continued)*   | **8-4.b** Validate that procedures       |
| >                         | dictate that self-signed certificates    |
| > ***Note:** Self-signed  | must not be used as the sole method of   |
| > certificates must not   | authentication.                          |
| > be used as the sole     |                                          |
| > method of               |                                          |
| > authentication.*        |                                          |
| >                         |                                          |
| > *Self-signed root       |                                          |
| > certificates protect    |                                          |
| > the integrity of the    |                                          |
| > data within the         |                                          |
| > certificate but do not  |                                          |
| > guarantee the           |                                          |
| > authenticity of the     |                                          |
| > data. The authenticity  |                                          |
| > of the root             |                                          |
| > certificates is based   |                                          |
| > on the use of secure    |                                          |
| > procedures to           |                                          |
| > distribute them.        |                                          |
| > Specifically, they must |                                          |
| > be directly installed   |                                          |
| > into the PIN pad of the |                                          |
| > ATM or POS device and   |                                          |
| > not remotely loaded to  |                                          |
| > the device subsequent   |                                          |
| > to manufacture.*        |                                          |
+---------------------------+------------------------------------------+
|                           | **8-4.c** Observe the process for        |
|                           | conveying public keys, associated logs,  |
|                           | and interview responsible personnel to   |
|                           | verify that the implemented method       |
|                           | ensures public keys are conveyed in a    |
|                           | manner that protects their integrity and |
|                           | authenticity.                            |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 9:**     |                                          |
| > During its              |                                          |
| > transmission,           |                                          |
| > conveyance, or movement |                                          |
| > between any two         |                                          |
| > locations or            |                                          |
| > organizational          |                                          |
| > entities, any single    |                                          |
| > unencrypted secret or   |                                          |
| > private key component   |                                          |
| > or share must at all    |                                          |
| > times be protected.*    |                                          |
| >                         |                                          |
| > *Sending and receiving  |                                          |
| > locations/entities are  |                                          |
| > equally responsible for |                                          |
| > the physical protection |                                          |
| > of the materials        |                                          |
| > involved.*              |                                          |
| >                         |                                          |
| > *These requirements     |                                          |
| > also apply to keys      |                                          |
| > moved between locations |                                          |
| > of the same             |                                          |
| > organization.*          |                                          |
+---------------------------+------------------------------------------+
| *Key components/shares    |                                          |
| conveyed to and from a    |                                          |
| key-injection facility    |                                          |
| (or applicable entity     |                                          |
| providing key-management  |                                          |
| services) must be         |                                          |
| conveyed in compliance    |                                          |
| with these requirements.  |                                          |
| Such key                  |                                          |
| components/shares include |                                          |
| but are not limited to    |                                          |
| those for key-encryption  |                                          |
| keys used to encrypt the  |                                          |
| BDKs when the BDKs are    |                                          |
| conveyed between entities |                                          |
| (e.g., from the BDK owner |                                          |
| to a device manufacturer  |                                          |
| that is performing        |                                          |
| key-injection on their    |                                          |
| behalf, or from a         |                                          |
| merchant to a third party |                                          |
| that is performing        |                                          |
| key-injection on their    |                                          |
| behalf), or key           |                                          |
| components for the BDKs   |                                          |
| themselves, and terminal  |                                          |
| master keys used in the   |                                          |
| master key/session key    |                                          |
| key-management method.    |                                          |
| These requirements also   |                                          |
| apply to keys moved       |                                          |
| between locations of the  |                                          |
| same organization.*       |                                          |
+---------------------------+------------------------------------------+
| 1.  During the process to | **9-1.a** Examine documented procedures  |
|     convey it, any single | for transmission, conveyance, or         |
|     clear-text secret or  | movement of keys between any two         |
|     private key           | locations to verify that any single      |
|     component/share must  | clear-text secret or private key         |
|     at all times be       | component/share must at all times be     |
|     either:               | either:                                  |
|                           |                                          |
|     -   Under the         | -   Under the continuous supervision of  |
|         > continuous      |     > a person with authorized access to |
|         > supervision of  |     > this component                     |
|         > a person with   |                                          |
|         > authorized      | -   Sealed in a security container or    |
|         > access to this  |     > courier mailer (including          |
|         > component, or   |     > pre-numbered, tamper- evident,     |
|                           |     > authenticable packaging) in such a |
|     -   Sealed in a       |     > way that it can be obtained only   |
|         > security        |     > by a person with authorized access |
|         > container or    |     > to it, unauthorized access to it   |
|         > courier mailer  |     > would be detected, or              |
|         > (including      |                                          |
|         > pre-numbered,   | -   Contained within a physically secure |
|         > tamper-evident, |     > SCD.                               |
|         > authenticable   |                                          |
|         > packaging) in   |                                          |
|         > such a way that |                                          |
|         > it can be       |                                          |
|         > obtained only   |                                          |
|         > by a person     |                                          |
|         > with authorized |                                          |
|         > access to it    |                                          |
|         > and             |                                          |
|         > unauthorized    |                                          |
|         > access would be |                                          |
|         > detected, or    |                                          |
|                           |                                          |
|     -   Contained within  |                                          |
|         > a physically    |                                          |
|         > secure SCD.     |                                          |
|                           |                                          |
| ***Note:** No single      |                                          |
| person must be able to    |                                          |
| access or use all         |                                          |
| components or a quorum of |                                          |
| shares of a single secret |                                          |
| or private cryptographic  |                                          |
| key.*                     |                                          |
+---------------------------+------------------------------------------+
|                           | **9-1.b** Observe key-management         |
|                           | processes, examine associated logs, and  |
|                           | interview responsible personnel to       |
|                           | verify processes implemented ensure that |
|                           | any single clear-text secret or private  |
|                           | key component/share is at all times      |
|                           | either:                                  |
|                           |                                          |
|                           | -   Under the continuous supervision of  |
|                           |     > a person with authorized access to |
|                           |     > this component                     |
|                           |                                          |
|                           | -   Sealed in a security container or    |
|                           |     > courier mailer (including          |
|                           |     > pre-numbered tamper- evident,      |
|                           |     > authenticable packaging) in such a |
|                           |     > way that it can be obtained only   |
|                           |     > by a person with authorized access |
|                           |     > to it, or contained within a       |
|                           |     > physically secure SCD.             |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **9-2** Packaging or    | **9-2.a** Verify documented procedures   |
| > mailers (i.e.,          | include requirements for all packaging   |
| > pre-numbered, tamper-   | or mailers containing clear-text key     |
| > evident packaging)      | components to be examined for evidence   |
| > containing clear-text   | of tampering before being opened.        |
| > key components are      |                                          |
| > examined for evidence   |                                          |
| > of tampering before     |                                          |
| > being opened. Any sign  |                                          |
| > of package tampering    |                                          |
| > indicating a component  |                                          |
| > was potentially         |                                          |
| > compromised must be     |                                          |
| > assessed and the        |                                          |
| > analysis formally       |                                          |
| > documented. If a        |                                          |
| > compromise is           |                                          |
| > confirmed, and the      |                                          |
| > result is that one      |                                          |
| > person could have       |                                          |
| > knowledge of the key,   |                                          |
| > it must result in the   |                                          |
| > destruction and         |                                          |
| > replacement of:         |                                          |
|                           |                                          |
| -   The set of components |                                          |
|                           |                                          |
| -   Any keys encrypted    |                                          |
|     > under this          |                                          |
|     > (combined) key      |                                          |
+---------------------------+------------------------------------------+
|                           | **9-2.b** Interview responsible          |
|                           | personnel and observe processes to       |
|                           | verify that all packaging or mailers     |
|                           | containing clear-text key components are |
|                           | examined for evidence of tampering       |
|                           | before being opened.                     |
+---------------------------+------------------------------------------+
|                           | **9-2.c** Verify documented procedures   |
|                           | require that any sign of package         |
|                           | tampering is identified, reported, and,  |
|                           | if compromise is confirmed, ultimately   |
|                           | results in the destruction and           |
|                           | replacement of both:                     |
|                           |                                          |
|                           | -   The set of components                |
|                           |                                          |
|                           | -   Any keys encrypted under this        |
|                           |     > (combined) key                     |
+---------------------------+------------------------------------------+
|                           | **9-2.d** Interview responsible          |
|                           | personnel and observe processes to       |
|                           | verify that if a package shows signs of  |
|                           | tampering indicating a component was     |
|                           | potentially compromised, processes are   |
|                           | implemented to identify the tampering,   |
|                           | report/escalate it, and, if compromise   |
|                           | is confirmed, ultimately result in the   |
|                           | destruction and replacement of both:     |
|                           |                                          |
|                           | -   The set of components                |
|                           |                                          |
|                           | -   Any keys encrypted under this        |
|                           |     > (combined) key                     |
+---------------------------+------------------------------------------+
|                           | **9-2.e** Examine records related to any |
|                           | escalated transmittal events. Verify     |
|                           | that if compromise is confirmed it       |
|                           | resulted in the destruction and          |
|                           | replacement of both:                     |
|                           |                                          |
|                           | -   The set of components                |
|                           |                                          |
|                           | -   Any keys encrypted under this        |
|                           |     > (combined) key                     |
+---------------------------+------------------------------------------+
| > **9-3** Only an         | **9-3.a** Verify the existence of a      |
| > authorized key          | list(s) of key custodiansand designated |
| > custodianand           | backup(s)authorized to have physical    |
| > designated              | access to key components prior to being  |
| > backup(s)must have     | secured in transmittal packaging and     |
| > physical access to a    | upon removal of a secured key component  |
| > key component prior to  | from transmittal packaging.              |
| > being secured in        |                                          |
| > transmittal packaging   |                                          |
| > and upon removal of a   |                                          |
| > secured key component   |                                          |
| > from transmittal        |                                          |
| > packaging.              |                                          |
+---------------------------+------------------------------------------+
|                           | **9-3.b** Observe implemented access     |
|                           | controls and processes to verify that    |
|                           | only those authorized key custodiansand |
|                           | designated backup(s)have physical       |
|                           | access to key components prior to being  |
|                           | secured in transmittal packaging and     |
|                           | upon removal of a secured key component  |
|                           | from transmittal packaging.              |
+---------------------------+------------------------------------------+
|                           | **9-3.c** Examine physical access logs   |
|                           | (e.g., to security containers for key    |
|                           | components) to verify that only the      |
|                           | authorized individual(s) have access to  |
|                           | each component.                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **9-4** Mechanisms must | **9-4.a** Verify that a list(s) of key   |
| > exist to ensure that    | custodians authorized to perform the     |
| > only authorized         | following activities is defined and      |
| > custodians:             | documented:                              |
|                           |                                          |
| -   Place key components  | -   Place the key component into         |
|     > into pre-numbered   |     > pre-numbered tamper-evident        |
|     > tamper- evident,    |     > packaging for transmittal.         |
|     > authenticable       |                                          |
|     > packaging for       | -   Upon receipt, check the              |
|     > transmittal.        |     > tamper-evident packaging for signs |
|                           |     > of tamper prior to opening the     |
| -   Check tamper-evident  |     > tamper-evident packaging           |
|     > packaging upon      |     > containing the key component.      |
|     > receipt for signs   |                                          |
|     > of tamper prior to  | -   Check the serial number of the       |
|     > opening             |     > tamper-evident packaging upon      |
|     > tamper-evident      |     > receipt of a component package.    |
|     > authenticable       |                                          |
|     > packaging           |                                          |
|     > containing key      |                                          |
|     > components.         |                                          |
|                           |                                          |
| -   Check the serial      |                                          |
|     > number of the       |                                          |
|     > tamper-evident      |                                          |
|     > packaging upon      |                                          |
|     > receipt of a        |                                          |
|     > component package.  |                                          |
|                           |                                          |
| > ***Note:** See          |                                          |
| > **Requirement 26** for  |                                          |
| > logging.*               |                                          |
+---------------------------+------------------------------------------+
|                           | **9-4.b** Observe implemented mechanisms |
|                           | and processes and examine logs to verify |
|                           | that only the authorized key custodians  |
|                           | can perform the following:               |
|                           |                                          |
|                           | -   Place the key component into         |
|                           |     > pre-numbered tamper-evident        |
|                           |     > packaging for transmittal.         |
|                           |                                          |
|                           | -   Upon receipt, check the              |
|                           |     > tamper-evident packaging for signs |
|                           |     > of tamper prior to opening the     |
|                           |     > tamper-evident packaging           |
|                           |     > containing the key component.      |
|                           |                                          |
|                           | -   Check the serial number of the       |
|                           |     > tamper-evident packaging upon      |
|                           |     > receipt of a component package.    |
+---------------------------+------------------------------------------+
| > **9-5** Pre-numbered,   | **9-5** Verify that pre-numbered,        |
| > tamper-evident,         | tamper-evident, authenticable bags are   |
| > authenticable bags must | used for the conveyance of clear-text    |
| > be used for the         | key components and perform the           |
| > conveyance of           | following:                               |
| > clear-text key          |                                          |
| > components not in an    | -   Examine documented procedures to     |
| > SCD. Out-of-band        |     > verify they define how details of  |
| > mechanisms must be used |     > the serial number are transmitted  |
| > to verify receipt of    |     > separately from the package        |
| > the appropriate bag     |     > itself.                            |
| > numbers.                |                                          |
| >                         | -   Observe the method used to transport |
| > ***Note:** Numbered     |     > clear-text key components using    |
| > courier bags are not    |     > tamper-evident mailers, and        |
| > sufficient for this     |     > interview responsible personnel to |
| > purpose.*               |     > verify that details of the serial  |
|                           |     > number of the package are          |
|                           |     > transmitted separately from the    |
|                           |     > package itself.                    |
|                           |                                          |
|                           | -   Examine logs to verify that          |
|                           |     > procedures are followed.           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | **Testing Procedures**                   |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **9-6** If components   | **9-6.a** If components or shares of     |
| > or shares of multiple   | multiple keys are being sent             |
| > keys are being sent     | simultaneously between the same sending  |
| > simultaneously between  | and receiving custodians, the            |
| > the same sending and    | component/shares for a specific          |
| > receiving custodians,   | custodian or custodian group can be      |
| > the component/shares    | shipped in the same TEA bag provided     |
| > for a specific          | that:                                    |
| > custodian or custodian  |                                          |
| > group can be shipped in | -   The components inside the            |
| > the same TEA bag        |     > tamper-evident and authenticable   |
| > provided that:          |     > package are in separate opaque and |
|                           |     > identifiable packaging (e.g.,      |
| -   The components inside |     > individually sealed within         |
|     > the tamper-evident  |     > labeled, opaque envelopes or       |
|     > and authenticable   |     > within PIN mailers) to prevent     |
|     > package are in      |     > confusion and/or inadvertent       |
|     > separate opaque and |     > observation when the package is    |
|     > identifiable        |     > opened.                            |
|     > packaging (e.g.,    |                                          |
|     > individually sealed | -   The components are repackaged at     |
|     > within labeled,     |     > receipt into separate              |
|     > opaque envelopes or |     > tamper-evident and authenticable   |
|     > PIN mailers) to     |     > packages for storage at the        |
|     > prevent confusion   |     > receiving location.                |
|     > and/or inadvertent  |                                          |
|     > observation when    | -   Records reflect the receipt of the   |
|     > the package is      |     > shipped bag and association with   |
|     > opened.             |     > subsequent individual bags         |
|                           |                                          |
| -   The components are    |                                          |
|     > repackaged at       |                                          |
|     > receipt into        |                                          |
|     > separate            |                                          |
|     > tamper-evident and  |                                          |
|     > authenticable       |                                          |
|     > packages for        |                                          |
|     > storage at the      |                                          |
|     > receiving location. |                                          |
|     > Records reflect the |                                          |
|     > receipt of the      |                                          |
|     > shipped bag and     |                                          |
|     > association with    |                                          |
|     > subsequent          |                                          |
|     > individual bags.    |                                          |
+---------------------------+------------------------------------------+
|                           | **9-6.b** Examine logs to verify that    |
|                           | procedures are followed.                 |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 10:** All  |                                          |
| key-encryption keys used  |                                          |
| to transmit or convey     |                                          |
| other cryptographic keys  |                                          |
| must be at least as       |                                          |
| strong as any key         |                                          |
| transmitted or conveyed.* |                                          |
+---------------------------+------------------------------------------+
| *Key-encryption keys used |                                          |
| to convey keys to a       |                                          |
| key-injection facility or |                                          |
| between locations or      |                                          |
| systems within the same   |                                          |
| key-injection facility    |                                          |
| (or applicable entity     |                                          |
| providing key-management  |                                          |
| services) must be at      |                                          |
| least as strong as any    |                                          |
| key transmitted or        |                                          |
| conveyed. Such keys       |                                          |
| include but are not       |                                          |
| limited to, key-          |                                          |
| encryption keys used to   |                                          |
| encrypt the BDKs when the |                                          |
| BDKs are conveyed between |                                          |
| entities, locations, or   |                                          |
| systems (e.g., from the   |                                          |
| BDK owner to a device     |                                          |
| manufacturer that is      |                                          |
| performing key-injection  |                                          |
| on their behalf, or from  |                                          |
| a merchant to a third     |                                          |
| party that is performing  |                                          |
| key-injection on their    |                                          |
| behalf) for system        |                                          |
| migration, or transport   |                                          |
| between injection         |                                          |
| locations owned by the    |                                          |
| same organization.*       |                                          |
+---------------------------+------------------------------------------+
| 1.  All key-encryption    | **10-1.a** Examine documented procedures |
|     keys used to encrypt  | to verify there is a requirement that    |
|     for transmittal or    | all keys used to transmit or convey      |
|     conveyance of other   | other cryptographic keys must be at      |
|     cryptographic keys    | least as strong as any key transmitted   |
|     must be at least as   | or conveyed, as delineated in Annex C    |
|     strong as the key     | (except as noted for RSA keys).          |
|     being sent, as        |                                          |
|     delineated in Annex   |                                          |
|     C, except as noted    |                                          |
|     below for RSA keys    |                                          |
|     used for key          |                                          |
|     transport.            |                                          |
|                           |                                          |
|     -   TDEA keys used    |                                          |
|         > for encrypting  |                                          |
|         > keys must be at |                                          |
|         > least           |                                          |
|         > triple-length   |                                          |
|         > keys (have bit  |                                          |
|         > strength of 112 |                                          |
|         > bits) and use   |                                          |
|         > the TDEA in an  |                                          |
|         > encrypt,        |                                          |
|         > decrypt,        |                                          |
|         > encrypt mode of |                                          |
|         > operation for   |                                          |
|                           |                                          |
|       > key-encipherment. |                                          |
|                           |                                          |
|     -   A triple-length   |                                          |
|         > TDEA key must   |                                          |
|         > not be          |                                          |
|         > encrypted with  |                                          |
|         > a TDEA key of   |                                          |
|         > lesser          |                                          |
|         > strength.       |                                          |
|                           |                                          |
|     -   TDEA keys must    |                                          |
|         > not be used to  |                                          |
|         > protect AES     |                                          |
|         > keys.           |                                          |
|                           |                                          |
|     -   TDEA keys must    |                                          |
|         > not be used to  |                                          |
|         > encrypt keys    |                                          |
|         > greater in      |                                          |
|         > strength than   |                                          |
|         > 112 bits.       |                                          |
|                           |                                          |
|     -   RSA keys          |                                          |
|         > encrypting keys |                                          |
|         > greater in      |                                          |
|         > strength than   |                                          |
|         > 80 bits must    |                                          |
|         > have a bit      |                                          |
|         > strength of at  |                                          |
|         > least 112 bits. |                                          |
|                           |                                          |
| > **(***continued on next |                                          |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+
|                           | **10-1.b** Using the network schematic   |
|                           | and the summary listing of cryptographic |
|                           | keys and through interview of personnel, |
|                           | identify keys that protect other keys    |
|                           | for transmission.                        |
|                           |                                          |
|                           | Consider keys manually transferred       |
|                           | (e.g., cryptograms sent to an ESO) as    |
|                           | well as those that are system-generated  |
|                           | and transferred (e.g., KEK or TMK        |
|                           | encrypting working keys).                |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **10-1** *continued*    | **10-1.c** Observe key-generation        |
|                           | processes for the key types identified   |
|                           | above. Verify that all keys used to      |
|                           | transmit or convey other cryptographic   |
|                           | keys are at least as strong as any key   |
|                           | transmitted or conveyed, except as noted |
|                           | for RSA keys. To verify this:            |
|                           |                                          |
|                           | -   Interview appropriate personnel and  |
|                           |     > examine documented procedures for  |
|                           |     > the creation of these keys.        |
|                           |                                          |
|                           | -   Using the table in Annex C, validate |
|                           |     > the respective key sizes relative  |
|                           |     > to the algorithms used for key     |
|                           |     > encryption.                        |
|                           |                                          |
|                           | -   Verify that:                         |
|                           |                                          |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}TDEA   |
|                           | > keys used for encrypting keys must be  |
|                           | > at least triple-length keys (have an   |
|                           | > effective bit strength of 112 bits)    |
|                           | > and use the TDEA in an encrypt,        |
|                           | > decrypt, encrypt mode of operation for |
|                           | > key-encipherment.                      |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}A      |
|                           | > triple-length TDEA key must not be     |
|                           | > encrypted with a TDEA key of lesser    |
|                           | > strength.                              |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}TDEA   |
|                           | > keys are not used to protect AES keys. |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}TDEA   |
|                           | > keys are not be used to encrypt keys   |
|                           | > greater in strength than 112 bits.     |
|                           | >                                        |
|                           | > ![](vertopal_60                        |
|                           | a238a099614e179dec6351a3c50457/media/ima |
|                           | ge34.png){width="7.443569553805775e-2in" |
|                           | > height="6.364829396325459e-3in"}RSA    |
|                           | > keys encrypting keys greater in        |
|                           | > strength than 80 bits have a bit       |
|                           | > strength at least 112 bits.            |
+---------------------------+------------------------------------------+
|                           | **10-1.d** Examine system documentation  |
|                           | and configuration files to validate the  |
|                           | above, including HSM settings.           |
+---------------------------+------------------------------------------+
| > **10-2 *Not used in     |                                          |
| > P2PE***                 |                                          |
+---------------------------+------------------------------------------+
| > **10-3 *Not used in     |                                          |
| > P2PE***                 |                                          |
+---------------------------+------------------------------------------+
| > **10-4 *Not used in     |                                          |
| > P2PE***                 |                                          |
+---------------------------+------------------------------------------+
| > **10-5 *Not used in     |                                          |
| > P2PE***                 |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 3:   |                                          |
| Keys are conveyed or      |                                          |
| transmitted in a secure   |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 11:**    |                                          |
| > Documented procedures   |                                          |
| > must exist and must be  |                                          |
| > demonstrably in use for |                                          |
| > all key transmission    |                                          |
| > and conveyance          |                                          |
| > processing.*            |                                          |
+---------------------------+------------------------------------------+
| **11-1** Written          | **11-1.a** Verify documented procedures  |
| procedures must exist and | exist for all key transmission and       |
| be known to all affected  | conveyance processing.                   |
| parties.                  |                                          |
+---------------------------+------------------------------------------+
|                           | **11-1.b** Interview responsible         |
|                           | personnel to verify that the documented  |
|                           | procedures are known and understood by   |
|                           | all affected parties for key             |
|                           | transmission and conveyance processing.  |
+---------------------------+------------------------------------------+
| **11-2** Methods used for | **11-2** Verify documented procedures    |
| the conveyance or receipt | include all methods used for the         |
| of keys must be           | conveyance or receipt of keys.           |
| documented.               |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| []{#_bookmark60           |                                          |
| .anchor}***Control        |                                          |
| Objective 4: Key loading  |                                          |
| to HSMs and POI devices   |                                          |
| is handled in a secure    |                                          |
| manner***                 |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 12:**      |                                          |
| Secret and private keys   |                                          |
| must be input into        |                                          |
| hardware (host) security  |                                          |
| modules (HSMs) and Point  |                                          |
| of Interaction (POI)      |                                          |
| devices in a secure       |                                          |
| manner:*                  |                                          |
|                           |                                          |
| a)  *Unencrypted secret   |                                          |
|     > or private keys     |                                          |
|     > must be entered     |                                          |
|     > into cryptographic  |                                          |
|     > devices using the   |                                          |
|     > principles of dual  |                                          |
|     > control and split   |                                          |
|     > knowledge.*         |                                          |
|                           |                                          |
| b)  *Key-establishment    |                                          |
|     > techniques using    |                                          |
|     > public-key          |                                          |
|     > cryptography must   |                                          |
|     > be implemented      |                                          |
|     > securely.*          |                                          |
+---------------------------+------------------------------------------+

> *Key-injection facilities (or applicable entities providing
> key-management services) must load keys using dual control and for
> clear-text secret and private keys, split knowledge. Such keys
> include, but are not limited to:*

-   *Derived Unique Key Per Transaction (DUKPT) Base Derivation Keys
    (BDKs) used in the DUKPT key-management method;*

-   *Key-encryption keys used to encrypt the BDKs when the BDKs are
    conveyed between entities (e.g., from the BDK owner to a device
    manufacturer that is performing key-injection on their behalf, or
    from a merchant to a third party that is injecting keys on their
    behalf);*

-   *Terminal master keys (TMKs) used in the master key/session key
    key-management method;*

-   *PIN-encryption keys used in the fixed-transaction key method;*

-   *Master keys for key-injection platforms and systems that include
    hardware devices (SCDs) for managing (e.g., generating and storing)
    the keys used to encrypt other keys for storage in the key-injection
    platform system;*

-   *Public and private key pairs loaded into the POIs for supporting
    remote key-establishment and distribution applications;*

-   *Digitally signed POI public key(s) signed by a device manufacture's
    private key and subsequently loaded into the POI for supporting
    certain key- establishment and distribution applications protocols
    (if applicable). Dual control is not necessary where other
    mechanisms exist to validate the authenticity of the key, such as
    the presence in the device of an authentication key;*

-   *Device manufacturer's authentication key (e.g., vendor root CA
    public key) loaded into the POI for supporting certain
    key-establishment and distribution applications protocols (if
    applicable).*

+---------------------------+------------------------------------------+
| **12-1** The loading of   | **12-1.a** Using the summary of          |
| secret or private keys,   | cryptographic keys, identify keys that   |
| when from the individual  | are loaded from components and examine   |
| key components or shares, | documented process to load each key type |
| must be performed using   | (MFK, TMK, PEK, etc.) from components to |
| the principles of dual    | ensure dual control and split knowledge  |
| control and split         | are required.                            |
| knowledge.                |                                          |
|                           |                                          |
| ***Note:** Manual key     |                                          |
| loading may involve the   |                                          |
| use of media such as      |                                          |
| paper, smart cards, or    |                                          |
| other physical tokens.*   |                                          |
|                           |                                          |
| > (*continued on next     |                                          |
| > page*)                  |                                          |
+===========================+==========================================+
|                           | **12-1.b** Interview appropriate         |
|                           | personnel to determine the number of key |
|                           | components for each manually loaded key. |
+---------------------------+------------------------------------------+
|                           | **12-1.c** Witness a structured          |
|                           | walk-through/demonstration of various    |
|                           | key-loading processes for all key types  |
|                           | (MFKs, AWKs, TMKs, PEKs, etc.). Verify   |
|                           | the number and length of the key         |
|                           | components against information provided  |
|                           | through verbal discussion and written    |
|                           | documentation.                           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **12-1** *(continued)*    | **12-1.d** Verify that the process       |
|                           | includes the entry of individual key     |
|                           | components by the designated key         |
|                           | custodians.                              |
+---------------------------+------------------------------------------+
|                           | **12-1.e** Ensure key-loading devices    |
|                           | can only be accessed and used under dual |
|                           | control.                                 |
+---------------------------+------------------------------------------+
|                           | **12-1.f** Examine locations where keys  |
|                           | may have been recorded that don\'t meet  |
|                           | this requirement. As applicable, examine |
|                           | HSM startup documentation (including     |
|                           | Disaster Recovery or Business Continuity |
|                           | Planning documentation) and procedure    |
|                           | manuals to ensure that there are no key  |
|                           | or component values recorded.            |
+---------------------------+------------------------------------------+
| **12-2** Procedures must  | **12-2.a**. Examine logs of access to    |
| be established that will  | security containers for key              |
| prohibit any one person   | components/shares to verify that only    |
| from having access to     | the authorized custodian(s) have         |
| components sufficient to  | accessed. Compare the number on the      |
| form an encryption key    | current tamper-evident and authenticable |
| when components are       | package for each component to the last   |
| removed from and returned | log entry for that component.            |
| to storage for key        |                                          |
| loading.                  | Trace historical movement of             |
|                           | higher-order keys (MFK, KEK, and BDK) in |
|                           | and out of secure storage to ensure      |
|                           | there is no break in the package-number  |
|                           | chain that would call into question      |
|                           | authorized handling and sufficient       |
|                           | storage of the component or share. This  |
|                           | must address at a minimum the time frame |
|                           | from the date of the prior audit.        |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **12-3** The loading of   | **12-3.a** Identify instances where a    |
| clear-text cryptographic  | key-loading device is used to load       |
| keys using a key-loading  | clear-text keys. Examine documented      |
| device requires dual      | procedures for loading of clear-text     |
| control to authorize any  | cryptographic keys to verify:            |
| key-loading session. It   |                                          |
| must not be possible for  | -   Procedures require dual control to   |
| a single person to use    |     > authorize any key-loading session. |
| the key-loading device to |                                          |
| load clear keys alone.    | -   The techniques to be used to achieve |
|                           |     > dual control are identified.       |
| Dual control must be      |                                          |
| implemented using one or  | -   There is a requirement to change any |
| more of, but not limited  |     > default passwords/authentication   |
| to, the following         |     > codes and set                      |
| techniques:               |     > passwords/authentication codes     |
|                           |     > that have at least five            |
| -   Two or more           |     > characters.                        |
|     >                     |                                          |
|  passwords/authentication | -   There is a requirement that if       |
|     > codes of five       |     > passwords/authentication codes or  |
|     > characters or more  |     > tokens are used, they are          |
|     > (vendor default     |     > maintained separately.             |
|     > values must be      |                                          |
|     > changed)            |                                          |
|                           |                                          |
| -   Multiple              |                                          |
|     > cryptographic       |                                          |
|     > tokens (such as     |                                          |
|     > smartcards), or     |                                          |
|     > physical keys       |                                          |
|                           |                                          |
| -   Physical access       |                                          |
|     > controls            |                                          |
|                           |                                          |
| -   Separate key-loading  |                                          |
|     > devices for each    |                                          |
|     > component/share     |                                          |
|                           |                                          |
| > *(continued on next     |                                          |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+
|                           | **12-3.b** For each type of production   |
|                           | SCD loaded using a key-loading device,   |
|                           | observe for the process (e.g., a         |
|                           | demonstration) of loading clear-text     |
|                           | cryptographic keys and interview         |
|                           | personnel. Verify that:                  |
|                           |                                          |
|                           | -   Dual control is necessary to         |
|                           |     > authorize the key-loading session. |
|                           |                                          |
|                           | -   Expected techniques are used.        |
|                           |                                          |
|                           | -   Default passwords/authentications    |
|                           |     > codes are reset.                   |
|                           |                                          |
|                           | -   Any passwords/authentication codes   |
|                           |     > used are a minimum of five         |
|                           |     > characters.                        |
|                           |                                          |
|                           | -   Any passwords/authentication codes   |
|                           |     > or tokens are maintained           |
|                           |     > separately.                        |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **12-3** *(continued)*    | **12-3.c** Examine documented records of |
|                           | key-loading to verify the presence of    |
| ***Note:** For devices    | two authorized persons during each type  |
| that do not support two   | of key-loading activity.                 |
| or more                   |                                          |
| passwords/authentication  |                                          |
| codes, this may be        |                                          |
| achieved by splitting the |                                          |
| single password used by   |                                          |
| the device into two       |                                          |
| halves, each half         |                                          |
| controlled by a separate  |                                          |
| authorized custodian.     |                                          |
| Each half must be a       |                                          |
| minimum of five           |                                          |
| characters.*              |                                          |
|                           |                                          |
| ***Note:**                |                                          |
| Passwords/authentication  |                                          |
| codes to the same object  |                                          |
| may be assigned to a      |                                          |
| custodian group           |                                          |
| teame.g., custodian team |                                          |
| for component A.*         |                                          |
|                           |                                          |
| ***Note:** The addition   |                                          |
| of applications that      |                                          |
| replace or disable the    |                                          |
| PCI-evaluated firmware    |                                          |
| functionality invalidates |                                          |
| the device approval for   |                                          |
| each such implementation  |                                          |
| unless those applications |                                          |
| are validated for         |                                          |
| compliance to PTS POI     |                                          |
| Security Requirements and |                                          |
| listed as such in the     |                                          |
| approval listings. If a   |                                          |
| PED that has been         |                                          |
| modified to perform these |                                          |
| functions has not been    |                                          |
| validated and approved to |                                          |
| the KLD approval class,   |                                          |
| the PED must be managed   |                                          |
| in accordance with        |                                          |
| Requirement 13-9.*        |                                          |
+---------------------------+------------------------------------------+
|                           | **12-3.d** Ensure that any default       |
|                           | dual-control mechanisms (e.g., default   |
|                           | passwords/authentication codes---usually |
|                           | printed in the vendor\'s manual---in a   |
|                           | key-loading device) have been disabled   |
|                           | or changed.                              |
+---------------------------+------------------------------------------+
| **12-4** Key components   | **12-4.a** Examine documented procedures |
| for symmetric keys must   | for combining symmetric-key components   |
| be combined using a       | and observe processes to verify that key |
| process such that no      | components are combined using a process  |
| active bit of the key can | such that no active bit of the key can   |
| be determined without     | be determined without knowledge of the   |
| knowledge of the          | remaining componentse.g., only within   |
| remaining                 | an SCD.                                  |
| componentse.g., via      |                                          |
| XOR'ing of full-length    |                                          |
| components.               |                                          |
|                           |                                          |
| The resulting key must    |                                          |
| only exist within the     |                                          |
| SCD.                      |                                          |
|                           |                                          |
| ***Note:** Concatenation  |                                          |
| of key components         |                                          |
| together to form the key  |                                          |
| is unacceptable; e.g.,    |                                          |
| concatenating two 8-      |                                          |
| hexadecimal character     |                                          |
| halves to form a          |                                          |
| 16-hexadecimal secret     |                                          |
| key.*                     |                                          |
+---------------------------+------------------------------------------+
|                           | **12-4.b** Confirm key-component lengths |
|                           | through interview and examination of     |
|                           | blank component forms and documented     |
|                           | procedures. Examine device configuration |
|                           | settings and interview personnel to      |
|                           | verify that key components used to       |
|                           | create a key are the same length as the  |
|                           | resultant key.                           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **12-5** Hardware         | **12-5** Examine vendor documentation    |
| security module (HSM)     | describing options for how the HSM MFK   |
| Master File Keys,         | is created and verify the current MFK    |
| including those generated | was created using AES (or triple-length  |
| internal to the HSM and   | TDEA for existing P2PE implementations   |
| never exported, must use  | only). Corroborate this via observation  |
| AES with a key size of at | of processes, with information gathered  |
| least 128 bits.           | during the interview process, and        |
|                           | procedural documentation provided by the |
|                           | entity under review.                     |
+---------------------------+------------------------------------------+
| **12-6** Any other SCD    | **12-6** Thorough examination of         |
| loaded with the same key  | documented procedures, interviews, and   |
| components must combine   | observation, confirm that any devices    |
| all entered key           | that are loaded with the same key        |
| components using the      | components use the same mathematical     |
| identical process.        | process to derive the final key.         |
+---------------------------+------------------------------------------+
| **12-7** The initial      | **12-7.a** Examine documented procedures |
| terminal master key (TMK) | for the loading of TMKs and initial      |
| or initial DUKPT key must | DUKPT keys to verify that they require   |
| be loaded to the device   | asymmetric key-loading techniques or     |
| using either asymmetric   | manual techniques for initial loading    |
| key-loading techniques or | and allowed methods for replacement TMK  |
| manual techniques---e.g., | or initial DUKPT key loading.            |
| the device keypad, IC     |                                          |
| cards, key- loading       |                                          |
| device, etc. Subsequent   |                                          |
| loading of the terminal   |                                          |
| master key or an initial  |                                          |
| DUKPT key may use         |                                          |
| techniques described in   |                                          |
| this document such as:    |                                          |
|                           |                                          |
| -   Asymmetric            |                                          |
|     > techniques;         |                                          |
|                           |                                          |
| -   Manual techniques;    |                                          |
|                           |                                          |
| -   The existing TMK to   |                                          |
|     > encrypt the         |                                          |
|     > replacement TMK for |                                          |
|     > download;           |                                          |
|                           |                                          |
| -   For AES DUKPT, using  |                                          |
|     > the option to       |                                          |
|     > derive a key-       |                                          |
|     > encryption key      |                                          |
|     > called the DUKPT    |                                          |
|     > Update Key so that  |                                          |
|     > the host can send a |                                          |
|     > device a new        |                                          |
|     > initial key         |                                          |
|     > encrypted under     |                                          |
|     > that key. Note this |                                          |
|     > also requires that  |                                          |
|     > a new initial key   |                                          |
|     > ID is also sent.    |                                          |
|                           |                                          |
| Keys must not be reloaded |                                          |
| by any methodology in the |                                          |
| event of a compromised    |                                          |
| device and must be        |                                          |
| withdrawn from use.       |                                          |
+---------------------------+------------------------------------------+
|                           | **12-7.b** Examine documented procedures |
|                           | to verify that keys are withdrawn from   |
|                           | use if they were loaded to a device that |
|                           | has been compromised or gone missing.    |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **12-8** If               | **12-8.a** For techniques involving      |
| key-establishment         | public-key cryptography, examine         |
| protocols using           | documentation to illustrate the process, |
| public-key cryptography   | including the size and sources of the    |
| are used to remotely      | parameters involved, and the mechanisms  |
| distribute secret keys,   | utilized for mutual device               |
| these must meet the       | authentication for both the host and the |
| applicable requirements   | POI device.                              |
| detailed in this Domain   |                                          |
| of this document. For     |                                          |
| example:                  |                                          |
|                           |                                          |
| A public-key technique    |                                          |
| for the distribution of   |                                          |
| symmetric secret keys     |                                          |
| must:                     |                                          |
|                           |                                          |
| -   Use public and        |                                          |
|     > private key lengths |                                          |
|     > that are in         |                                          |
|     > accordance with     |                                          |
|     > Annex C for the     |                                          |
|     > algorithm in        |                                          |
|     > question.           |                                          |
|                           |                                          |
| -   Use key-generation    |                                          |
|     > techniques that     |                                          |
|     > meet the current    |                                          |
|     > ANSI and ISO        |                                          |
|     > standards for the   |                                          |
|     > algorithm in        |                                          |
|     > question.           |                                          |
|                           |                                          |
| -   Provide for mutual    |                                          |
|     > device              |                                          |
|     > authentication for  |                                          |
|     > both the host and   |                                          |
|     > the POI device or   |                                          |
|     > host-to-host if     |                                          |
|     > applicable,         |                                          |
|     > including assurance |                                          |
|     > to the host that    |                                          |
|     > the POI device has  |                                          |
|     > (or can compute)    |                                          |
|     > the session key,    |                                          |
|     > and that no entity  |                                          |
|     > other than the POI  |                                          |
|     > device specifically |                                          |
|     > identified can      |                                          |
|     > possibly compute    |                                          |
|     > the session key.    |                                          |
+---------------------------+------------------------------------------+
|                           | **12-8.b** If key-establishment          |
|                           | protocols using public-key cryptography  |
|                           | are used to remotely distribute secret   |
|                           | keys, verify that the applicable         |
|                           | requirements detailed in this Domain are |
|                           | met, including:                          |
|                           |                                          |
|                           | -   Use of public and private key        |
|                           |     > lengths that are in accordance     |
|                           |     > with Annex C for the algorithm in  |
|                           |     > question.                          |
|                           |                                          |
|                           | -   Use of key-generation techniques     |
|                           |     > that meet the current ANSI and ISO |
|                           |     > standards for the algorithm in     |
|                           |     > question.                          |
|                           |                                          |
|                           | -   Providing for mutual device          |
|                           |     > authentication for both the host   |
|                           |     > and the POI device or host-to-host |
|                           |     > if applicable.                     |
+---------------------------+------------------------------------------+

+---+--------------------------+---+------------------------------------------+
| * |                          |   |                                          |
| * |                          |   |                                          |
| * |                          |   |                                          |
| C |                          |   |                                          |
| o |                          |   |                                          |
| n |                          |   |                                          |
| t |                          |   |                                          |
| r |                          |   |                                          |
| o |                          |   |                                          |
| l |                          |   |                                          |
| O |                          |   |                                          |
| b |                          |   |                                          |
| j |                          |   |                                          |
| e |                          |   |                                          |
| c |                          |   |                                          |
| t |                          |   |                                          |
| i |                          |   |                                          |
| v |                          |   |                                          |
| e |                          |   |                                          |
| 4 |                          |   |                                          |
| : |                          |   |                                          |
| K |                          |   |                                          |
| e |                          |   |                                          |
| y |                          |   |                                          |
| l |                          |   |                                          |
| o |                          |   |                                          |
| a |                          |   |                                          |
| d |                          |   |                                          |
| i |                          |   |                                          |
| n |                          |   |                                          |
| g |                          |   |                                          |
| t |                          |   |                                          |
| o |                          |   |                                          |
| H |                          |   |                                          |
| S |                          |   |                                          |
| M |                          |   |                                          |
| s |                          |   |                                          |
| a |                          |   |                                          |
| n |                          |   |                                          |
| d |                          |   |                                          |
| P |                          |   |                                          |
| O |                          |   |                                          |
| I |                          |   |                                          |
| d |                          |   |                                          |
| e |                          |   |                                          |
| v |                          |   |                                          |
| i |                          |   |                                          |
| c |                          |   |                                          |
| e |                          |   |                                          |
| s |                          |   |                                          |
| i |                          |   |                                          |
| s |                          |   |                                          |
| h |                          |   |                                          |
| a |                          |   |                                          |
| n |                          |   |                                          |
| d |                          |   |                                          |
| l |                          |   |                                          |
| e |                          |   |                                          |
| d |                          |   |                                          |
| i |                          |   |                                          |
| n |                          |   |                                          |
| a |                          |   |                                          |
| s |                          |   |                                          |
| e |                          |   |                                          |
| c |                          |   |                                          |
| u |                          |   |                                          |
| r |                          |   |                                          |
| e |                          |   |                                          |
| m |                          |   |                                          |
| a |                          |   |                                          |
| n |                          |   |                                          |
| n |                          |   |                                          |
| e |                          |   |                                          |
| r |                          |   |                                          |
| * |                          |   |                                          |
| * |                          |   |                                          |
| * |                          |   |                                          |
+===+==========================+===+==========================================+
| > |                          |   | > **Testing Procedures**                 |
|   |                          |   |                                          |
| * |                          |   |                                          |
| * |                          |   |                                          |
| D |                          |   |                                          |
| o |                          |   |                                          |
| m |                          |   |                                          |
| a |                          |   |                                          |
| i |                          |   |                                          |
| n |                          |   |                                          |
| > |                          |   |                                          |
|   |                          |   |                                          |
| 5 |                          |   |                                          |
| > |                          |   |                                          |
|   |                          |   |                                          |
| R |                          |   |                                          |
| e |                          |   |                                          |
| q |                          |   |                                          |
| u |                          |   |                                          |
| i |                          |   |                                          |
| r |                          |   |                                          |
| e |                          |   |                                          |
| m |                          |   |                                          |
| e |                          |   |                                          |
| n |                          |   |                                          |
| t |                          |   |                                          |
| s |                          |   |                                          |
| * |                          |   |                                          |
| * |                          |   |                                          |
+---+--------------------------+---+------------------------------------------+
| * |                          |   | **12-9.a** Examine documented            |
| * |                          |   | key-injection procedures to verify that  |
| 1 |                          |   | the procedures define the use of dual    |
| 2 |                          |   | control and split knowledge controls for |
| - |                          |   | the loading of keys into devices.        |
| 9 |                          |   |                                          |
| * |                          |   |                                          |
| * |                          |   |                                          |
| K |                          |   |                                          |
| e |                          |   |                                          |
| y |                          |   |                                          |
| - |                          |   |                                          |
| i |                          |   |                                          |
| n |                          |   |                                          |
| j |                          |   |                                          |
| e |                          |   |                                          |
| c |                          |   |                                          |
| t |                          |   |                                          |
| i |                          |   |                                          |
| o |                          |   |                                          |
| n |                          |   |                                          |
| f |                          |   |                                          |
| a |                          |   |                                          |
| c |                          |   |                                          |
| i |                          |   |                                          |
| l |                          |   |                                          |
| i |                          |   |                                          |
| t |                          |   |                                          |
| i |                          |   |                                          |
| e |                          |   |                                          |
| s |                          |   |                                          |
| m |                          |   |                                          |
| u |                          |   |                                          |
| s |                          |   |                                          |
| t |                          |   |                                          |
| i |                          |   |                                          |
| m |                          |   |                                          |
| p |                          |   |                                          |
| l |                          |   |                                          |
| e |                          |   |                                          |
| m |                          |   |                                          |
| e |                          |   |                                          |
| n |                          |   |                                          |
| t |                          |   |                                          |
| d |                          |   |                                          |
| u |                          |   |                                          |
| a |                          |   |                                          |
| l |                          |   |                                          |
| c |                          |   |                                          |
| o |                          |   |                                          |
| n |                          |   |                                          |
| t |                          |   |                                          |
| r |                          |   |                                          |
| o |                          |   |                                          |
| l |                          |   |                                          |
| a |                          |   |                                          |
| n |                          |   |                                          |
| d |                          |   |                                          |
| s |                          |   |                                          |
| p |                          |   |                                          |
| l |                          |   |                                          |
| i |                          |   |                                          |
| t |                          |   |                                          |
| - |                          |   |                                          |
| k |                          |   |                                          |
| n |                          |   |                                          |
| o |                          |   |                                          |
| w |                          |   |                                          |
| l |                          |   |                                          |
| e |                          |   |                                          |
| d |                          |   |                                          |
| g |                          |   |                                          |
| e |                          |   |                                          |
| c |                          |   |                                          |
| o |                          |   |                                          |
| n |                          |   |                                          |
| t |                          |   |                                          |
| r |                          |   |                                          |
| o |                          |   |                                          |
| l |                          |   |                                          |
| s |                          |   |                                          |
| f |                          |   |                                          |
| o |                          |   |                                          |
| r |                          |   |                                          |
| t |                          |   |                                          |
| h |                          |   |                                          |
| e |                          |   |                                          |
| l |                          |   |                                          |
| o |                          |   |                                          |
| a |                          |   |                                          |
| d |                          |   |                                          |
| i |                          |   |                                          |
| n |                          |   |                                          |
| g |                          |   |                                          |
| o |                          |   |                                          |
| f |                          |   |                                          |
| k |                          |   |                                          |
| e |                          |   |                                          |
| y |                          |   |                                          |
| s |                          |   |                                          |
| i |                          |   |                                          |
| n |                          |   |                                          |
| t |                          |   |                                          |
| o |                          |   |                                          |
| d |                          |   |                                          |
| e |                          |   |                                          |
| v |                          |   |                                          |
| i |                          |   |                                          |
| c |                          |   |                                          |
| e |                          |   |                                          |
| s |                          |   |                                          |
| ( |                          |   |                                          |
| e |                          |   |                                          |
| . |                          |   |                                          |
| g |                          |   |                                          |
| . |                          |   |                                          |
| , |                          |   |                                          |
| P |                          |   |                                          |
| O |                          |   |                                          |
| I |                          |   |                                          |
| s |                          |   |                                          |
| a |                          |   |                                          |
| n |                          |   |                                          |
| d |                          |   |                                          |
| o |                          |   |                                          |
| t |                          |   |                                          |
| h |                          |   |                                          |
| e |                          |   |                                          |
| r |                          |   |                                          |
| S |                          |   |                                          |
| C |                          |   |                                          |
| D |                          |   |                                          |
| s |                          |   |                                          |
| ) |                          |   |                                          |
| . |                          |   |                                          |
+---+--------------------------+---+------------------------------------------+
|   |                          |   | **12-9.b** Interview responsible         |
|   |                          |   | personnel and observe key-loading        |
|   |                          |   | processes and controls to verify that    |
|   |                          |   | dual control and split-knowledge         |
|   |                          |   | controls are in place for the loading of |
|   |                          |   | keys into devices.                       |
+---+--------------------------+---+------------------------------------------+
|   | ***Note:** Such controls |   |                                          |
|   | may include but are not  |   |                                          |
|   | limited to:*             |   |                                          |
|   |                          |   |                                          |
|   | -   *Physical dual       |   |                                          |
|   |     access controls that |   |                                          |
|   |     electronically       |   |                                          |
|   |     provide for          |   |                                          |
|   |     restricted entry and |   |                                          |
|   |     egress from a room   |   |                                          |
|   |     dedicated to key     |   |                                          |
|   |     injection such that  |   |                                          |
|   |     the badge- access    |   |                                          |
|   |     system enforces the  |   |                                          |
|   |     presence of at least |   |                                          |
|   |     two authorized       |   |                                          |
|   |     individuals at all   |   |                                          |
|   |     times in the room so |   |                                          |
|   |     no one person can    |   |                                          |
|   |     singly access the    |   |                                          |
|   |     key-loading          |   |                                          |
|   |     equipment. Access is |   |                                          |
|   |     restricted to only   |   |                                          |
|   |     appropriate          |   |                                          |
|   |     personnel involved   |   |                                          |
|   |     in the key-loading   |   |                                          |
|   |     process*             |   |                                          |
|   |                          |   |                                          |
|   | -   *Logical dual        |   |                                          |
|   |     control via multiple |   |                                          |
|   |     logins with unique   |   |                                          |
|   |     user IDs to the      |   |                                          |
|   |     key-injection        |   |                                          |
|   |     platform application |   |                                          |
|   |     such that no one     |   |                                          |
|   |     person can operate   |   |                                          |
|   |     the application to   |   |                                          |
|   |     singly inject        |   |                                          |
|   |     cryptographic keys   |   |                                          |
|   |     into devices*        |   |                                          |
|   |                          |   |                                          |
|   | -   *Key-injection       |   |                                          |
|   |     platform             |   |                                          |
|   |     applications that    |   |                                          |
|   |     force the entry of   |   |                                          |
|   |     multiple key         |   |                                          |
|   |     components and the   |   |                                          |
|   |     implementation of    |   |                                          |
|   |     procedures that      |   |                                          |
|   |     involve multiple key |   |                                          |
|   |     custodians who store |   |                                          |
|   |     and access key       |   |                                          |
|   |     components under     |   |                                          |
|   |     dual-control and     |   |                                          |
|   |     split-knowledge      |   |                                          |
|   |     mechanisms*          |   |                                          |
|   |                          |   |                                          |
|   | -   *Demonstrable        |   |                                          |
|   |     procedures that      |   |                                          |
|   |     prohibit key         |   |                                          |
|   |     custodians from      |   |                                          |
|   |     handing their        |   |                                          |
|   |     components to any    |   |                                          |
|   |     other individual for |   |                                          |
|   |     key entry*           |   |                                          |
|   |                          |   |                                          |
|   | -   *Separate            |   |                                          |
|   |     key-loading devices  |   |                                          |
|   |     for each component.* |   |                                          |
+---+--------------------------+---+------------------------------------------+
|   |                          |   | **12-9.c** Examine records of            |
|   |                          |   | key-loading processes and controls to    |
|   |                          |   | verify that the loading of keys does not |
|   |                          |   | occur without dual control and split     |
|   |                          |   | knowledge.                               |
+---+--------------------------+---+------------------------------------------+

+---------------------------+------------------------------------------+
| > ***Control Objective 4: |                                          |
| > Key loading to HSMs and |                                          |
| > POI devices is handled  |                                          |
| > in a secure manner***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 13:**    |                                          |
| > The mechanisms used to  |                                          |
| > load secret and private |                                          |
| > keys---such as          |                                          |
| > terminals, external PIN |                                          |
| > pads, key guns, or      |                                          |
| > similar devices and     |                                          |
| > methods---must be       |                                          |
| > protected to prevent    |                                          |
| > any type of monitoring  |                                          |
| > that could result in    |                                          |
| > the unauthorized        |                                          |
| > disclosure of any       |                                          |
| > component.*             |                                          |
+---------------------------+------------------------------------------+
| > *Key-injection          |                                          |
| > facilities (or          |                                          |
| > applicable entities     |                                          |
| > providing               |                                          |
| > key-management          |                                          |
| > services) must ensure   |                                          |
| > key-loading mechanisms  |                                          |
| > are not subject to      |                                          |
| > disclosure of key       |                                          |
| > components or keys.*    |                                          |
| >                         |                                          |
| > *Some key-injection     |                                          |
| > platforms use           |                                          |
| > personal-computer       |                                          |
| > (PC)-based software     |                                          |
| > applications, whereby   |                                          |
| > clear-text secret       |                                          |
| > and/or private keys     |                                          |
| > and/or their components |                                          |
| > exist in memory outside |                                          |
| > the secure boundary of  |                                          |
| > an SCD for loading      |                                          |
| > keys. Such systems have |                                          |
| > inherent weaknesses     |                                          |
| > that, if exploited, may |                                          |
| > cause the unauthorized  |                                          |
| > disclosure of           |                                          |
| > components and/or keys. |                                          |
| > These weaknesses        |                                          |
| > include:*               |                                          |
|                           |                                          |
| -   *XOR'ing of key       |                                          |
|     > components is       |                                          |
|     > performed in        |                                          |
|     > software.*          |                                          |
|                           |                                          |
| -   *Clear-text keys and  |                                          |
|     > components can      |                                          |
|     > reside in software  |                                          |
|     > during the          |                                          |
|     > key-loading         |                                          |
|     > process.*           |                                          |
|                           |                                          |
| -   *Some systems require |                                          |
|     > only a single       |                                          |
|     > password.*          |                                          |
|                           |                                          |
| -   *Some systems store   |                                          |
|     > the keys (e.g.,     |                                          |
|     > BDKs, TMKs) on      |                                          |
|     > removable media or  |                                          |
|     > smart cards. These  |                                          |
|     > keys are in the     |                                          |
|     > clear with some     |                                          |
|     > systems.*           |                                          |
|                           |                                          |
| -   *PCs, by default, are |                                          |
|     > not managed under   |                                          |
|     > dual control. Extra |                                          |
|     > steps (e.g.,        |                                          |
|     > logical user IDs,   |                                          |
|     > physical access     |                                          |
|     > controls, etc.)     |                                          |
|     > must be implemented |                                          |
|     > to prevent single   |                                          |
|     > control of a PC.*   |                                          |
|                           |                                          |
| -   *Data can be recorded |                                          |
|     > in the PC's         |                                          |
|     > non-volatile        |                                          |
|     > storage.*           |                                          |
|                           |                                          |
| -   *Software Trojan      |                                          |
|     > horses or keyboard  |                                          |
|     > sniffers can be     |                                          |
|     > installed on PCs.*  |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| 1.  Clear-text secret and | 1.  Observe key-loading environments,    |
|     private keys and key  |     processes, and mechanisms (e.g.,     |
|     components must be    |     terminals, PIN pads, key guns, etc.) |
|     transferred into an   |     used to transfer keys and key        |
|     SCD only when it can  |     components. Perform the following:   |
|     be ensured that:      |                                          |
|                           |     -   Ensure cameras are positioned to |
|     -   Any cameras       |         > ensure they cannot monitor the |
|         > present in the  |         > entering of clear- text key    |
|         > environment     |         > components.                    |
|         > must be         |                                          |
|         > positioned to   |     -   Examine documented procedures to |
|         > ensure they     |         > determine that they require    |
|         > cannot monitor  |         > that keys and components are   |
|         > the entering of |         > transferred into an SCD only   |
|         > clear-text key  |         > after an inspection of the     |
|         > components.     |         > devices and mechanism; and     |
|                           |         > verify they are followed by    |
|     -   There is not any  |         > observing a demonstration      |
|         > mechanism at    |         > that:                          |
|         > the interface   |                                          |
|         > between the     | > ![](vertopal_60                        |
|         > conveyance      | a238a099614e179dec6351a3c50457/media/ima |
|         > medium and the  | ge34.png){width="7.443569553805775e-2in" |
|         > SCD that might  | > height="6.364829396325459e-3in"}SCDs   |
|         > disclose the    | > are inspected to detect evidence of    |
|         > transferred     | > monitoring and to ensure dual-control  |
|         > keys.           | > procedures are not circumvented during |
|                           | > key loading.                           |
|     -   The sending and   | >                                        |
|         > receiving SCDs  | > ![](vertopal_60                        |
|         > must be         | a238a099614e179dec6351a3c50457/media/ima |
|         > inspected prior | ge34.png){width="7.443569553805775e-2in" |
|         > to key loading  | > height="6.364829396325459e-3in"}An SCD |
|         > to ensure that  | > transfers a plaintext secret or        |
|         > they have not   | > private key only when at least two     |
|         > been subject to | > authorized individuals are identified  |
|         > any prior       | > by the device.                         |
|         > tampering or    | >                                        |
|         > unauthorized    | > ![](vertopal_60                        |
|         > modification    | a238a099614e179dec6351a3c50457/media/ima |
|         > that could lead | ge34.png){width="7.443569553805775e-2in" |
|         > to the          | > height="6.364829396325459e-3in"}There  |
|         > disclosure of   | > is not any mechanism at the interface  |
|         > clear-text      | > (including cabling) between the        |
|         > keying          | > conveyance medium and the SCD that     |
|         > material.       | > might disclose the transferred keys.   |
|                           | >                                        |
|     -   SCDs must be      | > ![](vertopal_60                        |
|         > inspected to    | a238a099614e179dec6351a3c50457/media/ima |
|         > detect evidence | ge34.png){width="7.443569553805775e-2in" |
|         > of monitoring   | > height="6.364829396325459e-3in"}The    |
|         > and to ensure   | > SCD is inspected to ensure it has not  |
|         > dual control    | > been subject to any prior tampering or |
|         > procedures are  | > unauthorized modification, which could |
|         > not             | > lead to the disclosure of clear-text   |
|         > circumvented    | > keying material.                       |
|         > during key      |                                          |
|         > loading.        |                                          |
|                           |                                          |
|     -   An SCD must       |                                          |
|         > transfer a      |                                          |
|         > plaintext       |                                          |
|         > secret or       |                                          |
|         > private key     |                                          |
|         > only when at    |                                          |
|         > least two       |                                          |
|         > authorized      |                                          |
|         > individuals are |                                          |
|         > uniquely        |                                          |
|         > identified by   |                                          |
|         > the device.     |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **13-2** Only SCDs must   | **13-2.a** Examine documentation to      |
| be used in the loading of | verify that only SCDs are used in the    |
| clear-text secret or      | loading of clear- text secret or private |
| private keys or their     | keys or their components outside of a    |
| components outside of a   | secure key-loading facility, as          |
| secure key-loading        | delineated in this requirement. For      |
| facility, as delineated   | example, computer keyboards or keyboards |
| in the requirements       | attached to an HSM must never be used    |
| contained in this Domain. | for the loading of clear-text secret or  |
| For example, computer     | private keys or their components.        |
| keyboards or those        |                                          |
| attached to an HSM must   |                                          |
| never be used for the     |                                          |
| loading of clear-text     |                                          |
| secret or private keys or |                                          |
| their components.         |                                          |
|                           |                                          |
| ***Note:** The addition   |                                          |
| of applications that      |                                          |
| replace or disable the    |                                          |
| PCI-evaluated firmware    |                                          |
| functionality invalidates |                                          |
| the device approval for   |                                          |
| each such implementation  |                                          |
| unless those applications |                                          |
| are validated for         |                                          |
| compliance to PTS POI     |                                          |
| Security Requirements and |                                          |
| listed as such in the     |                                          |
| approval listings. If a   |                                          |
| PED that has been         |                                          |
| modified to perform these |                                          |
| functions has not been    |                                          |
| validated and approved to |                                          |
| the KLD approval class,   |                                          |
| the PED must be managed   |                                          |
| in accordance with        |                                          |
| Requirement 13-9.*        |                                          |
+---------------------------+------------------------------------------+
|                           | **13-2.b** Observe a demonstration of    |
|                           | key loading to verify that only SCDs are |
|                           | used in the loading of clear-text secret |
|                           | or private keys or their components      |
|                           | outside of a secure key- loading         |
|                           | facility.                                |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **13-3** The loading of   | **13-3.a** Examine documented procedures |
| clear-text secret or      | for the loading of secret or private key |
| private key components or | components from electronic medium to a   |
| shares from an electronic | cryptographic device. Verify that        |
| medium---e.g., smart      | procedures define specific instructions  |
| card, thumb drive, fob,   | to be followed as a result of key        |
| or other device used for  | injection, including:                    |
| data transport---directly |                                          |
| into a cryptographic      | -   Instructions for the medium to be    |
| device (and verification  |     > placed into secure storage and     |
| of the correct receipt of |     > managed under dual control (only   |
| the component, if         |     > if there is a possibility it will  |
| applicable) results in    |     > be required for future re-loading  |
| either of the following   |     > of the component into the          |
|                           |     > cryptographic device); or          |
| -   The medium is placed  |                                          |
|     > into secure storage | -   Instructions to erase or otherwise   |
|     > and managed under   |     > destroy all traces of the          |
|     > dual control (only  |     > component from the electronic      |
|     > if there is a       |     > medium, including the method to    |
|     > possibility it will |     > use.                               |
|     > be required for     |                                          |
|     > future re-loading   |                                          |
|     > of the component    |                                          |
|     > into the            |                                          |
|     > cryptographic       |                                          |
|     > device); or         |                                          |
|                           |                                          |
| -   All traces of the     |                                          |
|     > component are       |                                          |
|     > erased or otherwise |                                          |
|     > destroyed from the  |                                          |
|     > electronic medium   |                                          |
|     > in accordance with  |                                          |
|     > **Requirement 24**. |                                          |
+---------------------------+------------------------------------------+
|                           | **13-3.b** Observe key-loading processes |
|                           | to verify that the injection process     |
|                           | results in one of the following:         |
|                           |                                          |
|                           | -   The medium used for key injection is |
|                           |     > placed into secure storage and     |
|                           |     > managed under dual control (only   |
|                           |     > if there is a possibility it will  |
|                           |     > be required for future re-loading  |
|                           |     > of the component into the          |
|                           |     > cryptographic device); or          |
|                           |                                          |
|                           | -   All traces of the component are      |
|                           |     > erased or otherwise destroyed from |
|                           |     > the electronic medium.             |
+---------------------------+------------------------------------------+
|                           | **13-3.c** Examine records/logs of       |
|                           | erasures to confirm that:                |
|                           |                                          |
|                           | -   The documented procedure was         |
|                           |     > followed.                          |
|                           |                                          |
|                           | -   The method used was in accordance    |
|                           |     > with **Requirement 24**.           |
+---------------------------+------------------------------------------+
| **13-4** For secret or    | **13-4** Examine documented procedures   |
| private keys transferred  | and observe processes for the use of     |
| from the cryptographic    | key-loading devices. Perform the         |
| hardware that generated   | following:                               |
| the key to an electronic  |                                          |
| key-loading device:       |                                          |
+---------------------------+------------------------------------------+
| > **13-4.1** The          | > **13-4.1** Verify the key-loading      |
| > key-loading device must | > device is a physically secure SCD,     |
| > be a physically secure  | > designed and implemented in such a way |
| > SCD, designed and       | > that any unauthorized disclosure of    |
| > implemented in such a   | > the key is prevented or detected.      |
| > way that any            |                                          |
| > unauthorized disclosure |                                          |
| > of the key is prevented |                                          |
| > or detected*.*          |                                          |
| >                         |                                          |
| > ***Note:** A            |                                          |
| > PCI-approved KLD meets  |                                          |
| > this requirement for an |                                          |
| > SCD.*                   |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **13-4.2** The          | > **13-4.2** Verify the key-loading      |
| > key-loading device must | > device is under the supervision of a   |
| > be under the            | > person authorized by management, or    |
| > supervision of a person | > stored in a secure container such that |
| > authorized by           | > no unauthorized person can have access |
| > management, or stored   | > to it.                                 |
| > in a secure container   |                                          |
| > such that no            |                                          |
| > unauthorized person can |                                          |
| > have access to it.      |                                          |
| >                         |                                          |
| > ***Note:**              |                                          |
| > Furniture-based locks   |                                          |
| > or containers with a    |                                          |
| > limited set of unique   |                                          |
| > keys---e.g., desk       |                                          |
| > drawers---are not       |                                          |
| > sufficient to meet this |                                          |
| > requirement.*           |                                          |
+---------------------------+------------------------------------------+
| > **13-4.3** The          | > **13-4.3.a** Verify the key-loading    |
| > key-loading device must | > device is designed or controlled so    |
| > be designed or          | > that only authorized personnel under   |
| > controlled so that only | > dual control can use and enable it to  |
| > authorized personnel    | > output a key into another SCD.         |
| > under dual control can  |                                          |
| > use and enable it to    |                                          |
| > output a key into       |                                          |
| > another SCD. Such       |                                          |
| > personnel must ensure   |                                          |
| > that a key- recording   |                                          |
| > device is not inserted  |                                          |
| > between the SCDs.       |                                          |
+---------------------------+------------------------------------------+
|                           | > **13-4.3.b** Verify that both          |
|                           | > authorized personnel involved in       |
|                           | > key-loading activity inspect the       |
|                           | > key-loading device, prior to use to    |
|                           | > ensure that a key-recording device has |
|                           | > not been inserted between the SCDs.    |
+---------------------------+------------------------------------------+
| > **13-4.4** The          | > **13-4.4** Verify the key-loading      |
| > key-loading device must | > device does not retain any information |
| > not retain any          | > that might disclose the key that was   |
| > information that might  | > installed in the device or a key that  |
| > disclose the key (e.g., | > it has successfully transferred. For   |
| > allow replay of the key | > example, attempt to output the same    |
| > for injection into a    | > value more than one time from the      |
| > non-SCD) that was       | > device or cause the device to display  |
| > installed in the device | > check values for its contents both     |
| > or a key that it has    | > before and after injection and         |
| > successfully            | > compare.                               |
| > transferred.            |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **13-5** Any media        | **13-5.a** Interview personnel and       |
| (electronic or otherwise) | observe media locations to verify that   |
| containing secret or      | the media is maintained in a secure      |
| private key components or | location accessible only to custodian(s) |
| shares used for loading   | authorized to access the key components. |
| cryptographic keys must   |                                          |
| be maintained in a secure |                                          |
| location and accessible   |                                          |
| only to authorized        |                                          |
| custodian(s). When        |                                          |
| removed from the secure   |                                          |
| storage location, media   |                                          |
| or devices containing key |                                          |
| components or used for    |                                          |
| the injection of          |                                          |
| clear-text cryptographic  |                                          |
| keys must be in the       |                                          |
| physical possession of    |                                          |
| only the designated       |                                          |
| component holder(s), and  |                                          |
| only for the minimum      |                                          |
| practical time necessary  |                                          |
| to complete the           |                                          |
| key-loading process.      |                                          |
|                           |                                          |
| The media upon which a    |                                          |
| component resides must be |                                          |
| physically safeguarded at |                                          |
| all times when removed    |                                          |
| from secure storage.      |                                          |
|                           |                                          |
| Key components that can   |                                          |
| be read (e.g., those      |                                          |
| printed on paper or       |                                          |
| stored on magnetic cards, |                                          |
| PROMs, or smartcards)     |                                          |
| must be managed so they   |                                          |
| are never used in a       |                                          |
| manner that would result  |                                          |
| in the component being    |                                          |
| displayed in clear-text   |                                          |
| to anyone who is not a    |                                          |
| designated custodian for  |                                          |
| that component.           |                                          |
+---------------------------+------------------------------------------+
|                           | **13-5.b** Examine documented procedures |
|                           | for removing media or devices containing |
|                           | key components---or that are otherwise   |
|                           | used for the injection of cryptographic  |
|                           | keys---from the secure storage location. |
|                           | Verify procedures include the following: |
|                           |                                          |
|                           | -   Requirement that media/devices be in |
|                           |     > the physical possession of only    |
|                           |     > the designated component           |
|                           |     > holder(s).                         |
|                           |                                          |
|                           | -   The media/devices are removed from   |
|                           |     > secure storage only for the        |
|                           |     > minimum practical time necessary   |
|                           |     > to complete the key-loading        |
|                           |     > process.                           |
+---------------------------+------------------------------------------+
|                           | **13-5.c** Interview designated          |
|                           | component holder(s) and examine          |
|                           | key-management logs to verify that media |
|                           | or devices removed from secure storage   |
|                           | are in the physical possession of only   |
|                           | the designated component holder(s).      |
+---------------------------+------------------------------------------+
|                           | **13-5.d** Interview key-injection       |
|                           | personnel and examine logs for the       |
|                           | removal of media/devices from secure     |
|                           | storage to verify they are removed only  |
|                           | for the minimum practical time necessary |
|                           | to complete the key-loading process.     |
+---------------------------+------------------------------------------+
| **13-6** If the component | **13-6** Validate through interview and  |
| is in human-readable form | observation that if components are in    |
| it must be visible only   | human-readable form, they are visible    |
| to the designated         | only to designated component custodians  |
| component custodian and   | and only for the duration of time        |
| only for the duration of  | required for this person to privately    |
| time required for this    | enter the key component into an SCD.     |
| person to privately enter |                                          |
| the key component into an |                                          |
| SCD.                      |                                          |
+---------------------------+------------------------------------------+
| **13-7** Written or       | **13-7.a** Examine documented procedures |
| printed key component     | and confirm that printed/written key     |
| documents must not be     | component documents are not opened until |
| opened until immediately  | immediately prior to use.                |
| prior to use.             |                                          |
+---------------------------+------------------------------------------+
|                           | **13-7.b** Observe key-loading processes |
|                           | and verify that printed/written key      |
|                           | component documents are not opened until |
|                           | immediately prior to use.                |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **13-8** A person with    | **13-8.a** Examine documented procedures |
| access to any component   | for the use of key components to verify  |
| or share of a secret or   | that procedures ensure that any          |
| private key, or to the    | individual custodian only has access to  |
| media conveying this      | their assigned components and never has  |
| value, must not have      | access to sufficient key components to   |
| access to other           | reconstruct a cryptographic key.         |
| components or shares of   |                                          |
| this key or to any other  |                                          |
| medium containing other   |                                          |
| components or shares of   |                                          |
| this key that are         |                                          |
| sufficient to form the    |                                          |
| necessary threshold to    |                                          |
| derive the key.           |                                          |
|                           |                                          |
| *E.g., in an m-of-n       |                                          |
| scheme (which must use a  |                                          |
| recognized secret-sharing |                                          |
| scheme such as Shamir),   |                                          |
| such that any three key   |                                          |
| components or shares      |                                          |
| (i.e., m = 3) can be used |                                          |
| to derive the key, no     |                                          |
| single individual can     |                                          |
| have access to more than  |                                          |
| two components/shares.*   |                                          |
+---------------------------+------------------------------------------+
|                           | **13-8.b** Examine key-component access  |
|                           | controls and access logs to verify that  |
|                           | any single authorized custodian can and  |
|                           | has only had access to their assigned    |
|                           | component(s) and cannot access           |
|                           | sufficient key components to reconstruct |
|                           | a cryptographic key.                     |
+---------------------------+------------------------------------------+
| **13-9** Key-injection    | **13-9** Interview appropriate personnel |
| facilities that use       | and examine documentation to determine   |
| PC-based key- loading     | the procedures for key loading to POIs,  |
| software platforms or     | key-loading devices, and HSMs that are   |
| similar devices (e.g.,    | part of the key-loading platform.        |
| modified PEDs) that allow | Examine any logs of key loading.         |
| clear-text secret and/or  |                                          |
| private keys and/or their |                                          |
| components to exist in    |                                          |
| memory outside the secure |                                          |
| boundary of an SCD must   |                                          |
| minimally implement the   |                                          |
| following additional      |                                          |
| controls:                 |                                          |
|                           |                                          |
| ***Note: Effective 1      |                                          |
| January 2021,** entities  |                                          |
| engaged in key loading on |                                          |
| behalf of others must not |                                          |
| be allowed to use PC      |                                          |
| based key-loading         |                                          |
| methodologies where       |                                          |
| clear-text secret and/or  |                                          |
| private keying material   |                                          |
| appears in the clear in   |                                          |
| memory outside the secure |                                          |
| boundary of an SCD.*      |                                          |
|                           |                                          |
| ***Effective 1 January    |                                          |
| 2023**, entities only     |                                          |
| performing key loading    |                                          |
| for devices for which     |                                          |
| they are the processor    |                                          |
| must no longer have this  |                                          |
| option.*                  |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **13-9.1** PCs and      | > **13-9.1** For facilities using        |
| > similar devices must    | > PC-based key-loading software          |
| > be:                     | > platforms or similar devices, verify   |
|                           | > through interviews and observation     |
| -   Standalone (i.e.,     | > that the platform is:                  |
|     > without modems, not |                                          |
|     > connected to a LAN  | -   Standalone                           |
|     > or WAN, not capable |                                          |
|     > of wireless         | -   Dedicated to only key loading        |
|     > connections, etc.); |                                          |
|                           | -   Located in a physically secure room  |
| -   Dedicated to only the |     > meeting the criteria of            |
|     > key-loading         |     > Requirement 32-9 that is dedicated |
|     > function (e.g.,     |     > to key loading activities          |
|     > there must not be   |                                          |
|     > any other           |                                          |
|     > application         |                                          |
|     > software            |                                          |
|     > installed); and     |                                          |
|                           |                                          |
| -   Located in a          |                                          |
|     > physically secure   |                                          |
|     > room meeting the    |                                          |
|     > criteria of         |                                          |
|     > Requirement 32-9    |                                          |
|     > that is dedicated   |                                          |
|     > to key-loading      |                                          |
|     > activities.         |                                          |
+---------------------------+------------------------------------------+
| > **13-9.2** All hardware | > **13-9.2** Verify through interviews   |
| > used in key loading     | > and observation that:                  |
| > (including the PC) must |                                          |
| > be managed under dual   | -   All hardware used in key loading     |
| > control. Key-injection  |     > (including the PC) is managed      |
| > must not occur unless   |     > under dual control.                |
| > there are minimally two |                                          |
| > individuals in the      | -   Key-injection cannot occur unless    |
| > key-injection room at   |     > there are minimally two            |
| > all times during the    |     > individuals in the key- injection  |
| > process. If a situation |     > room at all times during the       |
| > arises that would cause |     > process. Mechanisms exist (See     |
| > only one person to be   |     > Requirement 32) that do not permit |
| > in the room, all        |     > the room to be occupied by fewer   |
| > individuals must exit   |     > than two authorized individuals.   |
| > until at least two can  |                                          |
| > be inside.              |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **13-9.3** PC access    | > **13-9.3.a** Verify through interviews |
| > and use must be         | > and observation that logs of           |
| > monitored, and logs of  | > key-loading activities are maintained  |
| > all key loading must be | > and meet the following:                |
| > maintained. These logs  |                                          |
| > must be retained for a  | -   Retained for a minimum of three      |
| > minimum of three years. |     > years.                             |
| > The logs must be        |                                          |
| > regularly (no less      | -   Regularly reviewed by an authorized  |
| > frequently than weekly) |     > person who does not have access to |
| > reviewed by an          |     > the room or to the PC.             |
| > authorized person who   |                                          |
| > does not have access to | -   The reviews are documented.          |
| > the room or to the PC.  |                                          |
| > The reviews must be     |                                          |
| > documented. The logs    |                                          |
| > must include but not be |                                          |
| > limited to:             |                                          |
|                           |                                          |
| -   Logs of access to the |                                          |
|     > room from a         |                                          |
|     > badge-access        |                                          |
|     > system;             |                                          |
|                           |                                          |
| -   Logs of access to the |                                          |
|     > room from a manual  |                                          |
|     > sign- in sheet;     |                                          |
|                           |                                          |
| -   User sign-on logs on  |                                          |
|     > the PC at the       |                                          |
|     > operating- system   |                                          |
|     > level;              |                                          |
|                           |                                          |
| -   User sign-on logs on  |                                          |
|     > the PC at the       |                                          |
|     > application level;  |                                          |
|                           |                                          |
| -   Logs of the device    |                                          |
|     > IDs and serial      |                                          |
|     > numbers that are    |                                          |
|     > loaded, along with  |                                          |
|     > the date and time   |                                          |
|     > and the individuals |                                          |
|     > performing the      |                                          |
|     > key-injection;      |                                          |
|                           |                                          |
| -   Video surveillance    |                                          |
|     > logs with a minimum |                                          |
|     > retention period of |                                          |
|     > 45 days.            |                                          |
+---------------------------+------------------------------------------+
|                           | > **13-9.3.b** Verify through interviews |
|                           | > and observation that logs of           |
|                           | > key-loading activities are maintained  |
|                           | > and meet the following:                |
|                           |                                          |
|                           | -   Logs include a minimum of:           |
|                           |                                          |
|                           |     -   Access to the room from a badge  |
|                           |         > access system,                 |
|                           |                                          |
|                           |     -   Access to the room from a manual |
|                           |         > sign-in sheet,                 |
|                           |                                          |
|                           |     -   User sign-on logs on the PC at   |
|                           |         > the operating system level,    |
|                           |                                          |
|                           |     -   User sign-on logs on the PC at   |
|                           |         > the application level,         |
|                           |                                          |
|                           |     -   Logs of the device IDs and       |
|                           |         > serial numbers that are loaded |
|                           |         > along with the date and time   |
|                           |         > and the individuals performing |
|                           |         > the key-injection,             |
|                           |                                          |
|                           |     -   Video surveillance logs with a   |
|                           |         > minimum retention period of 45 |
|                           |         > days.                          |
+---------------------------+------------------------------------------+
| > **13-9.4**              | > **13-9.4** Verify through interviews   |
| > Additionally:           | > and observation that:                  |
+---------------------------+------------------------------------------+
| > **13-9.4.1** Cable      | > **13-9.4.1** Cable attachments and the |
| > attachments and the     | > key-loading device are examined before |
| > key-loading device must | > each use to ensure the equipment is    |
| > be examined before each | > free from tampering.                   |
| > use to ensure the       |                                          |
| > equipment is free from  |                                          |
| > tampering.              |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.2** The        | > **13-9.4.2** The key-loading device is |
| > key-loading device must | > started from a powered-off position    |
| > be started from a       | > every time key- loading activities     |
| > powered-off position    | > occur.                                 |
| > every time key-loading  |                                          |
| > activities occur.       |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.3** The        | > **13-9.4.3** The software application  |
| > software application    | > loads keys without recording any       |
| > must load keys without  | > clear-text values on portable media or |
| > recording any           | > other unsecured devices.               |
| > clear-text values on    |                                          |
| > portable media or other |                                          |
| > unsecured devices.      |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.4** Clear-text | > **13-9.4.4** Clear-text keys are not   |
| > keys must not be stored | > stored except within an SCD.           |
| > except within an SCD.   |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.5** The        | > **13-9.4.5** Personnel responsible for |
| > personnel responsible   | > the systems administration of the PC   |
| > for the systems         | > do not have authorized access into the |
| > administration of the   | > room---i.e., they are escorted by      |
| > PC (e.g., a Windows     | > authorized key-injection               |
| > administrator who       | > personnel---and do not have user IDs   |
| > configures the PC's     | > or passwords/authentication codes to   |
| > user IDs and file       | > operate the key-injection application. |
| > settings, etc.) must    |                                          |
| > not have authorized     |                                          |
| > access into the         |                                          |
| > room---they must be     |                                          |
| > escorted by authorized  |                                          |
| > key-injection           |                                          |
| > personnel---and they    |                                          |
| > must not have user IDs  |                                          |
| > or                      |                                          |
| >                         |                                          |
|  passwords/authentication |                                          |
| > codes to operate the    |                                          |
| > key-injection           |                                          |
| > application.            |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.6** The        | > **13-9.4.6** Key-injection personnel   |
| > key-injection personnel | > do not have system-administration      |
| > must not have           | > capability at either the O/S or the    |
| > system-administration   | > application level on the PC.           |
| > capability at either    |                                          |
| > the O/S or the          |                                          |
| > application level on    |                                          |
| > the PC.                 |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.7** The PC     | > **13-9.4.7** The PC is not able to     |
| > must not be able to     | > boot from external media (e.g., USB    |
| > boot from external      | > devices or CDs). It must boot from the |
| > media (e.g., USB        | > hard drive only.                       |
| > devices or CDs). It     |                                          |
| > must boot from the hard |                                          |
| > drive only.             |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.8**            | > **13-9.4.8** All openings on the PC    |
| > Key-injection           | > that are not used for key-injection    |
| > facilities must cover   | > are covered with security seals that   |
| > all openings on the PC  | > are tamper-evident and serialized. The |
| > that are not used for   | > seals are recorded in a log, and the   |
| > key- injection with     | > log is maintained along with the other |
| > security seals that are | > key-loading logs in a dual-control     |
| > tamper-evident and      | > safe. Verification of the seals must   |
| > serialized. Examples    | > be performed prior to key-loading      |
| > include but are not     | > activities.                            |
| > limited to PCMCIA,      |                                          |
| > network, infrared and   |                                          |
| > modem connections on    |                                          |
| > the PC, and access to   |                                          |
| > the hard drive and      |                                          |
| > memory. The seals must  |                                          |
| > be recorded in a log,   |                                          |
| > and the log must be     |                                          |
| > maintained along with   |                                          |
| > the other key-loading   |                                          |
| > logs in a dual-control  |                                          |
| > safe. Verification of   |                                          |
| > the seals must be       |                                          |
| > performed prior to      |                                          |
| > key-loading activities. |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.9** If the PC  | > **13-9.4.9** If the PC application     |
| > application reads or    | > reads or stores keys (e.g., BDKs or    |
| > stores clear- text key  | > TMKs) from portable electronic media   |
| > components (e.g., BDKs  | > (e.g., smart cards), the media is      |
| > or TMKs) from portable  | > secured as components under dual       |
| > electronic media (e.g., | > control when not in use. The key       |
| > smart cards), the media | > components are manually entered at the |
| > must be secured as      | > start of each key-injection session    |
| > components under dual   | > from components that are maintained    |
| > control when not in     | > under dual control and split           |
| > use. The key components | > knowledge.                             |
| > must be manually        |                                          |
| > entered at the start of |                                          |
| > each key-injection      |                                          |
| > session from components |                                          |
| > that are maintained     |                                          |
| > under dual control and  |                                          |
| > split knowledge.        |                                          |
| >                         |                                          |
| > ***Note:** For DUKPT    |                                          |
| > implementations, the    |                                          |
| > BDK must be loaded from |                                          |
| > components each time    |                                          |
| > and this requires       |                                          |
| > manual tracking of the  |                                          |
| > device ID counter and   |                                          |
| > serial numbers from the |                                          |
| > previous key-loading    |                                          |
| > session. Key-injection  |                                          |
| > facilities with PC      |                                          |
| > applications that       |                                          |
| > require                 |                                          |
| >                         |                                          |
|  passwords/authentication |                                          |
| > codes to be used to     |                                          |
| > initiate decryption of  |                                          |
| > keys on portable        |                                          |
| > electronic media (e.g., |                                          |
| > smart cards) must       |                                          |
| > ensure the              |                                          |
| >                         |                                          |
|  passwords/authentication |                                          |
| > codes are maintained    |                                          |
| > under dual control and  |                                          |
| > split knowledge.*       |                                          |
+---------------------------+------------------------------------------+
| > **13-9.4.10**           | > **13-9.4.10** Manufacturer's default   |
| > Manufacturer's default  | > passwords/authentication codes for     |
| >                         | > PC-based applications are changed.     |
|  passwords/authentication |                                          |
| > codes for PC-based      |                                          |
| > applications must be    |                                          |
| > changed.                |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| > ***Control Objective 4: |                                          |
| > Key loading to HSMs and |                                          |
| > POI devices is handled  |                                          |
| > in a secure manner***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 14:**    |                                          |
| > All hardware and        |                                          |
| > access/authentication   |                                          |
| > mechanisms (e.g.,       |                                          |
| >                         |                                          |
|  passwords/authentication |                                          |
| > codes) used for key     |                                          |
| > loading or the signing  |                                          |
| > of authenticated        |                                          |
| > applications (e.g., for |                                          |
| > "whitelists") must be   |                                          |
| > managed under dual      |                                          |
| > control.*               |                                          |
+---------------------------+------------------------------------------+
| *Key-injection facilities |                                          |
| (or applicable entities   |                                          |
| providing key-management  |                                          |
| services) must ensure     |                                          |
| that the key-injection    |                                          |
| application               |                                          |
| passwords/authentication  |                                          |
| codes and associated user |                                          |
| IDs are managed in such a |                                          |
| way as to enforce dual    |                                          |
| control. Also, the        |                                          |
| hardware used for key-    |                                          |
| injection must be managed |                                          |
| under dual control.       |                                          |
| Vendor default            |                                          |
| passwords/authentication  |                                          |
| codes must be changed.*   |                                          |
+---------------------------+------------------------------------------+
| **14-1** Any hardware and | **14-1.a** Examine documented procedures |
| passwords/authentication  | to verify they require the following:    |
| codes used in the         |                                          |
| key-loading function or   | -   Any hardware used in the key-loading |
| for the signing of        |     > function or for the signing of     |
| authenticated             |     > authenticated applications must be |
| applications must be      |     > controlled and maintained in a     |
| controlled and maintained |     > secure environment under dual      |
| in a secure environment   |     > control.                           |
| under dual control.       |                                          |
| Resources (e.g.,          | -   Any resources (e.g.,                 |
| passwords/authentication  |     > passwords/authentication codes and |
| codes and associated      |     > associated hardware) used in the   |
| hardware) must be managed |     > key-loading function or for the    |
| such that no single       |     > signing of authenticated           |
| individual has the        |     > applications must be controlled    |
| capability to enable key  |     > and managed such that no single    |
| loading of clear-text     |     > individual has the capability to   |
| keys or their components. |     > enable key loading of clear-text   |
| This is not to imply that |     > keys or their components.          |
| individual access         |                                          |
| authentication mechanisms |                                          |
| must be managed under     |                                          |
| dual control.             |                                          |
|                           |                                          |
| ***Note:** Where          |                                          |
| key-loading is performed  |                                          |
| for POI devices, the      |                                          |
| secure environment as     |                                          |
| defined in **Requirement  |                                          |
| 32-9** must additionally  |                                          |
| be met.*                  |                                          |
+---------------------------+------------------------------------------+
|                           | **14-1.b** Observe key-loading           |
|                           | environments and controls to verify the  |
|                           | following:                               |
|                           |                                          |
|                           | -   All hardware used in the key-loading |
|                           |     > function or for the signing of     |
|                           |     > authenticated applications is      |
|                           |     > controlled and maintained in a     |
|                           |     > secure environment under dual      |
|                           |     > control.                           |
|                           |                                          |
|                           | -   All resources (e.g.,                 |
|                           |     > passwords/authentication codes and |
|                           |     > associated hardware) used for      |
|                           |     > key-loading functions and for the  |
|                           |     > signing of authenticated           |
|                           |     > applications are controlled and    |
|                           |     > managed such that no single        |
|                           |     > individual has the capability to   |
|                           |     > enable key loading.                |
+---------------------------+------------------------------------------+
| **14-2** All cable        | **14-2.a** Examine documented procedures |
| attachments over which    | to ensure they require that cable        |
| clear-text keying         | attachments are examined at the          |
| material traverses must   | beginning of an entity's key-activity    |
| be examined at the        | operations (system power                 |
| beginning of an entity's  | on/authorization) or application-signing |
| key activity operations   | operations.                              |
| (system power             |                                          |
| on/authorization) or      |                                          |
| application-signing       |                                          |
| operations to ensure they |                                          |
| have not been tampered    |                                          |
| with or compromised.      |                                          |
+---------------------------+------------------------------------------+
|                           | **14-2.b** Observe key-loading processes |
|                           | to verify that all cable attachments are |
|                           | properly examined at the beginning of an |
|                           | entity's key-activity operations (system |
|                           | power on/authorization) or               |
|                           | application-signing operations.          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | **Testing Procedures**                   |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **14-3** Key-loading      | **14-3.a** Observe key-loading and       |
| equipment usage must be   | application-signing activities to verify |
| monitored, and a log of   | that key-loading equipment usage is      |
| all key-loading and       | monitored.                               |
| application-signing       |                                          |
| activities maintained for |                                          |
| audit purposes must       |                                          |
| contain, at a minimum,    |                                          |
| date, time, personnel     |                                          |
| involved, and the number  |                                          |
| of devices keys are       |                                          |
| loaded to.                |                                          |
+---------------------------+------------------------------------------+
|                           | **14-3.b** Verify logs of all            |
|                           | key-loading and application-signing      |
|                           | activities are maintained and contain    |
|                           | all required information.                |
+---------------------------+------------------------------------------+
| **14-4** Any physical     | **14-4.a** Examine documented procedures |
| tokens (e.g., brass keys  | for the use of physical tokens (e.g.,    |
| or chip cards) used to    | brass keys or chip cards) to enable key  |
| enable key loading or the | loading or the signing of authenticated  |
| signing of authenticated  | applications. Verify procedures require  |
| applications must not be  | that physical tokens must not be in the  |
| in the control or         | control or possession of any one         |
| possession of any one     | individual who could use those tokens to |
| individual who could use  | load secret or private cryptographic     |
| those tokens to load      | keys or sign applications under single   |
| secret or private         | control.                                 |
| cryptographic keys or     |                                          |
| sign applications under   |                                          |
| single control. These     |                                          |
| tokens must be secured in |                                          |
| a manner similar to key   |                                          |
| components, including     |                                          |
| tamper-evident,           |                                          |
| authenticable packaging   |                                          |
| and the use of            |                                          |
| access-control logs for   |                                          |
| when removed or placed    |                                          |
| into secure storage.      |                                          |
+---------------------------+------------------------------------------+
|                           | **14-4.b** Inspect locations and         |
|                           | controls for physical tokens to verify   |
|                           | that tokens used to enable key loading   |
|                           | or the signing of authenticated          |
|                           | applications are not in the control or   |
|                           | possession of any one individual who     |
|                           | could use those tokens to load secret or |
|                           | private cryptographic keys or sign       |
|                           | applications under single control.       |
+---------------------------+------------------------------------------+
|                           | **14-4.c** Examine storage locations for |
|                           | physical tokens to determine adequacy to |
|                           | ensure that only the authorized          |
|                           | custodian(s) can access their specific   |
|                           | tokens.                                  |
+---------------------------+------------------------------------------+
|                           | **14-4.d** Verify that access-control    |
|                           | logs exist and are in use including      |
|                           | notation of tamper- evident,             |
|                           | authenticable bag numbers.               |
+---------------------------+------------------------------------------+
|                           | **14-4.e** Reconcile storage contents to |
|                           | access-control logs.                     |
+---------------------------+------------------------------------------+
| **14-5** Default          | **14-5.a** Verify that documented        |
| passwords/authentication  | procedures require default               |
| codes used to enforce     | passwords/authentication codes used to   |
| dual-control mechanisms   | enforce dual-control mechanisms are      |
| must be changed, and      | changed.                                 |
| documented procedures     |                                          |
| must exist to require     |                                          |
| that these password/PINs  |                                          |
| be changed when assigned  |                                          |
| personnel change.         |                                          |
+---------------------------+------------------------------------------+
|                           | **14-5.b** Verify that documented        |
|                           | procedures exist to require that these   |
|                           | passwords/authentication codes be        |
|                           | changed when assigned personnel change.  |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| > ***Control Objective 4: |                                          |
| > Key loading to HSMs and |                                          |
| > POI devices is handled  |                                          |
| > in a secure manner***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 15:** The  |                                          |
| loading of keys or key    |                                          |
| components must           |                                          |
| incorporate a validation  |                                          |
| mechanism such that the   |                                          |
| authenticity of the keys  |                                          |
| is ensured and it can be  |                                          |
| ascertained that they     |                                          |
| have not been tampered    |                                          |
| with, substituted, or     |                                          |
| compromised.*             |                                          |
+---------------------------+------------------------------------------+
| **15-1** A                | **15-1.a** Examine documented procedures |
| cryptographic-based       | to verify a cryptographic-based          |
| validation mechanism must | validation mechanism is in place to      |
| be in place to ensure the | ensure the authenticity and integrity of |
| authenticity and          | keys and/or components.                  |
| integrity of keys and/or  |                                          |
| their components (e.g.,   |                                          |
| testing key-check values, |                                          |
| hashes, or other similar  |                                          |
| unique values that are    |                                          |
| based upon the keys or    |                                          |
| key components being      |                                          |
| loaded). See *ISO 11568*. |                                          |
| Where check values are    |                                          |
| used, recorded, or        |                                          |
| displayed key-component   |                                          |
| check values and          |                                          |
| key-check values must be  |                                          |
| generated by a            |                                          |
| cryptographic process     |                                          |
| such that all portions of |                                          |
| the key or key component  |                                          |
| are involved in           |                                          |
| generating the check      |                                          |
| value. The check value    |                                          |
| must be in accordance     |                                          |
| with the following note.  |                                          |
|                           |                                          |
| ***Note:** Check values   |                                          |
| may be computed by two    |                                          |
| methods. TDEA may use     |                                          |
| either method. AES must   |                                          |
| only use the CMAC method. |                                          |
| In the first method,      |                                          |
| check values are computed |                                          |
| by encrypting an all      |                                          |
| binary zeros block using  |                                          |
| the key or component as   |                                          |
| the encryption key, using |                                          |
| the leftmost n-bits of    |                                          |
| the result; where n is at |                                          |
| most 24 bits (6           |                                          |
| hexadecimal digits/3      |                                          |
| bytes). In the second     |                                          |
| method the KCV is         |                                          |
| calculated by MACing an   |                                          |
| all binary zeros block    |                                          |
| using the CMAC algorithm  |                                          |
| as specified in* ISO      |                                          |
| 9797-1 *(see also* NIST   |                                          |
| SP 800-38B*). The check   |                                          |
| value will be the         |                                          |
| leftmost n-bits of the    |                                          |
| result, where n is at     |                                          |
| most 40 bits (10          |                                          |
| hexadecimal digits). The  |                                          |
| block cipher used in the  |                                          |
| CMAC function is the same |                                          |
| as the block cipher of    |                                          |
| the key itself. A TDEA    |                                          |
| key or a component of a   |                                          |
| TDEA key will be MACed    |                                          |
| using the TDEA block      |                                          |
| cipher, while a 128-bit   |                                          |
| AES key or component will |                                          |
| be MACed using the        |                                          |
| AES-128 block cipher.*    |                                          |
+---------------------------+------------------------------------------+
|                           | **15-1.b** Observe the key-loading       |
|                           | processes to verify that the defined     |
|                           | cryptographic-based validation mechanism |
|                           | used to ensure the authenticity and      |
|                           | integrity of keys and components is      |
|                           | being used and is verified by the        |
|                           | applicable key custodians.               |
+---------------------------+------------------------------------------+
|                           | **15-1.c** Verify that the methods used  |
|                           | for key validation are consistent with   |
|                           | *ISO 11568*---e.g., when check values    |
|                           | are used, they are in accordance with    |
|                           | this requirement.                        |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 4:   |                                          |
| Key loading to HSMs and   |                                          |
| POI devices is handled in |                                          |
| a secure manner***        |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **15-2** The public key   | **15-2.a** Interview personnel and       |
| must have its             | review documented procedures to verify   |
| authenticity and          | that all public keys exist only in an    |
| integrity ensured. In     | approved form.                           |
| order to ensure           |                                          |
| authenticity and          |                                          |
| integrity, a public key   |                                          |
| must be encrypted in      |                                          |
| accordance with Annex C,  |                                          |
| or if in plaintext form,  |                                          |
| must:                     |                                          |
|                           |                                          |
| -   Be within a           |                                          |
|     > certificate as      |                                          |
|     > defined in          |                                          |
|     > applicable          |                                          |
|     > requirements within |                                          |
|     > this Domain; or     |                                          |
|                           |                                          |
| -   Be within a PKCS#10   |                                          |
|     > (authentication and |                                          |
|     > integrity occurs    |                                          |
|     > via other           |                                          |
|     > mechanisms); or     |                                          |
|                           |                                          |
| -   Be within an SCD; or  |                                          |
|                           |                                          |
| -   Have a MAC (message   |                                          |
|     > authentication      |                                          |
|     > code) created using |                                          |
|     > the algorithm       |                                          |
|     > defined in *ISO     |                                          |
|     > 16609.*             |                                          |
+---------------------------+------------------------------------------+
|                           | **15-2.b** Observe public-key stores and |
|                           | mechanisms to verify that public keys    |
|                           | exist only in an approved form.          |
+---------------------------+------------------------------------------+
| **15-3** Mechanisms must  | **15-3.a** Examine documented procedures |
| exist to prevent a        | to confirm they define procedures for    |
| non-authorized KDH from   | mutual authentication of the sending and |
| performing key transport, | receiving devices, as follows:           |
| key exchange, or key      |                                          |
| establishment with POIs.  | -   POI devices must validate            |
| POIs and key-distribution |     > authentication credentials of KDHs |
| hosts (KDHs) using        |     > prior to any key transport,        |
| public-key schemes must   |     > exchange, or establishment with    |
| validate authentication   |     > that device.                       |
| credentials of other such |                                          |
| devices involved in the   | -   KDHs must validate authentication    |
| communication immediately |     > credentials of POIs prior to any   |
| prior to any key          |     > key transport, exchange, or        |
| transport, exchange, or   |     > establishment with that device.    |
| establishment.            |                                          |
|                           |                                          |
| Mutual authentication of  |                                          |
| the sending and receiving |                                          |
| devices must be           |                                          |
| performed.                |                                          |
|                           |                                          |
| ***Note:** Examples of    |                                          |
| this kind of validation   |                                          |
| include ensuring the SCD  |                                          |
| serial number is listed   |                                          |
| in a table of "permitted" |                                          |
| devices, checking current |                                          |
| certificate revocation    |                                          |
| lists or embedding valid  |                                          |
| authorized KDH            |                                          |
| certificates in devices   |                                          |
| and disallowing           |                                          |
| communication with        |                                          |
| unauthorized KDHs, as     |                                          |
| delineated by techniques  |                                          |
| defined in the Technical  |                                          |
| FAQs for PCI PTS POI      |                                          |
| Security Requirements.*   |                                          |
+---------------------------+------------------------------------------+
|                           | **15-3.b** Interview applicable          |
|                           | personnel to verify that mutual          |
|                           | authentication of the sending and        |
|                           | receiving devices is performed, as       |
|                           | follows:                                 |
|                           |                                          |
|                           | -   POI devices validate authentication  |
|                           |     > credentials of KDHs immediately    |
|                           |     > prior to any key transport,        |
|                           |     > exchange, or establishment with    |
|                           |     > that device.                       |
|                           |                                          |
|                           | -   KDHs validate authentication         |
|                           |     > credentials of POIs immediately    |
|                           |     > prior to any key transport,        |
|                           |     > exchange, or establishment with    |
|                           |     > that device.                       |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| > ***Control Objective 4: |                                          |
| > Key loading to HSMs and |                                          |
| > POI devices is handled  |                                          |
| > in a secure manner***   |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **15-4**                  | > **15-4** Examine system and process    |
| Key-establishment and     | > documentation to verify that           |
| distribution procedures   | > key-establishment and distribution     |
| must be designed such     | > procedures are designed such that:     |
| that:                     |                                          |
|                           | -   There are no means available in the  |
| -   Within an             |     > implementation design for          |
|     > implementation      |     > "man-in-the-middle" attacks.       |
|     > design, there must  |                                          |
|     > be no means         | -   System implementations are designed  |
|     > available for       |     > to prevent replay attacks.         |
|     > "man-in-the-middle" |                                          |
|     > attacks--- e.g.,    |                                          |
|     > through binding of  |                                          |
|     > the KDH certificate |                                          |
|     > upon the initial    |                                          |
|     > communication.      |                                          |
|                           |                                          |
| -   System                |                                          |
|     > implementations     |                                          |
|     > must be designed    |                                          |
|     > and implemented to  |                                          |
|     > prevent replay      |                                          |
|     > attacks---e.g.,     |                                          |
|     > through the use of  |                                          |
|     > random nonces and   |                                          |
|     > time stamps as      |                                          |
|     > noted in *ANSI      |                                          |
|     > TR-34*.             |                                          |
+---------------------------+------------------------------------------+
| **15-5** Key pairs        | > **15-5** If key pairs are generated    |
| generated external to the | > external to the device that uses the   |
| device that uses the key  | > key pair, perform the following:       |
| pair must be securely     |                                          |
| transferred and loaded    | -   Examine documented procedures to     |
| into the device and must  |     > verify that controls are defined   |
| provide for key           |     > to ensure the secrecy of private   |
| protection in accordance  |     > keys and the integrity of public   |
| with this document. That  |     > keys during key transfer and       |
| is, the secrecy of the    |     > loading.                           |
| private key and the       |                                          |
| integrity of the public   | -   Observe key transfer and loading     |
| key must be ensured. The  |     > operations to verify that the      |
| process must ensure that  |     > secrecy of private keys and the    |
| once keys are injected,   |     > integrity of the public keys are   |
| they are no longer        |     > ensured.                           |
| available for injection   |                                          |
| into other POI            | -   Verify the process ensures that key  |
| devices---i.e., key pairs |     > pairs are unique per POI device.   |
| are unique per POI        |                                          |
| device.                   |                                          |
+---------------------------+------------------------------------------+
| > ***Requirement 16:**    |                                          |
| > Documented procedures   |                                          |
| > must exist and be       |                                          |
| > demonstrably in use     |                                          |
| > (including audit        |                                          |
| > trails) for all         |                                          |
| > key-loading             |                                          |
| > activities.*            |                                          |
+---------------------------+------------------------------------------+
| **16-1** Documented       | > **16-1.a** Verify documented           |
| key-loading procedures    | > procedures exist for all key-loading   |
| must exist for all        | > operations.                            |
| devices (e.g., HSMs and   |                                          |
| POI devices), and all     |                                          |
| parties involved in       |                                          |
| cryptographic key loading |                                          |
| must be aware of those    |                                          |
| procedures.               |                                          |
+---------------------------+------------------------------------------+
|                           | > **16-1.b** Interview responsible       |
|                           | > personnel to verify that the           |
|                           | > documented procedures are known and    |
|                           | > understood by all affected parties for |
|                           | > all key-loading operations.            |
+---------------------------+------------------------------------------+
|                           | > **16-1.c** Observe the key-loading     |
|                           | > process for keys loaded as components  |
|                           | > and verify that the documented         |
|                           | > procedures are demonstrably in use.    |
|                           | > This may be done as necessary on test  |
|                           | > equipment---e.g., for HSMs.            |
+---------------------------+------------------------------------------+
| **16-2** All key-loading  | > **16-2** Examine log files and observe |
| events must be            | > logging processes to verify that audit |
| documented. Audit trails  | > trails are in place for all            |
| must be in place for all  | > key-loading events.                    |
| key-loading events.       |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| []{#_bookmark61           |                                          |
| .anchor}***Control        |                                          |
| Objective 5: Keys are     |                                          |
| used in a manner that     |                                          |
| prevents or detects their |                                          |
| unauthorized usage***     |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 17:**      |                                          |
| Unique, secret            |                                          |
| cryptographic keys must   |                                          |
| be in use for each        |                                          |
| identifiable link between |                                          |
| host computer systems of  |                                          |
| two organizations or      |                                          |
| logically separate        |                                          |
| systems within the same   |                                          |
| organization.*            |                                          |
+---------------------------+------------------------------------------+
| 1.  Where two             | > **17-1.a** Examine the documented key  |
|     organizations or      | > matrix and operational procedures and  |
|     logically separate    | > interview personnel to determine       |
|     systems share a key   | > whether any keys are shared between    |
|     to encrypt account    | > organizations or logically separate    |
|     data (including a     | > systems.                               |
|     key-encipherment key  |                                          |
|     used to encrypt a     |                                          |
|     data-encryption key)  |                                          |
|     communicated between  |                                          |
|     them, that key must:  |                                          |
|                           |                                          |
|     -   Be unique to      |                                          |
|         > those two       |                                          |
|         > entities or     |                                          |
|         > logically       |                                          |
|         > separate        |                                          |
|         > systems         |                                          |
|                           |                                          |
| > And,                    |                                          |
|                           |                                          |
| -   Not be given to any   |                                          |
|     > other entity or     |                                          |
|     > logically separate  |                                          |
|     > systems.            |                                          |
|                           |                                          |
| ***Note:** This           |                                          |
| requirement does not      |                                          |
| apply after the           |                                          |
| decryption environment.*  |                                          |
+---------------------------+------------------------------------------+
|                           | > **17-1.b** For all keys shared between |
|                           | > two organizations or logically         |
|                           | > separate systems for encrypting        |
|                           | > account data (including key-encryption |
|                           | > keys used to encrypt a data-encryption |
|                           | > key) perform the following:            |
|                           |                                          |
|                           | -   Generate or otherwise obtain         |
|                           |     > key-check values for any           |
|                           |     > key-encipherment keys (KEKs) to    |
|                           |     > verify key uniqueness between the  |
|                           |     > two organizations. A random sample |
|                           |     > may be used where more than 10     |
|                           |     > zone connections are in use. This  |
|                           |     > is not intended to be based on     |
|                           |     > values retained on paper or        |
|                           |     > otherwise sent as part of the      |
|                           |     > original conveyance of the keying  |
|                           |     > material, but rather on values     |
|                           |     > generated from stored zone         |
|                           |     > production keys from the           |
|                           |     > production host database.          |
|                           |     > Cryptograms may be used for this   |
|                           |     > purpose if it is verified that the |
|                           |     > same MFK variant is used to        |
|                           |     > encrypt the KEKs.                  |
|                           |                                          |
|                           | -   If a remote key-establishment and    |
|                           |     > distribution scheme is implemented |
|                           |     > between networks, examine public   |
|                           |     > keys and/or hash values and/or     |
|                           |     > fingerprints of the keys to verify |
|                           |     > key uniqueness of the              |
|                           |     > asymmetric-key pairs.              |
|                           |                                          |
|                           | -   Compare key-check values against     |
|                           |     > those for known or default keys to |
|                           |     > verify that known or default key   |
|                           |     > values are not used.               |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 18:**      |                                          |
| Procedures must exist to  |                                          |
| prevent or detect the     |                                          |
| unauthorized substitution |                                          |
| (unauthorized key         |                                          |
| replacement and key       |                                          |
| misuse) of one key for    |                                          |
| another key or the        |                                          |
| operation of any          |                                          |
| cryptographic device      |                                          |
| without legitimate keys.* |                                          |
+---------------------------+------------------------------------------+
| **18-1** Synchronization  | > **18-1.a** Verify procedures have been |
| errors must be monitored  | > implemented for monitoring and         |
| to help reduce the risk   | > alerting to the presence of multiple   |
| of an adversary's         | > cryptographic synchronization errors.  |
| substituting a key known  |                                          |
| only to them. Procedures  |                                          |
| must exist and be         |                                          |
| followed for              |                                          |
| investigating repeated    |                                          |
| synchronization errors    |                                          |
| for online processes such |                                          |
| as online key exchanges   |                                          |
| or transmission or        |                                          |
| processing of             |                                          |
| transactions.             |                                          |
|                           |                                          |
| ***Note:** Multiple       |                                          |
| synchronization errors    |                                          |
| may be caused by the      |                                          |
| unauthorized replacement  |                                          |
| or substitution of one    |                                          |
| stored key for another,   |                                          |
| or the replacement or     |                                          |
| substitution of any       |                                          |
| portion of a TDEA key,    |                                          |
| whether encrypted or      |                                          |
| unencrypted.*             |                                          |
+---------------------------+------------------------------------------+
|                           | > **18-1.b** Verify that implemented     |
|                           | > procedures include:                    |
|                           |                                          |
|                           | -   Specific actions that determine      |
|                           |     > whether the legitimate value of    |
|                           |     > the cryptographic key has changed. |
|                           |     > (For example, encryption of a      |
|                           |     > known value to determine whether   |
|                           |     > the resulting cryptogram matches   |
|                           |     > the expected result.)              |
|                           |                                          |
|                           | -   Proactive safeguards that shut down  |
|                           |     > the source of any synchronization  |
|                           |     > errors and start an investigative  |
|                           |     > process to determine the true      |
|                           |     > cause of the event.                |
+---------------------------+------------------------------------------+
| **18-2** To prevent or    | > **18-2.a** Verify that documented      |
| detect usage of a         | > procedures require that key-component  |
| compromised key,          | > packaging/containers showing signs of  |
| key-component packaging   | > tampering indicating a component was   |
| or containers that show   | > potentially compromised are assessed   |
| signs of tampering        | > and the analysis is formally           |
| indicating a component    | > documented. If compromise is           |
| was potentially           | > confirmed, and the result is that one  |
| compromised must be       | > person could have knowledge of the     |
| assessed and the analysis | > key, it must result in the discarding  |
| formally documented. If   | > and invalidation of all associated key |
| compromise is confirmed,  | > components and the resultant           |
| and the result is that    | > cryptographic key(s) at all locations  |
| one person could have     | > where they exist.                      |
| knowledge of the key, it  |                                          |
| must result in the        |                                          |
| discarding and            |                                          |
| invalidation of the       |                                          |
| component and the         |                                          |
| associated key at all     |                                          |
| locations where they      |                                          |
| exist.                    |                                          |
+---------------------------+------------------------------------------+
|                           | > **18-2.b** Interview personnel and     |
|                           | > observe processes to verify procedures |
|                           | > are implemented to require that        |
|                           | > key-component packaging/containers     |
|                           | > showing signs of tampering indicating  |
|                           | > a component was potentially            |
|                           | > compromised are assessed and the       |
|                           | > analysis is formally documented. If    |
|                           | > compromise is confirmed, and the       |
|                           | > result is that one person could have   |
|                           | > knowledge of the key, it results in    |
|                           | > the discarding and invalidation of all |
|                           | > associated key components and the      |
|                           | > resultant cryptographic key(s) at all  |
|                           | > locations where they exist.            |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **18-3** Encrypted        | **18-3** Using the cryptographic-key     |
| symmetric keys must be    | summary to identify secret keys conveyed |
| managed in structures     | or stored, examine documented procedures |
| called key blocks. The    | and observe key operations to verify     |
| key usage must be         | that secret cryptographic keys are       |
| cryptographically bound   | managed as key blocks using mechanisms   |
| to the key using accepted | that cryptographically bind the key      |
| methods                   | usage to the key at all times via one of |
|                           | the acceptable methods or an equivalent. |
| The phased implementation |                                          |
| dates are as follows:     | Where key blocks are not implemented,    |
|                           | identify and examine project plans to    |
| -   **Phase 1 --**        | implement in accordance with the         |
|     > Implement Key       | prescribed timeline.                     |
|     > Blocks for internal |                                          |
|     > connections and key |                                          |
|     > storage within      |                                          |
|     > Service Provider    |                                          |
|     > Environments --     |                                          |
|     > this would include  |                                          |
|     > all applications    |                                          |
|     > and databases       |                                          |
|     > connected to        |                                          |
|     > hardware security   |                                          |
|     > modules (HSM).      |                                          |
|     > Effective date: **1 |                                          |
|     > June 2019 (past).** |                                          |
|                           |                                          |
| -   **Phase 2** --        |                                          |
|     > Implement Key       |                                          |
|     > Blocks for external |                                          |
|     > connections to      |                                          |
|     > Associations and    |                                          |
|     > Networks. Effective |                                          |
|     > date: **1 January   |                                          |
|     > 2023.**             |                                          |
|                           |                                          |
| -   **Phase 3** --        |                                          |
|     > Implement Key Block |                                          |
|     > to extend to all    |                                          |
|     > merchant hosts,     |                                          |
|     > point-of-sale (POS) |                                          |
|     > devices and ATMs.   |                                          |
|     > Effective date: **1 |                                          |
|     > January 2025**.     |                                          |
|                           |                                          |
| Acceptable methods of     |                                          |
| implementing the          |                                          |
| integrity requirements    |                                          |
| include, but are not      |                                          |
| limited to:               |                                          |
|                           |                                          |
| -   A MAC computed over   |                                          |
|     > the concatenation   |                                          |
|     > of the clear- text  |                                          |
|     > attributes and the  |                                          |
|     > enciphered portion  |                                          |
|     > of the key block,   |                                          |
|     > which includes the  |                                          |
|     > key itselfe.g.,    |                                          |
|     > TR-31;              |                                          |
|                           |                                          |
| -   A digital signature   |                                          |
|     > computed over that  |                                          |
|     > same data, e.g.,    |                                          |
|     > TR-34;              |                                          |
|                           |                                          |
| ```{=html}                |                                          |
| <!-- -->                  |                                          |
| ```                       |                                          |
| -   An integrity check    |                                          |
|     > that is an implicit |                                          |
|     > part of the key-    |                                          |
|     > encryption process  |                                          |
|     > such as that which  |                                          |
|     > is used in the AES  |                                          |
|     > key-wrap process    |                                          |
|     > specified in *ANSI  |                                          |
|     > X9.102*.            |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **18-4** POI devices must | **18-4.a** Examine documented procedures |
| only communicate with a   | to verify that:                          |
| Certification Authority   |                                          |
| (CA) for the purpose of   | -   POI devices only communicate with    |
| certificate signing (or   |     > CAs for the purpose of certificate |
| for key injection where   |     > signing, or for key injection      |
| the certificate-issuing   |     > where the certificate-issuing      |
| authority generates the   |     > authority generates the key pair   |
| key pair on behalf of the |     > on behalf of the device;           |
| POI); and with KDHs for   |                                          |
| key management, normal    | -   POI devices only communicate with    |
| transaction processing,   |     > KDHs for key management, normal    |
| and certificate (entity)  |     > transaction processing, and        |
| status checking.          |     > certificate (entity) status        |
|                           |     > checking.                          |
+---------------------------+------------------------------------------+
|                           | **18-4.b** Interview responsible         |
|                           | personnel and observe POI configurations |
|                           | to verify that:                          |
|                           |                                          |
|                           | -   POI devices only communicate with    |
|                           |     > CAs for the purpose of certificate |
|                           |     > signing, or for key-injection      |
|                           |     > where the certificate issuing      |
|                           |     > authority generates the key pair   |
|                           |     > on behalf of the device;           |
|                           |                                          |
|                           | -   POI devices only communicate with    |
|                           |     > KDHs or key management, normal     |
|                           |     > transaction processing, and        |
|                           |     > certificate (entity) status        |
|                           |     > checking.                          |
+---------------------------+------------------------------------------+
| **18-5** KDHs must only   | **18-5.a** Examine documented procedures |
| communicate with POI      | to verify that:                          |
| devices for the purpose   |                                          |
| of key management and     | -   KDHs only communicate with POI       |
| normal transaction        |     > devices for the purpose of key     |
| processing, and with CAs  |     > management and normal transaction  |
| for the purpose of        |     > processing;                        |
| certificate signing and   |                                          |
| certificate (entity)      | -   KDHs only to communicate with CAs    |
| status checking.          |     > for the purpose of certificate     |
|                           |     > signing and certificate (entity)   |
|                           |     > status checking.                   |
+---------------------------+------------------------------------------+
|                           | **18-5.b** Interview responsible         |
|                           | personnel and observe KDH configurations |
|                           | to verify that:                          |
|                           |                                          |
|                           | -   KDHs only communicate with POIs for  |
|                           |     > the purpose of key management and  |
|                           |     > normal transaction processing;     |
|                           |                                          |
|                           | -   KDHs only communicate with CAs for   |
|                           |     > the purpose of certificate signing |
|                           |     > and certificate (entity) status    |
|                           |     > checking.                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **18-6** Controls must be | **18-6.a** Examine documented            |
| in place to prevent and   | key-injection procedures to verify that  |
| detect the loading of     | controls are defined to prevent and      |
| unencrypted private and   | detect the loading of keys by any one    |
| secret keys or their      | single person.                           |
| components by any one     |                                          |
| single person.            |                                          |
|                           |                                          |
| ***Note:** Controls       |                                          |
| include physical access   |                                          |
| to the room, logical      |                                          |
| access to the key-loading |                                          |
| application, video        |                                          |
| surveillance of           |                                          |
| activities in the         |                                          |
| key-injection room,       |                                          |
| physical access to secret |                                          |
| or private cryptographic  |                                          |
| key components or shares, |                                          |
| etc.*                     |                                          |
+---------------------------+------------------------------------------+
|                           | **18-6.b** Interview responsible         |
|                           | personnel and observe key-loading        |
|                           | processes and controls to verify that    |
|                           | controls---e.g., viewing CCTV            |
|                           | images---are implemented to prevent and  |
|                           | detect the loading of keys by any one    |
|                           | single person.                           |
+---------------------------+------------------------------------------+
| **18-7** Key-injection    | **18-7.a** Examine documented procedures |
| facilities must implement | to verify they include:                  |
| controls to protect       |                                          |
| against the unauthorized  | -   Controls to protect against          |
| substitution of keys and  |     > unauthorized substitution of keys, |
| to prevent the operation  |     > and                                |
| of devices without        |                                          |
| legitimate keys.          | -   Controls to prevent the operation of |
|                           |     > devices without legitimate keys.   |
| Examples include but are  |                                          |
| not limited to:           |                                          |
|                           |                                          |
| -   All devices loaded    |                                          |
|     > with keys must be   |                                          |
|     > tracked at each     |                                          |
|     > key-loading session |                                          |
|     > by serial number.   |                                          |
|                           |                                          |
| -   Key-injection         |                                          |
|     > facilities must use |                                          |
|     > something unique    |                                          |
|     > about the POI       |                                          |
|     > (e.g., logical      |                                          |
|     > identifiers) when   |                                          |
|     > deriving the key    |                                          |
|     > (e.g., DUKPT, TMK)  |                                          |
|     > injected into it    |                                          |
+---------------------------+------------------------------------------+
|                           | **18-7.b** Interview responsible         |
|                           | personnel and observe key-loading        |
|                           | processes and controls to verify that:   |
|                           |                                          |
|                           | -   Controls are implemented that        |
|                           |     > protect against unauthorized       |
|                           |     > substitution of keys, and          |
|                           |                                          |
|                           | -   Controls are implemented that        |
|                           |     > prevent the operation of devices   |
|                           |     > without legitimate keys.           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***Requirement 19:**      |                                          |
| Cryptographic keys must   |                                          |
| be used only for their    |                                          |
| sole intended purpose and |                                          |
| must never be shared      |                                          |
| between production and    |                                          |
| test systems.*            |                                          |
+---------------------------+------------------------------------------+
| -   *Where test keys are  |                                          |
|     > used, key-injection |                                          |
|     > facilities (or      |                                          |
|     > applicable entities |                                          |
|     > providing           |                                          |
|     > key-management      |                                          |
|     > services) must use  |                                          |
|     > a separate test     |                                          |
|     > system for the      |                                          |
|     > injection of test   |                                          |
|     > keys.*              |                                          |
|                           |                                          |
| -   *Test keys must not   |                                          |
|     > be injected using   |                                          |
|     > the production      |                                          |
|     > platform, and test  |                                          |
|     > keys must not be    |                                          |
|     > injected into       |                                          |
|     > production          |                                          |
|     > equipment.*         |                                          |
|                           |                                          |
| -   *Production keys must |                                          |
|     > not be injected     |                                          |
|     > using a test        |                                          |
|     > platform, and       |                                          |
|     > production keys     |                                          |
|     > must not be         |                                          |
|     > injected into       |                                          |
|     > equipment that is   |                                          |
|     > to be used for      |                                          |
|     > testing purposes.*  |                                          |
|                           |                                          |
| -   *Keys used for        |                                          |
|     > signing of test     |                                          |
|     > certificates must   |                                          |
|     > be test keys.*      |                                          |
|                           |                                          |
| -   *Keys used for        |                                          |
|     > signing of          |                                          |
|     > production          |                                          |
|     > certificates must   |                                          |
|     > be production       |                                          |
|     > keys.*              |                                          |
+---------------------------+------------------------------------------+
| **19-1** Encryption keys  | > **19-1.a** Examine key-management      |
| must only be used for the | > documentation (e.g., the               |
| purpose they were         | > cryptographic-key inventory) and       |
| intendedi.e.,            | > interview key custodians and           |
| key-encryption keys must  | > key-management supervisory personnel   |
| not be used as            | > to verify that cryptographic keys are  |
| PIN-encryption keys,      | > defined for a specific purpose.        |
| PIN-encryption keys must  |                                          |
| not be used for           |                                          |
| account-data, etc.        |                                          |
| Derivation Keys may be    |                                          |
| derived into multiple     |                                          |
| keys, each with its own   |                                          |
| purpose. For example, a   |                                          |
| DUKPT Initial Key may be  |                                          |
| used to derive both a PIN |                                          |
| encryption key and a data |                                          |
| encryption key. The       |                                          |
| derivation key would only |                                          |
| be used for its own       |                                          |
| purpose, key derivation.  |                                          |
| This is necessary to      |                                          |
| limit the magnitude of    |                                          |
| exposure should any       |                                          |
| key(s) be compromised.    |                                          |
| Using keys only as they   |                                          |
| are intended also         |                                          |
| significantly strengthens |                                          |
| the security of the       |                                          |
| underlying system.        |                                          |
+---------------------------+------------------------------------------+
|                           | > **19-1.b** Using a sample of device    |
|                           | > types, validate via examination of     |
|                           | > check values, terminal definition      |
|                           | > files, etc. that keys used for key     |
|                           | > encipherment or PIN encipherment are   |
|                           | > not used for any other purpose.        |
+---------------------------+------------------------------------------+
| **19-2** Private keys:    | > **19-2** Examine key-management        |
|                           | > documentation and interview key        |
| -   Must be used only for | > custodians and key- management         |
|     > a single            | > supervisory personnel to verify that   |
|     > purpose---a private | > private keys are :                     |
|     > key must only be    |                                          |
|     > used for either     | -   Used only to create digital          |
|     > decryption or for   |     > signatures or to perform           |
|     > creating digital    |     > decryption operations.             |
|     > signatures, but not |                                          |
|     > both (except for    | -   Used only for a single purpose---a   |
|     > transaction-        |     > private key must only be used for  |
|     > originating POI     |     > either decryption or for creating  |
|     > devices).           |     > digital signatures, but not both.  |
|                           |                                          |
| -   Must never be used to | -   Never used to encrypt other keys.    |
|     > encrypt other keys. |                                          |
|                           | -   Not used in connection with any      |
| -   When used for remote  |     > other purpose when used for remote |
|     > key distribution,   |     > key distribution.                  |
|     > must not be used in |                                          |
|     > connection with any |                                          |
|     > other purpose.      |                                          |
|                           |                                          |
| ***Note:** The            |                                          |
| restriction does not      |                                          |
| apply to certificate      |                                          |
| signing requests e.g.,    |                                          |
| PKCS #10.*                |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **19-3** Public keys must | **19-3** Examine key-management          |
| only be used for a single | documentation and interview key          |
| purpose--- a public key   | custodian and key- management            |
| must only be used for     | supervisory personnel to verify that     |
| either encryption or for  | public keys are only used:               |
| verifying digital         |                                          |
| signatures, but not both  | -   To perform encryption operations or  |
| (except for               |     > to verify digital signatures.      |
| transaction-originating   |                                          |
| POI devices).             | -   For a single purpose---a public key  |
|                           |     > must only be used for either       |
|                           |     > encryption or for verifying        |
|                           |     > digital signatures, but not both   |
|                           |     > (except for POI devices).          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **19-4** Keys must never  | **19-4.a** Examine key-management        |
| be shared or substituted  | documentation and interview key          |
| between production and    | custodians and key- management           |
| test/development systems. | supervisory personnel to verify that     |
|                           | cryptographic keys are never shared or   |
| -   Keys used for         | substituted between production and       |
|     > production must     | test/development systems.                |
|     > never be present or |                                          |
|     > used in a           |                                          |
|     > test/development    |                                          |
|     > system, and         |                                          |
|                           |                                          |
| -   Keys used for testing |                                          |
|     > must never be       |                                          |
|     > present or used in  |                                          |
|     > a production        |                                          |
|     > system.             |                                          |
|                           |                                          |
| ***Note:** For logically  |                                          |
| partitioned HSMs and      |                                          |
| computing platforms, if   |                                          |
| one or more logical       |                                          |
| partitions of a physical  |                                          |
| device are used for       |                                          |
| production and one or     |                                          |
| more other logical        |                                          |
| partitions are used for   |                                          |
| testing, including QA or  |                                          |
| similar, the entire       |                                          |
| configuration that is     |                                          |
| impacted--- computing     |                                          |
| platform(s) and           |                                          |
| networking                |                                          |
| equipment---must be       |                                          |
| managed and controlled as |                                          |
| production.*              |                                          |
+---------------------------+------------------------------------------+
|                           | **19-4.b** Observe processes for         |
|                           | generating and loading keys into         |
|                           | production systems to ensure that they   |
|                           | are in no way associated with test or    |
|                           | development keys.                        |
+---------------------------+------------------------------------------+
|                           | **19-4.c** Observe processes for         |
|                           | generating and loading keys into test    |
|                           | systems to ensure that they are in no    |
|                           | way associated with production keys.     |
+---------------------------+------------------------------------------+
|                           | **19-4.d** Compare check, hash,          |
|                           | cryptogram, or fingerprint values for    |
|                           | production and test/development keys     |
|                           | with higher-level keys (MFKs, KEKs       |
|                           | shared with other network nodes, and     |
|                           | BDKs) to verify that development and     |
|                           | test keys have different key values.     |
+---------------------------+------------------------------------------+
| **19-5** If a business    | **19-5** Interview personnel to          |
| rationale exists, a       | determine whether production platforms   |
| production platform (HSM  | are ever temporarily used for test       |
| and server/standalone     | purposes.                                |
| computer) may be          |                                          |
| temporarily used for test | If they are, verify that documented      |
| purposes. However, all    | procedures require that:                 |
| keying material must be   |                                          |
| deleted from the HSM(s)   | -   All keying material is deleted from  |
| and the server/computer   |     > the HSM(s) and the server          |
| platforms prior to        |     > /computer platforms prior to       |
| testing. Subsequent to    |     > testing.                           |
| completion of testing,    |                                          |
| all keying materials must | -   Subsequent to completion of testing, |
| be deleted, the           |     > all keying materials must be       |
| server/computer platforms |     > deleted, and the server/computer   |
| must be wiped and rebuilt |     > platforms must be wiped and        |
| from read-only media, and |     > rebuilt from read-only media.      |
| the relevant production   |                                          |
| keying material restored  | -   Prior to reuse for production        |
| using the principles of   |     > purposes the HSM is returned to    |
| dual control and split    |     > factory state.                     |
| knowledge as stated in    |                                          |
| these requirements.       | -   The relevant production keying       |
|                           |     > material is restored using the     |
| At all times, the HSMs    |     > principles of dual control and     |
| and servers/computers     |     > split knowledge as stated in these |
| must be physically and    |     > requirements.                      |
| logically secured in      |                                          |
| accordance with these     |                                          |
| requirements.             |                                          |
|                           |                                          |
| ***Note**: This does not  |                                          |
| apply to HSMs that are    |                                          |
| never intended to be used |                                          |
| for production.*          |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **19-6** Key pairs must   | **19-6.a** Examine documented procedures |
| not be reused for         | for requesting certificate issue,        |
| certificate renewal or    | renewal, and replacement to verify       |
| replacement---i.e., new   | procedures include generation of a       |
| key pairs must be         | unique key pair for each:                |
| generated.                |                                          |
|                           | -   New certificate issue request        |
| Each key pair must result |                                          |
| in only one certificate.  | -   Certificate replacement request      |
|                           |                                          |
|                           | -   Each key pair generated results in   |
|                           |     > only one certificate               |
+---------------------------+------------------------------------------+
|                           | **19-6.b** Interview responsible         |
|                           | personnel, examine records of past       |
|                           | KDH-signing requests, and observe        |
|                           | certificate issuing and replacement      |
|                           | processes to verify that:                |
|                           |                                          |
|                           | -   Only one certificate is requested    |
|                           |     > for each key pair generated.       |
|                           |                                          |
|                           | -   Certificates are replaced by         |
|                           |     > generating a new key pair and      |
|                           |     > requesting a new certificate.      |
|                           |                                          |
|                           | -   Each key pair generated results in   |
|                           |     > only one certificate.              |
+---------------------------+------------------------------------------+
| **19-7** KDH private keys | **19-7** Examine documented processes to |
| must not be shared        | verify that KDH private keys are not     |
| between devices except    | permitted to be shared between devices,  |
| for load balancing and    | except for load balancing and disaster   |
| disaster recovery.        | recovery.                                |
+---------------------------+------------------------------------------+
| **19-8** POI device       | **19-8.a** Examine documented processes  |
| private keys must not be  | to verify that POI device private keys   |
| shared between POI        | are not permitted to be shared between   |
| devices.                  | POI devices.                             |
+---------------------------+------------------------------------------+
|                           | **19-8.b** Inspect public key            |
|                           | certificates on the host processing      |
|                           | system to confirm that a unique          |
|                           | certificate exists for each connected    |
|                           | POI device.                              |
+---------------------------+------------------------------------------+
| **19-9** Mechanisms must  | **19-9.a** Examine key-usage             |
| be utilized to preclude   | documentation and ensure that the usage  |
| the use of a key for      | is in accordance with the certificate    |
| other than its designated | policy.                                  |
| and intended purpose----  |                                          |
| that is, keys must be     |                                          |
| used in accordance with   |                                          |
| their certificate policy. |                                          |
| See *RFC 3647- Internet   |                                          |
| X.509 Public Key          |                                          |
| Infrastructure            |                                          |
| Certificate Policy and    |                                          |
| Certification Practices   |                                          |
| Framework* for an example |                                          |
| of content.               |                                          |
+---------------------------+------------------------------------------+
|                           | **19-9.b** Examine vendor documentation  |
|                           | and device configuration settings to     |
|                           | verify that the device mechanisms are    |
|                           | implemented that preclude the use of a   |
|                           | key for other than its designated and    |
|                           | intended purpose.                        |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **19-9.1** CA           | > **19-9.1.a** Examine certificate       |
| > certificate signature   | > policy and documented procedures to    |
| > keys, certificate       | > verify that the following:             |
| > (entity) status         |                                          |
| > checking (e.g.,         | -   Certificate signature keys,          |
| > Certificate Revocation  |                                          |
| > Lists) signature keys,  | -   Certificate status checking (e.g.,   |
| > or signature keys for   |     > Certificate Revocation Lists)      |
| > updating                |     > signature keys, or                 |
| > valid/authorized host   |                                          |
| > lists in encryption     | -   Signature keys for updating          |
| > devices must not be     |     > valid/authorized host lists in POI |
| > used for any purpose    |     > devices. Are not used for any      |
| > other than subordinate  |     > purpose other than:                |
| > entity certificate      |                                          |
| > requests, certificate   | -   Subordinate entity certificate       |
| > status checking, and    |     > requests,                          |
| > self- signed root       |                                          |
| > certificates.           | -   Certificate status checking, and/or  |
| >                         |                                          |
| > ***Note:** The keys     | -   Self-signed root certificates.       |
| > used for certificate    |                                          |
| > signing and certificate |                                          |
| > (entity) status         |                                          |
| > checking (and if        |                                          |
| > applicable, self-signed |                                          |
| > roots) may be for       |                                          |
| > combined usage or may   |                                          |
| > exist as separate keys  |                                          |
| > dedicated to either     |                                          |
| > certificate-signing or  |                                          |
| > certificate (entity)    |                                          |
| > status checking.*       |                                          |
+---------------------------+------------------------------------------+
|                           | > **19-9.1.b** Interview responsible     |
|                           | > personnel and observe demonstration to |
|                           | > verify that the following:             |
|                           |                                          |
|                           | -   Certificate signature keys,          |
|                           |                                          |
|                           | -   Status checking (e.g., Certificate   |
|                           |     > Revocation Lists) signature keys,  |
|                           |     > or                                 |
|                           |                                          |
|                           | -   Signature keys for updating          |
|                           |     > valid/authorized host lists in     |
|                           |     > POIs. Are not used for any purpose |
|                           |     > other than:                        |
|                           |                                          |
|                           | -   Subordinate entity certificate       |
|                           |     > requests,                          |
|                           |                                          |
|                           | -   Certificate status checking, and/or  |
|                           |                                          |
|                           | -   Self-signed root certificates.       |
+---------------------------+------------------------------------------+
| > **19-9.2** CAs that     | > **19-9.2** If a CA issues certificates |
| > issue certificates to   | > to other CAs, examine the CA           |
| > other CAs must not be   | > certificate policy and documented      |
| > used to issue           | > procedures to verify that the CA does  |
| > certificates to POIs    | > not also issue certificates to POI     |
| > (i.e., a CA cannot sign | > devices.                               |
| > certificates to both    |                                          |
| > subordinate CAs and     |                                          |
| > end-entity \[POI\]      |                                          |
| > devices).               |                                          |
+---------------------------+------------------------------------------+
| **19-10**                 | **19-10** Examine documented procedures  |
| Public-key-based          | to verify that mechanisms are defined    |
| implementations must      | for restricting and controlling the use  |
| provide mechanisms for    | of public and private keys such that     |
| restricting and           | they can only be used for their intended |
| controlling the use of    | purpose.                                 |
| public and private keys.  |                                          |
| For example, this can be  |                                          |
| accomplished through the  |                                          |
| use of X.509 compliant    |                                          |
| certificate extensions.   |                                          |
+---------------------------+------------------------------------------+
| **19-11** CA private keys | **19-11** Examine CA's documented        |
| must not be shared        | processes to verify that CA private keys |
| between devices except    | are not permitted to be shared between   |
| for load balancing and    | devices, except for load balancing and   |
| disaster recovery.        | disaster recovery.                       |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **19-12** Certificates    | **19-12.a** Examine implementation       |
| used in conjunction with  | schematics and other relevant            |
| remote key- distribution  | documentation to identify PKI            |
| functions must only be    | architecture and where certificates are  |
| used for a single         | used in the implementation.              |
| purpose.                  |                                          |
|                           |                                          |
| -   Certificates          |                                          |
|     > associated with     |                                          |
|     > encryption for      |                                          |
|     > remote key-         |                                          |
|     > distribution        |                                          |
|     > functions must not  |                                          |
|     > be used for any     |                                          |
|     > other purpose.      |                                          |
|                           |                                          |
| -   Certificates          |                                          |
|     > associated with     |                                          |
|     > authentication of   |                                          |
|     > the KDH must not be |                                          |
|     > used for any other  |                                          |
|     > purpose.            |                                          |
|                           |                                          |
| -   Certificates          |                                          |
|     > associated with     |                                          |
|     > authentication of   |                                          |
|     > the POI must not be |                                          |
|     > used for any other  |                                          |
|     > purpose.            |                                          |
|                           |                                          |
| -   Certificates          |                                          |
|     > associated with     |                                          |
|     > authentication of   |                                          |
|     > POI firmware and    |                                          |
|     > POI applications    |                                          |
|     > must not be used    |                                          |
|     > for any other       |                                          |
|     > purpose.            |                                          |
|                           |                                          |
| If CA separation is used  |                                          |
| to ensure certificate     |                                          |
| segmentation:             |                                          |
|                           |                                          |
| -   Sub-CAs used to       |                                          |
|     > produce             |                                          |
|     > certificates used   |                                          |
|     > for remote          |                                          |
|     > key-delivery        |                                          |
|     > functions must not  |                                          |
|     > be used to produce  |                                          |
|     > certificates used   |                                          |
|     > for any other       |                                          |
|     > purpose.            |                                          |
|                           |                                          |
| -   Sub-CAs used to       |                                          |
|     > produce             |                                          |
|     > certificates for    |                                          |
|     > POI firmware and    |                                          |
|     > POI application     |                                          |
|     > authentication must |                                          |
|     > not be used for any |                                          |
|     > other purpose.      |                                          |
|                           |                                          |
| > *(continued on next     |                                          |
| > page)*                  |                                          |
+---------------------------+------------------------------------------+
|                           | **19.12.b** Identify mechanism(s) used   |
|                           | to restrict certificates to a            |
|                           | single-purpose use as either:            |
|                           |                                          |
|                           | -   Separation of the Sub-Cas issuing    |
|                           |     > the certificates, or               |
|                           |                                          |
|                           | -   Policy-based certificate             |
|                           |     > segmentation that depends upon a   |
|                           |     > characteristic of the certificate. |
+---------------------------+------------------------------------------+
|                           | **19-12.c** If CA separation is used to  |
|                           | ensure certificate segmentation, confirm |
|                           | that the following are true:             |
|                           |                                          |
|                           | -   The designation of each Sub-CA is    |
|                           |     > documented.                        |
|                           |                                          |
|                           | -   Policies and procedures are in place |
|                           |     > to support and require appropriate |
|                           |     > use of each Sub-CA.                |
|                           |                                          |
|                           | -   Any Sub-CA used to produce           |
|                           |     > certificates used for remote       |
|                           |     > key-delivery functions (i.e.,      |
|                           |     > encryption, POI authentication, or |
|                           |     > KDH authentication) is not used to |
|                           |     > produce certificates used for any  |
|                           |     > other purpose.                     |
|                           |                                          |
|                           | -   Any Sub-CA used to produce           |
|                           |     > certificates for POI firmware and  |
|                           |     > POI application authentication is  |
|                           |     > not used for any other purpose.    |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **19-12** *(continued)*   | **19-12.d** If policy-based certificate  |
|                           | segmentation is used to ensure           |
| If policy-based           | certificate segmentation, confirm that   |
| certificate segmentation  | all of the following are true:           |
| is used to achieve unique |                                          |
| purpose certificates:     | -   The method of segmentation between   |
|                           |     > certificates is clearly stated in  |
| -   The method of         |     > the certificate practice statement |
|     > segmentation        |     > (CPS) for the CA.                  |
|     > between             |                                          |
|     > certificates must   | -   Certificates issued for all of the   |
|     > be reflected in the |     > remote key-distribution functions  |
|     > certificate         |     > (i.e., encryption, POI             |
|     > practice statement  |     > authentication, or KDH             |
|     > (CPS) for the CA.   |     > authentication) include a          |
|                           |     > mechanism to identify designation  |
| -   Certificates issued   |     > for this purpose.                  |
|     > for remote          |                                          |
|     > key-distribution    | -   Policies and procedures are in place |
|     > purposes must       |     > to support and require specific    |
|     > include a mechanism |     > function designation for each      |
|     > to identify         |     > certificate issued, and there is   |
|     > designation for     |     > evidence that such procedures are  |
|     > this purpose.       |     > followed.                          |
|                           |                                          |
| -   Each SCD using a      | -   The SCDs involved in the remote      |
|     > certificate in a    |     > key-delivery functions ensure that |
|     > remote key-delivery |     > the certificates used for these    |
|     > function must       |     > functions are designated for the   |
|     > ensure there is a   |     > purpose for which they are being   |
|     > designation         |     > used.                              |
|     > included in the     |                                          |
|     > certificate         | -   The SCDs involved in remote key      |
|     > indicating that it  |     > delivery ensure that certificates  |
|     > is for use in the   |     > with remote key- delivery          |
|     > remote key-delivery |     > designation are not used for some  |
|     > function for which  |     > other purpose.                     |
|     > it is being used.   |                                          |
|                           |                                          |
| Each SCD using a          |                                          |
| certificate in a remote   |                                          |
| key-delivery function     |                                          |
| must ensure that if there |                                          |
| is a designation included |                                          |
| in a certificate that     |                                          |
| indicates it is for use   |                                          |
| in a remote key- delivery |                                          |
| function, the SCD does    |                                          |
| not use it for any other  |                                          |
| purpose.                  |                                          |
+---------------------------+------------------------------------------+
|                           | **19-12.e** Confirm that the mechanisms  |
|                           | in place are effective in restricting    |
|                           | the certificates to a single purpose use |
|                           | as noted below:                          |
|                           |                                          |
|                           | -   Certificates associated with         |
|                           |     > encryption for remote              |
|                           |     > key-distribution functions are not |
|                           |     > used for any other purpose.        |
|                           |                                          |
|                           | -   Certificates associated with         |
|                           |     > authentication of the KDH are not  |
|                           |     > used for any other purpose.        |
|                           |                                          |
|                           | -   Certificates associated with         |
|                           |     > authentication of the POI are not  |
|                           |     > used for any other purpose.        |
|                           |                                          |
|                           | -   Certificates associated with         |
|                           |     > authentication of POI firmware and |
|                           |     > POI applications are not used for  |
|                           |     > any other purpose.                 |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **Requirement 20:** *All  |                                          |
| secret and private        |                                          |
| cryptographic keys ever   |                                          |
| present and used for any  |                                          |
| function (e.g., key       |                                          |
| encipherment or           |                                          |
| account-data              |                                          |
| encipherment) by a POI    |                                          |
| device that processes     |                                          |
| account data must be      |                                          |
| unique (except by chance) |                                          |
| to that device.*          |                                          |
+---------------------------+------------------------------------------+
| **20-1** POI devices must | > **20-1.a** Examine documented          |
| each implement unique     | > procedures for the loading and usage   |
| secret and private keys   | > of all keys used in                    |
| for any function directly | > transaction-originating POI devices.   |
| or indirectly related to  | > Verify the procedures ensure that all  |
| account-data protection.  | > private and secret keys used in        |
| These keys must be known  | > transaction-originating POI devices    |
| only in that device and   | > are:                                   |
| in hardware security      |                                          |
| modules (HSMs) at the     | -   Known only to a single POI device,   |
| minimum number of         |     > and                                |
| facilities consistent     |                                          |
| with effective system     | -   Known only to HSMs at the minimum    |
| operations.               |     > number of facilities consistent    |
|                           |     > with effective system operations.  |
| Disclosure of the key in  |                                          |
| one such device must not  |                                          |
| provide any information   |                                          |
| that could be feasibly    |                                          |
| used to determine the key |                                          |
| in any other such device. |                                          |
|                           |                                          |
| *This means not only the  |                                          |
| account-data-encryption   |                                          |
| key(s), but also keys     |                                          |
| that are used to protect  |                                          |
| other keys, firmware-     |                                          |
| authentication keys,      |                                          |
| payment-application       |                                          |
| authentication and        |                                          |
| display-prompt control    |                                          |
| keys. As stated in the    |                                          |
| requirement, this does    |                                          |
| not apply to public keys  |                                          |
| resident in the device.*  |                                          |
|                           |                                          |
| *POI device private keys  |                                          |
| must not exist anywhere   |                                          |
| but the specific POI      |                                          |
| device they belong to,    |                                          |
| except where generated    |                                          |
| external to the POI       |                                          |
| device and prior to the   |                                          |
| injection into the POI    |                                          |
| device.*                  |                                          |
+---------------------------+------------------------------------------+
|                           | > **20-1.b** Observe HSM functions and   |
|                           | > procedures for generating and loading  |
|                           | > secret and private keys for use in     |
|                           | > transaction-originating POI devices to |
|                           | > verify that unique keys are generated  |
|                           | > and used for each POI device.          |
+---------------------------+------------------------------------------+
|                           | > **20-1.c** Examine check values, hash, |
|                           | > or fingerprint values for a sample of  |
|                           | > cryptographic keys from different POI  |
|                           | > devices to verify private and secret   |
|                           | > keys are unique for each POI device.   |
|                           | > This can include comparing a sample of |
|                           | > POI public keys (multiple devices for  |
|                           | > each POI device vendor used) to        |
|                           | > determine that the associated private  |
|                           | > keys stored in the POI devices are     |
|                           | > unique per device---i.e., the public   |
|                           | > keys are unique.                       |
+---------------------------+------------------------------------------+
| **20-2** If a POI device  | > **20-2.a** Examine documented          |
| directly interfaces with  | > procedures for generating all types of |
| more than one entity for  | > keys and verify procedures exist to    |
| decryption of account     | > ensure that unique keys or sets of     |
| data (e.g., different     | > keys are used for each acquiring       |
| acquiring organizations), | > organization and totally independent   |
| the POI device must have  | > and are not variants of one another.   |
| a completely different    |                                          |
| and unique key or set of  |                                          |
| keys for each acquirer.   |                                          |
| These different keys, or  |                                          |
| sets of keys, must be     |                                          |
| totally independent and   |                                          |
| not variants of one       |                                          |
| another.                  |                                          |
+---------------------------+------------------------------------------+
|                           | > **20-2.b** Interview personnel and     |
|                           | > observe key-generation processes to    |
|                           | > verify that unique keys or sets of     |
|                           | > keys will be generated for each        |
|                           | > acquiring organization when required.  |
+---------------------------+------------------------------------------+
|                           | > **20-2.c** Intentionally left blank    |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **20-3** Keys that are    | **20-3.a** Examine documented procedures |
| generated by a derivation | and observe processes for generating     |
| process and derived from  | initial keys. Verify the following is    |
| the same Base (master)    | implemented where initial keys are       |
| Derivation Key must use   | generated by a derivation process and    |
| unique data for the       | derived from the same Base Derivation    |
| derivation process as     | Key:                                     |
| defined in *ISO 11568* so |                                          |
| that all such             | -   Unique data is used for the          |
| cryptographic devices     |     > derivation process such that all   |
| receive unique initial    |     > transaction-originating POI        |
| secret keys. Base         |     > devices receive unique secret      |
| derivation keys must not  |     > keys.                              |
| ever be loaded onto POI   |                                          |
| devices---i.e., only the  | -   Key derivation is performed prior to |
| derived key is loaded to  |     > a key being loaded/sent to the     |
| the POI device.           |     > recipient transaction-originating  |
|                           |     > POI device.                        |
| This requirement refers   |                                          |
| to the use of a single    | -   Examine key-generation/injection     |
| "base" key to derive      |     > logs to ensure that sequential     |
| initial keys for many     |     > values included in unique key      |
| different POI devices,    |     > derivation are not repeated.       |
| using a key-derivation    |                                          |
| process as described      |                                          |
| above. This requirement   |                                          |
| does not preclude         |                                          |
| multiple unique keys      |                                          |
| being loaded on a single  |                                          |
| device, or for the device |                                          |
| to use a unique key for   |                                          |
| the derivation of other   |                                          |
| keys once loaded---e.g.,  |                                          |
| as done with DUKPT.       |                                          |
|                           |                                          |
| ***Note**: The same BDK   |                                          |
| with the same KSN         |                                          |
| installed in multiple     |                                          |
| injection systems or      |                                          |
| installed multiple times  |                                          |
| within the same injection |                                          |
| system will not meet      |                                          |
| uniqueness requirements.* |                                          |
+---------------------------+------------------------------------------+
|                           | **20-3.b** Verify that derivation keys   |
|                           | used to generate keys for multiple       |
|                           | devices are never loaded into a POI      |
|                           | device.                                  |
+---------------------------+------------------------------------------+
| **20-4** Entities         | **20-4** Examine documented              |
| processing or injecting   | key-generation and injection procedures  |
| DUKPT or other key-       | to verify that entities processing or    |
| derivation methodologies  | injecting DUKPT or other key-derivation  |
| on behalf of multiple     | methodologies incorporate a segmentation |
| acquiring organizations   | strategy in their environments using one |
| must incorporate a        | or more of the following techniques:     |
| segmentation strategy in  |                                          |
| their environments.       | -   Different BDKs for each financial    |
| Segmentation must use one |     > institution;                       |
| or more of the following  |                                          |
| techniques:               | -   Different BDKs by injection vendor   |
|                           |     > (e.g., ESO), terminal              |
| -   Different BDKs for    |     > manufacturer, or terminal model;   |
|     > each financial      |                                          |
|     > institution;        | -   Different BDKs by geographic region, |
|                           |     > market segment, processing         |
| -   Different BDKs by     |     > platform, or sales unit;           |
|     > injection vendor    |                                          |
|     > (e.g., ESO),        | ***FOR COMPONENT PROVIDERS ONLY:**       |
|     > terminal            | Examine documented key-generation and    |
|     > manufacturer, or    | injection procedures to verify that      |
|     > terminal model;     | key-injection vendors use at least one   |
|                           | unique Base Derivation Key (BDK) per     |
| -   Different BDKs by     | acquiring organization and are able to   |
|     > geographic region,  | support segmentation of multiple BDKs of |
|     > market segment,     | acquiring organizations.*                |
|     > processing          |                                          |
|     > platform, or sales  |                                          |
|     > unit.               |                                          |
|                           |                                          |
| ***COMPONENT PROVIDERS    |                                          |
| ONLY:** Must use at least |                                          |
| one unique Base           |                                          |
| Derivation Key (BDK) per  |                                          |
| acquiring organization    |                                          |
| and must be able to       |                                          |
| support segmentation of   |                                          |
| multiple BDKS of          |                                          |
| acquiring organizations.* |                                          |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Control Objective 5:   |                                          |
| Keys are used in a manner |                                          |
| that prevents or detects  |                                          |
| their unauthorized        |                                          |
| usage***                  |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **20-5** Key-injection    | **20-5.a** If the key-injection facility |
| facilities that load      | loads DUKPT keys, examine documented     |
| DUKPT keys for various    | procedures for generation and use of     |
| POI types for the same    | BDKs to verify they require use of       |
| entity must use separate  | separate BDKs per terminal type.         |
| BDKs per terminal type if |                                          |
| the terminal IDs can be   |                                          |
| duplicated among the      |                                          |
| multiple types of         |                                          |
| terminals. In other       |                                          |
| words, the key-injection  |                                          |
| facility must ensure that |                                          |
| any one given key cannot  |                                          |
| be derived for multiple   |                                          |
| devices except by chance. |                                          |
+---------------------------+------------------------------------------+
|                           | **20-5.b** Observe key-loading processes |
|                           | for a sample of terminal types used by a |
|                           | single entity, to verify that separate   |
|                           | BDKs are used for each terminal type.    |
+---------------------------+------------------------------------------+
| **20-6 Remote             | **20-6.a** For techniques involving      |
| Key-Establishment and     | public key cryptography, examine         |
| Distribution              | documentation and develop a schematic to |
| Applications**            | illustrate the process, including:       |
|                           |                                          |
| The following             | -   The size and sources of the          |
| requirements apply to     |     > parameters involved, and           |
| key-injection facilities  |                                          |
| participating in remote   | -   The mechanisms utilized for mutual   |
| key-establishment and     |     > device authentication for both the |
| distribution              |     > host and the POI device.           |
| applications:             |                                          |
|                           |                                          |
| -   Keys must be uniquely |                                          |
|     > identifiable in all |                                          |
|     > hosts and POI       |                                          |
|     > Devicese.g.,       |                                          |
|     > EPPs/PEDs. Keys     |                                          |
|     > must be             |                                          |
|     > identifiable via    |                                          |
|     > cryptographically   |                                          |
|     > verifiable          |                                          |
|     > meanse.g., through |                                          |
|     > the use of digital  |                                          |
|     > signatures or key   |                                          |
|     > check values.       |                                          |
|                           |                                          |
| -   Key pairs must be     |                                          |
|     > unique per POI      |                                          |
|     > devicee.g., EPPs   |                                          |
|     > and PEDs            |                                          |
+---------------------------+------------------------------------------+
|                           | **20-6.b** If key-establishment          |
|                           | protocols using public-key cryptography  |
|                           | are used to distribute secret keys,      |
|                           | verify that:                             |
|                           |                                          |
|                           | -   Cryptographic mechanisms exist to    |
|                           |     > uniquely identify the keys.        |
|                           |                                          |
|                           | -   Key pairs used by POI devices are    |
|                           |     > unique per device.                 |
+---------------------------+------------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark62            |                                         |
| .anchor}***Control         |                                         |
| Objective 6: Keys are      |                                         |
| administered in a secure   |                                         |
| manner***                  |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***Requirement 21:**     |                                         |
| > Secret keys used for     |                                         |
| > enciphering              |                                         |
| > account-data-encryption  |                                         |
| > keys or for account-data |                                         |
| > encryption, or private   |                                         |
| > keys used in connection  |                                         |
| > with remote              |                                         |
| > key-distribution         |                                         |
| > implementations, must    |                                         |
| > never exist outside of   |                                         |
| > SCDs, except when        |                                         |
| > encrypted or securely    |                                         |
| > stored and managed using |                                         |
| > the principles of dual   |                                         |
| > control and split        |                                         |
| > knowledge.*              |                                         |
+----------------------------+-----------------------------------------+
| > *Key-injection           |                                         |
| > facilities (or           |                                         |
| > applicable entities      |                                         |
| > providing key-management |                                         |
| > services) must ensure    |                                         |
| > that KEKs and            |                                         |
| > account-data-encryption  |                                         |
| > keys do not exist        |                                         |
| > outside of SCDs except   |                                         |
| > when encrypted or stored |                                         |
| > under dual control and   |                                         |
| > split knowledge.*        |                                         |
| >                          |                                         |
| > *Some key-injection      |                                         |
| > platforms use            |                                         |
| > personal-computer        |                                         |
| > (PC)-based software      |                                         |
| > applications or similar  |                                         |
| > devices whereby          |                                         |
| > clear-text secret and/or |                                         |
| > private keys and/or      |                                         |
| > their components exist   |                                         |
| > in memory outside the    |                                         |
| > secure boundary of an    |                                         |
| > SCD for loading keys.    |                                         |
| > Such systems have        |                                         |
| > inherent weaknesses      |                                         |
| > that, if exploited, may  |                                         |
| > cause the unauthorized   |                                         |
| > disclosure of components |                                         |
| > and/or keys. The         |                                         |
| > exploitation of some of  |                                         |
| > the weaknesses could be  |                                         |
| > possible without         |                                         |
| > collusion. Therefore,    |                                         |
| > key-injection facilities |                                         |
| > that use PC-based        |                                         |
| > key-loading software     |                                         |
| > platforms whereby        |                                         |
| > clear-text secret and/or |                                         |
| > private keys and/or      |                                         |
| > their components exist   |                                         |
| > in memory outside the    |                                         |
| > secure boundary of an    |                                         |
| > SCD must minimally       |                                         |
| > implement the            |                                         |
| > compensating controls    |                                         |
| > outlined in              |                                         |
| > **Requirement 13.***     |                                         |
+----------------------------+-----------------------------------------+
| > ***Note for hybrid       |                                         |
| > decryption solutions:**  |                                         |
| > Requirements specific to |                                         |
| > hybrid decryption        |                                         |
| > solutions are denoted    |                                         |
| > throughout **Control     |                                         |
| > Objective 6**.*          |                                         |
+----------------------------+-----------------------------------------+
| 1.  Secret or private keys | **21-1.a** Examine documented           |
|     must only exist in one | procedures for key storage and usage to |
|     or more of the         | verify that secret or private keys only |
|     following forms:       | exist in one or more approved forms at  |
|                            | all times when stored *(with the        |
|     -   At least two       | exception of DDKs used on the Host      |
|         > separate key     | System for hybrid decryption            |
|         > shares (secret   | solutions)*.                            |
|         > or private) or   |                                         |
|         > full-length      |                                         |
|         > components       |                                         |
|         > (secret)         |                                         |
|                            |                                         |
|     -   Encrypted with a   |                                         |
|         > key of equal or  |                                         |
|         > greater strength |                                         |
|         > as delineated in |                                         |
|         > Annex C          |                                         |
|                            |                                         |
|     -   Contained within a |                                         |
|         > secure           |                                         |
|         > cryptographic    |                                         |
|         > device           |                                         |
|                            |                                         |
| ***Note:** Key-injection   |                                         |
| facilities may have        |                                         |
| clear-text keying material |                                         |
| outside of an SCD when     |                                         |
| used within a secure room  |                                         |
| in accordance with         |                                         |
| Requirement 32.*           |                                         |
|                            |                                         |
| ***Note for hybrid         |                                         |
| decryption solutions:**    |                                         |
| Clear-text data Decryption |                                         |
| Keys (DDKs) may            |                                         |
| temporarily be retained by |                                         |
| the Host System in         |                                         |
| volatile memory for the    |                                         |
| purpose of decrypting      |                                         |
| account data.*             |                                         |
+----------------------------+-----------------------------------------+
|                            | **21-1.b** Observe key stores to verify |
|                            | that secret or private keys only exist  |
|                            | in one or more approved forms at all    |
|                            | times when stored *(with the exception  |
|                            | of DDKs used on the Host System for     |
|                            | hybrid decryption solutions)*.          |
+----------------------------+-----------------------------------------+
| **21-2** Wherever key      | > **21-2** Examine documented           |
| components/shares are      | > procedures and interview responsible  |
| used, they must have the   | > personnel to determine all instances  |
| following properties:      | > where key components/shares are used. |
+----------------------------+-----------------------------------------+
| > **21-2.1** Knowledge of  | > **21-2.1** Examine processes for      |
| > any one key              | > creating key components/shares to     |
| > component/share must not | > verify that knowledge of any one key  |
| > convey any knowledge of  | > component/ share does not convey any  |
| > any part of the actual   | > knowledge of any part of the actual   |
| > cryptographic key.       | > cryptographic key.                    |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **21-2.2** Construction  | > **21-2.2** Observe processes for      |
| > of the cryptographic key | > constructing cryptographic keys to    |
| > must require the use of  | > verify that at least two key          |
| > at least two key         | > components/shares are required for    |
| > components/shares.       | > each key construction.                |
+----------------------------+-----------------------------------------+
| > **21-2.3** Each key      | > **21-2.3.a** Examine documented       |
| > component/share must     | > procedures for the use of key         |
| > have one or more         | > components/shares and interview key   |
| > specified authorized     | > custodians and key-management         |
| > custodians.              | > supervisory personnel to verify that  |
|                            | > each key component/share is assigned  |
|                            | > to a specific individual, or set of   |
|                            | > individuals, who are designated as    |
|                            | > key custodians for that               |
|                            | > component/share.                      |
+----------------------------+-----------------------------------------+
|                            | > **21-2.3.b** Observe key-component    |
|                            | > access controls and key-custodian     |
|                            | > authorizations/assignments to verify  |
|                            | > that all individuals with access to   |
|                            | > key components or shares are          |
|                            | > designated as key custodians for      |
|                            | > those particular components/shares.   |
+----------------------------+-----------------------------------------+
| > **21-2.4** Procedures    | > **21-2.4.a** Examine documented       |
| > must exist to ensure     | > procedures for the use of key         |
| > that no custodian ever   | > components/shares to verify that      |
| > has access to sufficient | > procedures ensure that no custodian   |
| > key components or shares | > ever has access to sufficient key     |
| > to reconstruct a secret  | > components or shares to reconstruct a |
| > or private key           | > secret or private cryptographic key.  |
| > cryptographic key.       |                                         |
| >                          |                                         |
| > ***Note:** For example,  |                                         |
| > in an m-of-n scheme      |                                         |
| > (which must use a        |                                         |
| > recognized               |                                         |
| > secret-sharing scheme    |                                         |
| > such as Shamir), where   |                                         |
| > only two of any three    |                                         |
| > shares are required to   |                                         |
| > reconstruct the          |                                         |
| > cryptographic key, a     |                                         |
| > custodian must not have  |                                         |
| > current or prior         |                                         |
| > knowledge of more than   |                                         |
| > one share. If a          |                                         |
| > custodian was previously |                                         |
| > assigned share A, which  |                                         |
| > was then reassigned, the |                                         |
| > custodian must not then  |                                         |
| > be assigned share B or   |                                         |
| > C, as this would give    |                                         |
| > them knowledge of two    |                                         |
| > shares, which gives them |                                         |
| > the ability to recreate  |                                         |
| > the key.*                |                                         |
| >                          |                                         |
| > *In an m-of-n scheme     |                                         |
| > where n=5, where three   |                                         |
| > shares are required to   |                                         |
| > reconstruct the          |                                         |
| > cryptographic key, a     |                                         |
| > single custodian may be  |                                         |
| > permitted to have access |                                         |
| > to two of the key shares |                                         |
| > (e.g., share A and share |                                         |
| > B; and a second          |                                         |
| > custodian (with, in this |                                         |
| > example, share C) would  |                                         |
| > be required to           |                                         |
| > reconstruct the final    |                                         |
| > key, ensuring that dual  |                                         |
| > control is maintained.*  |                                         |
+----------------------------+-----------------------------------------+
|                            | > **21-2.4.b** Examine                  |
|                            | > key-component/share access controls   |
|                            | > and access logs to verify that        |
|                            | > authorized custodians cannot access   |
|                            | > sufficient key components or shares   |
|                            | > to reconstruct a secret or private    |
|                            | > cryptographic key.                    |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **21-3** Key               | **21-3** Examine documented procedures, |
| components/shares must be  | interview responsible personnel and     |
| stored as follows:         | inspect key-component/share storage     |
|                            | locations to verify that key            |
|                            | components/shares are stored as         |
|                            | outlined in Requirements **21-3.1**     |
|                            | through **21-3.3** below:               |
+----------------------------+-----------------------------------------+
| > **21-3.1** Key           | > **21-3.1.a** Examine key components   |
| > components that exist in | > and storage locations to verify that  |
| > clear-text outside of an | > components are stored in individual   |
| > SCD must be sealed in    | > opaque, pre-numbered, tamper-evident, |
| > individual opaque, pre-  | > authenticable packaging that prevents |
| > numbered,                | > the determination of the key          |
| > tamper-evident,          | > component without noticeable damage   |
| > authenticable packaging  | > to the packaging.                     |
| > that prevents the        |                                         |
| > determination of the key |                                         |
| > component without        |                                         |
| > noticeable damage to the |                                         |
| > packaging.               |                                         |
| >                          |                                         |
| > ***Note:**               |                                         |
| > Tamper-evident           |                                         |
| > authenticable            |                                         |
| > packaging---opacity may  |                                         |
| > be envelopes within      |                                         |
| > tamper-evident           |                                         |
| > packaging--- used to     |                                         |
| > secure key components    |                                         |
| > must ensure that the key |                                         |
| > component cannot be      |                                         |
| > determined. For          |                                         |
| > components written on    |                                         |
| > paper, opacity may be    |                                         |
| > sufficient, but          |                                         |
| > consideration must be    |                                         |
| > given to any embossing   |                                         |
| > or other possible        |                                         |
| > methods to "read" the    |                                         |
| > component without        |                                         |
| > opening of the           |                                         |
| > packaging. Similarly, if |                                         |
| > the component is stored  |                                         |
| > on a magnetic card, or   |                                         |
| > other media that can be  |                                         |
| > read without direct      |                                         |
| > physical contact, the    |                                         |
| > packaging should be      |                                         |
| > designed to prevent such |                                         |
| > access to the key        |                                         |
| > component.*              |                                         |
+----------------------------+-----------------------------------------+
|                            | > **21-3.1.b** Inspect any              |
|                            | > tamper-evident packaging used to      |
|                            | > secure key components--- e.g., is the |
|                            | > package sufficiently opaque to        |
|                            | > prevent reading of a component---and  |
|                            | > ensure that it prevents the           |
|                            | > determination of the key component    |
|                            | > without visible damage to the         |
|                            | > packaging.                            |
+----------------------------+-----------------------------------------+
|                            | > **21-3.1.c** Ensure clear-text key    |
|                            | > components do not exist in non-secure |
|                            | > containers, such as databases or in   |
|                            | > software programs.                    |
+----------------------------+-----------------------------------------+
|                            | > **21-3.1.d** Confirm that start-up    |
|                            | > instructions and other notes used by  |
|                            | > service technicians do not contain    |
|                            | > initialization-key values written in  |
|                            | > the clear (e.g., at the point in the  |
|                            | > checklist where the keys are          |
|                            | > entered).                             |
+----------------------------+-----------------------------------------+
| > **21-3.2** Key           | > **21-3.2** Inspect each key           |
| > components/shares for    | > component/share storage container and |
| > each specific custodian  | > verify the following:                 |
| > must be stored in a      |                                         |
| > separate secure          | -   Key components/shares for different |
| > container that is        |     > custodians are stored in separate |
| > accessible only by the   |     > secure containers.                |
| > custodian and/or         |                                         |
| > designated backup(s).    | -   Each secure container is accessible |
| >                          |     > only by the custodian and/or      |
| > ***Note:**               |     > designated backup(s).             |
| > Furniture-based locks or |                                         |
| > containers with a        |                                         |
| > limited set of unique    |                                         |
| > keys---e.g., desk        |                                         |
| > drawers---are not        |                                         |
| > sufficient to meet this  |                                         |
| > requirement.*            |                                         |
| >                          |                                         |
| > *Components/shares for a |                                         |
| > specific key that are    |                                         |
| > stored in separate       |                                         |
| > envelopes, but within    |                                         |
| > the same secure          |                                         |
| > container, place         |                                         |
| > reliance upon procedural |                                         |
| > controls and do not meet |                                         |
| > the requirement for      |                                         |
| > physical barriers.*      |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **21-3.3** If a key      | > **21-3.3** Interview responsible      |
| > component /share is      | > personnel and observe implemented     |
| > stored on a token, and   | > processes to verify that if a key is  |
| > an access code (e.g., a  | > stored on a token, and an access code |
| > PIN or similar           | > (PIN or similar mechanism) is used to |
| > access-control           | > access the token, only that token's   |
| > mechanism) is used to    | > owner---or designated backup(s)---has |
| > access the token, only   | > possession of both the token and its  |
| > that token's owner or    | > access code.                          |
| > designated backup(s)     |                                         |
| > must have possession of  |                                         |
| > both the token and its   |                                         |
| > access code.             |                                         |
+----------------------------+-----------------------------------------+
| **21-4** Private keys used | **21-4.a** Examine documented           |
| to sign certificates,      | key-management procedures to verify     |
| certificate status lists,  | that private keys used to sign          |
| messages, or for key       | certificates, certificate-status lists, |
| protection must exist only | messages, or for key protection must    |
| in one or more of the      | exist only in one or more of the        |
| following forms:           | approved forms at all times.            |
|                            |                                         |
| -   Within a secure        |                                         |
|     > cryptographic device |                                         |
|     > that meets           |                                         |
|     > applicable PCI PTS   |                                         |
|     > or FIPS 140-2/140-3  |                                         |
|     > level 3 or higher    |                                         |
|     > requirements for     |                                         |
|     > such a device,       |                                         |
|                            |                                         |
| -   Encrypted using an     |                                         |
|     > algorithm and key    |                                         |
|     > size of equivalent   |                                         |
|     > or greater strength  |                                         |
|     > as delineated in     |                                         |
|     > Annex C, or          |                                         |
|                            |                                         |
| -   As components using a  |                                         |
|     > recognized           |                                         |
|     > secret-sharing       |                                         |
|     > scheme (e.g.,        |                                         |
|     > Shamir) that are at  |                                         |
|     > all times managed    |                                         |
|     > under dual control   |                                         |
|     > and split knowledge. |                                         |
+----------------------------+-----------------------------------------+
|                            | **21-4.b** Observe key-management       |
|                            | operations and interview key custodians |
|                            | and key- management supervisory         |
|                            | personnel to verify that private keys   |
|                            | used to sign certificates,              |
|                            | certificate-status lists, messages, or  |
|                            | for key protection must exist only in   |
|                            | one or more of the approved forms at    |
|                            | all times.                              |
+----------------------------+-----------------------------------------+
| > ***Requirement 22:**     |                                         |
| > Procedures must exist    |                                         |
| > and must be demonstrably |                                         |
| > in use to replace any    |                                         |
| > key determined to be     |                                         |
| > compromised, its         |                                         |
| > subsidiary keys (those   |                                         |
| > keys encrypted with the  |                                         |
| > compromised key), and    |                                         |
| > keys derived from the    |                                         |
| > compromised key, to      |                                         |
| > values not feasibly      |                                         |
| > related to the original  |                                         |
| > keys.*                   |                                         |
+----------------------------+-----------------------------------------+
| *Key-injection facilities  |                                         |
| (or applicable entities    |                                         |
| providing key-management   |                                         |
| services) must have        |                                         |
| written procedures to      |                                         |
| follow in the event of     |                                         |
| compromise of any key      |                                         |
| associated with the        |                                         |
| key-injection platform and |                                         |
| process. Written           |                                         |
| procedures must exist, and |                                         |
| all parties involved in    |                                         |
| cryptographic key loading  |                                         |
| must be aware of those     |                                         |
| procedures. All            |                                         |
| key-compromise procedures  |                                         |
| must be documented.*       |                                         |
+----------------------------+-----------------------------------------+
| **22-1** Procedures for    | **22-1** Verify documented procedures   |
| known or suspected         | exist for replacing known or suspected  |
| compromised keys must      | compromised keys that include all of    |
| include the following:     | the following (**22-1.1** through       |
|                            | **22-1.5** below):                      |
+----------------------------+-----------------------------------------+
| > **22-1.1** Key           | > **22-1.1** Interview responsible      |
| > components/shares are    | > personnel and observe implemented     |
| > never reloaded when      | > processes to verify key               |
| > there is any suspicion   | > components/shares are never reloaded  |
| > that either the          | > when there is any suspicion that      |
| > originally loaded key or | > either the originally loaded key or   |
| > the SCD *(or, for hybrid | > the SCD *(or, for hybrid decryption   |
| > decryption solutions,    | > solutions, the Host System)* has been |
| > the Host System)* has    | > compromised.                          |
| > been compromised.        |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **22-1.2** If            | > **22-1.2** Interview responsible      |
| > unauthorized alteration  | > personnel and observe implemented     |
| > is suspected, new keys   | > processes to verify that if           |
| > are not installed until  | > unauthorized alteration is suspected, |
| > the SCD *(or, for hybrid | > new keys are not installed until the  |
| > decryption solutions,    | > SCD *(or, for hybrid decryption       |
| > the Host System)* has    | > solutions, the Host System)* has been |
| > been inspected and       | > inspected and assurance reached that  |
| > assurance reached that   | > the equipment has not been subject to |
| > the equipment has not    | > any form of unauthorized              |
| > been subject to any form | > modification.                         |
| > of unauthorized          |                                         |
| > modification.            |                                         |
+----------------------------+-----------------------------------------+
| > **22-1.3** A secret or   | > **22-1.3** Interview responsible      |
| > private cryptographic    | > personnel and observe implemented     |
| > key must be replaced     | > processes to verify that if           |
| > with a new key whenever  | > compromise of the cryptographic key   |
| > the compromise of the    | > is suspected, an assessment and       |
| > original key is known.   | > analysis is performed. If compromise  |
| > Suspected compromises    | > is confirmed, and all the following   |
| > must be assessed and the | > are performed:                        |
| > analysis formally        |                                         |
| > documented. If           | -   Use of that key is halted, and the  |
| > compromise is confirmed, |     > key is replaced with a new unique |
| > the key must be          |     > key.                              |
| > replaced. In addition,   |                                         |
| > all keys encrypted under | -   Any systems, devices, or processing |
| > or derived using that    |     > involving subordinate keys that   |
| > key must be replaced     |     > have been calculated, derived, or |
| > with a new key within    |     > otherwise generated, loaded, or   |
| > the minimum feasible     |     > protected using the compromised   |
| > time. The replacement    |     > key are included in the           |
| > key must not be a        |     > key-replacement process.          |
| > variant or an            |                                         |
| > irreversible             | -   The replacement key must not be a   |
| > transformation of the    |     > variant of the original key, or   |
| > original key.            |     > an irreversible transformation of |
| >                          |     > the original key.                 |
| > Compromised keys must    |                                         |
| > not be used to           |                                         |
| > facilitate replacement   |                                         |
| > with a new key(s).       |                                         |
| >                          |                                         |
| > ***Note:** The           |                                         |
| > compromise of a key must |                                         |
| > result in the            |                                         |
| > replacement and          |                                         |
| > destruction of that key  |                                         |
| > and all variants and     |                                         |
| > non-reversible           |                                         |
| > transformations of that  |                                         |
| > key, as well as all keys |                                         |
| > encrypted under or       |                                         |
| > derived from that key.*  |                                         |
| >                          |                                         |
| > *Known or suspected      |                                         |
| > substitution of a secret |                                         |
| > key must result in the   |                                         |
| > replacement of that key  |                                         |
| > and based on an analysis |                                         |
| > of how the key was       |                                         |
| > substituted, any         |                                         |
| > associated               |                                         |
| > key-encipherment keys    |                                         |
| > that may have been       |                                         |
| > compromised.*            |                                         |
+----------------------------+-----------------------------------------+
| > **22-1.4** A documented  | > **22-1.4.a** Interview responsible    |
| > escalation process and   | > personnel and examine documented      |
| > notification to          | > processes to verify key personnel are |
| > organizations that       | > identified and that the escalation    |
| > currently share or have  | > process includes notification to      |
| > previously shared the    | > organizations that currently share or |
| > key(s), including:       | > have previously shared the key(s).    |
|                            |                                         |
| -   Identification of key  |                                         |
|     > personnel            |                                         |
|                            |                                         |
| -   A damage assessment    |                                         |
|     > including, where     |                                         |
|     > necessary, the       |                                         |
|     > engagement of        |                                         |
|     > outside consultants  |                                         |
|                            |                                         |
| -   Specific actions to be |                                         |
|     > taken with system    |                                         |
|     > software and         |                                         |
|     > hardware, encryption |                                         |
|     > keys, encrypted      |                                         |
|     > data, etc.           |                                         |
+----------------------------+-----------------------------------------+
|                            | > **22-1.4.b** Verify notifications     |
|                            | > include the following:                |
|                            |                                         |
|                            | -   A damage assessment including,      |
|                            |     > where necessary, the engagement   |
|                            |     > of outside consultants.           |
|                            |                                         |
|                            | -   Details of specific actions to be   |
|                            |     > taken with system software and    |
|                            |     > hardware, encryption keys,        |
|                            |     > encrypted data, etc.              |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **22-1.5**               | > **22-1.5** Interview responsible      |
| > Identification of        | > personnel and examine documented      |
| > specific events that     | > procedures to verify that specific    |
| > would indicate a         | > events that may indicate a compromise |
| > compromise may have      | > are identified. This must include, as |
| > occurred. Such events    | > a minimum, the following events:      |
| > must include but are not |                                         |
| > limited to:              | -   Missing SCDs                        |
|                            |                                         |
| -   Missing secure         | -   Tamper-evident seals or             |
|     > cryptographic        |     > authenticable envelope numbers or |
|     > devices              |     > dates and times not agreeing with |
|                            |     > log entries                       |
| -   Tamper-evident seals   |                                         |
|     > or authenticable     | -   Tamper-evident seals or             |
|     > envelope numbers or  |     > authenticable envelopes that have |
|     > dates and times not  |     > been opened without authorization |
|     > agreeing with log    |     > or show signs of attempts to open |
|     > entries              |     > or penetrate                      |
|                            |                                         |
| -   Tamper-evident seals   | -   Indications of physical or logical  |
|     > or authenticable     |     > access attempts to the processing |
|     > envelopes that have  |     > system by unauthorized            |
|     > been opened without  |     > individuals or entities           |
|     > authorization or     |                                         |
|     > show signs of        | -   Failure to document that a secret   |
|     > attempts to open or  |     > or private key has been managed   |
|     > penetrate            |     > using the principles of dual      |
|                            |     > control and split knowledge from  |
| -   Indications of         |     > its date of creation              |
|     > physical or logical  |                                         |
|     > access attempts to   | -   *Host System tamper-detection       |
|     > the processing       |     > mechanism has been activated, for |
|     > system by            |     > hybrid decryption solutions*      |
|     > unauthorized         |                                         |
|     > individuals or       |                                         |
|     > entities             |                                         |
|                            |                                         |
| -   Failure to document    |                                         |
|     > that a secret or     |                                         |
|     > private key has been |                                         |
|     > managed using the    |                                         |
|     > principles of dual   |                                         |
|     > control and split    |                                         |
|     > knowledge from its   |                                         |
|     > date of creation     |                                         |
|                            |                                         |
| -   *Host System           |                                         |
|     > tamper-detection     |                                         |
|     > mechanism has been   |                                         |
|     > activated, for       |                                         |
|     > hybrid decryption    |                                         |
|     > solutions*           |                                         |
+----------------------------+-----------------------------------------+
| **22-2** If attempts to    | **22-2** Interview responsible          |
| load a secret key or key   | personnel and observe implemented       |
| component into a KLD or    | processes to verify that if attempts to |
| POI device *(or a Host     | load a secret key or key component into |
| System, for hybrid         | an KLD or POI device *(or a Host        |
| decryption solutions)*     | System, for hybrid decryption           |
| fail, the same key or      | solutions)* fail, the same key or       |
| component must not be      | component is not loaded into a          |
| loaded into a replacement  | replacement device unless it can be     |
| device unless it can be    | ensured that all residue of the key or  |
| ensured that all residue   | component has been erased from or       |
| of the key or component    | otherwise destroyed in the original KLD |
| has been erased from or    | or POI device *(or Host System)*.       |
| otherwise destroyed in the |                                         |
| original KLD or POI device |                                         |
| *(or Host System)*.        |                                         |
+----------------------------+-----------------------------------------+
| **22-3** Root CAs must     | **22-3** Through the examination of     |
| provide for segmentation   | documented procedures, interviews and   |
| of risk to address key     | observation confirm that Root CAs       |
| compromise. An example of  | provide for segmentation of risk to     |
| this would be the          | address key compromise.                 |
| deployment of subordinate  |                                         |
| CAs.                       |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **22-4** Mechanisms must   | **22-4.a** Examine documented           |
| be in place to respond to  | procedures to verify that mechanisms    |
| address compromise of a CA | are defined to respond to compromise of |
| due to, for example, key   | a CA. Verify the mechanisms include     |
| compromise or              | procedures to:                          |
| mismanagement. This must   |                                         |
| include procedures to      | -   Revoke subordinate certificates,    |
| revoke or otherwise        |     > and                               |
| invalidate the usage of    |                                         |
| subordinate certificates,  | -   Notify affected entities.           |
| and notification of        |                                         |
| affected entities.         |                                         |
+----------------------------+-----------------------------------------+
|                            | **22-4.b** Interview responsible        |
|                            | personnel to verify that the defined    |
|                            | mechanisms to respond to compromise of  |
|                            | a CA are in place and include:          |
|                            |                                         |
|                            | -   Revoke subordinate certificates,    |
|                            |     > and                               |
|                            |                                         |
|                            | -   Notify affected entities.           |
+----------------------------+-----------------------------------------+
| > **22-4.1** The CA must   | > **22-4.1.a** Examine documented       |
| > cease issuance of        | > procedures to verify that the         |
| > certificates if a        | > following are required in the event a |
| > compromise is known or   | > compromise is known or suspected:     |
| > suspected and perform a  |                                         |
| > damage assessment,       | -   The CA will cease issuance of       |
| > including a documented   |     > certificates.                     |
| > analysis of how and why  |                                         |
| > the event occurred.      | -   The CA will perform a damage        |
|                            |     > assessment, including a           |
|                            |     > documented analysis of how and    |
|                            |     > why the event occurred.           |
+----------------------------+-----------------------------------------+
|                            | > **22-4.1.b** Interview responsible    |
|                            | > personnel and observe process to      |
|                            | > verify that in the event a compromise |
|                            | > is known or suspected:                |
|                            |                                         |
|                            | -   The CA will cease issuance of       |
|                            |     > certificates.                     |
|                            |                                         |
|                            | -   The CA will perform a damage        |
|                            |     > assessment, including a           |
|                            |     > documented analysis of how and    |
|                            |     > why the event occurred.           |
+----------------------------+-----------------------------------------+
| > **22-4.2** In the event  | > **22-4.2.a** Examine documented       |
| > of confirming a          | > procedures to verify that in the      |
| > compromise, the CA must  | > event of a confirmed compromise,      |
| > determine whether to     | > procedures are defined for the CA to  |
| > revoke and reissue all   | > determine whether to revoke and       |
| > signed certificates with | > reissue all signed certificates with  |
| > a newly generated        | > a newly generated signing key.        |
| > signing key.             |                                         |
+----------------------------+-----------------------------------------+
|                            | > **22-4.2.b** Interview responsible    |
|                            | > personnel to verify procedures are    |
|                            | > followed for the CA to determine      |
|                            | > whether to revoke and reissue all     |
|                            | > signed certificates with a newly      |
|                            | > generated signing key.                |
+----------------------------+-----------------------------------------+
| > **22-4.3** Mechanisms    | > **22-4.3.a** Examine documented       |
| > (e.g., time stamping)    | > procedures to verify that mechanisms  |
| > must exist to prevent    | > are defined to prevent the usage of   |
| > the usage of fraudulent  | > fraudulent certificates.              |
| > certificates, once       |                                         |
| > identified.              |                                         |
+----------------------------+-----------------------------------------+
|                            | > **22-4.3.b** Interview responsible    |
|                            | > personnel and observe implemented     |
|                            | > mechanisms to verify the prevention   |
|                            | > of the use of fraudulent              |
|                            | > certificates.                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **22-4.4** The           | > **22-4.4.a** Examine documented       |
| > compromised CA must      | > procedures to verify that the         |
| > notify any superior or   | > following procedures are required in  |
| > subordinate CAs of the   | > the event of a compromise:            |
| > compromise. The          |                                         |
| > compromise damage        | -   The CA will notify any superior     |
| > analysis must include a  |     > CAs.                              |
| > determination of whether |                                         |
| > subordinate CAs and KDHs | -   The CA will notify any subordinate  |
| > must have their          |     > CAs.                              |
| > certificates reissued    |                                         |
| > and distributed to them  | -   The CA will perform a damage        |
| > or be notified to apply  |     > assessment to determine the need  |
| > for new certificates.    |     > to either:                        |
|                            |                                         |
|                            |     -   Reissue and distribute          |
|                            |         > certificates to affected      |
|                            |         > parties, or                   |
|                            |                                         |
|                            |     -   Notify the affected parties to  |
|                            |         > apply for new certificates.   |
+----------------------------+-----------------------------------------+
|                            | > **22-4.4.b** Interview responsible    |
|                            | > personnel to verify that the          |
|                            | > following procedures are performed in |
|                            | > the event a compromise:               |
|                            |                                         |
|                            | -   The CA notifies any superior CAs.   |
|                            |                                         |
|                            | -   The CA notifies any subordinate     |
|                            |     > CAs.                              |
|                            |                                         |
|                            | -   The CA performs a damage assessment |
|                            |     > to determine the need to either:  |
|                            |                                         |
|                            |     -   Reissues and distributes        |
|                            |         > certificates to affected      |
|                            |         > parties, or                   |
|                            |                                         |
|                            |     -   Notifies the affected parties   |
|                            |         > to apply for new              |
|                            |         > certificates.                 |
+----------------------------+-----------------------------------------+
| **22-5** Minimum           | **22-5.a** Interview appropriate        |
| cryptographic strength for | personnel and examine documented        |
| the CA system must be:     | procedures for the creation of these    |
|                            | keys.                                   |
| -   Root and subordinate   |                                         |
|     > CAs have a minimum   |                                         |
|     > RSA 2048 bits or     |                                         |
|     > equivalent;          |                                         |
|                            |                                         |
| -   POI devices and KDHs   |                                         |
|     > have a minimum RSA   |                                         |
|     > 2048 bits or         |                                         |
|     > equivalent.          |                                         |
|                            |                                         |
| The key-pair lifecycle     |                                         |
| must result in expiration  |                                         |
| of KDH keys every five     |                                         |
| years, unless another      |                                         |
| mechanism exists to        |                                         |
| prevent the use of a       |                                         |
| compromised KDH private    |                                         |
| key.                       |                                         |
+----------------------------+-----------------------------------------+
|                            | **22-5.b** Verify that the following    |
|                            | minimum key sizes exist for RSA keys or |
|                            | the equivalent for the algorithm used   |
|                            | as defined in Annex C:                  |
|                            |                                         |
|                            | -   2048 for CAs                        |
|                            |                                         |
|                            | -   2048 for KDHs and POI devices       |
+----------------------------+-----------------------------------------+
|                            | **22-5.c** Verify that KDH keys expire  |
|                            | every five years unless another         |
|                            | mechanism exists to prevent the use of  |
|                            | a compromised KDH private key.          |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***Requirement 23:** Keys  |                                         |
| generated using reversible |                                         |
| key-calculation methods,   |                                         |
| such as key variants, must |                                         |
| only be used in SCDs that  |                                         |
| possess the original key.* |                                         |
|                            |                                         |
| > *Keys generated using    |                                         |
| > reversible               |                                         |
| > key-calculation methods  |                                         |
| > must not be used at      |                                         |
| > different levels of the  |                                         |
| > key hierarchy. For       |                                         |
| > example, a variant of a  |                                         |
| > key-encryption key used  |                                         |
| > for key exchange must    |                                         |
| > not be used as a working |                                         |
| > key or as a Master File  |                                         |
| > Key for local storage.*  |                                         |
| >                          |                                         |
| > *Keys generated with a   |                                         |
| > non-reversible process,  |                                         |
| > such as key derivation   |                                         |
| > or transformation        |                                         |
| > process with a base key  |                                         |
| > using an encipherment    |                                         |
| > process, are not subject |                                         |
| > to these requirements.*  |                                         |
+----------------------------+-----------------------------------------+
| **23-1** Any key generated | **23-1.a** Examine documented           |
| with a reversible process  | procedures and interview responsible    |
| (such as a variant of a    | personnel to determine whether keys are |
| key) of another key must   | generated using reversible              |
| be protected in the same   | key-calculation methods.                |
| manner as the original     |                                         |
| key---that is, under the   |                                         |
| principles of dual control |                                         |
| and split knowledge.       |                                         |
| Variants of the same key   |                                         |
| may be used for different  |                                         |
| purposes but must not be   |                                         |
| used at different levels   |                                         |
| of the key hierarchy. For  |                                         |
| example, reversible        |                                         |
| transformations must not   |                                         |
| generate key- encipherment |                                         |
| keys from account-data     |                                         |
| keys.                      |                                         |
|                            |                                         |
| ***Note:** Exposure of     |                                         |
| keys that are created      |                                         |
| using reversible           |                                         |
| transforms of another      |                                         |
| (key-generation) key can   |                                         |
| result in the exposure of  |                                         |
| all keys that have been    |                                         |
| generated under that       |                                         |
| key-generation key. To     |                                         |
| limit this risk posed by   |                                         |
| reversible key             |                                         |
| calculation, such as key   |                                         |
| variants, the reversible   |                                         |
| transforms of a key must   |                                         |
| be secured in the same way |                                         |
| as the original            |                                         |
| key-generation key.*       |                                         |
+----------------------------+-----------------------------------------+
|                            | **23-1.b** Observe processes to verify  |
|                            | that any key generated using a          |
|                            | reversible process of another key is    |
|                            | protected under the principles of dual  |
|                            | control and split knowledge.            |
+----------------------------+-----------------------------------------+
| **23-2** An MFK used by    | **23-2.a** Interview responsible        |
| host processing systems    | personnel to determine which host MFKs  |
| for encipherment of keys   | keys exist as variants.                 |
| for local storage---and    |                                         |
| variants of the MFK---must | ***Note:** Some HSMs may automatically  |
| not be used external to    | generate variants or control vectors    |
| the (logical)              | for specific keys, but it is still up   |
| configuration that houses  | to the entity to specify exact usage.*  |
| the MFK itself. For        |                                         |
| example, MFKs and their    |                                         |
| variants used by host      |                                         |
| processing systems for     |                                         |
| encipherment of keys for   |                                         |
| local storage must not be  |                                         |
| used for other purposes,   |                                         |
| such as key conveyance     |                                         |
| between platforms that are |                                         |
| not part of the same       |                                         |
| logical configuration.     |                                         |
|                            |                                         |
| *A logical configuration   |                                         |
| is defined as one where    |                                         |
| all the components form a  |                                         |
| system used to undertake a |                                         |
| particular task and are    |                                         |
| managed and controlled     |                                         |
| under a single operational |                                         |
| and security policy.*      |                                         |
+----------------------------+-----------------------------------------+
|                            | **23-2.b** Examine vendor documentation |
|                            | to determine support for key variants.  |
+----------------------------+-----------------------------------------+
|                            | **23-2.c** Via examination of the       |
|                            | network schematic detailing transaction |
|                            | flows with the associated key usage and |
|                            | identification of the sources of the    |
|                            | keys used, determine that variants of   |
|                            | the MFK are not used external to the    |
|                            | logical configuration that houses the   |
|                            | MFK.                                    |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **23-3** Reversible key    | **23-3** Examine documented             |
| transformations are not    | key-transformation procedures and       |
| used across different      | observe implemented processes to verify |
| levels of the key          | that reversible key transformations are |
| hierarchy. For example,    | not used across different levels of the |
| reversible transformations | key hierarchy, as follows:              |
| must not generate working  |                                         |
| keys e.g., DEKs from       | -   Variants used as KEKs must only be  |
| key-encrypting keys.       |     > calculated from other             |
|                            |     > key-encrypting keys               |
| Such transformations are   |                                         |
| only used to generate      | -   Variants of working keys must only  |
| different types of         |     > be calculated from other working  |
| key-encrypting keys from   |     > keys.                             |
| an initial key-encrypting  |                                         |
| key, or working keys with  |                                         |
| different purposes from    |                                         |
| another working key.       |                                         |
|                            |                                         |
| ***Note:** Using           |                                         |
| transformations of keys    |                                         |
| across different levels of |                                         |
| a key hierarchy---e.g.,    |                                         |
| generating a DEK from a    |                                         |
| key- encrypting            |                                         |
| key---increases the risk   |                                         |
| of exposure of each of     |                                         |
| those keys.*               |                                         |
|                            |                                         |
| *It is acceptable to use   |                                         |
| one "working" key to       |                                         |
| generate multiple          |                                         |
| reversible transforms to   |                                         |
| be used for different      |                                         |
| working keys, such as MAC  |                                         |
| key(s), and data key(s)    |                                         |
| (where a different         |                                         |
| reversible transform is    |                                         |
| used to generate each      |                                         |
| different working key).    |                                         |
| Similarly, it is           |                                         |
| acceptable to generate     |                                         |
| multiple key-encrypting    |                                         |
| keys from a single         |                                         |
| key-encrypting key.*       |                                         |
|                            |                                         |
| *However, it is not        |                                         |
| acceptable to generate     |                                         |
| working keys from          |                                         |
| key-encrypting keys.*      |                                         |
+----------------------------+-----------------------------------------+
| ***Requirement 24:**       |                                         |
| Secret and private keys    |                                         |
| and key components that    |                                         |
| are no longer used or have |                                         |
| been replaced must be      |                                         |
| securely destroyed.*       |                                         |
+----------------------------+-----------------------------------------+
| **24-1** Instances of      | **24-1.a** Verify documented procedures |
| secret or private keys,    | are in place for destroying secret or   |
| and their key components,  | private keys, and their key components  |
| that are no longer used or | that are no longer used or that have    |
| that have been replaced by | been replaced by a new key.             |
| a new key must be          |                                         |
| destroyed.                 |                                         |
+----------------------------+-----------------------------------------+
|                            | **24-1.b** Identify a sample of keys    |
|                            | and key components that are no longer   |
|                            | used or have been replaced. For each    |
|                            | item in the sample, interview           |
|                            | responsible personnel and examine       |
|                            | key-history logs and key-destruction    |
|                            | logs to verify that all keys have been  |
|                            | destroyed.                              |
+----------------------------+-----------------------------------------+
|                            | **24-1.c** Examine storage locations    |
|                            | for the sample of destroyed keys to     |
|                            | verify they are no longer kept.         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **24-2** The procedures    | **24-2.a** Examine documented           |
| for destroying key         | procedures for destroying keys and      |
| components or shares that  | confirm they are sufficient to ensure   |
| are no longer used or have | that no part of the key or component    |
| been replaced by a new key | can be recovered.                       |
| must be documented and     |                                         |
| sufficient to ensure that  |                                         |
| no part of the key or      |                                         |
| component can be           |                                         |
| recovered. For written     |                                         |
| components, this must be   |                                         |
| accomplished by use of a   |                                         |
| cross-cut shredder,        |                                         |
| pulping or burning.        |                                         |
| Strip-shredding is not     |                                         |
| sufficient.                |                                         |
|                            |                                         |
| ***Note:** Key destruction |                                         |
| for keys installed in HSMs |                                         |
| and POI devices is         |                                         |
| addressed in **Requirement |                                         |
| 31**.*                     |                                         |
+----------------------------+-----------------------------------------+
|                            | **24-2.b** Observe key-destruction      |
|                            | processes to verify that no part of the |
|                            | key or component can be recovered.      |
+----------------------------+-----------------------------------------+
| > **24-2.1** Keys on all   | > **24-2.1.a** Examine documented       |
| > other storage media      | > procedures for destroying keys and    |
| > types in all permissible | > confirm that keys on all other        |
| > forms---physically       | > storage media types in all            |
| > secured, enciphered      | > permissible forms---physically        |
| > (except for electronic   | > secured, enciphered, or               |
| > database backups of      | > components---must be destroyed        |
| > cryptograms), or         | > following the procedures outlined in  |
| > components---must be     | > *ISO--9564* or *ISO--11568.*          |
| > destroyed following the  |                                         |
| > procedures outlined in   |                                         |
| > *ISO--9564* or           |                                         |
| > *ISO--11568*.            |                                         |
| >                          |                                         |
| > *For example, keys       |                                         |
| > (including components or |                                         |
| > shares) maintained on    |                                         |
| > paper must be burned,    |                                         |
| > pulped, or shredded in a |                                         |
| > crosscut shredder.*      |                                         |
+----------------------------+-----------------------------------------+
|                            | > **24-2.1.b** Observe key-destruction  |
|                            | > processes to verify that keys on all  |
|                            | > other storage media types in all      |
|                            | > permissible forms---physically        |
|                            | > secured, enciphered, or               |
|                            | > component---are destroyed following   |
|                            | > the procedures outlined in            |
|                            | > *ISO--9564* or *ISO-- 11568.*         |
+----------------------------+-----------------------------------------+
| > **24-2.2** The           | > **24-2.2.a** Observe key-destruction  |
| > key-destruction process  | > process and verify that it is         |
| > must be observed by a    | > witnessed by a third party other than |
| > third party other than   | > a key custodian for any component of  |
| > the custodians of any    | > that key.                             |
| > component of that        |                                         |
| > key---i.e., the third    |                                         |
| > party must not be a key  |                                         |
| > custodian for any part   |                                         |
| > of the key being         |                                         |
| > destroyed.               |                                         |
| >                          |                                         |
| > The third-party witness  |                                         |
| > must sign an affidavit   |                                         |
| > of destruction, and this |                                         |
| > affidavit is retained    |                                         |
| > for a minimum of two     |                                         |
| > years.                   |                                         |
+----------------------------+-----------------------------------------+
|                            | > **24-2.2.b** Inspect key-destruction  |
|                            | > logs and verify that a third-party,   |
|                            | > non-key-custodian witness signs an    |
|                            | > affidavit as a witness to the         |
|                            | > key-destruction process**.**          |
+----------------------------+-----------------------------------------+
| > **24-2.3** Key           | > **24-2.3.a** Verify documented        |
| > components for keys      | > procedures exist for destroying key   |
| > other than the HSM or    | > components of keys once the keys are  |
| > KLD MFKs that have been  | > successfully loaded and validated as  |
| > successfully loaded and  | > operational.                          |
| > confirmed as operational |                                         |
| > must also be destroyed,  |                                         |
| > unless the HSM does not  |                                         |
| > store the encrypted      |                                         |
| > values on a database but |                                         |
| > only stores the          |                                         |
| > subordinate keys         |                                         |
| > internal to the HSM.     |                                         |
| > BDKs used in KLDs may    |                                         |
| > also be stored as        |                                         |
| > components where         |                                         |
| > necessary to reload the  |                                         |
| > KLD.                     |                                         |
+----------------------------+-----------------------------------------+
|                            | > **24-2.3.b** Observe                  |
|                            | > key-conveyance/loading processes to   |
|                            | > verify that any key components are    |
|                            | > destroyed once the keys are           |
|                            | > successfully loaded and validated as  |
|                            | > operational.                          |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***Requirement 25:**       |                                         |
| Access to secret and       |                                         |
| private cryptographic keys |                                         |
| and key material must be:* |                                         |
|                            |                                         |
| a)  *Limited on to a       |                                         |
|     > need-to-know basis   |                                         |
|     > so that the fewest   |                                         |
|     > number of key        |                                         |
|     > custodians are       |                                         |
|     > necessary to enable  |                                         |
|     > their effective use; |                                         |
|     > and*                 |                                         |
|                            |                                         |
| b)  *Protected such that   |                                         |
|     > no other person (not |                                         |
|     > similarly entrusted  |                                         |
|     > with that component) |                                         |
|     > can observe or       |                                         |
|     > otherwise obtain the |                                         |
|     > component.*          |                                         |
+----------------------------+-----------------------------------------+
| **25-1** To reduce the     | **25-1** Interview key custodians and   |
| opportunity for key        | key-management supervisory personnel    |
| compromise, the number of  | and observe implemented processes to    |
| key custodians must be     | verify the following:                   |
| limited to the minimum     |                                         |
| required for operational   |                                         |
| efficiency.                |                                         |
|                            |                                         |
| Controls must include:     |                                         |
+----------------------------+-----------------------------------------+
| > **25-1.1** Designate key | > **25-1.1** Examine key-custodian      |
| > custodian(s) for each    | > assignments for each component to     |
| > component, such that the | > verify that:                          |
| > fewest number (e.g., a   |                                         |
| > primary and a backup) of | -   Key custodian(s) are designated for |
| > key custodians are       |     > each component.                   |
| > assigned as necessary to |                                         |
| > enable effective key     | -   The fewest number of key custodians |
| > management. Key          |     > is assigned as necessary to       |
| > custodians must be       |     > enable effective key management.  |
| > employees or contracted  |                                         |
| > personnel.               | -   Assigned key custodians are         |
|                            |     > employees or contracted           |
|                            |     > personnel.                        |
+----------------------------+-----------------------------------------+
| > **25-1.2** Document this | > **25-1.2.a** Examine completed        |
| > designation by having    | > key-custodian forms to verify that    |
| > each custodian and       | > key custodians sign the form.         |
| > backup custodian sign a  |                                         |
| > key-custodian form.      |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-1.2.b** Examine completed        |
|                            | > key-custodian forms to verify that    |
|                            | > backup custodians sign the form.      |
+----------------------------+-----------------------------------------+
| > **25-1.3** Each          | > **25-1.3** Examine all key-custodian  |
| > key-custodian form       | > forms to verify that they include the |
| > provides the following:  | > following:                            |
|                            |                                         |
| -   Specific authorization | -   Specific authorization for the      |
|     > for the custodian    |     > custodian                         |
|                            |                                         |
| -   Identification of the  | -   Identification of the custodian's   |
|     > custodian's          |     > responsibilities for safeguarding |
|     > responsibilities for |     > key components or other keying    |
|     > safeguarding key     |     > material entrusted to them        |
|     > components or other  |                                         |
|     > keying material      | -   Signature of the custodian          |
|     > entrusted to them    |     > acknowledging their               |
|                            |     > responsibilities                  |
| -   Signature of the       |                                         |
|     > custodian            | -   An effective date and time for the  |
|     > acknowledging their  |     > custodian's access                |
|     > responsibilities     |                                         |
|                            | -   Signature of management authorizing |
| -   An effective date and  |     > the access                        |
|     > time for the         |                                         |
|     > custodian's access   |                                         |
|                            |                                         |
| -   Signature of           |                                         |
|     > management           |                                         |
|     > authorizing the      |                                         |
|     > access               |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25-1.4** In order for  | > **25-1.4.a** Examine key-custodian    |
| > key custodians to be     | > assignments and organization charts   |
| > free from undue          | > to confirm the following:             |
| > influence in discharging |                                         |
| > their custodial duties,  | -   Key custodians that form the        |
| > key custodians           |     > necessary threshold to create a   |
| > sufficient to form the   |     > key do not directly report to the |
| > necessary threshold to   |     > same individual.                  |
| > create a key must not    |                                         |
| > directly report to the   | -   Neither direct reports nor the      |
| > same individual except   |     > direct reports in combination     |
| > as noted below for       |     > with their immediate supervisors  |
| > organizations of         |     > possess the necessary threshold   |
| > insufficient size.       |     > of key components sufficient to   |
| >                          |     > form any given key.               |
| > *For example, for a key  |                                         |
| > managed as three         | -   A key custodian is not and has not  |
| > components, at least two |     > been a custodian for another      |
| > individuals report to    |     > component/share of a key where    |
| > different individuals.   |     > that collectively would           |
| > In an m- of-n scheme     |     > constitute a quorum to form the   |
| > (which must use a        |     > actual key.                       |
| > recognized               |                                         |
| > secret-sharing scheme    |                                         |
| > such as Shamir), such as |                                         |
| > three of five key shares |                                         |
| > to form the key, key     |                                         |
| > custodians sufficient to |                                         |
| > form the threshold       |                                         |
| > necessary to form the    |                                         |
| > key must not report to   |                                         |
| > the same individual.*    |                                         |
| >                          |                                         |
| > The components           |                                         |
| > collectively held by an  |                                         |
| > individual and his or    |                                         |
| > her direct reports must  |                                         |
| > not constitute a quorum  |                                         |
| > (or must not provide any |                                         |
| > information about the    |                                         |
| > value of the key that is |                                         |
| > not derivable from a     |                                         |
| > single component).       |                                         |
| >                          |                                         |
| > A custodian must not     |                                         |
| > become a custodian for a |                                         |
| > component/share of a key |                                         |
| > where the custodian has  |                                         |
| > previously been or is    |                                         |
| > currently a custodian    |                                         |
| > for another              |                                         |
| > component/share of that  |                                         |
| > key if that would        |                                         |
| > collectively constitute  |                                         |
| > a quorum to form the     |                                         |
| > actual key.              |                                         |
| >                          |                                         |
| > When the overall         |                                         |
| > organization is of       |                                         |
| > insufficient size such   |                                         |
| > that the reporting       |                                         |
| > structure cannot support |                                         |
| > this requirement,        |                                         |
| > procedural controls can  |                                         |
| > be implemented.          |                                         |
| >                          |                                         |
| > *(continued on next      |                                         |
| > page)*                   |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25-1.4** *continued*   | > **25-1.4.b** For organizations that   |
| >                          | > are such a small, modest size that    |
| > Organizations that are   | > they cannot support the               |
| > of insufficient size     | > reporting-structure requirement,      |
| > that they cannot support | > ensure that documented procedures     |
| > the reporting-structure  | > exist and are followed to:            |
| > requirement must:        |                                         |
|                            | -   Ensure key custodians do not report |
| -   Ensure key custodians  |     > to each other.                    |
|     > do not report to     |                                         |
|     > each other (i.e.,    | -   Receive explicit training to        |
|     > the manager cannot   |     > instruct them from sharing key    |
|     > also be a key        |     > components with their direct      |
|     > custodian);          |     > manager.                          |
|                            |                                         |
| -   Receive explicit       | -   Sign key-custodian agreement that   |
|     > training to instruct |     > includes an attestation to the    |
|     > them from sharing    |     > requirement.                      |
|     > key components with  |                                         |
|     > their direct         | -   Ensure training includes procedures |
|     > manager;             |     > to report any violations.         |
|                            |                                         |
| -   Sign key-custodian     |                                         |
|     > agreements that      |                                         |
|     > include an           |                                         |
|     > attestation to the   |                                         |
|     > requirement; and     |                                         |
|                            |                                         |
| -   Receive training that  |                                         |
|     > includes procedures  |                                         |
|     > to report any        |                                         |
|     > violations.          |                                         |
+----------------------------+-----------------------------------------+
| **25-2** All user access   | **25-2.a** Examine documented           |
| to material that can be    | procedures to confirm that access to    |
| used to construct secret   | material that can be used to construct  |
| and private keys (such as  | secret and private keys is directly     |
| key components or key      | attributable to an individual user.     |
| shares used to             |                                         |
| reconstitute a key) must   |                                         |
| be directly attributable   |                                         |
| to an individual user      |                                         |
| (e.g., through the use of  |                                         |
| unique IDs).               |                                         |
|                            |                                         |
| ***Note:** Individual user |                                         |
| IDs may be assigned to a   |                                         |
| role or group.*            |                                         |
+----------------------------+-----------------------------------------+
|                            | **25-2.b** Observe the access-control   |
|                            | mechanisms in place to verify that      |
|                            | access to material that can be used to  |
|                            | construct secret and private keys is    |
|                            | directly attributable to an individual  |
|                            | user.                                   |
+----------------------------+-----------------------------------------+
| > **25-2.1** All user      | > **25-2.1.a** Examine documented       |
| > access must be           | > procedures to confirm that access to  |
| > restricted to actions    | > material that can be used to          |
| > authorized for that      | > construct secret and private keys     |
| > role.                    | > must be restricted to actions         |
| >                          | > authorized for that role.             |
| > ***Note:** Examples of   |                                         |
| > how access can be        |                                         |
| > restricted include the   |                                         |
| > use of CA software and   |                                         |
| > operating-system and     |                                         |
| > procedural controls.*    |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-2.1.b** Observe user role        |
|                            | > assignments and access-control        |
|                            | > mechanisms to verify that access to   |
|                            | > material that can be used to          |
|                            | > construct secret and private keys is  |
|                            | > restricted to actions authorized for  |
|                            | > that role.                            |
+----------------------------+-----------------------------------------+
| **25-3** The system        |                                         |
| enforces an explicit and   |                                         |
| well-defined certificate   |                                         |
| security policy and        |                                         |
| certification practice     |                                         |
| statement. This must       |                                         |
| include the following:     |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25-3.1** CA systems    | > **25-3.1** Examine network diagrams   |
| > that issue certificates  | > and observe network and system        |
| > to other CAs and KDHs    | > configurations to verify:             |
| > must be operated offline |                                         |
| > using a dedicated closed | -   CA systems that issue certificates  |
| > network (not a network   |     > to other CAs and KDHs are         |
| > segment).                |     > operated offline using a          |
|                            |     > dedicated closed network (not a   |
| -   The network must only  |     > network segment).                 |
|     > be used for          |                                         |
|     > certificate issuance | -   The network is only used for        |
|     > and/or revocation.   |     > certificate issuance, revocation, |
|                            |     > or both certificate issuance and  |
| -   Outside network access |     > revocation.                       |
|     > (e.g., using a       |                                         |
|     > separate platform in | -   Outside network access must exist   |
|     > the DMZ) must exist  |     > only for the purposes of          |
|     > only for the         |     > "pushing" certificate-status      |
|     > purposes of          |     > information to relying parties    |
|     > "pushing"            |     > (e.g., KDHs).                     |
|     > certificate-status   |                                         |
|     > information to       |                                         |
|     > relying parties      |                                         |
|     > (e.g., KDHs).        |                                         |
+----------------------------+-----------------------------------------+
| > **25-3.2** For CAs       | > **25-3.2** Examine software update    |
| > operated online---e.g.,  | > processes to verify that local        |
| > POI-signing CAs: CA or   | > console access is used for all CA or  |
| > Registration Authority   | > RA software updates.                  |
| > (RA) software updates    |                                         |
| > must not be done over    |                                         |
| > the network (local       |                                         |
| > console access must be   |                                         |
| > used for CA or RA        |                                         |
| > software updates).       |                                         |
+----------------------------+-----------------------------------------+
| > **25-3.3** For CAs       | > **25-3.3** Examine remote-access      |
| > operated online---e.g.,  | > mechanisms and system configurations  |
| > POI-signing CAs:         | > to verify that all non-console        |
| > Non-console access must  | > access, including remote access,      |
| > use multi-factor         | > requires multi-factor authentication. |
| > authentication. This     |                                         |
| > also applies to the use  |                                         |
| > of remote console        |                                         |
| > access.                  |                                         |
+----------------------------+-----------------------------------------+
| > **25-3.4** For CAs       | > **25-3.4.a** Examine non-console      |
| > operated online---e.g.,  | > access mechanisms and system          |
| > POI-signing CAs:         | > configurations to verify that all     |
| > Non-console user access  | > non-console user access is protected  |
| > to the CA or RA system   | > by authenticated encrypted sessions.  |
| > environments must be     |                                         |
| > protected by             |                                         |
| > authenticated encrypted  |                                         |
| > sessions. No other       |                                         |
| > remote access is         |                                         |
| > permitted to the host    |                                         |
| > platform(s) for system   |                                         |
| > or application           |                                         |
| > administration.          |                                         |
| >                          |                                         |
| > ***Note:** Access for    |                                         |
| > monitoring only (no      |                                         |
| > create, update, delete   |                                         |
| > capability) of online    |                                         |
| > systems may occur        |                                         |
| > without restriction.*    |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-3.4.b** Observe an authorized CA |
|                            | > personnel attempt non-console access  |
|                            | > to the host platform using valid CA   |
|                            | > credentials without using an          |
|                            | > authenticated encrypted session to    |
|                            | > verify that non-console access is not |
|                            | > permitted.                            |
+----------------------------+-----------------------------------------+
| > **25-3.5** CA            | > **25-3.5.a** Examine the certificate  |
| > certificate (for POI/KDH | > security policy and certification     |
| > authentication and       | > practice statement to verify that CA  |
| > validity status          | > certificate-signing keys must only be |
| > checking) signing keys   | > enabled under at least dual control.  |
| > must only be enabled     |                                         |
| > under at least dual      |                                         |
| > control.                 |                                         |
| >                          |                                         |
| > ***Note:** Certificate   |                                         |
| > requests may be vetted   |                                         |
| > (approved) using single  |                                         |
| > user logical access to   |                                         |
| > the RA application.*     |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-3.5.b** Observe                  |
|                            | > certificate-signing processes to      |
|                            | > verify that signing keys are enabled  |
|                            | > only under at least dual control.     |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **25-4** The CA must       | **25-4.a** Examine documented           |
| require a separation of    | procedures to verify they include the   |
| duties for critical CA     | following:                              |
| functions to prevent one   |                                         |
| person from maliciously    | -   Definition of critical functions of |
| using a CA system without  |     > the CA                            |
| detection, the practice    |                                         |
| referred to as "dual       | -   Separation of duties to prevent one |
| control." At a minimum,    |     > person from maliciously using a   |
| there must be multi-person |     > CA system without detection       |
| control for operational    |                                         |
| procedures such that no    | -   Multi-person control for            |
| one person can gain        |     > operational procedures such that  |
| control over the CA        |     > no one person can gain control    |
| signing key(s).            |     > over the CA signing key(s)        |
+----------------------------+-----------------------------------------+
|                            | **25-4.b** Observe CA operations and    |
|                            | interview responsible personnel to      |
|                            | verify:                                 |
|                            |                                         |
|                            | -   Definition of Critical functions of |
|                            |     > the CA                            |
|                            |                                         |
|                            | -   Separation of duties to prevent one |
|                            |     > person from maliciously using a   |
|                            |     > CA system without detection       |
|                            |                                         |
|                            | -   Multi-person control for            |
|                            |     > operational procedures such that  |
|                            |     > no one person can gain control    |
|                            |     > over the CA signing key(s)        |
+----------------------------+-----------------------------------------+
| **25-5** All CA systems    | **25-5.a** Examine system documentation |
| that are not operated      | to verify the following is required:    |
| exclusively offline must   |                                         |
| be hardened to prevent     | -   Services that are not necessary or  |
| insecure network access,   |     > that allow non-secure access      |
| to include:                |     > (e.g., rlogin, rshell, etc.,      |
|                            |     > commands in UNIX) must be removed |
| -   Services that are not  |     > or disabled.                      |
|     > necessary or that    |                                         |
|     > allow non- secure    | -   Unnecessary ports must also be      |
|     > access (e.g.,        |     > disabled.                         |
|     > rlogin, rshell,      |                                         |
|     > telnet, ftp, etc.)   | -   Documentation must exist to support |
|     > must be removed or   |     > the enablement of all active      |
|     > disabled.            |     > services and ports.               |
|                            |                                         |
| -   Unnecessary ports must |                                         |
|     > also be disabled.    |                                         |
|                            |                                         |
| -   Documentation must     |                                         |
|     > exist to support the |                                         |
|     > enablement of all    |                                         |
|     > active services and  |                                         |
|     > ports.               |                                         |
+----------------------------+-----------------------------------------+
|                            | **25-5.b** For a sample of systems,     |
|                            | examine documentation supporting the    |
|                            | enablement of active services and       |
|                            | ports, and observe system               |
|                            | configurations to verify:               |
|                            |                                         |
|                            | -   Services that are not necessary or  |
|                            |     > that allow non-secure access      |
|                            |     > (e.g., rlogin, rshell, etc.,      |
|                            |     > commands in UNIX) are removed or  |
|                            |     > disabled.                         |
|                            |                                         |
|                            | -   Unnecessary ports are disabled.     |
|                            |                                         |
|                            | -   There is documentation to support   |
|                            |     > all active services and ports.    |
+----------------------------+-----------------------------------------+
| > **25-5.1** All           | > **25-5.1.a** Examine documented       |
| > vendor-default IDs must  | > procedures to verify that:            |
| > be changed, removed, or  |                                         |
| > disabled unless          | -   Vendor-default IDs are changed,     |
| > necessary for a          |     > removed, or disabled unless       |
| > documented and specific  |     > necessary for a documented and    |
| > business reason.         |     > specific business reason.         |
| >                          |                                         |
| > *(continued on next      | -   Vendor default IDs that are         |
| > page)*                   |     > required as owners of objects or  |
|                            |     > processes or for installation of  |
|                            |     > patches and upgrades are only be  |
|                            |     > enabled when required and         |
|                            |     > otherwise must be disabled from   |
|                            |     > login.                            |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25-5.1** *(continued)* | > **25-5.1.b** Examine system           |
| >                          | > configurations and interview          |
| > Vendor default IDs that  | > responsible personnel to verify that: |
| > are required as owners   |                                         |
| > of objects or processes  | -   Vendor-default IDs are changed,     |
| > or for installation of   |     > removed or disabled unless        |
| > patches and upgrades     |     > necessary for a documented and    |
| > must only be enabled     |     > specific business reason.         |
| > when necessary and       |                                         |
| > otherwise must be        | -   Vendor default IDs that are         |
| > disabled from login.     |     > required as owners of objects or  |
|                            |     > processes or for installation of  |
|                            |     > patches and upgrades are only be  |
|                            |     > enabled when required and         |
|                            |     > otherwise must be disabled from   |
|                            |     > login.                            |
+----------------------------+-----------------------------------------+
| > **25-5.2** Vendor        | > **25-5.2.a** Examine documented       |
| > defaults, including      | > procedures to verify that vendor      |
| > passwords and SNMP       | > defaults, including passwords and     |
| > strings, that exist and  | > SNMP strings, that exist and are not  |
| > are not addressed in the | > addressed in the prior step are       |
| > prior step must be       | > changed, removed, or disabled before  |
| > changed, removed, or     | > installing a system on the network.   |
| > disabled before          |                                         |
| > installing a system on   |                                         |
| > the network.             |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-5.2.b** Examine system           |
|                            | > configurations and interview          |
|                            | > responsible personnel to verify that  |
|                            | > vendor defaults, including passwords  |
|                            | > and SNMP strings, that exist and are  |
|                            | > not addressed in the prior step are   |
|                            | > changed, removed, or disabled before  |
|                            | > installing a system on the network.   |
+----------------------------+-----------------------------------------+
| **25-6** Audit trails must | **25-6.a** Examine system               |
| include but not be limited | configurations and audit trails to      |
| to the following:          | verify that all key-management          |
|                            | operations are logged.                  |
| -   All key-management     |                                         |
|     > operations, such as  |                                         |
|     > key generation,      |                                         |
|     > loading,             |                                         |
|     > transmission,        |                                         |
|     > backup, recovery,    |                                         |
|     > compromise,          |                                         |
|     > destruction, and     |                                         |
|     > certificate          |                                         |
|     > generation or        |                                         |
|     > revocation           |                                         |
|                            |                                         |
| -   The identity of the    |                                         |
|     > person authorizing   |                                         |
|     > the operation        |                                         |
|                            |                                         |
| -   The identities of all  |                                         |
|     > persons handling any |                                         |
|     > key material (such   |                                         |
|     > as key components or |                                         |
|     > keys stored in       |                                         |
|     > portable devices or  |                                         |
|     > media)               |                                         |
|                            |                                         |
| -   Protection of the logs |                                         |
|     > from alteration and  |                                         |
|     > destruction          |                                         |
+----------------------------+-----------------------------------------+
|                            | **25-6.b** For a sample of              |
|                            | key-management operations, examine      |
|                            | audit trails to verify they include:    |
|                            |                                         |
|                            | -   The identity of the person          |
|                            |     > authorizing the operation         |
|                            |                                         |
|                            | -   The identities of all persons       |
|                            |     > handling any key material         |
|                            |                                         |
|                            | -   Mechanisms exist to protect logs    |
|                            |     > from alteration and destruction   |
+----------------------------+-----------------------------------------+
| > **25-6.1** Audit logs    | > **25-6.1** Examine audit trail files  |
| > must be archived for a   | > to verify that they are archived for  |
| > minimum of two years.    | > a minimum of two years.               |
+----------------------------+-----------------------------------------+
| > **25-6.2** Records       | > **25-6.2.a** For a sample of          |
| > pertaining to            | > certificate issuances, examine audit  |
| > certificate issuance and | > records to verify that the records    |
| > revocation must be       | > are retained for at least the life of |
| > retained for the life of | > the associated certificate.           |
| > the associated           |                                         |
| > certificate, at a        |                                         |
| > minimum.                 |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-6.2.b** For a sample of          |
|                            | > certificate revocations, examine      |
|                            | > audit records to verify that the      |
|                            | > records are retained for at least the |
|                            | > life of the associated certificate.   |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25-6.3** Logical       | > **25-6.3.a** Examine audit trails to  |
| > events are divided into  | > verify that logical events are        |
| > operating-system and CA  | > divided into operating- system and CA |
| > application events. For  | > application events.                   |
| > both, the following must |                                         |
| > be recorded in the form  |                                         |
| > of an audit record:      |                                         |
|                            |                                         |
| -   Date and time of the   |                                         |
|     > event,               |                                         |
|                            |                                         |
| -   Identity of the entity |                                         |
|     > and/or user that     |                                         |
|     > caused the event,    |                                         |
|                            |                                         |
| -   Type of event, and     |                                         |
|                            |                                         |
| -   Success or failure of  |                                         |
|     > the event            |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-6.3.b** Examine a sample of      |
|                            | > operating-system logs to verify they  |
|                            | > contain the following information:    |
|                            |                                         |
|                            | -   Date and time of the event,         |
|                            |                                         |
|                            | -   Identity of the entity and/or user  |
|                            |     > that caused the event,            |
|                            |                                         |
|                            | -   Type of event, and                  |
|                            |                                         |
|                            | -   Success or failure of the event     |
+----------------------------+-----------------------------------------+
|                            | > **25-6.3.c** Examine a sample of      |
|                            | > application logs to verify they       |
|                            | > contain the following information:    |
|                            |                                         |
|                            | -   Date and time of the event,         |
|                            |                                         |
|                            | -   Identity of the entity and/or user  |
|                            |     > that caused the event,            |
|                            |                                         |
|                            | -   Type of event, and                  |
|                            |                                         |
|                            | -   Success or failure of the event     |
+----------------------------+-----------------------------------------+
| **25-7** CA application    | **25-7.a** Examine log security         |
| logs must use a digital    | controls to verify that CA application  |
| signature or a symmetric   | logs use a digital signature or a       |
| MAC (based on one of the   | symmetric MAC (based on one of the      |
| methods stated in *ISO     | methods stated in *ISO 16609 -- Banking |
| 16609 -- Banking --        | -- Requirements for message             |
| Requirements for message   | authentication using symmetric          |
| authentication using       | techniques*) mechanism for detection of |
| symmetric techniques*)     | alteration.                             |
| mechanism for detection of |                                         |
| alteration.                |                                         |
|                            |                                         |
| The signing/MACing key(s)  |                                         |
| used for this must be      |                                         |
| protected using a secure   |                                         |
| cryptographic device in    |                                         |
| accordance with the        |                                         |
| key-management             |                                         |
| requirements stipulated in |                                         |
| this document.             |                                         |
+----------------------------+-----------------------------------------+
|                            | **25-7.b** Examine documentation and    |
|                            | interview personnel and observe to      |
|                            | verify that signing/MACing key(s) used  |
|                            | for this are protected using a secure   |
|                            | cryptographic device in accordance with |
|                            | the key-management requirements         |
|                            | stipulated in this document.            |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25-7.1**               | > **25-7.1.a** Examine network and      |
| > Certificate-processing   | > system configurations to verify that  |
| > system components        | > certificate- processing system        |
| > operated online must be  | > components operated online are        |
| > protected by a           | > protected from unauthorized access by |
| > firewall(s) from all     | > firewall(s).                          |
| > unauthorized access,     |                                         |
| > including casual         |                                         |
| > browsing and deliberate  |                                         |
| > attacks. Firewalls must  |                                         |
| > minimally be configured  |                                         |
| > to:                      |                                         |
|                            |                                         |
| -   Deny all services not  |                                         |
|     > explicitly           |                                         |
|     > permitted.           |                                         |
|                            |                                         |
| -   Disable or remove all  |                                         |
|     > unnecessary          |                                         |
|     > services, protocols, |                                         |
|     > and ports.           |                                         |
|                            |                                         |
| -   Fail to a              |                                         |
|     > configuration that   |                                         |
|     > denies all services  |                                         |
|     > and require a        |                                         |
|     > firewall             |                                         |
|     > administrator to     |                                         |
|     > re-enable services   |                                         |
|     > after a failure.     |                                         |
|                            |                                         |
| -   Disable source routing |                                         |
|     > on the firewall.     |                                         |
|                            |                                         |
| -   Not accept traffic on  |                                         |
|     > its external         |                                         |
|     > interfaces that      |                                         |
|     > appears to be coming |                                         |
|     > from internal        |                                         |
|     > network addresses.   |                                         |
|                            |                                         |
| -   Notify the firewall    |                                         |
|     > administrator in     |                                         |
|     > near real time of    |                                         |
|     > any item that may    |                                         |
|     > need immediate       |                                         |
|     > attention such as a  |                                         |
|     > break-in, little     |                                         |
|     > disk space           |                                         |
|     > available, or other  |                                         |
|     > related messages so  |                                         |
|     > that an immediate    |                                         |
|     > action can be taken. |                                         |
|                            |                                         |
| -   Run on a dedicated     |                                         |
|     > computer: All        |                                         |
|     > non-firewall related |                                         |
|     > software, such as    |                                         |
|     > compilers, editors,  |                                         |
|     > communications       |                                         |
|     > software, etc., must |                                         |
|     > be deleted or        |                                         |
|     > disabled.            |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-7.1.b** Examine firewall         |
|                            | > configurations to verify they are     |
|                            | > configured to:                        |
|                            |                                         |
|                            | -   Deny all services not explicitly    |
|                            |     > permitted.                        |
|                            |                                         |
|                            | -   Disable or remove all unnecessary   |
|                            |     > services, protocols, and ports.   |
|                            |                                         |
|                            | -   Fail to a configuration that denies |
|                            |     > all services and require a        |
|                            |     > firewall administrator to         |
|                            |     > re-enable services after a        |
|                            |     > failure.                          |
|                            |                                         |
|                            | -   Disable source routing on the       |
|                            |     > firewall.                         |
|                            |                                         |
|                            | -   Not accept traffic on its external  |
|                            |     > interfaces that appears to be     |
|                            |     > coming from internal network      |
|                            |     > addresses.                        |
|                            |                                         |
|                            | -   Notify the firewall administrator   |
|                            |     > in near real time of any item     |
|                            |     > that may need immediate attention |
|                            |     > such as a break-in, little disk   |
|                            |     > space available, or other related |
|                            |     > messages so that an immediate     |
|                            |     > action can be taken.              |
|                            |                                         |
|                            | -   Run on a dedicated computer: All    |
|                            |     > non-firewall related software,    |
|                            |     > such as compilers, editors,       |
|                            |     > communications software, etc.,    |
|                            |     > must be deleted or disabled.      |
+----------------------------+-----------------------------------------+
| > **25-7.2** Online        | > **25-7.2.a** Observe network-based    |
| > certificate-processing   | > and/or host-based IDS configurations  |
| > systems must employ      | > to verify that on-line                |
| > individually, or in      | > certificate-processing systems are    |
| > combination, network and | > protected by IDS to detect            |
| > host-based intrusion     | > inappropriate access.                 |
| > detection systems (IDS)  |                                         |
| > to detect inappropriate  |                                         |
| > access. At a minimum,    |                                         |
| > database servers and the |                                         |
| > application servers for  |                                         |
| > RA and web, as well as   |                                         |
| > the intervening          |                                         |
| > segments, must be        |                                         |
| > covered.                 |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25-7.2.b** Verify that IDS coverage |
|                            | > includes all database servers, RA     |
|                            | > application servers and web servers,  |
|                            | > as well as the intervening segments.  |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **25-8** Implement         |                                         |
| user-authentication        |                                         |
| management for all system  |                                         |
| components as follows:     |                                         |
+----------------------------+-----------------------------------------+
| > **25.8.1** Initial,      | > **25.8.1** Examine password           |
| > assigned passphrases are | > procedures and observe security       |
| > pre-expired (user must   | > personnel to verify that first-time   |
| > replace at first logon). | > passwords for new users, and reset    |
|                            | > passwords for existing users, are set |
|                            | > to a unique value for each user and   |
|                            | > are pre-expired.                      |
+----------------------------+-----------------------------------------+
| > **25.8.2** Use of group, | > **25.8.2.a** For a sample of system   |
| > shared, or generic       | > components, examine user ID lists to  |
| > accounts and passwords,  | > verify the following:                 |
| > or other authentication  |                                         |
| > methods is prohibited.   | -   Generic user IDs and accounts are   |
|                            |     > disabled or removed.              |
|                            |                                         |
|                            | -   Shared user IDs for system          |
|                            |     > administration activities and     |
|                            |     > other critical functions do not   |
|                            |     > exist.                            |
|                            |                                         |
|                            | -   Shared and generic user IDs are not |
|                            |     > used.                             |
+----------------------------+-----------------------------------------+
|                            | > **25.8.2.b** Examine authentication   |
|                            | > policies/procedures to verify that    |
|                            | > group and shared passwords or other   |
|                            | > authentication methods are explicitly |
|                            | > prohibited.                           |
+----------------------------+-----------------------------------------+
|                            | > **25.8.2.c** Interview system         |
|                            | > administrators to verify that group   |
|                            | > and shared passwords or other         |
|                            | > authentication methods are not        |
|                            | > distributed, even if requested.       |
+----------------------------+-----------------------------------------+
| > **25.8.3** If passwords  | > **25.8.3** For a sample of system     |
| > are used,                | > components, obtain and inspect system |
| > system-enforced          | > configuration settings to verify that |
| > expiration life must not | > user password parameters are set to   |
| > exceed 90 days and a     | > require users to change passwords at  |
| > minimum life at least    | > least every 90 days and have a        |
| > one day.                 | > minimum life of at least one day.     |
+----------------------------+-----------------------------------------+
| > **25.8.4** Passwords     | > **25.8.4** For a sample of system     |
| > must have a minimum      | > components, obtain and inspect system |
| > length of eight          | > configuration settings to verify that |
| > characters using a mix   | > password parameters are set to        |
| > of alphabetic, numeric,  | > require passwords to be at least      |
| > and special characters   | > eight characters long and contain     |
| > or equivalent strength   | > numeric, alphabetic, and special      |
| > as defined in *NIST SP   | > characters or equivalent strength as  |
| > 800-63b.*                | > defined in *NIST SP 800-63b.*         |
+----------------------------+-----------------------------------------+
| > **25.8.5** Limit         | > **25.8.5** For a sample of system     |
| > repeated access attempts | > components, obtain and inspect system |
| > by locking out the user  | > configuration settings to verify that |
| > ID after not more than   | > authentication parameters are set to  |
| > five attempts.           | > require that a user's account be      |
|                            | > locked out after not more than five   |
|                            | > invalid logon attempts.               |
+----------------------------+-----------------------------------------+
| > **25.8.6**               | > **25.8.6** For a sample of system     |
| > Authentication           | > components, obtain and inspect system |
| > parameters must require  | > configuration settings to verify that |
| > a system- enforced       | > authentication parameters are set to  |
| > passphrase history,      | > require a system-enforced passphrase  |
| > preventing the reuse of  | > history, preventing the reuse of any  |
| > any passphrase used in   | > passphrase used in the last 12        |
| > the last 12 months.      | > months.                               |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **25.8.7** Passwords are | > **25.8.7** For a sample of system     |
| > not stored on any of the | > components, obtain and inspect system |
| > systems except in        | > configuration settings to verify that |
| > encrypted form or as     | > passwords are not stored unless       |
| > part of a proprietary    | > encrypted as part of a proprietary    |
| > one- way transformation  | > one-way hash.                         |
| > process, such as those   |                                         |
| > used in UNIX systems.    |                                         |
+----------------------------+-----------------------------------------+
| > **25.8.8** The embedding | > **25.8.8.a** Examine policies and     |
| > of passwords in shell    | > procedures and interview personnel to |
| > scripts, command files,  | > determine that the embedding of       |
| > communication scripts,   | > passwords in shell scripts, command   |
| > etc. is strictly         | > files, communication scripts, etc. is |
| > prohibited.              | > strictly prohibited.                  |
+----------------------------+-----------------------------------------+
|                            | > **25.8.8.b** Inspect a sample of      |
|                            | > shell scripts, command files,         |
|                            | > communication scripts, etc. to verify |
|                            | > that passwords are not embedded in    |
|                            | > shell scripts, command files, or      |
|                            | > communication scripts.                |
+----------------------------+-----------------------------------------+
| > **25.8.9** Where log-on  | > **25.8.9.a** If log-on security       |
| > security tokens (e.g.,   | > tokens are used, observe devices in   |
| > smart cards) are used,   | > use to verify that the security       |
| > the security tokens must | > tokens have an associated             |
| > have an associated       | > usage-authentication mechanism, such  |
| > usage-authentication     | > as a biometric or associated          |
| > mechanism, such as a     | > PIN/passphrase to enable their usage. |
| > biometric or associated  |                                         |
| > PIN/passphrase to enable |                                         |
| > their usage. The         |                                         |
| > PIN/passphrase must be   |                                         |
| > at least eight decimal   |                                         |
| > digits in length, or     |                                         |
| > equivalent.              |                                         |
| >                          |                                         |
| > ***Note:** Log-on        |                                         |
| > security tokens (e.g.,   |                                         |
| > smart cards) and         |                                         |
| > encryption devices are   |                                         |
| > not subject to the       |                                         |
| > pass-phrase management   |                                         |
| > requirements for         |                                         |
| > password expiry as       |                                         |
| > stated above.*           |                                         |
+----------------------------+-----------------------------------------+
|                            | > **25.8.9.b** Examine                  |
|                            | > token-configuration settings to       |
|                            | > verify parameters are set to require  |
|                            | > that PINs/passwords be at least eight |
|                            | > decimal digits in length, or          |
|                            | > equivalent.                           |
+----------------------------+-----------------------------------------+
| > **25.9** Implement a     | > **25.9.a** Examine documented         |
| > method to synchronize    | > procedures and system configuration   |
| > all critical system      | > standards to verify a method is       |
| > clocks and times for all | > defined to synchronize all critical   |
| > systems involved in key- | > system clocks and times for all       |
| > management operations.   | > systems involved in key-management    |
|                            | > operations.                           |
+----------------------------+-----------------------------------------+
|                            | > **25.9.b** For a sample of critical   |
|                            | > systems, examine the time-related     |
|                            | > system parameters to verify that      |
|                            | > system clocks and times are           |
|                            | > synchronized for all systems involved |
|                            | > in key-management operations.         |
+----------------------------+-----------------------------------------+
|                            | > **25.9.c** If a manual process is     |
|                            | > defined, verify that the documented   |
|                            | > procedures require that it occur at   |
|                            | > least quarterly.                      |
+----------------------------+-----------------------------------------+
|                            | > **25.9.d** If a manual process is     |
|                            | > defined, examine system               |
|                            | > configurations and synchronization    |
|                            | > logs to verify that the process       |
|                            | > occurs at least quarterly.            |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***Requirement 26:** Logs  |                                         |
| must be kept for any time  |                                         |
| that keys, key components, |                                         |
| or related materials are   |                                         |
| removed from storage or    |                                         |
| loaded to an SCD.*         |                                         |
+----------------------------+-----------------------------------------+
| *Key-injection facilities  |                                         |
| (or applicable entities    |                                         |
| providing key-management   |                                         |
| services) must maintain    |                                         |
| logs for the key           |                                         |
| management of all keys and |                                         |
| keying material used in    |                                         |
| all key-loading sessions.  |                                         |
| These include keys and     |                                         |
| materials removed from     |                                         |
| safes and used in the      |                                         |
| loading process.*          |                                         |
+----------------------------+-----------------------------------------+
| 1.  Logs must be kept      | **26-1.a** Interview responsible        |
|     whenever keys, key     | personnel and examine documented        |
|     components, or related | procedures to determine the following:  |
|     materials are removed  |                                         |
|     from secure storage or | -   Logs are kept whenever keys, key    |
|     loaded to an SCD. The  |     > components, or related materials  |
|     logs must be securely  |     > are removed from secure storage   |
|     stored, for example,   |     > or loaded to an SCD.              |
|     in a secure container  |                                         |
|     with the associated    | -   Logs are securely stored, for       |
|     key components. These  |     > example, in a secure container    |
|     logs must be archived  |     > with the associated key           |
|     for a minimum of two   |     > components.                       |
|     years subsequent to    |                                         |
|     key destruction.       | -   Logs must be archived for a minimum |
|                            |     > of two years subsequent to key    |
| At a minimum, logs must    |     > destruction                       |
| include the following:     |                                         |
|                            |                                         |
| -   Date and time in/out   |                                         |
|                            |                                         |
| -   Key-component          |                                         |
|     > identifier           |                                         |
|                            |                                         |
| -   Purpose of access      |                                         |
|                            |                                         |
| -   Name and signature of  |                                         |
|     > custodian accessing  |                                         |
|     > the component        |                                         |
|                            |                                         |
| -   Name and signature of  |                                         |
|     > a non-custodian (for |                                         |
|     > that                 |                                         |
|     > component/share)     |                                         |
|     > witness              |                                         |
|                            |                                         |
| -   Tamper-evident and     |                                         |
|     > authenticable        |                                         |
|     > package number (if   |                                         |
|     > applicable)          |                                         |
+----------------------------+-----------------------------------------+
|                            | **26-1.b** Examine log files and audit  |
|                            | log settings to verify that logs are    |
|                            | kept for any time that keys, key        |
|                            | components, or related materials are:   |
|                            |                                         |
|                            | -   Removed from secure storage         |
|                            |                                         |
|                            | -   Loaded to an SCD                    |
+----------------------------+-----------------------------------------+
|                            | **26-1.c** Examine log files and verify |
|                            | they are:                               |
|                            |                                         |
|                            | -   Archived for a minimum of two years |
|                            |     > subsequent to key destruction     |
|                            |                                         |
|                            | -   Securely stored                     |
+----------------------------+-----------------------------------------+
|                            | **26-1.d** Examine log files and audit  |
|                            | log settings to verify that logs        |
|                            | include the following:                  |
|                            |                                         |
|                            | -   Date and time in/out                |
|                            |                                         |
|                            | -   Key component identifier            |
|                            |                                         |
|                            | -   Purpose of access                   |
|                            |                                         |
|                            | -   Name and signature of custodian     |
|                            |     > accessing the component           |
|                            |                                         |
|                            | -   Name and signature of a             |
|                            |     > non-custodian (for that           |
|                            |     > component/share) witness          |
|                            |                                         |
|                            | -   Tamper-evident and authenticable    |
|                            |     > package number (if applicable)    |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***Requirement 27:**       |                                         |
| Backups of secret and      |                                         |
| private keys must exist    |                                         |
| only for the purpose of    |                                         |
| reinstating keys that are  |                                         |
| accidentally destroyed or  |                                         |
| are otherwise              |                                         |
| inaccessible. The backups  |                                         |
| must exist only in one of  |                                         |
| the allowed storage forms  |                                         |
| for that key.*             |                                         |
|                            |                                         |
| > ***Note:** It is not a   |                                         |
| > requirement to have      |                                         |
| > backup copies of key     |                                         |
| > components or keys.*     |                                         |
+----------------------------+-----------------------------------------+
| ***Note for hybrid         |                                         |
| decryption solutions:**    |                                         |
| Clear-text cryptographic   |                                         |
| keys used on the Host      |                                         |
| System must not be         |                                         |
| included in any system     |                                         |
| back-up (refer to          |                                         |
| Requirement 4D-1.14)*      |                                         |
+----------------------------+-----------------------------------------+
| **27-1** If backup copies  | **27-1.a** Interview responsible        |
| of secret and/or private   | personnel and examine documented        |
| keys exist, they must be   | procedures and backup records to        |
| maintained in accordance   | determine whether any backup copies of  |
| with the same requirements | keys or their components exist. Perform |
| as are followed for the    | the following:                          |
| primary keys.              |                                         |
+----------------------------+-----------------------------------------+
|                            | **27-1.b** Observe backup processes to  |
|                            | verify backup copies of secret and/or   |
|                            | private keys are maintained in          |
|                            | accordance with the same requirements   |
|                            | as are followed for the primary keys.   |
+----------------------------+-----------------------------------------+
|                            | **27-1.c** Inspect backup storage       |
|                            | locations and access controls or        |
|                            | otherwise verify through examination of |
|                            | documented procedures and interviews of |
|                            | personnel that backups are maintained   |
|                            | as follows:                             |
|                            |                                         |
|                            | -   Securely stored with proper access  |
|                            |     > controls                          |
|                            |                                         |
|                            | -   Under at least dual control         |
|                            |                                         |
|                            | -   Subject to at least the same level  |
|                            |     > of security control as            |
|                            |     > operational keys as specified in  |
|                            |     > this document                     |
+----------------------------+-----------------------------------------+
| **27-2** If backup copies  | **27-2** Interview responsible          |
| are created, the following | personnel and observe backup processes  |
| must be in place:          | to verify the following:                |
|                            |                                         |
| -   Creation (including    | -   The creation of any backup copies   |
|     > cloning) of          |     > for top-level keys requires at    |
|     > top-level            |     > least two authorized individuals  |
|     > keys---e.g.,         |     > to enable the process             |
|     > MFKs---must require  |                                         |
|     > a minimum of two     | -   All requirements applicable for the |
|     > authorized           |     > original keys also apply to any   |
|     > individuals to       |     > backup copies of keys and their   |
|     > enable the process.  |     > components.                       |
|                            |                                         |
| -   All requirements       |                                         |
|     > applicable for the   |                                         |
|     > original keys also   |                                         |
|     > apply to any backup  |                                         |
|     > copies of keys and   |                                         |
|     > their components.    |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***Requirement 28:**       |                                         |
| Documented procedures must |                                         |
| exist and must be          |                                         |
| demonstrably in use for    |                                         |
| all key-administration     |                                         |
| operations.*               |                                         |
+----------------------------+-----------------------------------------+
| 1.  Written procedures     | **28-1.a** Examine documented           |
|     must exist and all     | procedures for key-administration       |
|     affected parties must  | operations to verify they cover all     |
|     be aware of those      | activities related to key               |
|     procedures. All        | administration, and include:            |
|     activities related to  |                                         |
|     key administration     | -   Training of all key custodians      |
|     must be documented.    |     > regarding their responsibilities, |
|     This includes all      |     > and forming part of their annual  |
|     aspects of key         |     > security training                 |
|     administration, as     |                                         |
|     well as:               | -   Role definition---nominated         |
|                            |     > individual with overall           |
|     -   Training of all    |     > responsibility                    |
|         > key custodians   |                                         |
|         > regarding their  | -   Background checks for personnel     |
|                            |     > (within the constraints of local  |
|        > responsibilities, |     > laws)                             |
|         > and forming part |                                         |
|         > of their annual  | -   Management of personnel changes,    |
|         > security         |     > including revocation of access    |
|         > training         |     > control and other privileges when |
|                            |     > personnel move                    |
|     -   Role               |                                         |
|                            |                                         |
|   > definition---nominated |                                         |
|         > individual with  |                                         |
|         > overall          |                                         |
|         > responsibility   |                                         |
|                            |                                         |
|     -   Background checks  |                                         |
|         > for personnel    |                                         |
|         > (within the      |                                         |
|         > constraints of   |                                         |
|         > local laws)      |                                         |
|                            |                                         |
|     -   Management of      |                                         |
|         > personnel        |                                         |
|         > changes,         |                                         |
|         > including        |                                         |
|         > revocation of    |                                         |
|         > access control   |                                         |
|         > and other        |                                         |
|         > privileges when  |                                         |
|         > personnel move   |                                         |
+----------------------------+-----------------------------------------+
|                            | **28-1.b** Interview personnel          |
|                            | responsible for key-administration      |
|                            | operations to verify that the           |
|                            | documented procedures are known and     |
|                            | understood.                             |
+----------------------------+-----------------------------------------+
|                            | **28-1.c** Interview personnel to       |
|                            | verify that security-awareness training |
|                            | is provided for the appropriate         |
|                            | personnel.                              |
+----------------------------+-----------------------------------------+
|                            | **28-1.d** Interview responsible HR     |
|                            | personnel to verify that background     |
|                            | checks are conducted (within the        |
|                            | constraints of local laws).             |
+----------------------------+-----------------------------------------+
| > **28-2** CA operations   | **28-2.a** Examine documented           |
| > must be dedicated to     | procedures to verify:                   |
| > certificate issuance and |                                         |
| > management. All physical | -   CA operations must be dedicated to  |
| > and logical CA system    |     > certificate issuance and          |
| > components must be       |     > management.                       |
| > separated from key-      |                                         |
| > distribution systems.    | -   All physical and logical CA system  |
|                            |     > components must be separated from |
|                            |     > key- distribution systems.        |
+----------------------------+-----------------------------------------+
|                            | **28-2.b** Observe CA system            |
|                            | configurations and operations to verify |
|                            | they are dedicated to certificate       |
|                            | issuance and management.                |
+----------------------------+-----------------------------------------+
|                            | **28-2.c** Observe system and network   |
|                            | configurations and physical access      |
|                            | controls to verify that all physical    |
|                            | and logical CA system components are    |
|                            | separated from key- distribution        |
|                            | systems.                                |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **28-3** Each CA operator  | **28-3.a** Examine documented           |
| must develop a             | certification practice statement (CPS)  |
| certification practice     | to verify that the CPS is consistent    |
| statement (CPS). (See *RFC | with the requirements described within  |
| 3647- Internet X.509       | this document.                          |
| Public Key Infrastructure  |                                         |
| Certificate Policy and     |                                         |
| Certification Practices    |                                         |
| Framework* for an example  |                                         |
| of content.)               |                                         |
|                            |                                         |
| -   The CPS must be        |                                         |
|     > consistent with the  |                                         |
|     > requirements         |                                         |
|     > described within     |                                         |
|     > this document.       |                                         |
|                            |                                         |
| -   The CA must operate in |                                         |
|     > accordance with its  |                                         |
|     > CPS.                 |                                         |
|                            |                                         |
| ***Note:** This may take   |                                         |
| the form of a declaration  |                                         |
| by the CA operator of the  |                                         |
| details of its trustworthy |                                         |
| system and the practices   |                                         |
| it employs in its          |                                         |
| operations and in support  |                                         |
| of the issuance of         |                                         |
| certificates. A CPS may    |                                         |
| take the form of either a  |                                         |
| specific, single document  |                                         |
| or a collection of         |                                         |
| specific documents.*       |                                         |
|                            |                                         |
| The CPS must be consistent |                                         |
| with the requirements      |                                         |
| described within this      |                                         |
| document. The CA must      |                                         |
| operate in accordance with |                                         |
| its CPS.                   |                                         |
+----------------------------+-----------------------------------------+
|                            | **28-3.b** Examine documented operating |
|                            | procedures to verify they are defined   |
|                            | in accordance with the CPS.             |
+----------------------------+-----------------------------------------+
|                            | **28-3.c** Interview personnel and      |
|                            | observe CA processes to verify that CA  |
|                            | operations are in accordance with its   |
|                            | CPS.                                    |
+----------------------------+-----------------------------------------+
| **28-4** Each CA operator  | **28-4** Examine documented certificate |
| must develop a certificate | policy to verify that the CA has one in |
| policy. (See RFC 3647-     | place.                                  |
| Internet X.509 Public Key  |                                         |
| Infrastructure Certificate |                                         |
| Policy and Certification   |                                         |
| Practices Framework for an |                                         |
| example of content.)       |                                         |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **28-5** Documented        | **28-5.a** Examine documented           |
| procedures exist and are   | procedures to verify that unless the    |
| demonstrably in use by CAs | certificate request is generated within |
| to validate the identity   | the same secure room meeting the        |
| of the certificate         | requirements of the Level 3             |
| requestor and recipient    | environment, they include validating    |
| before issuing a digital   | the identity of the certificate         |
| certificate for the        | requestor and recipient before issuing  |
| recipient's associated     | a digital certificate for the           |
| public key where the       | recipient's associated public key.      |
| certificate request is not |                                         |
| generated within the same  |                                         |
| secure room meeting the    |                                         |
| requirements of the Level  |                                         |
| 3 environment defined      |                                         |
| below. These procedures    |                                         |
| must include at a minimum, |                                         |
| two or more of the         |                                         |
| following for KDH          |                                         |
| certificate requests:      |                                         |
|                            |                                         |
| -   Verification of the    |                                         |
|     > certificate          |                                         |
|     > applicant's          |                                         |
|     > possession of the    |                                         |
|     > associated private   |                                         |
|     > key through the use  |                                         |
|     > of a digitally       |                                         |
|     > signed certificate   |                                         |
|     > request pursuant to  |                                         |
|     > PKCS #10 or another  |                                         |
|     > cryptographically    |                                         |
|     > equivalent           |                                         |
|     > demonstration;       |                                         |
|                            |                                         |
| -   Determination that the |                                         |
|     > organization exists  |                                         |
|     > by using at least    |                                         |
|     > one third-party      |                                         |
|     > identity-proofing    |                                         |
|     > service or database  |                                         |
|     > or, alternatively,   |                                         |
|     > organizational       |                                         |
|     > documentation issued |                                         |
|     > by or filed with the |                                         |
|     > applicable           |                                         |
|     > government agency or |                                         |
|     > competent authority  |                                         |
|     > that confirms the    |                                         |
|     > existence of the     |                                         |
|     > organization;        |                                         |
|                            |                                         |
| -   Confirmation by        |                                         |
|     > telephone,           |                                         |
|     > confirmatory postal  |                                         |
|     > mail, and/or         |                                         |
|     > comparable procedure |                                         |
|     > to the certificate   |                                         |
|     > applicant to confirm |                                         |
|     > that the             |                                         |
|     > organization has     |                                         |
|     > authorized the       |                                         |
|     > certificate          |                                         |
|     > application,         |                                         |
|     > confirmation of the  |                                         |
|     > employment of the    |                                         |
|     > representative       |                                         |
|     > submitting the       |                                         |
|     > certificate          |                                         |
|     > application on       |                                         |
|     > behalf of the        |                                         |
|     > certificate          |                                         |
|     > applicant, and       |                                         |
|     > confirmation of the  |                                         |
|     > authority of the     |                                         |
|     > representative to    |                                         |
|     > act on behalf of the |                                         |
|     > certificate          |                                         |
|     > applicant;           |                                         |
|                            |                                         |
| -   Confirmation by        |                                         |
|     > telephone,           |                                         |
|     > confirmatory postal  |                                         |
|     > mail, and/or         |                                         |
|     > comparable procedure |                                         |
|     > to the certificate   |                                         |
|     > applicant's          |                                         |
|     > representative to    |                                         |
|     > confirm that the     |                                         |
|     > person named as      |                                         |
|     > representative has   |                                         |
|     > submitted the        |                                         |
|     > certificate          |                                         |
|     > application.         |                                         |
+----------------------------+-----------------------------------------+
|                            | **28-5.b** Observe certificate-issuing  |
|                            | processes to verify that the identities |
|                            | of the certificate requestor and        |
|                            | recipient are validated before issuing  |
|                            | a digital certificate for the           |
|                            | recipient's associated public key.      |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Control Objective 6:    |                                         |
| Keys are administered in a |                                         |
| secure manner***           |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **28-5.1** For CA and    | > **28-5.1.a** Examine documented       |
| > KDH certificate-signing  | > procedures to verify that             |
| > requests, including      | > certificate-signing requests,         |
| > certificate or           | > including certificate or key-validity |
| > key-validity status      | > status changes, require validation    |
| > changes---e.g.,          | > that:                                 |
| > revocation, suspension,  |                                         |
| >                          | -   The entity submitting the request   |
| replacement---verification |     > is who it claims to be.           |
| > must include validation  |                                         |
| > that:                    | -   The entity submitting the request   |
|                            |     > is authorized to submit the       |
| -   The entity submitting  |     > request on behalf of the          |
|     > the request is who   |     > certificate request's originating |
|     > it claims to be.     |     > entity.                           |
|                            |                                         |
| -   The entity submitting  | -   The entity submitting the request   |
|     > the request is       |     > has a valid business relationship |
|     > authorized to submit |     > with the issuing authority (e.g., |
|     > the request on       |     > the vendor) consistent with the   |
|     > behalf of the        |     > certificate being requested.      |
|     > certificate          |                                         |
|     > request's            | -   The certificate-signing request has |
|     > originating entity.  |     > been transferred from the         |
|                            |     > certificate request's originating |
| -   The entity submitting  |     > entity to the RA in a secure      |
|     > the request has a    |     > manner.                           |
|     > valid business       |                                         |
|     > relationship with    |                                         |
|     > the issuing          |                                         |
|     > authority (e.g., the |                                         |
|     > vendor) consistent   |                                         |
|     > with the certificate |                                         |
|     > being requested.     |                                         |
|                            |                                         |
| -   The                    |                                         |
|     > certificate-signing  |                                         |
|     > request has been     |                                         |
|     > transferred from the |                                         |
|     > certificate          |                                         |
|     > request's            |                                         |
|     > originating entity   |                                         |
|     > to the RA in a       |                                         |
|     > secure manner.       |                                         |
+----------------------------+-----------------------------------------+
|                            | > **28-5.1.b** Observe                  |
|                            | > certificate-signing requests,         |
|                            | > including certificate or key-validity |
|                            | > status changes, to verify they        |
|                            | > include validation that:              |
|                            |                                         |
|                            | -   The entity submitting the request   |
|                            |     > is who it claims to be.           |
|                            |                                         |
|                            | -   The entity submitting the request   |
|                            |     > is authorized to submit the       |
|                            |     > request on behalf of the          |
|                            |     > certificate request's originating |
|                            |     > entity.                           |
|                            |                                         |
|                            | -   The entity submitting the request   |
|                            |     > has a valid business relationship |
|                            |     > with the issuing authority (e.g., |
|                            |     > the vendor) consistent with the   |
|                            |     > certificate being requested.      |
|                            |                                         |
|                            | -   The certificate-signing request has |
|                            |     > been transferred from the         |
|                            |     > certificate request's originating |
|                            |     > entity to the RA in a secure      |
|                            |     > manner.                           |
+----------------------------+-----------------------------------------+
| > **28-5.2** RAs must      | > **28-5.2** Examine documentation and  |
| > retain documentation and | > audit trails to verify that the       |
| > audit trails relating to | > identification of entities is         |
| > the identification of    | > retained for the life of the          |
| > entities for all         | > associated certificates:              |
| > certificates issued and  |                                         |
| > certificates whose       | -   For all certificates issued         |
| > status had changed for   |                                         |
| > the life of the          | -   For all certificates whose status   |
| > associated certificates. |     > had changed                       |
+----------------------------+-----------------------------------------+

+-----------------------------+----------------------------------------+
| []{#_bookmark63             |                                        |
| .anchor}***Control          |                                        |
| Objective 7: Equipment used |                                        |
| to process account data and |                                        |
| keys is managed in a secure |                                        |
| manner***                   |                                        |
+=============================+========================================+
| > **Domain 5 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| ***Requirement 29:**        |                                        |
| Equipment used to protect   |                                        |
| account data (e.g., POI     |                                        |
| devices and HSMs) must be   |                                        |
| placed into service only if |                                        |
| there is assurance that the |                                        |
| equipment has not been      |                                        |
| substituted or subjected to |                                        |
| unauthorized modifications  |                                        |
| or tampering prior to the   |                                        |
| deployment of the device--- |                                        |
| both prior to and           |                                        |
| subsequent to the loading   |                                        |
| of cryptographic keys---and |                                        |
| that precautions are taken  |                                        |
| to minimize the threat of   |                                        |
| compromise once deployed.*  |                                        |
+-----------------------------+----------------------------------------+
| > ***Note:** Where POI is   |                                        |
| > mentioned in              |                                        |
| > **Requirement 29**, the   |                                        |
| > requirements apply to the |                                        |
| > solution provider         |                                        |
| > managing POI devices      |                                        |
| > prior to deployment to    |                                        |
| > distribution channels or  |                                        |
| > to the merchants that     |                                        |
| > will process payments     |                                        |
| > with the POI device.      |                                        |
| > Merchant protection and   |                                        |
| > use of POI devices once   |                                        |
| > deployed are not the      |                                        |
| > subject of these P2PE     |                                        |
| > requirements and are      |                                        |
| > instead covered by        |                                        |
| > guidance provided to      |                                        |
| > merchants by the solution |                                        |
| > provider in the P2PE      |                                        |
| > Instruction Manual (PIM). |                                        |
| > See the PIM Template for  |                                        |
| > more information about    |                                        |
| > guidance required to be   |                                        |
| > included in the PIM.*     |                                        |
|                             |                                        |
| *Likewise, distribution     |                                        |
| channels used by a solution |                                        |
| provider to distribute POI  |                                        |
| devices to the end merchant |                                        |
| are also not the subjects   |                                        |
| of these P2PE requirements. |                                        |
| However, regardless of the  |                                        |
| distribution channel used,  |                                        |
| the merchant that will      |                                        |
| process payments with the   |                                        |
| device must be able to      |                                        |
| confirm that the device and |                                        |
| packaging have not been     |                                        |
| tampered with via           |                                        |
| instructions provided in    |                                        |
| the PIM. For example, this  |                                        |
| could be done via secure    |                                        |
| inner packaging that easily |                                        |
| shows evidence that it has  |                                        |
| been tampered with or       |                                        |
| opened previously via       |                                        |
| instructions provided to    |                                        |
| the merchant in the PIM.    |                                        |
| The merchant in such        |                                        |
| scenarios must also be able |                                        |
| to establish secure,        |                                        |
| confirmed communications    |                                        |
| with the solution provider  |                                        |
| via the POI device keys,    |                                        |
| also with instructions      |                                        |
| provided in the PIM.*       |                                        |
+-----------------------------+----------------------------------------+
| *Key-injection facilities   |                                        |
| (or applicable entities     |                                        |
| providing key-management    |                                        |
| services) must ensure that  |                                        |
| only legitimate, unaltered  |                                        |
| devices are loaded with     |                                        |
| cryptographic keys.*        |                                        |
|                             |                                        |
| *Secure rooms must be       |                                        |
| established for inventory   |                                        |
| that includes securing POI  |                                        |
| devices that have not had   |                                        |
| keys injected. The area     |                                        |
| must have extended walls    |                                        |
| from the real floor to the  |                                        |
| real ceiling using          |                                        |
| sheetrock, wire mesh, or    |                                        |
| equivalent. Equivalence can |                                        |
| be steel cages extending    |                                        |
| floor to real ceiling. The  |                                        |
| cages can have a steel cage |                                        |
| top in lieu of the sides    |                                        |
| extending to the real       |                                        |
| ceiling. The cages must     |                                        |
| have locks (with logs) or   |                                        |
| badge control with logging  |                                        |
| for entry.*                 |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| ***Control Objective 7:     |                                        |
| Equipment used to process   |                                        |
| account data and keys is    |                                        |
| managed in a secure         |                                        |
| manner***                   |                                        |
+=============================+========================================+
| > **Domain 5 Requirements** | > **Testing Procedures**               |
+-----------------------------+----------------------------------------+
| **29-1** Secure             | **29-1.a** Examine documented          |
| cryptographic               | procedures to confirm that processes   |
| devices---such as HSMs and  | are defined to provide the following   |
| POI devices---must be       | assurances prior to the loading of     |
| placed into service only if | cryptographic keys:                    |
| there is assurance that the |                                        |
| equipment has not been      | -   POI devices have not been          |
| subjected to unauthorized   |     > substituted or subjected to      |
| modifications,              |     > unauthorized modifications or    |
| substitution, or tampering  |     > tampering.                       |
| and has not otherwise been  |                                        |
| subject to misuse prior to  | -   SCDs used for                      |
| deployment.                 |     > key-injection/loading or code    |
|                             |     > signing have not been            |
| ***Note**: This applies to  |     > substituted or subjected to      |
| SCDs used for key injection |     > unauthorized modifications or    |
| or code signing, including  |     > tampering.                       |
| display prompts.*           |                                        |
+-----------------------------+----------------------------------------+
|                             | **29-1.b** Observe processes and       |
|                             | interview personnel to verify that     |
|                             | processes are followed to provide the  |
|                             | following assurances prior to the      |
|                             | loading of cryptographic keys:         |
|                             |                                        |
|                             | -   POI devices have not been          |
|                             |     > substituted or subjected to      |
|                             |     > unauthorized modifications or    |
|                             |     > tampering.                       |
|                             |                                        |
|                             | -   SCDs used for                      |
|                             |     > key-injection/loading or code    |
|                             |     > signing have not been            |
|                             |     > substituted or subjected to      |
|                             |     > unauthorized modifications or    |
|                             |     > tampering.                       |
+-----------------------------+----------------------------------------+
| > **29-1.1** All POI        | > **29-1.1** Examine documented        |
| > devices and other SCDs    | > procedures to verify controls are    |
| > must be protected against | > defined to protect POI devices and   |
| > compromise. Any           | > other SCDs from unauthorized access  |
| > compromise must be        | > up to point of deployment.           |
| > detected. Loading and use |                                        |
| > of any financial keys     |                                        |
| > after the compromise must |                                        |
| > be prevented.             |                                        |
| >                           |                                        |
| > Controls must include the |                                        |
| > following:                |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **29-1.1.1** Access to    | > **29-1.1.1.a** Examine               |
| > all POI devices and other | > access-control documentation and     |
| > SCDs is documented,       | > device configurations to verify that |
| > defined, logged, and      | > access to all POI devices and        |
| > controlled such that      | > key-injection/loading devices is     |
| > unauthorized individuals  | > defined and documented.              |
| > cannot access, modify, or |                                        |
| > substitute any device     |                                        |
| > without detection.        |                                        |
| >                           |                                        |
| > The minimum log contents  |                                        |
| > include date and time,    |                                        |
| > object name/identifier,   |                                        |
| > purpose, name of          |                                        |
| > individual(s) involved,   |                                        |
| > signature or electronic   |                                        |
| > capture (e.g., badge) of  |                                        |
| > individual involved and,  |                                        |
| > if applicable,            |                                        |
| > tamper-evident package    |                                        |
| > number(s) and serial      |                                        |
| > number(s) of device(s)    |                                        |
| > involved.                 |                                        |
| >                           |                                        |
| > Electronic logginge.g.,  |                                        |
| > using bar codesis        |                                        |
| > acceptable for device     |                                        |
| > tracking.                 |                                        |
+=============================+========================================+
|                             | > **29-1.1.1.b** For a sample of POI   |
|                             | > device types and other SCDs, observe |
|                             | > authorized personnel accessing       |
|                             | > devices and examine access logs to   |
|                             | > verify that access to all POI        |
|                             | > devices and other SCDs is logged.    |
+-----------------------------+----------------------------------------+
|                             | > **29-1.1.1.c** Examine implemented   |
|                             | > access controls to verify that       |
|                             | > unauthorized individuals cannot      |
|                             | > access, modify, or substitute any    |
|                             | > POI device or other SCD.             |
+-----------------------------+----------------------------------------+
| > **29-1.1.2** All          | > **29-1.1.2.a** Examine documented    |
| > personnel with access to  | > authorizations for personnel with    |
| > POI devices and other     | > access to devices to verify that     |
| > SCDs **prior to           | > prior to deployment:                 |
| > deployment** are          |                                        |
| > documented in a formal    | -   All personnel with access to POI   |
| > list and authorized by    |     > devices and other SCDs are       |
| > management. A documented  |     > authorized by management in an   |
| > security policy must      |     > auditable manner.                |
| > exist that requires the   |                                        |
| > specification of          | -   The authorizations are reviewed    |
| > personnel with authorized |     > annually.                        |
| > access to all secure      |                                        |
| > cryptographic devices.    |                                        |
| > This includes             |                                        |
| > documentation of all      |                                        |
| > personnel with access to  |                                        |
| > POI devices and other     |                                        |
| > SCDs as authorized by     |                                        |
| > management. The list of   |                                        |
| > authorized personnel is   |                                        |
| > reviewed at least         |                                        |
| > annually.                 |                                        |
| >                           |                                        |
| > ***Note:** "Prior to      |                                        |
| > deployment" for this      |                                        |
| > requirement means prior   |                                        |
| > to the solution provider  |                                        |
| > (or component provider)   |                                        |
| > sending POI devices to    |                                        |
| > either a distribution     |                                        |
| > channel or the end        |                                        |
| > merchant who will use the |                                        |
| > POI device to process     |                                        |
| > payment transactions.*    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **29-1.1.2.b** For a sample of POI   |
|                             | > device types and other SCDs, examine |
|                             | > implemented access controls to       |
|                             | > verify that only personnel           |
|                             | > documented and authorized in an      |
|                             | > auditable manner have access to      |
|                             | > devices.                             |
+-----------------------------+----------------------------------------+
| > **29-1.2** POI devices    | > **29-1.2.a** Examine vendor          |
| > and other SCDs must not   | > documentation or other information   |
| > use default keys or data  | > sources to identify default keys     |
| > (such as keys that are    | > (such as keys that are pre-installed |
| > pre-installed for testing | > for testing purposes), passwords, or |
| > purposes) or              | > data.                                |
| > passwords/authentication  |                                        |
| > codes.                    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **29-1.2.b** Observe implemented     |
|                             | > processes and interview personnel to |
|                             | > verify that default keys or          |
|                             | > passwords are not used.              |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| **29-2** Implement a        | **29-2.a** Examine documented          |
| documented "chain of        | processes to verify that the chain of  |
| custody" to ensure that all | custody is required for devices from   |
| devices are controlled from | receipt to placement into service.     |
| receipt to placement into   |                                        |
| service.                    |                                        |
|                             |                                        |
| The chain of custody must   |                                        |
| include records to identify |                                        |
| responsible personnel for   |                                        |
| each interaction with the   |                                        |
| devices.                    |                                        |
|                             |                                        |
| ***Note:** Chain of custody |                                        |
| includes procedures, as     |                                        |
| stated in **Requirement     |                                        |
| 29-1**, that ensure that    |                                        |
| access to all POI devices   |                                        |
| and other SCDs is           |                                        |
| documented, defined,        |                                        |
| logged, and controlled such |                                        |
| that unauthorized           |                                        |
| individuals cannot access,  |                                        |
| modify, or substitute any   |                                        |
| device without detection.*  |                                        |
+=============================+========================================+
|                             | **29-2.b** For a sample of devices,    |
|                             | examine documented records and         |
|                             | interview responsible personnel to     |
|                             | verify the chain of custody is         |
|                             | maintained from receipt to placement   |
|                             | into service.                          |
+-----------------------------+----------------------------------------+
|                             | **29-2.c** Verify that the             |
|                             | chain-of-custody records identify      |
|                             | responsible personnel for each         |
|                             | interaction with the device.           |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| **29-3** Implement physical | **29-3.a** Examine documented          |
| protection of devices from  | procedures to verify they require      |
| the manufacturer's facility | physical protection of devices from    |
| up to the point of          | the manufacturer's facility up to the  |
| key-insertion or            | point of key-insertion and deployment, |
| inspection, through one or  | through one or more of the defined     |
| more of the following:      | methods.                               |
|                             |                                        |
| -   Transportation using a  |                                        |
|     > trusted courier       |                                        |
|     > service (e.g., via    |                                        |
|     > bonded carrier). The  |                                        |
|     > devices are then      |                                        |
|     > securely stored until |                                        |
|     > key-insertion occurs. |                                        |
|                             |                                        |
| -   Use of physically       |                                        |
|     > secure and trackable  |                                        |
|     > packaging (e.g.,      |                                        |
|     > pre-serialized,       |                                        |
|                             |                                        |
|    > counterfeit-resistant, |                                        |
|     > tamper-evident        |                                        |
|     > packaging). The       |                                        |
|     > devices are then      |                                        |
|     > stored in such        |                                        |
|     > packaging, or in      |                                        |
|     > secure storage, until |                                        |
|     > key-insertion occurs. |                                        |
|                             |                                        |
| -   A secret, device-unique |                                        |
|     > "transport-protection |                                        |
|     > token" is loaded into |                                        |
|     > the secure storage    |                                        |
|     > area of each device   |                                        |
|     > at the manufacturer's |                                        |
|     > facility. The SCD     |                                        |
|     > used for              |                                        |
|     > key-insertion         |                                        |
|     > verifies the presence |                                        |
|     > of the correct        |                                        |
|     > "transport-protection |                                        |
|     > token" before         |                                        |
|     > overwriting this      |                                        |
|     > value with the        |                                        |
|     > initial key, and the  |                                        |
|     > device is further     |                                        |
|     > protected until       |                                        |
|     > deployment.           |                                        |
|                             |                                        |
| -   Upon tamper of the      |                                        |
|     > device it becomes     |                                        |
|     > infeasible to load    |                                        |
|     > any keying material.  |                                        |
|                             |                                        |
| -   Shipped and stored      |                                        |
|     > containing a secret   |                                        |
|     > that:                 |                                        |
|                             |                                        |
| > ![](vertopal_6            |                                        |
| 0a238a099614e179dec6351a3c5 |                                        |
| 0457/media/image34.png){wid |                                        |
| th="7.443569553805775e-2in" |                                        |
| > height=                   |                                        |
| "6.364829396325459e-3in"}Is |                                        |
| > immediately and           |                                        |
| > automatically erased if   |                                        |
| > any physical or           |                                        |
| > functional alteration to  |                                        |
| > the device is attempted,  |                                        |
| > and                       |                                        |
| >                           |                                        |
| > ![](vertopal_6            |                                        |
| 0a238a099614e179dec6351a3c5 |                                        |
| 0457/media/image34.png){wid |                                        |
| th="7.443569553805775e-2in" |                                        |
| > height="                  |                                        |
| 6.364829396325459e-3in"}Can |                                        |
| > be verified by the        |                                        |
| > initial key-loading       |                                        |
| > facility, but that cannot |                                        |
| > feasibly be determined by |                                        |
| > unauthorized personnel.   |                                        |
| >                           |                                        |
| > *(continued on next       |                                        |
| > page)*                    |                                        |
+=============================+========================================+
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **29-3** *(continued)*    | **29-3.b** Interview responsible       |
|                             | personnel to verify that one or more   |
| -   Each cryptographic      | of the defined methods are in place to |
|     > device is carefully   | provide physical device protection for |
|     > inspected and tested  | devices, from the manufacturer's       |
|     > immediately prior to  | facility up to the point of            |
|     > key-insertion and     | key-insertion and deployment.          |
|     > deployment using due  |                                        |
|     > diligence. This is    |                                        |
|     > done to provide       |                                        |
|     > reasonable assurance  |                                        |
|     > that it is the        |                                        |
|     > legitimate device and |                                        |
|     > that it has not been  |                                        |
|     > subject to any        |                                        |
|     > unauthorized access   |                                        |
|     > or modifications.     |                                        |
|                             |                                        |
| > ***Note:** Unauthorized   |                                        |
| > access includes that by   |                                        |
| > customs officials.*       |                                        |
|                             |                                        |
| -   Devices incorporate     |                                        |
|     > self-tests to ensure  |                                        |
|     > their correct         |                                        |
|     > operation. Devices    |                                        |
|     > must not be           |                                        |
|     > re-installed unless   |                                        |
|     > there is assurance    |                                        |
|     > they have not been    |                                        |
|     > tampered with or      |                                        |
|     > compromised.          |                                        |
|                             |                                        |
| > *(**Note**: this control  |                                        |
| > must be used in           |                                        |
| > conjunction with one of   |                                        |
| > the other methods.)*      |                                        |
|                             |                                        |
| -   Controls exist and are  |                                        |
|     > in use to ensure that |                                        |
|     > all physical and      |                                        |
|     > logical controls and  |                                        |
|     > anti-tamper           |                                        |
|     > mechanisms used are   |                                        |
|     > not modified or       |                                        |
|     > removed.              |                                        |
+=============================+========================================+
| **29-4** Dual-control       | **29-4.a** Examine documented          |
| mechanisms must exist to    | procedures to verify that dual-control |
| prevent substitution or     | mechanisms exist to prevent            |
| tampering of HSMs---both    | substitution or tampering of           |
| deployed and spare or       | HSMs---both deployed and spare or      |
| backup devices---throughout | back-up devices---throughout their     |
| their lifecycle. Procedural | life cycle.                            |
| controls, which may be a    |                                        |
| combination of physical     |                                        |
| barriers and logical        |                                        |
| controls, may exist to      |                                        |
| support the prevention and  |                                        |
| detection of substituted    |                                        |
| HSMs, but cannot supplant   |                                        |
| the implementation of       |                                        |
| dual-control mechanisms.    |                                        |
+-----------------------------+----------------------------------------+
|                             | **29-4.b** Interview responsible       |
|                             | personnel and physically verify the    |
|                             | dual-control mechanism used to prevent |
|                             | substitution or tampering of           |
|                             | HSMs---both in service and spare or    |
|                             | back-up devices---throughout their     |
|                             | life cycle.                            |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **29-4.1** HSM serial     | > **29-4.1.a** Interview responsible   |
| > numbers must be compared  | > personnel to verify that device      |
| > to the serial numbers     | > serial numbers are compared to the   |
| > documented by the sender  | > serial number documented by the      |
| > (sent using a different   | > sender.                              |
| > communication channel     |                                        |
| > from the device) to       |                                        |
| > ensure device             |                                        |
| > substitution has not      |                                        |
| > occurred. A record of     |                                        |
| > device serial- number     |                                        |
| > verification must be      |                                        |
| > maintained.               |                                        |
| >                           |                                        |
| > ***Note:** Documents used |                                        |
| > for this process must be  |                                        |
| > received via a different  |                                        |
| > communication             |                                        |
| > channel---i.e., the       |                                        |
| > control document used     |                                        |
| > must not have arrived     |                                        |
| > with the equipment. An    |                                        |
| > example of how serial     |                                        |
| > numbers may be documented |                                        |
| > by the sender includes    |                                        |
| > but is not limited to     |                                        |
| > manufacturer's invoice or |                                        |
| > similar document.*        |                                        |
+=============================+========================================+
|                             | > **29-4.1.b** For a sample of         |
|                             | > received devices, examine sender     |
|                             | > documentation sent by a different    |
|                             | > communication channel than the       |
|                             | > device's shipment (e.g., the         |
|                             | > manufacturer's invoice or similar    |
|                             | > documentation) used to verify device |
|                             | > serial numbers. Examine the record   |
|                             | > of serial-number validations to      |
|                             | > confirm the serial number for the    |
|                             | > received device was verified to      |
|                             | > match that documented by the sender. |
+-----------------------------+----------------------------------------+
| > **29-4.2** The security   | > **29-4.2.a** Obtain and examine the  |
| > policy enforced by the    | > defined security policy to be        |
| > HSM must not allow        | > enforced by the HSM.                 |
| > unauthorized or           |                                        |
| > unnecessary functions.    |                                        |
| > HSM API functionality and |                                        |
| > commands that are not     |                                        |
| > required to support       |                                        |
| > specified functionality   |                                        |
| > must be disabled before   |                                        |
| > the equipment is          |                                        |
| > commissioned.             |                                        |
| >                           |                                        |
| > Documentation (e.g., a    |                                        |
| > checklist or similar      |                                        |
| > suitable to use as a log) |                                        |
| > of configuration settings |                                        |
| > must exist and be signed  |                                        |
| > and dated by personnel    |                                        |
| > responsible for the       |                                        |
| > implementation. This      |                                        |
| > documentation must        |                                        |
| > include identifying       |                                        |
| > information for the HSM,  |                                        |
| > such as serial number     |                                        |
| > and/or asset identifiers. |                                        |
| > This documentation must   |                                        |
| > be retained and updated   |                                        |
| > for each affected HSM any |                                        |
| > time changes to           |                                        |
| > configuration settings    |                                        |
| > would impact security.    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **29-4.2.b** Examine documentation   |
|                             | > of the HSM configuration settings    |
|                             | > from past commissioning events to    |
|                             | > determine that the functions and     |
|                             | > commands enabled are in accordance   |
|                             | > with the security policy.            |
+-----------------------------+----------------------------------------+
|                             | > **29-4.2.c** For a sample of HSMs,   |
|                             | > examine the configuration settings   |
|                             | > to determine that only authorized    |
|                             | > functions are enabled.               |
+-----------------------------+----------------------------------------+
|                             | > **29-4.2.d** *Not used in P2PE*      |
+-----------------------------+----------------------------------------+
|                             | > **29-4.2.e** *Not used in P2PE*      |
+-----------------------------+----------------------------------------+
|                             | > **29-4.2.f** Examine documentation   |
|                             | > to verify:                           |
|                             |                                        |
|                             | -   Configuration settings are         |
|                             |     > defined, signed, and dated by    |
|                             |     > personnel responsible for        |
|                             |     > implementation.                  |
|                             |                                        |
|                             | -   It includes identifying            |
|                             |     > information for the HSM, such as |
|                             |     > serial number and/or asset       |
|                             |     > identifiers.                     |
|                             |                                        |
|                             | -   The documentation is retained and  |
|                             |     > updated anytime configuration    |
|                             |     > setting impacting security occur |
|                             |     > for each affected HSM.           |
+-----------------------------+----------------------------------------+
| > **29-4.3** When HSMs are  | > **29-4.3** Examine HSM               |
| > connected to online       | > configurations and observe processes |
| > systems, controls are in  | > to verify that HSMs are not enabled  |
| > place to prevent the use  | > in a sensitive state when connected  |
| > of an HSM to perform      | > to online systems.                   |
| > privileged or sensitive   |                                        |
| > functions that are not    |                                        |
| > available during routine  |                                        |
| > HSM operations.           |                                        |
| >                           |                                        |
| > ***Note:** Examples of    |                                        |
| > sensitive functions       |                                        |
| > include but are not       |                                        |
| > limited to: loading of    |                                        |
| > key components,           |                                        |
| > outputting clear-text key |                                        |
| > components, and altering  |                                        |
| > HSM configuration.*       |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **29-4.4** Inspect and    | > **29-4.4** Examine documented        |
| > test all HSMs---either    | > procedures to verify they require    |
| > new or retrieved from     | > inspection and testing of HSMs prior |
| > secure storage---prior to | > to installation to verify the        |
| > installation to verify    | > integrity of the device and include  |
| > devices have not been     | > requirements specified at            |
| > tampered with or          | > **29-4.4.1** through **29-4.4.4**    |
| > compromised.              | > below.                               |
| >                           |                                        |
| > Processes must include:   |                                        |
+=============================+========================================+
| > **29-4.4.1** Running      | > **29-4.4.1** Examine records of      |
| > self-tests to ensure the  | > device inspections and test results  |
| > correct operation of the  | > to verify that self-tests are run on |
| > device.                   | > devices to ensure the correct        |
|                             | > operation of the device.             |
+-----------------------------+----------------------------------------+
| > **29-4.4.2** Installing   | > **29-4.4.2** Observe inspection      |
| > (or re-installing)        | > processes and interview responsible  |
| > devices only after        | > personnel to verify that devices are |
| > confirming that the       | > installed, or reinstalled, only      |
| > device has not been       | > after confirming that the device has |
| > tampered with or          | > not been tampered with or            |
| > compromised.              | > compromised.                         |
+-----------------------------+----------------------------------------+
| > **29-4.4.3** Physical     | > **29-4.4.3** Observe inspection      |
| > and/or functional tests   | > processes and interview responsible  |
| > and visual inspection to  | > personnel to confirm processes       |
| > confirm that physical and | > include physical and/or functional   |
| > logical controls and      | > tests and visual inspection to       |
| > anti-tamper mechanisms    | > verify that physical and logical     |
| > are not modified or       | > controls and anti-tamper mechanisms  |
| > removed.                  | > are not modified or removed.         |
+-----------------------------+----------------------------------------+
| > **29-4.4.4** Maintaining  | > **29-4.4.4.a** Examine records of    |
| > records of the tests and  | > inspections and interview            |
| > inspections, and          | > responsible personnel to verify      |
| > retaining records for at  | > records of the tests and inspections |
| > least one year.           | > are maintained.                      |
+-----------------------------+----------------------------------------+
|                             | > **29-4.4.4.b** Examine records of    |
|                             | > inspections to verify records are    |
|                             | > retained for at least one year.      |
+-----------------------------+----------------------------------------+
| > **29-5** Maintain HSMs in | > **29-5.a** Examine documented        |
| > tamper-evident packaging  | > procedures to verify they require    |
| > or in secure storage      | > devices be maintained in             |
| > until ready for           | > tamper-evident packaging until ready |
| > installation.             | > for installation.                    |
+-----------------------------+----------------------------------------+
|                             | > **29-5.b** Observe a sample of       |
|                             | > received devices to verify they are  |
|                             | > maintained in tamper-evident         |
|                             | > packaging until ready for            |
|                             | > installation.                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > ***Requirement 30:**      |                                        |
| > Physical and logical      |                                        |
| > protections must exist    |                                        |
| > for deployed POI          |                                        |
| > devices.*                 |                                        |
+=============================+========================================+
| Key-injection facilities    |                                        |
| (or applicable entities     |                                        |
| providing key-management    |                                        |
| services) must ensure       |                                        |
| protection against          |                                        |
| unauthorized use of SCDs    |                                        |
| (e.g., HSMs) used in the    |                                        |
| key-injection platform that |                                        |
| are capable of encrypting a |                                        |
| key and producing           |                                        |
| cryptograms of that key.    |                                        |
+-----------------------------+----------------------------------------+
| ***30-1 Not used in P2PE*** |                                        |
+-----------------------------+----------------------------------------+
| ***30-2 Not used in P2PE*** |                                        |
+-----------------------------+----------------------------------------+
| **30-3** Processes must     | **30-3.a** Obtain and examine          |
| exist to ensure that        | documentation of inventory control and |
| key-injection operations    | monitoring procedures. Determine that  |
| are performed and           | the procedures cover:                  |
| reconciled on an inventory  |                                        |
| of pre-authorized devices.  | -   Each production run is associated  |
|                             |     > with a predefined inventory of   |
| Processes must include the  |     > identified POI devices to be     |
| following:                  |     > injected or initialized with     |
|                             |     > keys.                            |
| -   Each production run     |                                        |
|     > must be associated    | -   Unauthorized personnel are not     |
|     > with a predefined     |     > able to modify this inventory    |
|     > inventory of          |     > without detection.               |
|     > identified POI        |                                        |
|     > devices to be         | -   All POI devices to be initialized  |
|     > injected or           |     > with keys on a production run    |
|     > initialized with      |     > are identified and accounted for |
|     > keys.                 |     > against the inventory.           |
|                             |                                        |
| -   Unauthorized personnel  | -   Unauthorized POI devices submitted |
|     > must not be able to   |     > for injection or initialized are |
|     > modify this inventory |     > rejected by the injection        |
|     > without detection.    |     > platform and investigated.       |
|                             |                                        |
| -   All POI devices to be   | -   Once processed by the KIF, whether |
|     > initialized with keys |     > successfully initialized with    |
|     > on a production run   |     > keys or not, all submitted POI   |
|     > must be identified    |     > devices are identified and       |
|     > and accounted for     |     > accounted for against the        |
|     > against the           |     > inventory.                       |
|     > inventory.            |                                        |
|                             |                                        |
| -   Unauthorized POI        |                                        |
|     > devices submitted for |                                        |
|     > injection or          |                                        |
|     > initialized must be   |                                        |
|     > rejected by the       |                                        |
|     > injection platform    |                                        |
|     > and investigated.     |                                        |
|                             |                                        |
| -   Once processed by the   |                                        |
|     > KIF, whether          |                                        |
|     > successfully          |                                        |
|     > initialized with keys |                                        |
|     > or not, all submitted |                                        |
|     > POI devices must be   |                                        |
|     > identified and        |                                        |
|     > accounted for against |                                        |
|     > the inventory.        |                                        |
|                             |                                        |
| ***Note:** The KIF platform |                                        |
| must ensure that only       |                                        |
| authorized devices can ever |                                        |
| be injected or initialized  |                                        |
| with authorized keys.       |                                        |
| Processes must prevent (1)  |                                        |
| substitution of an          |                                        |
| authorized device with an   |                                        |
| unauthorized device, and    |                                        |
| (2) insertion of an         |                                        |
| unauthorized device into a  |                                        |
| production run.*            |                                        |
+-----------------------------+----------------------------------------+
|                             | > **30-3.b** Interview applicable      |
|                             | > personnel to determine that          |
|                             | > procedures are known and followed.   |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > ***Requirement 31:**      |                                        |
| > Procedures must be in     |                                        |
| > place and implemented to  |                                        |
| > protect any SCDs---and    |                                        |
| > ensure the destruction of |                                        |
| > any cryptographic keys or |                                        |
| > key material within such  |                                        |
| > devices---when removed    |                                        |
| > from service, retired at  |                                        |
| > the end of the deployment |                                        |
| > lifecycle, or returned    |                                        |
| > for repair.*              |                                        |
+=============================+========================================+
| *Key-injection facilities   |                                        |
| (or applicable entities     |                                        |
| providing key-management    |                                        |
| services) must have         |                                        |
| procedures to ensure keys   |                                        |
| are destroyed in            |                                        |
| cryptographic devices       |                                        |
| removed from service. This  |                                        |
| applies to any SCDs (e.g.,  |                                        |
| HSM) used in the            |                                        |
| key-injection platform, as  |                                        |
| well as to any devices that |                                        |
| have been loaded with keys  |                                        |
| and securely stored or      |                                        |
| warehoused on site that are |                                        |
| subsequently deemed to be   |                                        |
| unnecessary and never to be |                                        |
| placed into service.*       |                                        |
|                             |                                        |
| > *If a key-injection       |                                        |
| > facility receives a used  |                                        |
| > device to reload with     |                                        |
| > keys, procedures must     |                                        |
| > ensure that old keys that |                                        |
| > may be in the device are  |                                        |
| > destroyed prior to        |                                        |
| > loading of new keys. (The |                                        |
| > used device should have   |                                        |
| > had its keys destroyed    |                                        |
| > when it was removed from  |                                        |
| > service, but this is a    |                                        |
| > prudent secondary check   |                                        |
| > that the keys were        |                                        |
| > destroyed.)*              |                                        |
+-----------------------------+----------------------------------------+
| > ***Note:** The            |                                        |
| > requirements within       |                                        |
| > **Requirement 31** apply  |                                        |
| > to the solution provider  |                                        |
| > managing POI devices when |                                        |
| > removed from service,     |                                        |
| > retired at the end of the |                                        |
| > deployment lifecycle, or  |                                        |
| > returned for repair.      |                                        |
| > Merchant protection and   |                                        |
| > use of POI devices once   |                                        |
| > deployed are not the      |                                        |
| > subjects of these P2PE    |                                        |
| > requirements and are      |                                        |
| > instead covered by        |                                        |
| > guidance provided to      |                                        |
| > merchants by the solution |                                        |
| > provider in the P2PE      |                                        |
| > Instruction Manual (PIM). |                                        |
| > See the PIM Template for  |                                        |
| > more information about    |                                        |
| > guidance required to be   |                                        |
| > included in the PIM.*     |                                        |
+-----------------------------+----------------------------------------+
| 1.  Procedures must be in   | 1.  Verify that documented procedures  |
|     place to ensure that    |     for removing SCDs from service     |
|     any SCDs to be removed  |     include the following:             |
|     from service---e.g.,    |                                        |
|     retired or returned for |     -   Procedures require that all    |
|     repair--- are not       |         > secret and private keys, key |
|     intercepted or used in  |         > material, and all account    |
|     an unauthorized manner, |         > data stored within the       |
|     including rendering all |         > device be securely           |
|     secret and private      |         > destroyed.                   |
|     keys, key material, and |                                        |
|     account data stored     |     -   Procedures cover all devices   |
|     within the device       |         > removed from service         |
|     irrecoverable.          |         > permanently or for repair.   |
|                             |                                        |
| Processes must include the  |     -   Procedures cover requirements  |
| following:                  |         > at **31-1.1** through        |
|                             |         > **31-1.6** below.            |
| ***Note:** Without          |                                        |
| proactive key-removal       |                                        |
| processes, devices removed  |                                        |
| from service can retain     |                                        |
| cryptographic keys in       |                                        |
| battery- backed RAM for     |                                        |
| days or weeks. Likewise,    |                                        |
| host/hardware security      |                                        |
| modules (HSMs) can also     |                                        |
| retain keys---and more      |                                        |
| critically, the Master File |                                        |
| Key---resident within these |                                        |
| devices. Proactive          |                                        |
| key-removal procedures must |                                        |
| be in place to delete all   |                                        |
| such keys from any SCD      |                                        |
| being removed from the      |                                        |
| network.*                   |                                        |
+-----------------------------+----------------------------------------+
| > **31-1.1** HSMs require   | > **31-1.1.a** Examine documented      |
| > dual control (e.g., to    | > procedures for removing HSMs from    |
| > invoke the system menu)   | > service to verify that dual control  |
| > to implement all critical | > is implemented for all critical      |
| > decommissioning           | > decommissioning processes.           |
| > processes.                |                                        |
| >                           |                                        |
| > ***Note:** Dual control   |                                        |
| > is not explicitly         |                                        |
| > required by the HSM       |                                        |
| > itself. E.g., an HSM with |                                        |
| > a decommission-type       |                                        |
| > physical button (e.g., a  |                                        |
| > zeroize button) is        |                                        |
| > acceptable provided       |                                        |
| > physical access to the    |                                        |
| > HSM (and therefore the    |                                        |
| > mechanism for             |                                        |
| > decommissioning) requires |                                        |
| > dual control.*            |                                        |
+-----------------------------+----------------------------------------+
|                             | > **31-1.1.b** Interview personnel and |
|                             | > observe demonstration (if HSM is     |
|                             | > available) of processes for removing |
|                             | > HSMs from service to verify that     |
|                             | > dual control is implemented for all  |
|                             | > critical decommissioning processes.  |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **31-1.2** Keys and       | > **31-1.2** Interview personnel and   |
| > account data are rendered | > observe demonstration of processes   |
| > irrecoverable (e.g.,      | > for removing SCDs from service to    |
| > zeroized) for SCDs. If    | > verify that all keying material and  |
| > data cannot be rendered   | > account data are rendered            |
| > irrecoverable, devices    | > irrecoverable (e.g., zeroized), or   |
| > must be physically        | > that devices are physically          |
| > destroyed under dual      | > destroyed under dual control to      |
| > control to prevent the    | > prevent the disclosure of any        |
| > disclosure of any         | > sensitive data or keys.              |
| > sensitive data or keys.   |                                        |
+=============================+========================================+
| > **31-1.3** SCDs being     | > **31-1.3** Interview personnel and   |
| > decommissioned are tested | > observe processes for removing SCDs  |
| > and inspected to ensure   | > from service to verify that tests    |
| > keys and account data     | > and inspections of devices are       |
| > have been rendered        | > performed to confirm that keys and   |
| > irrecoverable.            | > account data have been rendered      |
|                             | > irrecoverable.                       |
+-----------------------------+----------------------------------------+
| > **31-1.4** Affected       | > **31-1.4** Interview responsible     |
| > entities are notified     | > personnel and examine device-return  |
| > before devices are        | > records to verify that affected      |
| > returned.                 | > entities are notified before devices |
|                             | > are returned.                        |
+-----------------------------+----------------------------------------+
| > **31-1.5** Devices are    | > **31-1.5** Interview responsible     |
| > tracked during the return | > personnel and examine device-return  |
| > process.                  | > records to verify that devices are   |
|                             | > tracked during the return process.   |
+-----------------------------+----------------------------------------+
| > **31-1.6** Records of the | > **31-1.6** Interview personnel and   |
| > tests and inspections are | > observe records to verify that       |
| > maintained for at least   | > records of the tests and inspections |
| > one year.                 | > are maintained for at least one      |
|                             | > year.                                |
+-----------------------------+----------------------------------------+
| > ***Requirement 32:** Any  |                                        |
| > SCD capable of encrypting |                                        |
| > a key and producing       |                                        |
| > cryptograms (i.e., an HSM |                                        |
| > or key-injection/loading  |                                        |
| > device) of that key, or   |                                        |
| > signing applications to   |                                        |
| > be loaded onto a POI      |                                        |
| > device, must be protected |                                        |
| > against unauthorized use  |                                        |
| > to encrypt known keys or  |                                        |
| > known key components.     |                                        |
| > This protection takes the |                                        |
| > form of one or more of    |                                        |
| > the following:*           |                                        |
|                             |                                        |
| a)  *Dual access controls   |                                        |
|     > required to enable    |                                        |
|     > the key-encryption    |                                        |
|     > function*             |                                        |
|                             |                                        |
| b)  *Physical protection of |                                        |
|     > the equipment (e.g.,  |                                        |
|     > locked access to it)  |                                        |
|     > under dual control*   |                                        |
|                             |                                        |
| c)  *Restriction of logical |                                        |
|     > access to the         |                                        |
|     > equipment*            |                                        |
+-----------------------------+----------------------------------------+
| *Key-injection facilities   |                                        |
| (or applicable entities     |                                        |
| providing key-management    |                                        |
| services) must ensure       |                                        |
| protection against          |                                        |
| unauthorized use for SCDs   |                                        |
| (e.g., HSMs) used in the    |                                        |
| key-injection platform that |                                        |
| are capable of encrypting a |                                        |
| key and producing           |                                        |
| cryptograms of that key.*   |                                        |
+-----------------------------+----------------------------------------+
| **32-1** For HSMs and other | **32-1.a** Examine documented          |
| SCDs used for the           | procedures to confirm that they        |
| generation or loading of    | specify protection against             |
| cryptographic keys for use  | unauthorized access and use for HSMs   |
| in POI devices, or for      | and other devices used for the         |
| signing applications and/or | generation or loading of cryptographic |
| whitelists to be loaded     | keys for use in POI devices, or for    |
| into POI devices,           | signing applications and/or whitelists |
| procedures must be          | to be loaded into POI devices.         |
| documented and implemented  |                                        |
| to protect against          |                                        |
| unauthorized access and     |                                        |
| use.                        |                                        |
|                             |                                        |
| Required procedures and     |                                        |
| processes include the       |                                        |
| following:                  |                                        |
+-----------------------------+----------------------------------------+
|                             | **32-1.b** Verify that documented      |
|                             | procedures cover requirements          |
|                             | **32-1.1** through **32-1.5**          |
|                             |                                        |
|                             | below.                                 |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-1.1** Devices must   | > **32-1.1** Observe dual-control      |
| > not be authorized for use | > mechanisms and device-authorization  |
| > except under the dual     | > processes to confirm that logical    |
| > control of at least two   | > and/or physical characteristics are  |
| > authorized people.        | > in place that prevent the device     |
| >                           | > being authorized for use except      |
| > ***Note:** Dual control   | > under the dual control of at least   |
| > consists of logical       | > two authorized people.               |
| > and/or physical           |                                        |
| > characteristics. For      |                                        |
| > example, dual control may |                                        |
| > be implemented for        |                                        |
| > logical access via two    |                                        |
| > individuals with two      |                                        |
| > different                 |                                        |
| > passwords/authentication  |                                        |
| > codes (at least five      |                                        |
| > characters in length), or |                                        |
| > for physical access via a |                                        |
| > physical lock that        |                                        |
| > requires two individuals  |                                        |
| > each with a different     |                                        |
| > high- security key.*      |                                        |
| >                           |                                        |
| > *For devices that do not  |                                        |
| > support two or more       |                                        |
| > passwords/authentication  |                                        |
| > codes, this may be        |                                        |
| > achieved by splitting the |                                        |
| > single password used by   |                                        |
| > the device into two       |                                        |
| > halves, each half         |                                        |
| > controlled by a separate  |                                        |
| > authorized custodian.     |                                        |
| > Each half must be a       |                                        |
| > minimum of five           |                                        |
| > characters.*              |                                        |
| >                           |                                        |
| > *Physical keys,           |                                        |
| > authorization codes,      |                                        |
| > passwords/authentication  |                                        |
| > codes, or other enablers  |                                        |
| > must be managed so that   |                                        |
| > no one person can use     |                                        |
| > both the enabler(s) and   |                                        |
| > the device, which can     |                                        |
| > create cryptograms of     |                                        |
| > known keys or key         |                                        |
| > components under a        |                                        |
| > key-encipherment key used |                                        |
| > in production.*           |                                        |
+=============================+========================================+
| > **32-1.2**                | > **32-1.2** Observe password policies |
| > Passwords/authentication  | > and configuration settings to        |
| > codes used for dual       | > confirm that                         |
| > control must each be of   | > passwords/authentication codes used  |
| > at least five numeric     | > for dual control must be at least    |
| > and/or alphabetic         | > five numeric and/or alphabetic       |
| > characters.               | > characters.                          |
+-----------------------------+----------------------------------------+
| > **32-1.3** Dual control   | > **32-1.3** Examine dual-control      |
| > must be implemented for   | > mechanisms and observe authorized    |
| > the following:            | > personnel performing the defined     |
|                             | > activities to confirm that dual      |
| -   To enable any manual    | > control is implemented for the       |
|     > key-encryption        | > following:                           |
|     > functions and any     |                                        |
|     > key-encryption        | -   To enable any manual               |
|     > functions that occur  |     > key-encryption functions, and    |
|     > outside of normal     |     > any key-encryption functions     |
|     > transaction           |     > that occur outside of normal     |
|     > processing;           |     > transaction processing;          |
|                             |                                        |
| -   To enable               | -   To enable application-signing      |
|     > application-signing   |     > functions;                       |
|     > functions;            |                                        |
|                             | -   To place the device into a state   |
| -   To place the device     |     > that allows for the input or     |
|     > into a state that     |     > output of clear- text key        |
|     > allows for the input  |     > components;                      |
|     > or output of          |                                        |
|     > clear-text key        | -   For all access to KLDs and         |
|     > components;           |     > authenticated                    |
|                             |     > application-signing devices.     |
| -   For all access to       |                                        |
|     > key-loading devices   |                                        |
|     > (KLDs) and            |                                        |
|     > authenticated         |                                        |
|     > application-signing   |                                        |
|     > devices.              |                                        |
+-----------------------------+----------------------------------------+
| > **32-1.4** Devices must   | > **32-1.4.a** Examine password        |
| > not use default           | > policies and documented procedures   |
| > passwords/authentication  | > to confirm default                   |
| > codes.                    | > passwords/authentication codes must  |
|                             | > not be used for HSMs, KLDs, and      |
|                             | > other SCDs used to generate or load  |
|                             | > cryptographic keys, or to sign       |
|                             | > applications or whitelists.          |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
|                             | > **32-1.4.b** Observe device          |
|                             | > configurations and interview device  |
|                             | > administrators to verify that HSMs,  |
|                             | > KLDs and other SCDs used to generate |
|                             | > or load cryptographic keys, or to    |
|                             | > sign applications or whitelists, do  |
|                             | > not use default                      |
|                             | > passwords/authentication codes.      |
+=============================+========================================+
| > **32-1.5** To detect any  | > **32-1.5.a** Examine and confirm     |
| > unauthorized use, devices | > documented procedures require        |
| > are at all times within a | > devices are within a secure room and |
| > secure room and either:   | > are either:                          |
|                             |                                        |
| -   Locked in a secure      | -   Locked in a secure cabinet and/or  |
|     > cabinet and/or sealed |     > sealed in tamper-evident         |
|     > in tamper- evident    |     > packaging at all times, or       |
|     > packaging, or         |                                        |
|                             | -   Under the continuous supervision   |
| -   Under the continuous    |     > of at least two authorized       |
|     > supervision of at     |     > people at all times.             |
|     > least two authorized  |                                        |
|     > people who ensure     |                                        |
|     > that any unauthorized |                                        |
|     > use of the device     |                                        |
|     > would be detected.    |                                        |
|                             |                                        |
| > ***Note:** For            |                                        |
| > key-injection facilities, |                                        |
| > or applicable entities    |                                        |
| > providing key-management  |                                        |
| > services, POI devices may |                                        |
| > be secured by storage in  |                                        |
| > the dual-control access   |                                        |
| > key-injection room.*      |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-1.5.b** Interview responsible   |
|                             | > personnel and observe devices and    |
|                             | > processes to confirm that devices    |
|                             | > are at all times within a secure     |
|                             | > room and either:                     |
|                             |                                        |
|                             | -   Locked in a secure cabinet and/or  |
|                             |     > sealed in tamper-evident         |
|                             |     > packaging at all times, or       |
|                             |                                        |
|                             | -   Under the continuous supervision   |
|                             |     > of at least two authorized       |
|                             |     > people at all times.             |
+-----------------------------+----------------------------------------+
| > **32-2 Intentionally left |                                        |
| > blank**                   |                                        |
+-----------------------------+----------------------------------------+
| > **32-2.1** The            | > **32-2.1.a** Examine physical        |
| > certificate-processing    | > security policies to verify three    |
| > operations center must    | > tiers of physical security are       |
| > implement a three-tier    | > defined as follows:                  |
| > physical security         |                                        |
| > boundary, as follows:     | -   Level One Barrier -- The entrance  |
|                             |     > to the facility                  |
| -   Level One Barrier --    |                                        |
|     > Consists of the       | -   Level Two Barrier -- The entrance  |
|     > entrance to the       |     > beyond the foyer/reception area  |
|     > facility.             |     > to the CA facility               |
|                             |                                        |
| -   Level Two Barrier --    | -   Level Three Barrier -- Access to   |
|     > Secures the entrance  |     > the physically secure, dedicated |
|     > beyond the            |     > room housing the CA and RA       |
|     > foyer/reception area  |     > database and application servers |
|     > to the CA facility.   |     > and cryptographic devices        |
|                             |                                        |
| -   Level Three Barrier --  |                                        |
|     > Provides access to    |                                        |
|     > the physically        |                                        |
|     > secure, dedicated     |                                        |
|     > room housing the CA   |                                        |
|     > and RA database and   |                                        |
|     > application servers   |                                        |
|     > and cryptographic     |                                        |
|     > devices.              |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.1.b** Observe the physical    |
|                             | > facility to verify three tiers of    |
|                             | > physical security are implemented as |
|                             | > follows:                             |
|                             |                                        |
|                             | -   Level One Barrier -- The entrance  |
|                             |     > to the facility                  |
|                             |                                        |
|                             | -   Level Two Barrier -- The entrance  |
|                             |     > beyond the foyer/reception area  |
|                             |     > to the CA facility               |
|                             |                                        |
|                             | -   Level Three Barrier -- Access to   |
|                             |     > the physically secure, dedicated |
|                             |     > room housing the CA and RA       |
|                             |     > database and application servers |
|                             |     > and cryptographic devices        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **Level 1 Barrier**       |                                        |
+=============================+========================================+
| > **32-2.2** The entrance   |                                        |
| > to the CA                 |                                        |
| > facility/building must    |                                        |
| > include the following     |                                        |
| > controls:                 |                                        |
+-----------------------------+----------------------------------------+
| > **32-2.2.1** The facility | > **32-2.2.1.a** Examine               |
| > entrance only allows      | > physical-security procedures and     |
| > authorized personnel to   | > policies to verify they require that |
| > enter the facility.       | > the facility entrance allows only    |
|                             | > authorized personnel to enter the    |
|                             | > facility.                            |
+-----------------------------+----------------------------------------+
|                             | > **32-2.2.1.b** Observe the facility  |
|                             | > entrance and observe personnel       |
|                             | > entering the facility to verify that |
|                             | > only authorized personnel are        |
|                             | > allowed to enter the facility.       |
+-----------------------------+----------------------------------------+
| > **32-2.2.2** The facility | > **32-2.2.2.a** Examine               |
| > has a guarded entrance or | > physical-security procedures and     |
| > a foyer with a            | > policies to verify they require that |
| > receptionist. No entry is | > the facility have a guarded entrance |
| > allowed for visitors if   | > or a foyer with a receptionist or    |
| > the entryway is not       | > the entryway prevents access to      |
| > staffed---i.e., only      | > visitors.                            |
| > authorized personnel who  |                                        |
| > badge or otherwise        |                                        |
| > authenticate themselves   |                                        |
| > can enter when entryway   |                                        |
| > is unstaffed.             |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.2.2.b** Observe the facility  |
|                             | > entrance to verify it has a guarded  |
|                             | > entrance or a foyer with a           |
|                             | > receptionist.                        |
+-----------------------------+----------------------------------------+
| > **32-2.2.3** Visitors     | > **32-2.2.3.a** Examine               |
| > (guests) to the facility  | > physical-security procedures and     |
| > must be authorized and be | > policies to verify they require      |
| > registered in a logbook.  | > visitors to the facility to be       |
|                             | > authorized and be registered in a    |
|                             | > logbook.                             |
+-----------------------------+----------------------------------------+
|                             | > **32-2.2.3.b** Observe the facility  |
|                             | > entrance and observe personnel       |
|                             | > entering the facility to verify that |
|                             | > visitors are authorized and          |
|                             | > registered in a logbook.             |
+-----------------------------+----------------------------------------+
| > **Level 2 Barrier**       |                                        |
+-----------------------------+----------------------------------------+
| > **32-2.3** The Level 2    | > **32-2.3.a** Examine                 |
| > barrier/entrance must     | > physical-security procedures and     |
| > only allow authorized     | > policies to verify that only         |
| > personnel beyond this     | > authorized personnel are allowed     |
| > entrance.                 | > beyond the Level 2 barrier/entrance. |
+-----------------------------+----------------------------------------+
|                             | > **32-2.3.b** Observe personnel       |
|                             | > entering the Level 2                 |
|                             | > barrier/entrance to verify that only |
|                             | > authorized personnel are allowed     |
|                             | > through.                             |
+-----------------------------+----------------------------------------+
| > **32-2.3.1** Visitors     | > **32-2.3.1.a** Examine documented    |
| > must be authorized and    | > policies and procedures to verify    |
| > escorted at all times     | > that authorized visitors must be     |
| > within the Level 2        | > escorted at all times within the     |
| > environment.              | > Level 2 environment.                 |
+-----------------------------+----------------------------------------+
|                             | > **32-2.3.1.b** Interview personnel   |
|                             | > and observe visitors entering the    |
|                             | > environment to verify that visitors  |
|                             | > are authorized and escorted at all   |
|                             | > times within the Level 2             |
|                             | > environment.                         |
+-----------------------------+----------------------------------------+
| > **32-2.3.2** Access logs  | > **32-2.3.2.a** Examine documented    |
| > must record all personnel | > policies and procedures to verify    |
| > entering the Level 2      | > that access logs are required to     |
| > environment.              | > record all personnel entering the    |
| >                           | > Level 2 environment.                 |
| > ***Note:** The logs may   |                                        |
| > be electronic, manual, or |                                        |
| > both.*                    |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.3.2.b** Observe personnel     |
|                             | > entering the Level 2 barrier and     |
|                             | > examine corresponding access logs to |
|                             | > verify that all entry through the    |
|                             | > Level 2 barrier is logged.           |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-2.4** The Level 2    | > **32-2.4.a** Observe the Level 2     |
| > entrance must be          | > entrance to verify that a            |
| > monitored by a video-     | > video-recording system is in place.  |
| > recording system.         |                                        |
+=============================+========================================+
|                             | > **32-2.4.b** Examine a sample of     |
|                             | > recorded footage to verify that the  |
|                             | > video-recording system captures all  |
|                             | > entry through the Level 2 entrance.  |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **Level 3 Barrier**       |                                        |
+=============================+========================================+
| > **32-2.5** The Level 3    | > **32-2.5.a** Examine documented      |
| > environment must consist  | > policies and procedures to verify    |
| > of a physically secure,   | > that all certificate- processing     |
| > dedicated room not used   | > systems must be located within a     |
| > for any other business    | > Level 3 environment.                 |
| > activities but            |                                        |
| > certificate operations.   |                                        |
| >                           |                                        |
| > ***Note:** All            |                                        |
| > certificate-processing    |                                        |
| > operations must operate   |                                        |
| > in the Level 3            |                                        |
| > environment.*             |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.5.b** Examine physical        |
|                             | > locations of certificate operations  |
|                             | > to verify that all                   |
|                             | > certificate-processing systems are   |
|                             | > located within a Level 3 secure      |
|                             | > room.                                |
+-----------------------------+----------------------------------------+
|                             | > **32-2.5.c** Observe operations and  |
|                             | > interview personnel to confirm that  |
|                             | > the Level 3 secure room is not used  |
|                             | > for any business activity other than |
|                             | > certificate operations.              |
+-----------------------------+----------------------------------------+
| > **32-2.5.1** Doors to the | > **32-2.5.1** Observe Level 3         |
| > Level 3 secure room must  | > environment entrances to verify that |
| > have locking mechanisms.  | > all doors to the Level 3 environment |
|                             | > have locking mechanisms.             |
+-----------------------------+----------------------------------------+
| > **32-2.5.2** The Level 3  | > **32-2.5.2.a** Examine physical      |
| > environment must be       | > security documentation for the Level |
| > enclosed on all sides     | > 3 environment to verify that the     |
| > (including the ceiling    | > environment is enclosed on all sides |
| > and flooring areas) using | > (including the ceiling and flooring  |
| > techniques such as true   | > areas) using techniques such as have |
| > floor-to-ceiling          | > true floor-to-ceiling (slab-to-slab) |
| > (slab-to-slab) walls,     | > walls, steel mesh, or bars           |
| > steel mesh, or bars.      |                                        |
| >                           |                                        |
| > *For example, the Level 3 |                                        |
| > environment may be        |                                        |
| > implemented within a      |                                        |
| > "caged" environment.*     |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.5.2.b** Examine the physical  |
|                             | > boundaries of the Level 3            |
|                             | > environment to verify that the       |
|                             | > environment is enclosed on all sides |
|                             | > (including the ceiling and flooring  |
|                             | > areas) using techniques such as true |
|                             | > floor-to-ceiling (slab-to-slab)      |
|                             | > walls, steel mesh, or bars and       |
|                             | > protection from entry from below     |
|                             | > floors and above ceilings.           |
+-----------------------------+----------------------------------------+
| > **32-2.6** Documented     | > **32-2.6.a** Examine documented      |
| > procedures must exist     | > procedures to verify they include    |
| > for:                      | > the following:                       |
|                             |                                        |
| -   Granting, revocation,   | -   Granting, revocation, and review   |
|     > and review of access  |     > of access privileges by an       |
|     > privileges by an      |     > authorized officer of the entity |
|     > authorized officer of |     > operating the CA                 |
|     > the entity operating  |                                        |
|     > the CA                | -   Specific access authorizations,    |
|                             |     > whether logical or physical      |
| -   Specific access         |                                        |
|     > authorizations,       |                                        |
|     > whether logical or    |                                        |
|     > physical              |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.6.b** Interview responsible   |
|                             | > personnel to verify that the         |
|                             | > documented procedures are followed   |
|                             | > for:                                 |
|                             |                                        |
|                             | -   Granting, revocation, and review   |
|                             |     > of access privileges by an       |
|                             |     > authorized officer of the entity |
|                             |     > operating the CA                 |
|                             |                                        |
|                             | -   Specific access authorizations,    |
|                             |     > whether logical or physical      |
+-----------------------------+----------------------------------------+
| > **32-2.6.1** All          | > **32-2.6.1.a** Examine documented    |
| > authorized personnel with | > policies and procedures to verify    |
| > access through the Level  | > they require personnel authorized as |
| > 3 barrier must:           | > having access through the Level 3    |
| >                           | > barrier to:                          |
| > *(continued on next       |                                        |
| > page)*                    | -   Have successfully completed a      |
|                             |     > background security check.       |
|                             |                                        |
|                             | -   Be assigned resources of the CA    |
|                             |     > operator with defined business   |
|                             |     > needs and duties.                |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-2.6.1**              | > **32-2.6.1.b** Interview responsible |
| > *(continued)*             | > HR personnel to verify that          |
|                             | > background checks are conducted      |
| -   Have successfully       | > (within the constraints of local     |
|     > completed a           | > laws) on CA personnel prior such     |
|     > background security   | > personnel being authorized for       |
|     > check                 | > access through the Level 3 barrier.  |
|                             |                                        |
| -   Be assigned resources   |                                        |
|     > (staff, dedicated     |                                        |
|     > personnel) of the CA  |                                        |
|     > operator with defined |                                        |
|     > business needs and    |                                        |
|     > duties                |                                        |
|                             |                                        |
| > ***Note:** This           |                                        |
| > requirement applies to    |                                        |
| > all personnel with pre-   |                                        |
| > designated access to the  |                                        |
| > Level 3 environment.*     |                                        |
+=============================+========================================+
|                             | > **32-2.6.1.c** Interview a sample of |
|                             | > personnel authorized for access      |
|                             | > through the Level 3 barrier to       |
|                             | > verify that they are assigned        |
|                             | > resources of the CA with defined     |
|                             | > business needs and duties.           |
+-----------------------------+----------------------------------------+
| > **32-2.6.2** Other        | > **32-2.6.2.a** Examine documented    |
| > personnel requiring entry | > policies and procedures to verify    |
| > to this level must be     | > that personnel requiring entry to    |
| > accompanied by two (2)    | > this level must be accompanied by    |
| > authorized and assigned   | > two (2) authorized and assigned      |
| > resources at all times.   | > resources at all times.              |
+-----------------------------+----------------------------------------+
|                             | > **32-2.6.2.b** Interview a sample of |
|                             | > responsible personnel to verify that |
|                             | > personnel requiring entry to this    |
|                             | > level are accompanied by two (2)     |
|                             | > authorized and assigned resources at |
|                             | > all times.                           |
+-----------------------------+----------------------------------------+
| > **32-2.7** The Level 3    | > **32-2.7.a** Examine documented      |
| > environment must require  | > policies and procedures to verify    |
| > dual-control access and   | > that the Level 3 environment         |
| > dual-occupancy such that  | > requires dual-control access and     |
| > the room is never         | > dual-occupancy such that the room is |
| > occupied by one person    | > never occupied by one person alone   |
| > for more than thirty (30) | > for more than thirty (30) seconds.   |
| > seconds--- i.e., one      |                                        |
| > person may never be in    |                                        |
| > the room for more than 30 |                                        |
| > seconds alone.            |                                        |
| >                           |                                        |
| > *For example: The Level 3 |                                        |
| > room is never occupied by |                                        |
| > one person except during  |                                        |
| > the time of entry and/or  |                                        |
| > exit, and the period for  |                                        |
| > entry/exit does not       |                                        |
| > exceed 30 seconds.*       |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.7.b** Observe authorized      |
|                             | > personnel accessing the Level 3      |
|                             | > environment to verify that           |
|                             | > dual-control access and              |
|                             | > dual-occupancy is enforced such that |
|                             | > the room is never occupied by one    |
|                             | > person alone for more than thirty    |
|                             | > (30) seconds.                        |
+-----------------------------+----------------------------------------+
| > **32-2.7.1** The          | > **32-2.7.1.a** Examine documented    |
| > mechanism for enforcing   | > policies and procedures to verify    |
| > dual-control and          | > that the defined enforcement         |
| > dual-occupancy must be    | > mechanism is automated.              |
| > automated.                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.7.1.b** Observe enforcement   |
|                             | > mechanism configuration to verify it |
|                             | > is automated.                        |
+-----------------------------+----------------------------------------+
| > **32-2.7.2** The system   | > **32-2.7.2.a** Examine documented    |
| > must enforce              | > policies and procedures to verify    |
| > anti-pass-back.           | > that the system is required to       |
|                             | > enforce anti-pass-back.              |
+-----------------------------+----------------------------------------+
|                             | > **32-2.7.2.b** Observe mechanisms in |
|                             | > use and authorized personnel within  |
|                             | > the environment to verify that       |
|                             | > anti-pass-back is enforced by the    |
|                             | > conduct of a test.                   |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-2.7.3** Dual         | > **32-2.7.3.a** Examine documented    |
| > occupancy requirements    | > policies and procedures to verify    |
| > are managed using         | > that dual occupancy requirements are |
| > electronic (e.g., badge   | > defined to be managed using          |
| > and/or biometric)         | > electronic (e.g., badge and/or       |
| > systems.                  | > biometric) systems.                  |
+=============================+========================================+
|                             | > **32-2.7.3.b** Observe mechanisms in |
|                             | > use and authorized personnel within  |
|                             | > the environment to verify that       |
|                             | > dual-occupancy requirements are      |
|                             | > managed using electronic systems.    |
+-----------------------------+----------------------------------------+
| > **32-2.7.4** Any time a   | > **32-2.7.4.a** Examine documented    |
| > single occupancy exceeds  | > policies and procedures to verify    |
| > 30 seconds, the system    | > that any time one person is alone in |
| > must automatically        | > the room for more than 30 seconds,   |
| > generate an alarm and     | > the system must automatically        |
| > audit event that is       | > generate an alarm and an audit event |
| > followed up by security   | > that is followed up by security      |
| > personnel.                | > personnel.                           |
+-----------------------------+----------------------------------------+
|                             | > **32-2.7.4.b** Observe mechanisms in |
|                             | > use to verify that the system        |
|                             | > automatically generates an alarm     |
|                             | > event and an audit event when one    |
|                             | > person is alone in the room for more |
|                             | > than 30 seconds.                     |
+-----------------------------+----------------------------------------+
|                             | > **32-2.7.4.c** Examine a sample of   |
|                             | > audit events and interview security  |
|                             | > personnel to verify that the audit   |
|                             | > events are followed up by security   |
|                             | > personnel.                           |
+-----------------------------+----------------------------------------+
| > **32-2.8** Access to the  | > **32-2.8** Observe authorized        |
| > Level 3 room must create  | > personnel enter the environment and  |
| > an audit event, which     | > examine correlating audit logs to    |
| > must be logged.           | > verify that access to the Level 3    |
|                             | > room creates an audit log event.     |
+-----------------------------+----------------------------------------+
| > **32-2.8.1** Invalid      | > **32-2.8.1** Observe an invalid      |
| > access attempts to the    | > access attempt and examine           |
| > Level 3 room must create  | > correlating audit logs to verify     |
| > audit records, which must | > that invalid access attempts to the  |
| > be followed up by         | > Level 3 room create an audit log     |
| > security personnel        | > event.                               |
+-----------------------------+----------------------------------------+
| > **32-2.9** The Level 3    |                                        |
| > environment must be       |                                        |
| > monitored as follows:     |                                        |
+-----------------------------+----------------------------------------+
| > **32-2.9.1** A minimum of | > **32-2.9.1.a** Observe the Level 3   |
| > one or more cameras must  | > physical environment to verify that  |
| > provide continuous        | > cameras are in place to monitor the  |
| > monitoring (e.g., CCTV    | > Level 3 environment, including the   |
| > system) of the Level 3    | > entry and exit.                      |
| > environment, including    |                                        |
| > the entry and exit.       |                                        |
| >                           |                                        |
| > ***Note:**                |                                        |
| > Motion-activated systems  |                                        |
| > that are separate from    |                                        |
| > the intrusion-detection   |                                        |
| > system may be used to     |                                        |
| > activate recording        |                                        |
| > activity.*                |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.9.1.b** Examine monitoring    |
|                             | > system configurations (e.g., CCTV    |
|                             | > systems) to verify that continuous   |
|                             | > monitoring is provided.              |
+-----------------------------+----------------------------------------+
|                             | > **32-2.9.1.c** If motion-activated   |
|                             | > systems are used for monitoring,     |
|                             | > observe system configurations for    |
|                             | > the motion-activated systems to      |
|                             | > verify they are separate from the    |
|                             | > intrusion-detection system.          |
+-----------------------------+----------------------------------------+
| > **32-2.9.2** The cameras  | > **32-2.9.2** Examine monitoring      |
| > must record to time-lapse | > system configurations to verify;     |
| > VCRs or similar           |                                        |
| > mechanisms, with a        | -   The system records to time-lapse   |
| > minimum of five frames    |     > VCRs or similar mechanisms.      |
| > equally recorded over     |                                        |
| > every three seconds.      | -   A minimum of five frames are       |
|                             |     > recorded every three seconds.    |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-2.9.3** Continuous   | > **32-2.9.3.a** Observe the Level 3   |
| > or motion-activated,      | > physical environment to verify that  |
| > appropriate lighting must | > continuous or motion-activated       |
| > be provided for the       | > lighting is provided for each camera |
| > cameras.                  | > monitoring the environment.          |
| >                           |                                        |
| > ***Note:** Visible        |                                        |
| > spectrum lighting may not |                                        |
| > be necessary if the       |                                        |
| > cameras do not require    |                                        |
| > such lighting to capture  |                                        |
| > images (e.g., when        |                                        |
| > infrared cameras are      |                                        |
| > used).*                   |                                        |
+=============================+========================================+
|                             | > **32-2.9.3.b** Examine a sample of   |
|                             | > captured footage from different days |
|                             | > and times to ensure that the         |
|                             | > lighting is adequate.                |
+-----------------------------+----------------------------------------+
| > **32-2.9.4** Surveillance | > **32-2.9.4.a** Observe each camera   |
| > cameras must be           | > locations in the Level 3 environment |
| > configured to prevent the | > to verify they are not set to        |
| > monitoring of computer    | > monitor computer screens, keyboards, |
| > screens, keyboards, PIN   | > PIN pads, or other systems that may  |
| > pads, or other systems    | > expose sensitive data.               |
| > that may expose sensitive |                                        |
| > data. Cameras must not be |                                        |
| > able to be remotely       |                                        |
| > adjusted to zoom in or    |                                        |
| > otherwise observe the     |                                        |
| > aforementioned.           |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.9.4.b** Examine a sample of   |
|                             | > captured footage to verify it does   |
|                             | > not allow for the monitoring of      |
|                             | > computer screens, keyboards, PIN     |
|                             | > pads, or other systems that may      |
|                             | > expose sensitive data.               |
+-----------------------------+----------------------------------------+
| > **32-2.9.5** Personnel    | > **32-2.9.5.a** Examine documented    |
| > with access to the Level  | > access policies and procedures to    |
| > 3 environment must not    | > verify that personnel with access to |
| > have access to the media  | > the Level 3 environment are not      |
| > (e.g., VCR tapes,         | > permitted to have access to the      |
| > digital- recording        | > media containing recorded            |
| > systems, etc.) containing | > surveillance data for that           |
| > the recorded surveillance | > environment.                         |
| > data.                     |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.9.5.b** Examine Level 3       |
|                             | > access lists as well as access       |
|                             | > controls to the media containing     |
|                             | > surveillance data, to verify that    |
|                             | > personnel with access to the Level 3 |
|                             | > environment do not have access to    |
|                             | > the media containing recorded        |
|                             | > surveillance data.                   |
+-----------------------------+----------------------------------------+
| > **32-2.9.6** Images       | > **32-2.9.6.a** Examine storage of    |
| > recorded from the CCTV    | > captured recordings to verify that   |
| > system must be securely   | > at least the most recent 45 days of  |
| > archived for a period of  | > images are securely archived.        |
| > no less than 45 days.     |                                        |
| >                           |                                        |
| > If digital-recording      |                                        |
| > mechanisms are used, they |                                        |
| > must have sufficient      |                                        |
| > storage capacity and      |                                        |
| > redundancy (primary and   |                                        |
| > backup) to prevent the    |                                        |
| > loss of information       |                                        |
| > necessary to reconstruct  |                                        |
| > events for the most       |                                        |
| > recent 45-day period.     |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-2.9.6.b** If digital-recording  |
|                             | > mechanisms are used, examine system  |
|                             | > configurations to verify that the    |
|                             | > systems have sufficient redundancy   |
|                             | > to prevent the loss of information   |
|                             | > necessary to reconstruct events for  |
|                             | > the most recent 45- day period.      |
+-----------------------------+----------------------------------------+
| > **32-2.9.7** CCTV images  | > **32-2.9.7** Examine backup          |
| > must be backed up daily.  | > techniques utilized to ensure that:  |
| > The backup recording must |                                        |
| > be stored in a separate,  | -   Backups are securely stored in a   |
| > secure location within    |     > separate location from the       |
| > the facility and must     |     > primary.                         |
| > ensure segregation of     |                                        |
| > duties between the users  | -   Ensure that segregation is         |
| > (personnel accessing the  |     > maintained between users and     |
| > secure room) and          |     > administrators of the system.    |
| > administrators of the     |                                        |
| > system. Alternatively,    |                                        |
| > backups may be stored in  |                                        |
| > other facilities via      |                                        |
| > techniques such as disk   |                                        |
| > mirroring, provided the   |                                        |
| > storage is secure in      |                                        |
| > accordance with these     |                                        |
| > requirements.             |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-3** The environment  | **32-3.a** Examine security policies   |
| > must have continuous      | and procedures to verify they require: |
| > (24/7) intrusion-         |                                        |
| > detection systems in      | -   Continuous (24/7)                  |
| > place, which protects the |     > intrusion-detection monitoring   |
| > secure room by motion     |     > of the Level 3 environment       |
| > detectors when            |                                        |
| > unoccupied.               | -   Motion detectors must be active    |
|                             |     > when the environment is          |
|                             |     > unoccupied.                      |
+=============================+========================================+
|                             | **32-3.b** Examine intrusion-detection |
|                             | system configurations to verify:       |
|                             |                                        |
|                             | -   Continuous (24/7)                  |
|                             |     > intrusion-detection monitoring   |
|                             |     > of the Level 3 environment is in |
|                             |     > place                            |
|                             |                                        |
|                             | -   Motion detectors are active when   |
|                             |     > the environment is unoccupied.   |
+-----------------------------+----------------------------------------+
| > **32-3.1** Any windows in | > **32-3.1.a** Observe all windows in  |
| > the secure room must be   | > the secure room to verify they are   |
| > locked and protected by   | > locked and protected by alarmed      |
| > alarmed sensors.          | > sensors.                             |
+-----------------------------+----------------------------------------+
|                             | > **32-3.1.b** Examine the             |
|                             | > configuration of window sensors to   |
|                             | > verify that the alarm mechanism is   |
|                             | > active.                              |
+-----------------------------+----------------------------------------+
|                             | > **32-3.1.c** Test at least one       |
|                             | > window (if they can be opened) to    |
|                             | > verify that the alarms function      |
|                             | > appropriately.                       |
+-----------------------------+----------------------------------------+
| > **32-3.2** Any windows or | > **32-3.2** Observe all windows and   |
| > glass walls must be       | > glass walls in the secure room to    |
| > covered, rendered opaque, | > verify they are covered, rendered    |
| > or positioned to prevent  | > opaque, or positioned to prevent     |
| > unauthorized observation  | > unauthorized observation of the      |
| > of the secure room.       | > secure area.                         |
+-----------------------------+----------------------------------------+
| > **32-3.3** The            | > **32-3.3.a** Examine security system |
| > intrusion-detection       | > configurations to verify:            |
| > system(s) must be         |                                        |
| > connected to the alarm    | -   The intrusion-detection system(s)  |
| > system and automatically  |     > is connected to the alarm        |
| > activated every time all  |     > system.                          |
| > authorized personnel have |                                        |
| > performed an              | -   The intrusion-detection system(s)  |
| > authenticated exit of the |     > is automatically activated every |
| > secure room. The system   |     > time all authorized personnel    |
| > must be configured to     |     > have exited the secure room.     |
| > activate within 30        |                                        |
| > seconds.                  |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-3.3.b** Verify the IDS and      |
|                             | > alarms function correctly via:       |
|                             |                                        |
|                             | -   Having all authorized personnel    |
|                             |     > who badged or otherwise          |
|                             |     > authenticated into the area exit |
|                             |     > and one person remain behind     |
|                             |     > even though they have badged out |
|                             |                                        |
|                             | -   Having all but one authorized      |
|                             |     > person who badged or otherwise   |
|                             |     > authenticated into the system    |
|                             |     > badge out and exit               |
+-----------------------------+----------------------------------------+
| > **32-3.4** Alarm activity | > **32-3.4** Examine security-system   |
| > must include unauthorized | > configurations to verify that an     |
| > entry attempts or any     | > alarm event is generated for:        |
| > actions that disable the  |                                        |
| > intrusion-detection       | -   Unauthorized entry attempts        |
| > system.                   |                                        |
|                             | -   Actions that disable the           |
|                             |     > intrusion-detection system       |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| **32-4** All non-CA         | **32-4.a** Examine security policies   |
| personnel must sign an      | and procedures to verify they require  |
| access logbook when         | all non-CA personnel to sign an access |
| entering the Level 3        | logbook when entering the Level 3      |
| environment.                | environment.                           |
|                             |                                        |
| ***Note:** This log is in   |                                        |
| addition to those provided  |                                        |
| by the access- control      |                                        |
| system.*                    |                                        |
+=============================+========================================+
|                             | **32-4.b** On the escorted entry into  |
|                             | the secure room, observe that all      |
|                             | non-CA personnel appropriately sign    |
|                             | the access logbook.                    |
+-----------------------------+----------------------------------------+
| > **32-4.1** The access log | > **32-4.1** Examine the access        |
| > must include the          | > logbook to verify it contains the    |
| > following details:        | > following information:               |
|                             |                                        |
| -   Name and signature of   | -   Name and signature of the          |
|     > the individual        |     > individual                       |
|                             |                                        |
| -   Organization            | -   Organization                       |
|                             |                                        |
| -   Date and time in and    | -   Date and time in and out           |
|     > out                   |                                        |
|                             | -   Reason for access or purpose of    |
| -   Reason for access or    |     > visit                            |
|     > purpose of visit      |                                        |
|                             | -   For visitor access, the initials   |
| -   For visitor access, the |     > of the person escorting the      |
|     > initials of the       |     > visitor                          |
|     > person escorting the  |                                        |
|     > visitor               |                                        |
+-----------------------------+----------------------------------------+
| > **32-4.2** The logbook    | > **32-4.2** Observe the location of   |
| > must be maintained within | > the access logbook and verify that   |
| > the Level 3 secure        | > it is maintained within the Level 3  |
| > environment.              | > secure environment.                  |
+-----------------------------+----------------------------------------+
| **32-5** All access-control | **32-5** Inspect uninterruptible power |
| and monitoring systems      | source (UPS) system configurations to  |
| (including                  | verify that all access-control and     |
| intrusion-detection         | monitoring systems, including          |
| systems) are powered        | intrusion-detection systems, are       |
| through an uninterruptible  | powered through the UPS.               |
| power source (UPS).         |                                        |
+-----------------------------+----------------------------------------+
| **32-6** All alarm events   | **32-6.a** Examine security policies   |
| must be documented.         | and procedures to verify they require  |
|                             | that all alarm events be logged.       |
+-----------------------------+----------------------------------------+
|                             | **32-6.b** Examine security-system     |
|                             | configurations and documented alarm    |
|                             | events to verify that all alarm events |
|                             | are logged.                            |
+-----------------------------+----------------------------------------+
| > **32-6.1** An individual  | > **32-6.1.a** Examine documented      |
| > must not sign off on an   | > procedures for responding to alarm   |
| > alarm event in which they | > events to verify that the procedure  |
| > were involved.            | > does not permit a person who was     |
|                             | > involved in an alarm event to        |
|                             | > sign-off on that alarm event.        |
+-----------------------------+----------------------------------------+
|                             | > **32-6.1.b** Determine who is        |
|                             | > authorized to sign off on alarm      |
|                             | > events.                              |
+-----------------------------+----------------------------------------+
|                             | > **32-6.1.c** For a sample of         |
|                             | > documented alarm events, examine the |
|                             | > record to verify that personnel      |
|                             | > authorized to sign off on alarm      |
|                             | > events were not also the cause of    |
|                             | > that event.                          |
+-----------------------------+----------------------------------------+
| > **32-6.2** The use of any | > **32-6.2.a** Examine security system |
| > emergency entry or exit   | > configurations to verify that an     |
| > mechanism must cause an   | > alarm event is generated upon use of |
| > alarm event.              | > any emergency entry or exit          |
|                             | > mechanism.                           |
+-----------------------------+----------------------------------------+
|                             | > **32-6.2.b** Conduct a test to       |
|                             | > verify the mechanisms work           |
|                             | > appropriately.                       |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-6.3** All alarms for | > **32-6.3.a** Examine documented      |
| > physical intrusion        | > procedures to verify they require    |
| > necessitate an active     | > that all alarms for physical         |
| > response within 30        | > intrusion must be responded to       |
| > minutes by personnel      | > within 30 minutes by personnel       |
| > assigned security duties. | > assigned security duties.            |
+=============================+========================================+
|                             | > **32-6.3.b** Examine a sample of     |
|                             | > alarm events and interview personnel |
|                             | > assigned with security-response      |
|                             | > duties to verify that alarms for     |
|                             | > physical intrusion are responded to  |
|                             | > within 30 minutes.                   |
+-----------------------------+----------------------------------------+
|                             | > **32-6.3.c** Conduct a test to       |
|                             | > verify the appropriate response      |
|                             | > occurs.                              |
+-----------------------------+----------------------------------------+
| **32-7** A process must be  | **32-7.a** Examine documented          |
| implemented for             | procedures to verify that mechanisms   |
| synchronizing the time and  | are defined (may be automated or       |
| date stamps of the access,  | manual) for synchronizing the time and |
| intrusion-detection, and    | date stamps of the access,             |
| monitoring (camera) systems | intrusion-detection, and monitoring    |
| to ensure accuracy of logs. | (camera) systems to ensure accuracy of |
| It must be ensured that     | logs.                                  |
| synchronization errors      |                                        |
| between CCTV, intrusion     |                                        |
| detection, and access       |                                        |
| control cannot exceed one   |                                        |
| minute.                     |                                        |
|                             |                                        |
| ***Note:** This may be done |                                        |
| by either automated or      |                                        |
| manual mechanisms.*         |                                        |
+-----------------------------+----------------------------------------+
|                             | **32-7.b** Examine system              |
|                             | configurations for access,             |
|                             | intrusion-detection, and monitoring    |
|                             | (camera) systems to verify that time   |
|                             | and date stamps are synchronized.      |
+-----------------------------+----------------------------------------+
|                             | **32-7.c** Examine a sample of logs    |
|                             | from the access, intrusion-detection,  |
|                             | and monitoring (camera) systems to     |
|                             | verify log time and date stamps are    |
|                             | synchronized.                          |
+-----------------------------+----------------------------------------+
| > **32-7.1** If a manual    | > **32-7.1.a** If a manual             |
| > synchronization process   | > synchronization process is           |
| > is used, synchronization  | > implemented, interview responsible   |
| > must occur at least       | > personnel and examine records of     |
| > quarterly; events must be | > synchronization to verify the        |
| > recorded and variances    | > mechanism is performed at least      |
| > documented; and           | > quarterly.                           |
| > documentation of the      |                                        |
| > synchronization must be   |                                        |
| > retained for at least a   |                                        |
| > one-year period.          |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-7.1.b** Examine records of the  |
|                             | > synchronization process to verify    |
|                             | > that documentation is retained for   |
|                             | > at least one year.                   |
+-----------------------------+----------------------------------------+
| > *Functionality of a       |                                        |
| > key-injection facility    |                                        |
| > (or applicable entity     |                                        |
| > providing key-management  |                                        |
| > services) may be located  |                                        |
| > at a single physical      |                                        |
| > location or distributed   |                                        |
| > over a number of separate |                                        |
| > physical locations.       |                                        |
| > Distributed KIF           |                                        |
| > functionality may include |                                        |
| > key generation, CA        |                                        |
| > functionality, key        |                                        |
| > distribution, and key     |                                        |
| > injection. In order to    |                                        |
| > mitigate the expanded     |                                        |
| > attack surface of a       |                                        |
| > distributed KIF, specific |                                        |
| > controls apply to a       |                                        |
| > distributed architecture. |                                        |
| > If any secret or private  |                                        |
| > keys or their             |                                        |
| > components/shares appear  |                                        |
| > in the clear outside of a |                                        |
| > SCD, **Requirement 32-9** |                                        |
| > for a secure room must be |                                        |
| > met.*                     |                                        |
+-----------------------------+----------------------------------------+
| **32-8** Distributed        |                                        |
| functionality of the KIF    |                                        |
| that is used for generation |                                        |
| and transfer of keys must   |                                        |
| communicate via mutually    |                                        |
| authenticated channels. All |                                        |
| key transfers between       |                                        |
| distributed KIF functions   |                                        |
| must meet the requirements  |                                        |
| of **Control Objective 3**. |                                        |
+-----------------------------+----------------------------------------+

+------------------------------+---------------------------------------+
| > **32-8.1** The KIF must    | > **32-8.1.a** Examine documented     |
| > ensure that keys are       | > procedures for key conveyance or    |
| > transmitted between KIF    | > transmittal to verify that keys     |
| > components in accordance   | > used between KIF components are     |
| > with **Control Objective   | > addressed in accordance with        |
| > 3**.                       | > applicable criteria in **Control    |
|                              | > Objective 3**.                      |
+==============================+=======================================+
|                              | > **32-8.1.b** Interview responsible  |
|                              | > personnel and observe conveyance    |
|                              | > processes to verify that the        |
|                              | > documented procedures are followed  |
|                              | > for key conveyance or transmittal   |
|                              | > for keys used between KIF           |
|                              | > components.                         |
+------------------------------+---------------------------------------+
| > **32-8.2** The KIF must    | > **32-8.2** Examine documented       |
| > implement mutually         | > procedures to confirm they specify  |
| > authenticated channels for | > the establishment of a channel for  |
| > communication between      | > mutual authentication of the        |
| > distributed KIF            | > sending and receiving devices.      |
| > functions---e.g., between  |                                       |
| > a host used to generate    |                                       |
| > keys and a host used to    |                                       |
| > distribute keys.           |                                       |
+------------------------------+---------------------------------------+
| > **32-8.3** The KIF must    |                                       |
| > ensure that injection of   |                                       |
| > enciphered secret or       |                                       |
| > private keys into POI      |                                       |
| > devices meets the          |                                       |
| > requirements of **Control  |                                       |
| > Objective 4**.             |                                       |
+------------------------------+---------------------------------------+
| > **32-8.4** The channel for | > **32-8.4.a** Examine documented     |
| > mutual authentication is   | > procedures for key loading to hosts |
| > established using the      | > and POI devices to verify that they |
| > requirements of **Control  | > are in accordance with applicable   |
| > Objective 4**.             | > criteria in **Control Objective     |
|                              | > 4**.                                |
+------------------------------+---------------------------------------+
|                              | > **32-8.4.b** Interview responsible  |
|                              | > personnel and observe key-loading   |
|                              | > processes to verify that the        |
|                              | > documented procedures are followed  |
|                              | > for key conveyance or transmittal   |
|                              | > for keys used between KIF           |
|                              | > components.                         |
+------------------------------+---------------------------------------+
| > **32-8.5** The KIF must    | > **32-8.5** Examine documented       |
| > implement a mutually       | > procedures to confirm they specify  |
| > authenticated channel for  | > the establishment of a mutually     |
| > the establishment of       | > authenticated channel for           |
| > enciphered secret or       | > establishment of enciphered secret  |
| > private keys between POI   | > or private keys between sending and |
| > devices and an HSM at the  | > receiving devices---e.g., POI       |
| > KIF.                       | > devices and HSMs.                   |
+------------------------------+---------------------------------------+
| > **32-8.6** Mutual          | > **32-8.6** Interview responsible    |
| > authentication of the      | > personnel and observe processes for |
| > sending and receiving      | > establishment of enciphered secret  |
| > devices must be performed. | > or private keys between sending and |
|                              | > receiving devices to verify:        |
| -   KIFs must validate       |                                       |
|     > authentication         | -   KIFs validate authentication      |
|     > credentials of a POI   |     > credentials of a POI device     |
|     > device prior to any    |     > prior to any key transport,     |
|     > key transport,         |     > exchange, or establishment with |
|     > exchange, or           |     > that device.                    |
|     > establishment with     |                                       |
|     > that device.           | -   POI devices validate              |
|                              |     > authentication credentials of   |
| -   POI devices must         |     > KLDs prior to any key           |
|     > validate               |     > transport, exchange, or         |
|     > authentication         |     > establishment with that device. |
|     > credentials of KDHs    |                                       |
|     > prior to any key       | -   When a KLD is used as an          |
|     > transport, exchange,   |     > intermediate device to          |
|     > or establishment with  |     > establish keys between POI      |
|     > that device.           |     > devices and a KIF HSM, it is    |
|                              |     > not possible to insert an       |
| -   When a KLD is used as an |     > unauthorized SCD into the flow  |
|     > intermediate device to |     > without detection               |
|     > establish keys between |                                       |
|     > POI devices and a KIF  |                                       |
|     > HSM it must not be     |                                       |
|     > possible to insert an  |                                       |
|     > unauthorized SCD into  |                                       |
|     > the flow without       |                                       |
|     > detection.             |                                       |
+------------------------------+---------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-8.7** Mechanisms     | > **32-8.7** Examine documented        |
| > must exist to prevent a   | > procedures to confirm they define    |
| > non-authorized host from  | > mechanisms to prevent an             |
| > injecting keys into POI   | > unauthorized host from performing    |
| > devices or an             | > key transport, key exchange, or key  |
| > unauthorized POI device   | > establishment with POI devices.      |
| > from establishing a key   |                                        |
| > with a legitimate KIF     |                                        |
| > component.                |                                        |
+=============================+========================================+
| > **32-9** The KIF must     |                                        |
| > implement a physically    |                                        |
| > secure room for key       |                                        |
| > injection where any       |                                        |
| > secret or private keys or |                                        |
| > their components/shares   |                                        |
| > appear in memory outside  |                                        |
| > the secure boundary of an |                                        |
| > SCD during the process of |                                        |
| > loading/injecting keys    |                                        |
| > into an SCD.              |                                        |
|                             |                                        |
| The secure room for key     |                                        |
| injection must include the  |                                        |
| following:                  |                                        |
|                             |                                        |
| -   **Effective 1 January   |                                        |
|     > 2024** the injection  |                                        |
|     > of clear-text secret  |                                        |
|     > or private keying     |                                        |
|     > material must not be  |                                        |
|     > allowed for entities  |                                        |
|     > engaged in key        |                                        |
|     > injection on behalf   |                                        |
|     > of others. This       |                                        |
|     > applies to new        |                                        |
|     > deployments of POI v5 |                                        |
|     > and higher devices.   |                                        |
|     > Subsequent to that    |                                        |
|     > date, only encrypted  |                                        |
|     > key injection will be |                                        |
|     > allowed for POI v5    |                                        |
|     > and higher devices.   |                                        |
|                             |                                        |
| -   **Effective 1 January   |                                        |
|     > 2026**, the same      |                                        |
|     > restriction applies   |                                        |
|     > to entities engaged   |                                        |
|     > in key injection of   |                                        |
|     > devices for which     |                                        |
|     > they are the          |                                        |
|     > processors.           |                                        |
|                             |                                        |
| > ***Note:** This does not  |                                        |
| > apply to key components   |                                        |
| > entered into the keypad   |                                        |
| > of a secure cryptographic |                                        |
| > device, such as a device  |                                        |
| > approved against the PCI  |                                        |
| > PTS POI Security          |                                        |
| > Requirements. It does     |                                        |
| > apply to all other        |                                        |
| > methods of loading of     |                                        |
| > clear-text keying         |                                        |
| > material for POI v5 and   |                                        |
| > higher devices.*          |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-9.1** The secure     | > **32-9.1** Inspect the secure room   |
| > room must have walls made | > designated for key injection to      |
| > of solid materials. In    | > verify that it is constructed with   |
| > addition, if the solid    | > extended walls from the real floor   |
| > walls do not extend from  | > to the real ceiling using sheetrock  |
| > the real floor to the     | > or wire mesh.                        |
| > real ceiling, the secure  |                                        |
| > room must also have       |                                        |
| > extended walls from the   |                                        |
| > real floor to the real    |                                        |
| > ceiling using sheetrock   |                                        |
| > or wire mesh.             |                                        |
| >                           |                                        |
| > ***Note:** In KIF         |                                        |
| > environments where Level  |                                        |
| > 1 and Level 2 physical    |                                        |
| > barrier controls are in   |                                        |
| > place and confirmed, the  |                                        |
| > secure room may be        |                                        |
| > implemented within a      |                                        |
| > "caged" environment. A    |                                        |
| > caged environment is an   |                                        |
| > enclosed secure room that |                                        |
| > meets the criteria of     |                                        |
| > Requirement 32 but is not |                                        |
| > made of solid walls.      |                                        |
| > Refer to applicable       |                                        |
| > requirements within this  |                                        |
| > Domain for additional     |                                        |
| > information on Level 1    |                                        |
| > and Level 2 physical      |                                        |
| > barrier controls. All     |                                        |
| > other criteria stated in  |                                        |
| > Requirements 13-9 and     |                                        |
| > 32-9 relating to          |                                        |
| > clear-text secret and/or  |                                        |
| > private keys and/or their |                                        |
| > components existing in    |                                        |
| > unprotected memory        |                                        |
| > outside the secure        |                                        |
| > boundary of an SCD for    |                                        |
| > loading keys apply.*      |                                        |
+=============================+========================================+
| > **32-9.2** Any windows    | > **32-9.2.a** Observe all windows in  |
| > into the secure room must | > the secure room to verify they are   |
| > be locked and protected   | > locked and protected by alarmed      |
| > by alarmed sensors.       | > sensors.                             |
+-----------------------------+----------------------------------------+
|                             | > **32-9.2.b** Examine the             |
|                             | > configuration of window sensors to   |
|                             | > verify that the alarm mechanism is   |
|                             | > active.                              |
+-----------------------------+----------------------------------------+
| > **32-9.3** Any windows    | > **32-9.3** Observe all windows in    |
| > must be covered, rendered | > the secure room to verify they are   |
| > opaque, or positioned to  | > covered, rendered opaque, or         |
| > prevent unauthorized      | > positioned to prevent unauthorized   |
| > observation of the secure | > observation of the secure room.      |
| > room.                     |                                        |
+-----------------------------+----------------------------------------+
| > **32-9.4** A solid-core   | > **32-9.4** Inspect the secure room   |
| > door or a steel door must | > to verify that it is only accessed   |
| > be installed to ensure    | > through a solid- core or a steel     |
| > that door hinges cannot   | > door, with door hinges that cannot   |
| > be removed from outside   | > be removed from outside the room.    |
| > the room.                 |                                        |
+-----------------------------+----------------------------------------+
| > **32-9.5** An electronic  | > **32-9.5** Observe authorized        |
| > access-control system     | > personnel entering the secure room   |
| > (e.g., badge and/or       | > to verify that a badge-control       |
| > biometrics) must be in    | > system is in place that enforces the |
| > place that enforces:      | > following requirements:              |
|                             |                                        |
| -   Dual-access             | -   Dual-access for entry to the       |
|     > requirements for      |     > secure room                      |
|     > entry into the secure |                                        |
|     > room, and             | -   Anti-pass-back                     |
|                             |                                        |
| -   Anti-pass-back          |                                        |
|     > requirements.         |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-9.6** The            | > **32-9.6** Examine alarm mechanisms  |
| > badge-control system must | > and interview alarm-response         |
| > support generation of an  | > personnel to verify that the         |
| > alarm when one person     | > badge-control system supports        |
| > remains alone in the      | > generation of an alarm when one      |
| > secure room for more than | > person remains alone in the secure   |
| > 30 seconds.               | > room for more than 30 seconds.       |
| >                           |                                        |
| > ***Note:** Examples of    |                                        |
| > alarm-generation          |                                        |
| > mechanisms include but    |                                        |
| > are not limited to motion |                                        |
| > detectors, login/logout   |                                        |
| > controls, biometrics,     |                                        |
| > badge sensors, etc.*      |                                        |
+=============================+========================================+
| > **32-9.7** CCTV cameras   | > **32-9.7** Inspect CCTV              |
| > must record all activity, | > configuration and examine a sample   |
| > including recording       | > of recordings to verify that CCTV    |
| > events during dark        | > monitoring is in place on a 24/7     |
| > periods through the use   | > basis, including the ability to      |
| > of infrared CCTV cameras  | > record events during dark periods,   |
| > or automatic activation   | > and if motion activated verify that  |
| > of floodlights in case of | > recording continues for at least a   |
| > any detected activity.    | > minute after the last pixel of       |
| > This recording may be     | > activity subsides.                   |
| > motion-activated. The     |                                        |
| > recording must continue   |                                        |
| > for at least a minute     |                                        |
| > after the last pixel of   |                                        |
| > activity subsides.        |                                        |
+-----------------------------+----------------------------------------+
| > **32-9.8** Monitoring     | > **32-9.8** Inspect configuration of  |
| > must be supported on a    | > monitoring systems and interview     |
| > continuous (24/7) basis   | > monitoring personnel to verify that  |
| > such that alarms can be   | > monitoring is supported on a         |
| > resolved by authorized    | > continuous (24/7) basis and alarms   |
| > personnel.                | > can be resolved by authorized        |
|                             | > personnel.                           |
+-----------------------------+----------------------------------------+
| > **32-9.9** The CCTV       | > **32-9.9.a** Inspect location of the |
| > server and digital        | > CCTV server and digital-storage to   |
| > storage must be secured   | > verify they are located in a secure  |
| > in a separate secure      | > location that is separate from the   |
| > location that is not      | > key-injection secure room.           |
| > accessible to personnel   |                                        |
| > who have access to the    |                                        |
| > key-injection secure      |                                        |
| > room.                     |                                        |
+-----------------------------+----------------------------------------+
|                             | > **32-9.9.b** Inspect access-control  |
|                             | > configurations for the CCTV          |
|                             | > server/storage secure location and   |
|                             | > the key-injection secure room to     |
|                             | > identify all personnel who have      |
|                             | > access to each area. Compare access  |
|                             | > lists to verify that personnel with  |
|                             | > access to the key-injection secure   |
|                             | > room do not have access to the CCTV  |
|                             | > server/storage secure location.      |
+-----------------------------+----------------------------------------+
| > **32-9.10** The CCTV      | > **32-9.10** Inspect CCTV positioning |
| > cameras must be           | > and examine a sample of recordings   |
| > positioned to monitor:    | > to verify that CCTV cameras are      |
|                             | > positioned to monitor:               |
| -   The entrance door,      |                                        |
|                             | -   The entrance door,                 |
| -   SCDs, both pre and post |                                        |
|     > key injection,        | -   SCDs, both pre and post key        |
|                             |     > injection,                       |
| -   Any safes that are      |                                        |
|     > present, and          | -   Any safes that are present, and    |
|                             |                                        |
| -   The equipment used for  | -   The equipment used for key         |
|     > key injection.        |     > injection.                       |
+-----------------------------+----------------------------------------+
| > **32-9.11** CCTV cameras  | > **32-9.11** Inspect CCTV positioning |
| > must be positioned so     | > and examine a sample of recordings   |
| > they do not monitor any   | > to verify that CCTV cameras do not   |
| > combination locks, PIN    | > monitor any combination locks, PIN   |
| > pads, or keyboards used   | > pads, or keyboards used to enter     |
| > to enter                  | > passwords/authentication codes or    |
| > passwords/authentication  | > other authentication credentials.    |
| > codes or other            |                                        |
| > authentication            |                                        |
| > credentials.              |                                        |
+-----------------------------+----------------------------------------+

+-----------------------------+----------------------------------------+
| > **32-9.12** Images        | > **32-9.12.a** Examine storage of     |
| > recorded from the CCTV    | > captured recordings to verify that   |
| > system must be securely   | > at least the most recent 45 days of  |
| > archived for a period of  | > images are securely archived.        |
| > no less than 45 days.     |                                        |
| >                           |                                        |
| > If digital-recording      |                                        |
| > mechanisms are used, they |                                        |
| > must have sufficient      |                                        |
| > storage capacity and      |                                        |
| > redundancy to prevent the |                                        |
| > loss of information       |                                        |
| > necessary to reconstruct  |                                        |
| > events for the most       |                                        |
| > recent 45-day period.     |                                        |
+=============================+========================================+
|                             | > **32-9.12.b** If digital-recording   |
|                             | > mechanisms are used, examine system  |
|                             | > configurations to verify that the    |
|                             | > systems have sufficient redundancy   |
|                             | > to prevent the loss of information   |
|                             | > necessary to reconstruct events for  |
|                             | > the most recent 45-day period.       |
+-----------------------------+----------------------------------------+
| ***Requirement 33:**        |                                        |
| Documented procedures must  |                                        |
| exist and be demonstrably   |                                        |
| in use to ensure the        |                                        |
| security and integrity of   |                                        |
| account-data processing     |                                        |
| equipment (e.g., POI        |                                        |
| devices and HSMs) placed    |                                        |
| into service, initialized,  |                                        |
| deployed, used, and         |                                        |
| decommissioned.*            |                                        |
+-----------------------------+----------------------------------------+
| **33-1** Written procedures | **33-1.a** Examine documented          |
| must exist, and all         | procedures/processes and interview     |
| affected parties must be    | responsible personnel to verify that   |
| aware of those procedures.  | all affected parties are aware of      |
| Records must be maintained  | required processes and are provided    |
| of the tests and            | suitable guidance on procedures for    |
| inspections performed on    | account-data processing devices placed |
| account- data processing    | into service, initialized, deployed,   |
| devices before they are     | used, and decommissioned               |
| placed into service, as     |                                        |
| well as devices being       |                                        |
| decommissioned.             |                                        |
+-----------------------------+----------------------------------------+
|                             | **33-1.b** Verify that written records |
|                             | exist for the tests and inspections    |
|                             | performed on devices before they are   |
|                             | placed into service, as well as        |
|                             | devices being decommissioned.          |
+-----------------------------+----------------------------------------+

+----------------------------+-----------------------------------------+
| []{#_bookmark64            |                                         |
| .anchor}***Requirement 5A: |                                         |
| Account data is processed  |                                         |
| using algorithms and       |                                         |
| methodologies that ensure  |                                         |
| they are kept secure***    |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| ***5A-1** Account data is  |                                         |
| protected with appropriate |                                         |
| cryptographic algorithms,  |                                         |
| key sizes and strengths,   |                                         |
| and key-management         |                                         |
| processes.*                |                                         |
+----------------------------+-----------------------------------------+
| **5A-1.1** Only approved   | **5A-1.1.a** Examine documented         |
| encryption algorithms and  | key-management policies and procedures  |
| key sizes must be used to  | to verify that all cryptographic keys   |
| protect account data and   | use algorithms and key sizes that are   |
| cryptographic keys, as     | in accordance with Normative Annex C:   |
| listed in Normative Annex  | Minimum and Equivalent Key Sizes and    |
| C: Minimum and Equivalent  | Strengths for Approved Algorithms.      |
| Key Sizes and Strengths    |                                         |
| for Approved Algorithms.   |                                         |
+----------------------------+-----------------------------------------+
|                            | **5A-1.1.b** Observe key-management     |
|                            | operations and devices to verify that   |
|                            | all cryptographic algorithms and key    |
|                            | sizes are in accordance with Normative  |
|                            | Annex C: Minimum and Equivalent Key     |
|                            | Sizes and Strengths for Approved        |
|                            | Algorithms.                             |
+----------------------------+-----------------------------------------+
| **5A-1.2**                 | **5A-1.2.a** Examine documented         |
| Cryptographic-key changes  | key-management procedures to verify:    |
| must be implemented for    |                                         |
| keys that have reached the | -   Crypto-periods are defined for      |
| end of their crypto-period |     > every type of key in use.         |
| (e.g., after a defined     |                                         |
| period of time and/or      | -   Crypto-periods are based on         |
| after a certain amount of  |     > industry best practices and       |
| cipher-text has been       |     > guidelines (e.g., *NIST Special   |
| produced by a given key),  |     > Publication 800-57*).             |
| as defined by the          |                                         |
| associated application     | -   A process/methodology is in place   |
| vendor or key owner, and   |     > to determine when the             |
| based on industry best     |     > crypto-period is reached for each |
| practices and guidelines   |     > cryptographic key.                |
| (e.g., *NIST Special       |                                         |
| Publication 800-57*).      | -   Cryptographic key changes are       |
|                            |     > implemented whenever a key        |
| *See [Domain 5 Normative   |     > reaches the end of its defined    |
| Annex C: Minimum           |     > crypto-period.                    |
| and](#_bookmark67)         |                                         |
| [Equivalent Key Sizes and  |                                         |
| Strengths for              |                                         |
| Approved](#_bookmark67)    |                                         |
| [A                         |                                         |
| lgorithms.](#_bookmark67)* |                                         |
+----------------------------+-----------------------------------------+
|                            | **5A-1.2.b** Through observation of     |
|                            | key-management operations and           |
|                            | inspection of SCDs, verify that         |
|                            | crypto-periods are defined for every    |
|                            | type of key in use.                     |
+----------------------------+-----------------------------------------+
| **5A-1.3** Documentation   | **5A-1.3.a** Verify documentation       |
| describing the             | exists describing the architecture      |
| architecture (including    | (including all participating devices    |
| all participating devices  | and cryptographic protocols), set-up    |
| and cryptographic          | and operation of the key- management    |
| protocols), set-up and     | solution.                               |
| operation of the           |                                         |
| key-management solution    |                                         |
| must exist and must be     |                                         |
| demonstrably in use for    |                                         |
| all key-management         |                                         |
| processes.                 |                                         |
+----------------------------+-----------------------------------------+
|                            | **5A-1.3.b** Observe architecture and   |
|                            | key-management operations to verify     |
|                            | that the documentation reviewed in      |
|                            | **5A-1.3.a** is demonstrably in use for |
|                            | all key-management processes.           |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 5A: Account |                                         |
| data is processed using    |                                         |
| algorithms and             |                                         |
| methodologies that ensure  |                                         |
| they are kept secure***    |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **5A-1.3.1** Maintain    | > **5A-1.3.1.a** Examine key-management |
| > documentation of all     | > policies and procedures and verify    |
| > cryptographic keys       | > documentation of all cryptographic    |
| > managed as part of the   | > keys managed as part of the P2PE      |
| > P2PE solution,           | > solution is required, and includes:   |
| > including:               |                                         |
|                            | -   Key type/description                |
| -   Key type/description   |                                         |
|                            | -   Description of level in the key     |
| -   Description of level   |     > hierarchy                         |
|     > in the key hierarchy |                                         |
|                            | -   Purpose/function of the key         |
| -   Purpose/function of    |     > (including type of devices using  |
|     > the key (including   |     > key)                              |
|     > type of devices      |                                         |
|     > using key)           | -   Key-creation method                 |
|                            |                                         |
| -   Key-creation method    | -   Key-distribution method (e.g.,      |
|                            |     > manually via courier, remote key  |
| -   Key-distribution       |     > distribution)                     |
|     > method (e.g.,        |                                         |
|     > manually via         | -   Type of media used for key storage  |
|     > courier, remote key  |                                         |
|     > distribution)        | -   Key-destruction method              |
|                            |                                         |
| -   Type of media used for |                                         |
|     > key storage          |                                         |
|                            |                                         |
| -   Key-destruction method |                                         |
+----------------------------+-----------------------------------------+
|                            | > **5A-1.3.1.b** Observe documentation  |
|                            | > and interview personnel and confirm   |
|                            | > that documentation of all             |
|                            | > cryptographic keys managed as part of |
|                            | > the P2PE solution exists, and         |
|                            | > includes:                             |
|                            |                                         |
|                            | -   Key type/description                |
|                            |                                         |
|                            | -   Description of level in the key     |
|                            |     > hierarchy                         |
|                            |                                         |
|                            | -   Purpose/function of the key         |
|                            |     > (including type of devices using  |
|                            |     > key)                              |
|                            |                                         |
|                            | -   Key-creation method                 |
|                            |                                         |
|                            | -   Key-distribution method (e.g.,      |
|                            |     > manually via courier, remote key  |
|                            |     > distribution)                     |
|                            |                                         |
|                            | -   Type of media used for key storage  |
|                            |                                         |
|                            | -   Key-destruction method              |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement 5A: Account |                                         |
| data is processed using    |                                         |
| algorithms and             |                                         |
| methodologies that ensure  |                                         |
| they are kept secure***    |                                         |
+============================+=========================================+
| > **Domain 5               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > **5A-1.3.2** Maintain a  | > **5A-1.3.2.a** Examine key-management |
| > list of all devices used | > policies and procedures and verify a  |
| > to generate keys or key  | > list of all devices used to generate  |
| > components managed as    | > keys managed as part of the P2PE      |
| > part of the P2PE         | > solution is required, and includes:   |
| > solution, including:     |                                         |
|                            | -   Device name/identifier              |
| -   Device name/identifier |                                         |
|                            | -   Device manufacturer/model           |
| -   Device                 |                                         |
|     > manufacturer/model   | -   Type of keys generated (per         |
|                            |     > **5A-1.3.1**)                     |
| -   Type of keys generated |                                         |
|     > (per **5A-1.3.1**)   | -   Device location                     |
|                            |                                         |
| -   Device location        | -   Approved key-generation function    |
|                            |     > (PTS, FIPS, or other approved per |
| -   Approved               |     > *NIST SP800-22*)                  |
|     > key-generation       |                                         |
|     > function (PTS, FIPS, |                                         |
|     > or other approved    |                                         |
|     > per *NIST SP800-22*) |                                         |
+----------------------------+-----------------------------------------+
|                            | > **5A-1.3.2.b** Observe documentation  |
|                            | > and interview personnel and confirm   |
|                            | > that a list of all devices used to    |
|                            | > generate keys managed as part of the  |
|                            | > P2PE solution exists, and includes:   |
|                            |                                         |
|                            | -   Device name/identifier              |
|                            |                                         |
|                            | -   Device manufacturer/model           |
|                            |                                         |
|                            | -   Type of keys generated (per         |
|                            |     > **5A-1.3.1**)                     |
|                            |                                         |
|                            | -   Device location                     |
|                            |                                         |
|                            | -   Approved key-generation function    |
|                            |     > (PTS, FIPS, or other approved per |
|                            |     > *NIST SP800-22*)                  |
+----------------------------+-----------------------------------------+

+---------------------------+------------------------------------------+
| []{#_bookmark65           |                                          |
| .anchor}***Requirement    |                                          |
| 5H: For hybrid decryption |                                          |
| solutions: Implement      |                                          |
| secure hybrid key         |                                          |
| management***             |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > ***5H-1** Hybrid        |                                          |
| > decryption solutions    |                                          |
| > securely manage the     |                                          |
| > Data Decryption Keys    |                                          |
| > (DDKs) that decrypt     |                                          |
| > account data in         |                                          |
| > software on a Host      |                                          |
| > System.*                |                                          |
+---------------------------+------------------------------------------+
| > ***Note:** DDKs used to |                                          |
| > decrypt account data in |                                          |
| > a Host System are the   |                                          |
| > ONLY keys that can ever |                                          |
| > be managed in software  |                                          |
| > per these 5H            |                                          |
| > Requirements; all other |                                          |
| > cryptographic keys used |                                          |
| > in hybrid decryption    |                                          |
| > solutions are managed   |                                          |
| > in HSMs and are never   |                                          |
| > present or managed in   |                                          |
| > software.*              |                                          |
+---------------------------+------------------------------------------+
| **5H-1.1** The Data       | **5H-1.1.a** Examine documented          |
| Decryption Keys (DDKs)    | key-management policies and procedures   |
| used in software to       | to verify that DDKs managed on the Host  |
| decrypt account data must | System meet one or both of the           |
| have defined usage        | following:                               |
| limits.                   |                                          |
|                           | -   Each DDK must have a defined usage   |
| This can be achieved      |     > period (cryptoperiod) based on a   |
| through the use of either |     > formal risk assessment and         |
| one of the following      |     > industry guidance as provided in   |
| approaches:               |     > *NIST SP800-57, ISO TR 14742,* and |
|                           |     > *NIST SP800-131*. The cryptoperiod |
| -   Each DDK must have a  |     > defines the duration of time that  |
|     > defined usage       |     > the DDK may be used to decrypt     |
|     > period              |     > account data, defined either as a  |
|     > (cryptoperiod)      |     > maximum threshold of transactions, |
|     > based on a formal   |     > or hours, or both (e.g., 1024      |
|     > risk assessment and |     > transactions or 24 hours,          |
|     > industry guidance   |     > whichever is reached first).       |
|     > as provided in      |                                          |
|     > *NIST SP800-57, ISO | > Upon reaching the defined usage        |
|     > TR 14742,* and      | > threshold, the DDK must not be used    |
|     > *NIST SP800-131*.   | > for further transaction processing and |
|     > The cryptoperiod    | > must be securely erased from memory of |
|     > defines the         | > the host processing system.            |
|     > duration of time    | >                                        |
|     > that the DDK may be | > ***OR***                               |
|     > used to decrypt     |                                          |
|     > account data,       | -   DDKs are unique per transaction.     |
|     > defined either as a |     > Each DDK is erased from the host   |
|     > maximum threshold   |     > memory upon completion of the      |
|     > of transactions, or |     > decryption process.                |
|     > hours, or both      |                                          |
|     > (e.g., 1024         |                                          |
|     > transactions or 24  |                                          |
|     > hours, whichever is |                                          |
|     > reached first).     |                                          |
|                           |                                          |
| > Upon reaching the       |                                          |
| > defined usage           |                                          |
| > threshold, the DDK must |                                          |
| > not be used for further |                                          |
| > transaction processing  |                                          |
| > and must be securely    |                                          |
| > erased from memory of   |                                          |
| > the Host System.        |                                          |
| >                         |                                          |
| > ***OR***                |                                          |
|                           |                                          |
| -   DDKs are unique per   |                                          |
|     > transaction. Each   |                                          |
|     > DDK is erased from  |                                          |
|     > the host memory     |                                          |
|     > upon completion of  |                                          |
|     > the decryption      |                                          |
|     > process.            |                                          |
+---------------------------+------------------------------------------+
|                           | > **5H-1.1.b** Observe the               |
|                           | > key-management methods used to manage  |
|                           | > DDKs on the Host System to verify they |
|                           | > meet one, or both of the above         |
|                           | > options.                               |
+---------------------------+------------------------------------------+
| **5H-1.2** DDKs must be   | **5H-1.2.a** Examine documented          |
| erased from the Host      | key-management policies and procedures   |
| System volatile memory    | to verify that the mechanism used to     |
| via a mechanism that      | erase a DDK from the Host System         |
| ensures the key cannot be | volatile memory is sufficient to ensure  |
| recovered or              | the key cannot be recovered or           |
| reconstructed.            | reconstructed.                           |
+---------------------------+------------------------------------------+
|                           | **5H-1.2.b** Verify, through the use of  |
|                           | forensic tools and/or methods, that the  |
|                           | mechanism used to erase the DDK from the |
|                           | host volatile memory, is sufficient to   |
|                           | ensure the key cannot be recovered or    |
|                           | reconstructed.                           |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 5H: For    |                                          |
| hybrid decryption         |                                          |
| solutions: Implement      |                                          |
| secure hybrid key         |                                          |
| management***             |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| **5H-1.3** If the DDK is  | **5H-1.3.a** Examine key-management      |
| generated from a master   | policies and procedures to verify that   |
| key, the following        | the following is required for any DDKs   |
| conditions apply:         | generated from a master key:             |
|                           |                                          |
| -   A one-way derivation  | -   A one-way derivation process must be |
|     > process must be     |     > used.                              |
|     > used.               |                                          |
|                           | -   The DDK must never be generated as a |
| -   The DDK must never be |     > variant of the HSM master file     |
|     > generated as a      |     > key.                               |
|     > variant of the HSM  |                                          |
|     > master file key.    | -   The master key used to generate the  |
|                           |     > DDK must be dedicated to           |
| -   The master key used   |     > generating DDKs.                   |
|     > to generate the DDK |                                          |
|     > must be dedicated   |                                          |
|     > to generating DDKs. |                                          |
+---------------------------+------------------------------------------+
|                           | **5H-1.3.b** Observe key-generation      |
|                           | processes for generating DDKs from a     |
|                           | master key to verify:                    |
|                           |                                          |
|                           | -   A one-way derivation process is      |
|                           |     > used.                              |
|                           |                                          |
|                           | -   The DDK is never generated as a      |
|                           |     > variant of the HSM master file     |
|                           |     > key.                               |
|                           |                                          |
|                           | -   The master key used to generate the  |
|                           |     > DDK is dedicated to generating     |
|                           |     > DDKs.                              |
+---------------------------+------------------------------------------+
| **5H-1.4** The DDK must   | **5H-1.4.a** Examine key-management      |
| be encrypted between the  | policies and procedures to verify that   |
| HSM and the Host System,  | DDKs must be encrypted between the HSM   |
| e.g., using a fixed       | and the Host System.                     |
| transport key or a        |                                          |
| cryptographic protocol.   |                                          |
| The method of encryption  |                                          |
| used must maintain the    |                                          |
| security policy to which  |                                          |
| the HSM was approved      |                                          |
| (either *FIPS 140-2* or   |                                          |
| *140-3*, Level 3 or       |                                          |
| higher, or approved to    |                                          |
| the PCI HSM standard).    |                                          |
+---------------------------+------------------------------------------+
|                           | **5H-1.4.b** Examine HSM and Host System |
|                           | configurations to verify that DDKs are   |
|                           | encrypted between the HSM and the Host   |
|                           | System.                                  |
+---------------------------+------------------------------------------+
|                           | **5H-1.4.c** Examine the HSM security    |
|                           | policies and observe HSM implementations |
|                           | to verify that the method of encryption  |
|                           | used maintains the security policy to    |
|                           | which the HSM was approved.              |
+---------------------------+------------------------------------------+
| **5H-1.5** The encryption | **5H-1.5** Verify the encryption         |
| mechanism used to protect | mechanism used to protect the DDK        |
| the DDK between the HSM   | between the HSM and the Host System,     |
| and the Host System:      | includes **5H-1.5.1** through            |
|                           | **5H-1.5.4.**                            |
|                           |                                          |
|                           | Perform the following:                   |
+---------------------------+------------------------------------------+
| > **5H-1.5.1** The        | > **5H-1.5.1.a** Examine documented      |
| > encryption key must be  | > key-management policies and procedures |
| > equal or greater in     | > to verify that the encryption          |
| > strength than the key   | > mechanism uses an encryption key that  |
| > it protects.            | > is equal or greater in strength than   |
|                           | > the key it protects.                   |
+---------------------------+------------------------------------------+
|                           | > **5H-1.5.1.b** Observe key-management  |
|                           | > processes to verify the encryption     |
|                           | > mechanism used to protect the DDK      |
|                           | > between the HSM and the Host System    |
|                           | > uses an encryption key that is equal   |
|                           | > or greater in strength than the key it |
|                           | > protects.                              |
+---------------------------+------------------------------------------+

+---------------------------+------------------------------------------+
| ***Requirement 5H: For    |                                          |
| hybrid decryption         |                                          |
| solutions: Implement      |                                          |
| secure hybrid key         |                                          |
| management***             |                                          |
+===========================+==========================================+
| > **Domain 5              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| > **5H-1.5.2** The        | > **5H-1.5.2.a** Examine documented      |
| > encryption key must be  | > key-management policies and procedures |
| > unique for each Host    | > to verify that the encryption          |
| > System.                 | > mechanism uses an encryption key that  |
|                           | > is unique for each Host System.        |
+---------------------------+------------------------------------------+
|                           | > **5H-1.5.2.b** Observe key-management  |
|                           | > processes to verify that the           |
|                           | > encryption mechanism uses an           |
|                           | > encryption key that is unique for each |
|                           | > Host System.                           |
+---------------------------+------------------------------------------+
| > **5H-1.5.3** The        | > **5H-1.5.3.a** Examine documented      |
| > encryption key must     | > key-management policies and procedures |
| > only be used to encrypt | > to verify that the encryption          |
| > the DDK during          | > mechanism uses an encryption key that  |
| > transmission between    | > is only used to encrypt the DDK during |
| > the HSM and the Host    | > transmission between the HSM and the   |
| > System, and not used to | > Host System, and not used to           |
| > encrypt/transmit any    | > encrypt/transmit any other             |
| > other cryptographic     | > cryptographic key, or for any other    |
| > key, or for any other   | > purpose.                               |
| > purpose.                |                                          |
+---------------------------+------------------------------------------+
|                           | > **5H-1.5.3.b** Observe key-management  |
|                           | > processes to verify that the           |
|                           | > encryption mechanism uses an           |
|                           | > encryption key that is only used to    |
|                           | > encrypt the DDK during transmission    |
|                           | > between the HSM and the Host System,   |
|                           | > and not used to encrypt/transmit any   |
|                           | > other cryptographic key, or for any    |
|                           | > other purpose.                         |
+---------------------------+------------------------------------------+
| > **5H-1.5.4** The        | > **5H-1.5.4.a** Examine documented      |
| > encryption key must     | > key-management policies and procedures |
| > have a defined          | > to verify that the encryption          |
| > cryptoperiod based on   | > mechanism uses an encryption key that  |
| > the volume of keys it   | > has a defined cryptoperiod based on    |
| > transports and industry | > the volume of keys it transports and   |
| > recommendations/best    | > industry recommendations/best          |
| > practices               | > practices                              |
+---------------------------+------------------------------------------+
|                           | > **5H-1.5.4.b** Observe key-management  |
|                           | > processes to verify that the           |
|                           | > encryption mechanism uses an           |
|                           | > encryption key that has a defined      |
|                           | > cryptoperiod based on the volume of    |
|                           | > keys it transports and industry        |
|                           | > recommendations/best practices         |
+---------------------------+------------------------------------------+

[]{#_bookmark67 .anchor}

+---------------------------+-----------------------------------+-----+
| []{#_bookmark66           |                                   |     |
| .anchor}***Requirement    |                                   |     |
| 5I: Component providers   |                                   |     |
| ONLY: report status to    |                                   |     |
| solution providers***     |                                   |     |
+===========================+===================================+=====+
| > **Domain 5              | > **Testing Procedures**          |     |
| > Requirements**          |                                   |     |
+---------------------------+-----------------------------------+-----+
| ***Note:** This section   |                                   |     |
| is ONLY applicable for    |                                   |     |
| P2PE component providers  |                                   |     |
| undergoing an assessment  |                                   |     |
| of this domain for        |                                   |     |
| subsequent PCI listing of |                                   |     |
| the component provider's  |                                   |     |
| services. This section is |                                   |     |
| not applicable to, and    |                                   |     |
| does not need to be       |                                   |     |
| completed by, P2PE        |                                   |     |
| solution providers (or    |                                   |     |
| merchants as solution     |                                   |     |
| providers).*              |                                   |     |
+---------------------------+-----------------------------------+-----+
| ***5I-1 For component     |                                   |     |
| providers performing key  |                                   |     |
| management, maintain and  |                                   |     |
| monitor critical P2PE     |                                   |     |
| controls and provide      |                                   |     |
| reporting to the          |                                   |     |
| responsible solution      |                                   |     |
| provider.***              |                                   |     |
+---------------------------+-----------------------------------+-----+
| **5I-1.1** Track status   | > **5I-1.1.a** Review component   |     |
| of the deployed           | > provider's documented           |     |
| key-management services   | > procedures for providing        |     |
| for POIs and HSMs, and    | > required reporting to           |     |
| provide reports to        | > applicable solution providers,  |     |
| solution provider         | > and interview responsible       |     |
| annually and upon         | > component-provider personnel to |     |
| significant changes,      | > confirm that the following      |     |
| including at least the    | > processes are documented and    |     |
| following:                | > implemented:                    |     |
|                           |                                   |     |
| -   Types/models of POIs  | -   Types/models of POIs and/or   |     |
|     > and/or HSMs for     |     > HSMs for which keys have    |     |
|     > which keys have     |     > been injected               |     |
|     > been injected       |                                   |     |
|                           | -   For each type/model of POI    |     |
| -   For each type/model   |     > and/or HSM: Number of       |     |
|     > of POI and/or HSM:  |     > devices                     |     |
|     > Number of devices   |                                   |     |
|                           | > ![](vertopal_60a238a099614e17   |     |
| > ![](vertopal_60a238a    | 9dec6351a3c50457/media/image34.pn |     |
| 099614e179dec6351a3c50457 | g){width="7.443569553805775e-2in" |     |
| /media/image34.png){width | > height="6.364829396325459e-3    |     |
| ="7.443569553805775e-2in" | in"}![](vertopal_60a238a099614e17 |     |
| > he                      | 9dec6351a3c50457/media/image34.pn |     |
| ight="6.364829396325459e- | g){width="7.443569553805775e-2in" |     |
| 3in"}![](vertopal_60a238a | > hei                             |     |
| 099614e179dec6351a3c50457 | ght="6.364829396325459e-3in"}Type |     |
| /media/image34.png){width | > of key injected                 |     |
| ="7.443569553805775e-2in" | > Key-distribution method         |     |
| > height="6.3             |                                   |     |
| 64829396325459e-3in"}Type | -   ![](vertopal_60a238a099614e17 |     |
| > of key(s) injected      | 9dec6351a3c50457/media/image34.pn |     |
| > Key-distribution method | g){width="7.443569553805775e-2in" |     |
|                           |     > height                      |     |
| -   ![](vertopal_60a238a  | ="6.364829396325459e-3in"}Details |     |
| 099614e179dec6351a3c50457 |     > of any known or suspected   |     |
| /media/image34.png){width |     > compromised keys, per       |     |
| ="7.443569553805775e-2in" |     > **22-1**                    |     |
|     > height="6.3648      |                                   |     |
| 29396325459e-3in"}Details |                                   |     |
|     > of any known or     |                                   |     |
|     > suspected           |                                   |     |
|     > compromised keys,   |                                   |     |
|     > per **22-1**        |                                   |     |
|                           |                                   |     |
| ***Note:** Adding,        |                                   |     |
| changing, or removing POI |                                   |     |
| and/or HSM types, or      |                                   |     |
| critical key-management   |                                   |     |
| methods may require       |                                   |     |
| adherence to PCI SSC's    |                                   |     |
| process for P2PE          |                                   |     |
| Designated Changes to     |                                   |     |
| Solutions. Please refer   |                                   |     |
| to the P2PE Program Guide |                                   |     |
| for details about         |                                   |     |
| obligations when adding,  |                                   |     |
| changing, or removing     |                                   |     |
| elements of a P2PE        |                                   |     |
| solution.*                |                                   |     |
+---------------------------+-----------------------------------+-----+
|                           | > **5I-1.1.b** Observe reports    |     |
|                           | > provided to applicable solution |     |
|                           | > providers annually and upon     |     |
|                           | > significant changes to the      |     |
|                           | > solution, and confirm they      |     |
|                           | > include at least the following: |     |
|                           |                                   |     |
|                           | -   Types/models of POIs for      |     |
|                           |     > which keys have been        |     |
|                           |     > injected                    |     |
|                           |                                   |     |
|                           | -   ![](vertopal_60a238a099614e17 |     |
|                           | 9dec6351a3c50457/media/image34.pn |     |
|                           | g){width="7.443569553805775e-2in" |     |
|                           |     > he                          |     |
|                           | ight="6.364829396325459e-3in"}For |     |
|                           |     > each type/model of POI:     |     |
|                           |     > Number of POI devices Type  |     |
|                           |     > of key injected             |     |
|                           |     > Key-distribution method     |     |
|                           |                                   |     |
|                           | -   ![](vertopal_60a238a099614e17 |     |
|                           | 9dec6351a3c50457/media/image34.pn |     |
|                           | g){width="7.443569553805775e-2in" |     |
|                           |                                   |     |
|                           |    > height="6.364829396325459e-3 |     |
|                           | in"}![](vertopal_60a238a099614e17 |     |
|                           | 9dec6351a3c50457/media/image34.pn |     |
|                           | g){width="7.443569553805775e-2in" |     |
|                           |     > height                      |     |
|                           | ="6.364829396325459e-3in"}Details |     |
|                           |     > of any known or suspected   |     |
|                           |     > compromised keys, per       |     |
|                           |     > **22-1**                    |     |
+---------------------------+-----------------------------------+-----+

## Domain 5 Normative Annex C: Minimum and Equivalent Key Sizes and Strengths for Approved Algorithms

> Approved Algorithms in connection with the requirements in this
> document are based on the approved algorithms listed in NIST SP 800-57
> Part 1 Rev. 4, Section 4;
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Hash functions: only algorithms from
> the SHA2 and SHA3 family are allowed on POI v3 and higher devices,
> with output size \>255**2**
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Symmetric-Key Algorithms used for
> encryption and decryption: AES must be used, with key size \>= 128
> bits or TDEA with keys size \>= 112 bits
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Message Authentication Codes (MACs):
> CMAC or GMAC can be used with AES, as well as HMAC with an approved
> hash function and a key size \>=128
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Signature algorithms: DSA, RSA (with
> PKCS1-v1.5 or PSS) and ECDSA with key sizes specified below.
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Approved key establishment schemes are
> described in NIST SP800-56A (ECC/FCC**3**-based key agreement), NIST
> SP800-56B (IFC- based key agreement) and NIST SP800-38F (AES-based key
> encryption/wrapping).
>
> ^2^ Except as noted, the use of SHA-1 is prohibited for all digital
> signatures used on the device that are used in connection with meeting
> PCI security requirements. This includes certificates used by the
> device that are non-device-specific that are part of a vendor PKI, up
> to and including a vendor root certificate. The only exception to this
> is that the initial code on ROM that initiates upon the device start
> may authenticate itself using SHA-1, but all subsequent code must be
> authenticated using SHA-2.
>
> SHA-2 or higher is recommended for other usages, but SHA-1 may be used
> in conjunction with the generation of HMAC values and surrogate PANs
> (with salt), for deriving keys using key derivation functions (i.e.,
> KDFs) and random number generation. Where applicable, appropriate key
> length minimums as delineated in the Derived Test Requirements are
> also required.
>
> 3 IFC: Integer Factorization Cryptography; ECC: Elliptic Curve
> Cryptography; FFC: Finite Field Cryptography
>
> The following are the **minimum key sizes^4^** and parameters for the
> algorithm(s) in question that must be used in connection with key
> transport, exchange, or establishment, and for key or data protection:

+-----------------------+------+-----+---------------+----------+-----+
| > **Algorithm**       | >    | >   | **ECC**       | **FFC**  | > * |
|                       | **TD | **( |               |          | *AE |
|                       | EA** | IFC | **(ECDSA,     | **(DSA,  | S** |
|                       |      | )** | ECDH,         | DH,      |     |
|                       |      | >   | ECMQV)**      | MQV)**   |     |
|                       |      | > * |               |          |     |
|                       |      | *RS |               |          |     |
|                       |      | A** |               |          |     |
+=======================+======+=====+===============+==========+=====+
| > **Minimum key       | >    | > 2 | > 224         | >        | >   |
| > size** in number of |  168 | 048 |               | 2048/224 | 128 |
| > bits ^5^            |      |     |               |          |     |
+-----------------------+------+-----+---------------+----------+-----+

> TDEA refers to TDEA (TDES) keys with non-parity bits. The RSA key size
> refers to the size of the modulus. The Elliptic Curve key size refers
> to the minimum order of the base point on the elliptic curve; this
> order should be slightly smaller than the field size. The DSA key
> sizes refer to the size of the modulus and the minimum size of a large
> subgroup. Key-encipherment keys shall be at least of equal or greater
> strength than any key that they are protecting.^6^ This applies to any
> key-encipherment keys used for the protection of secret or private
> keys that are stored or for keys used to encrypt any secret or private
> keys for loading or transport. For purposes of this requirement, the
> following algorithms and keys sizes by row are considered equivalent.
>
> ^4^ Additional key sizes and algorithms may be supported for non-PCI
> payment brand relevant transactions.
>
> ^5^ Double-length (2-key i.e.,112 bits) TDEA, RSA 1024, ECC 160, and
> DSA 1024/160 are only allowed for PTS v2.x SRED devices that cannot
> support the minimum key sizes listed above.
>
> PTS POI version 3.0 devices and above are **ONLY** permitted to use
> 2-key TDEA for account-data encryption with an industry recognized
> unique-key-per- transaction algorithm as defined in *ISO 11568* for
> key derivation or transformation (i.e., UKPT, DUKPT), including the
> use of a double-length BDK for key generation of data
> encryption/decryption keys.
>
> ^6^ Notwithstanding the statement, 2048 RSA keys may be used to
> transport 128 AES keys when performing remote key distribution using
> asymmetric techniques.

+-------------+-------------+-------------+-------------+-------------+
| > **Bits of | >           | > **IFC     | > **ECC**   | > **FFC     |
| >           | **Symmetric | > (RSA)**   | >           | > (DSA, DH, |
|  Security** | >           |             | > **(ECDSA, | > MQV)**    |
| >           |  encryption |             | > ECDH,     |             |
| > *(not to  | > a         |             | > ECMQV)**  |             |
| > be        | lgorithms** |             |             |             |
| > confused  |             |             |             |             |
| > with      |             |             |             |             |
| > minimum   |             |             |             |             |
| > key       |             |             |             |             |
| > size)*    |             |             |             |             |
+=============+=============+=============+=============+=============+
| > 112       | > Tr        | > 2048      | > 224       | > 2048/224  |
|             | iple-length |             |             |             |
|             | > TDEA      |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| > 128       | > AES-128   | > 3072      | > 256       | > 3072/256  |
+-------------+-------------+-------------+-------------+-------------+
| > 192       | > AES-192   | > 7680      | > 384       | > 7680/384  |
+-------------+-------------+-------------+-------------+-------------+
| > 256       | > AES-256   | > 15360     | > 512       | > 15360/512 |
+-------------+-------------+-------------+-------------+-------------+

> For implementations using FFC or ECC:

1.  **FFC implementations --** Entities must securely generate and
    distribute the system-wide parameters: generator *g,* prime number
    *p* and parameter *q,* the large prime factor of (*p* - 1).
    Parameter *p* must be at least 2048 bits long, and parameter *q*
    must be at least 224 bits long. Each entity must generate a private
    key *x* and a public key *y* using the domain parameters (*p, q,
    g*,).

2.  **ECC implementations --** Entities must securely generate and
    distribute the system-wide parameters. Entities may generate the
    elliptic curve domain parameters or use a recommended curve (See
    *FIPS186-4*). The elliptic curve specified by the domain parameters
    must be at least as secure as P-224. Each entity must generate a
    private key *d* and a public key *Q* using the specified elliptic
    curve domain parameters. (See *FIPS186-4* for methods of generating
    *d* and *Q*).

3.  Each private key must be statistically unique, unpredictable, and
    created using an approved random number generator as described in
    this document.

4.  Entities must authenticate the FFC or ECC public keys using either
    DSA, ECDSA, a certificate, or a symmetric MAC (see *ISO 16609 --
    Banking --Requirements for message authentication using symmetric
    techniques).* One of the following should be used: MAC algorithm 1
    using padding method 3, MAC algorithm 5 using padding method 4).

> IFC, FFC and ECC are vulnerable to attacks from large-scale quantum
> computers. In 2017, NIST initiated a process to solicit, evaluate, and
> standardize one or more quantum-resistant public-key cryptographic
> algorithms, planned to end with a selection of new algorithms by
> 2023-2025.
>
> Because of rapid progress in the field of quantum computing, it is
> advised to become informed/aware of this specific threat and its
> potential mitigations.

# Appendix A: Merchant-Managed Solutions: Separation between Merchant Encryption and Decryption Environments

+--------------+------------------+------------------------------------+
|              | > **Overview**   | > **P2PE Validation Requirements** |
+==============+==================+====================================+
| > **Merc     | Separate duties  | **MM-A** Restrict access between   |
| hant-managed | and functions    | the merchant decryption            |
| >            | between merchant | environment and all other          |
|  Solutions** | encryption and   | networks/systems.                  |
| >            | decryption       |                                    |
| > *Note that | environments.    | **MM-B** Restrict traffic between  |
| > this       |                  | the encryption environment and any |
| > Appendix   |                  | other CDE.                         |
| > is not     |                  |                                    |
| > applicable |                  | **MM-C** Restrict personnel access |
| > to         |                  | between the encryption environment |
| >            |                  | and the merchant decryption        |
|  third-party |                  | environment.                       |
| > solution   |                  |                                    |
| >            |                  |                                    |
|  providers.* |                  |                                    |
+--------------+------------------+------------------------------------+

> ***Target Audience:** This appendix, in addition to applicable
> Domains, applies only to merchants that manage their own P2PE
> solutions.*

#### *Overview*

> Some merchants may choose to manage their own P2PE solution on behalf
> of their own merchant encryption environments rather than fully
> outsourcing the solution to a third-party solution provider. This type
> of P2PE solution is defined as a "*merchant-managed solution*" since
> the merchant is acting as its own P2PE solution provider. This
> appendix specifies the additional requirements that must be met for a
> *merchant- managed solution* with the objective of reducing the
> presence of clear-text account data within their encryption
> environments.
>
> This appendix is ***only*** applicable to *merchants acting as their
> own P2PE solution providers*, as defined in this Standard. This
> appendix is ***not*** applicable to third-party solution providers who
> manage P2PE solutions on behalf of merchants. *Merchants acting as
> their own P2PE solution providers* are responsible for ensuring all
> requirements and domains within this P2PE standard are met, either
> directly or in conjunction with P2PE component providers.
>
> Merchants may use a service provider(s) or P2PE component providers to
> perform some P2PE functions. For example, a *merchant acting as its
> own P2PE solution provider* may choose to outsource POI device
> management and cryptographic key management to another entity. In this
> scenario, both the merchant and the third party may be responsible for
> meeting different P2PE requirements. While P2PE requirements may be
> met by either the merchant directly or by a third party on the
> merchant's behalf, the *merchant acting as its own P2PE solution
> provider* is ultimately responsible for ensuring that all P2PE
> requirements are met.
>
> If the merchant manages any element of the solution---that is, if any
> requirement from Domains 1, 2, 4, or 5 is under the merchant's
> control---the merchant must meet Domain 3 in addition to this appendix
> to ensure all P2PE requirements are being met (either by the merchant
> as the solution provider itself or by a P2PE component provider).
>
> See ["P2PE Solutions and use of Third Parties and/or P2PE Component
> Providers"](#p2pe-solutions-and-use-of-third-parties-andor-p2pe-component-providers)
> for more information about solution providers, component providers,
> and merchant as a solution provider.

#### *Eligibility Criteria*

> In a merchant-managed solution, the merchant retains control over the
> entire solution, from point of capture and encryption at the POI
> devices in the encryption environment through to the decryption of
> P2PE transaction data. There is inherently greater risk to the
> security of the account data when a merchant possesses autonomous
> control over the P2PE solution without having the separation between
> the encryption and decryption environments that is naturally included
> when the solution is delivered by a third-party. Therefore, *merchants
> acting as their own solution provider* must meet the following
> additional criteria to be eligible for P2PE solution validation:
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Only use hardware-based decryption as
> part of the P2PE solution (use of hybrid decryption in a
> *merchant-managed P2PE solution* is not permitted).
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Satisfy all P2PE domain requirements
> (Domains 1, 2, 3, 4, and 5) in this standard, including this Appendix.
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image2.png){width="0.125in"
> height="0.1527777777777778in"} Undergo a full P2PE assessment by a
> qualified P2PE assessor.
>
> ***Note:** The PCI SSC does **not** approve or list merchant-managed
> solutions on its website.*
>
> []{#_bookmark72 .anchor}**At a Glance -- Example of Separation between
> Merchant Encryption and Decryption Environments for Merchant- Managed
> Solutions**
>
> ![](vertopal_60a238a099614e179dec6351a3c50457/media/image35.png){width="1.3046511373578302in"
> height="0.8034995625546807in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image36.png){width="1.2210542432195977in"
> height="0.7178357392825897in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image37.png){width="1.0811143919510062in"
> height="0.6365234033245845in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image38.png){width="0.9365944881889764in"
> height="0.49894247594050745in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image39.png){width="1.3046511373578302in"
> height="0.8034995625546807in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image40.png){width="1.2210542432195977in"
> height="0.7178357392825897in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image41.png){width="1.0811143919510062in"
> height="0.44in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image42.png){width="0.857577646544182in"
> height="0.49894247594050745in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image43.png){width="0.1984951881014873in"
> height="0.23750656167979003in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image44.png){width="0.1962817147856518in"
> height="0.23750656167979003in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image45.png){width="0.19857174103237096in"
> height="0.23750656167979003in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image46.png){width="2.717483595800525in"
> height="3.1060411198600173in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image47.png){width="3.404965004374453e-2in"
> height="6.993547681539808e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image48.png){width="2.4811898512685913e-2in"
> height="1.8093832020997375e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image49.png){width="0.11963145231846019in"
> height="6.993547681539808e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image50.png){width="1.580271216097988e-2in"
> height="6.993547681539808e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image51.png){width="0.4672276902887139in"
> height="0.3883114610673666in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image52.png){width="2.2520778652668418e-2in"
> height="1.8246937882764654e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image53.png){width="0.3635520559930009in"
> height="0.32501859142607176in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image54.png){width="0.1939905949256343in"
> height="1.8246937882764654e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image55.png){width="0.17865485564304462in"
> height="0.49454943132108486in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image56.png){width="0.23030839895013122in"
> height="0.4807709973753281in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image57.png){width="0.15573490813648294in"
> height="0.18974300087489063in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image58.png){width="0.28890529308836393in"
> height="0.21230424321959754in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image59.png){width="0.22793088363954506in"
> height="0.273176946631671in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image60.png){width="0.1872878390201225in"
> height="0.5032939632545932in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image61.png){width="0.23239173228346457in"
> height="0.4807709973753281in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image62.png){width="0.15573490813648294in"
> height="0.2934481627296588in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image63.jpeg){width="0.5800962379702537in"
> height="0.48977252843394575in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image64.png){width="0.20078521434820648in"
> height="0.4807709973753281in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image65.jpeg){width="0.17827209098862642in"
> height="0.48075568678915137in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image66.png){width="0.20102252843394575in"
> height="0.4807709973753281in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image67.png){width="0.15573490813648294in"
> height="0.29569991251093614in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image67.png){width="0.15573490813648294in"
> height="0.29569991251093614in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image68.png){width="0.15573490813648294in"
> height="0.29569991251093614in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image69.png){width="0.4085958005249344in"
> height="0.8172419072615923in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image70.png){width="0.23911089238845146in"
> height="0.10375765529308836in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image71.png){width="0.46493766404199477in"
> height="0.3906025809273841in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image72.png){width="0.5145614610673666in"
> height="0.32295713035870516in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image73.png){width="0.35652887139107614in"
> height="0.31845253718285216in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image74.png){width="0.37027012248468943in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image75.png){width="0.1804779090113736in"
> height="0.27956146106736657in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image76.png){width="0.11291338582677166in"
> height="0.2639391951006124in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image77.png){width="0.1230282152230971in"
> height="9.0168416447944e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image78.png){width="0.19198272090988627in"
> height="0.23485017497812774in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image79.png){width="0.10140748031496064in"
> height="8.78772965879265e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image80.png){width="0.1309689413823272in"
> height="0.10841535433070866in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image81.png){width="0.4153904199475066in"
> height="8.566382327209099e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image82.png){width="0.10143372703412074in"
> height="2.4862204724409448e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image83.png){width="2.0307305336832896e-2in"
> height="2.0231846019247594e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image84.png){width="2.0307305336832896e-2in"
> height="2.0231846019247594e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image85.png){width="0.4153904199475066in"
> height="8.810695538057743e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image86.png){width="0.10143372703412074in"
> height="2.2571084864391952e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image87.png){width="2.0307305336832896e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image88.png){width="2.0307305336832896e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image89.png){width="0.4153904199475066in"
> height="8.581583552055994e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image90.png){width="0.10143372703412074in"
> height="2.478565179352581e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image91.png){width="2.0307305336832896e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image92.png){width="2.0307305336832896e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image93.png){width="0.1579560367454068in"
> height="0.15796587926509187in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image94.png){width="0.1579560367454068in"
> height="0.15796587926509187in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image95.png){width="0.158001968503937in"
> height="0.16025699912510935in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image96.png){width="0.1579560367454068in"
> height="0.16025699912510935in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image97.png){width="0.15803258967629047in"
> height="0.1580424321959755in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image98.png){width="0.28876312335958004in"
> height="0.21438867016622923in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image99.png){width="0.2271117672790901in"
> height="0.27096347331583553in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image100.png){width="0.41531386701662293in"
> height="8.566382327209099e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image101.png){width="0.10143372703412074in"
> height="2.478565179352581e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image102.png){width="2.0459317585301836e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image103.png){width="2.0307305336832896e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image104.png){width="0.41531386701662293in"
> height="8.810695538057743e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image105.png){width="0.10143372703412074in"
> height="2.280074365704287e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image106.png){width="2.0459317585301836e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image107.png){width="2.0307305336832896e-2in"
> height="2.0308398950131232e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image108.png){width="0.41531386701662293in"
> height="8.566382327209099e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image109.png){width="0.10143372703412074in"
> height="2.478565179352581e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image110.png){width="2.0459317585301836e-2in"
> height="1.8018372703412073e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image111.png){width="2.0307305336832896e-2in"
> height="1.8018372703412073e-2in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image112.png){width="0.15803258967629047in"
> height="0.15796587926509187in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image113.png){width="0.2866185476815398in"
> height="0.21211614173228346in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image114.png){width="0.22808727034120735in"
> height="0.2707338145231846in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image115.png){width="0.15803258967629047in"
> height="0.15796587926509187in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image116.png){width="0.1579560367454068in"
> height="0.15796587926509187in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image117.png){width="0.1579560367454068in"
> height="0.1580424321959755in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image118.png){width="0.20277012248468942in"
> height="0.23706364829396326in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image119.png){width="9.710958005249344e-2in"
> height="0.20782261592300963in"}![](vertopal_60a238a099614e179dec6351a3c50457/media/image120.png){width="0.16246062992125984in"
> height="0.2578783902012248in"}

+----------------------------+-----------------------------------------+
| []{#_bookmark73            |                                         |
| .anchor}***Requirement     |                                         |
| MM-A: Restrict access      |                                         |
| between the merchant       |                                         |
| decryption environment and |                                         |
| all other                  |                                         |
| networks/systems***        |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***MM-A-1** The merchant |                                         |
| > decryption environment   |                                         |
| > must be dedicated to     |                                         |
| > decryption operations.*  |                                         |
+----------------------------+-----------------------------------------+
| **MM-A-1.1** Current       | **MM-A-1.1.a** Interview responsible    |
| documentation must be      | personnel and review documentation to   |
| maintained that describes, | verify that procedures exist for        |
| or illustrates, the        | maintaining documentation that          |
| architecture of the        | describes/illustrates the architecture  |
| merchant- managed P2PE     | of the merchant-managed P2PE solution,  |
| solution, including the    | including the flow of data and          |
| flow of data and           | cryptographic key exchanges, and        |
| cryptographic key          | interconnectivity between all systems   |
| exchanges, and             | within the encryption environment, the  |
| interconnectivity between  | merchant decryption environment, and    |
| all systems within the     | any other CDEs.                         |
| encryption environment,    |                                         |
| the merchant decryption    |                                         |
| environment, and any other |                                         |
| CDEs.                      |                                         |
+----------------------------+-----------------------------------------+
|                            | **MM-A-1.1.b** Interview responsible    |
|                            | personnel and review merchant           |
|                            | documentation that                      |
|                            | describes/illustrates the architecture  |
|                            | of the merchant-managed P2PE solution,  |
|                            | including the flow of data and          |
|                            | cryptographic key exchanges, and        |
|                            | interconnectivity between all systems   |
|                            | within the encryption environment, the  |
|                            | merchant decryption environment, and    |
|                            | any other CDEs to verify that the       |
|                            | document is kept current.               |
+----------------------------+-----------------------------------------+
| **MM-A-1.2** Decryption    | **MM-A-1.2.a** Examine network diagrams |
| systems must reside on a   | to verify that decryption systems are   |
| network that is dedicated  | located on a network that is dedicated  |
| to decryption operations.  | to decryption operations.               |
|                            |                                         |
| ***Note:** The decryption  |                                         |
| environment must exist     |                                         |
| within a cardholder data   |                                         |
| environment (CDE).*        |                                         |
+----------------------------+-----------------------------------------+
|                            | **MM-A-1.2.b** Inspect network and      |
|                            | system configurations to verify that    |
|                            | decryption systems are located on a     |
|                            | network that is dedicated to decryption |
|                            | operations.                             |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement MM-A:       |                                         |
| Restrict access between    |                                         |
| the merchant decryption    |                                         |
| environment and all other  |                                         |
| networks/systems***        |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **MM-A-1.3** Systems in    | **MM-A-1.3.a** Inspect network and      |
| the decryption environment | system configuration settings to verify |
| must be dedicated to       | that only necessary services,           |
| performing and/or          | protocols, daemons, etc. are enabled,   |
| supporting decryption and  | and any functions not required for      |
| key-management operations: | performing or supporting decryption     |
|                            | operations are disabled or isolated     |
| -   Services, protocols,   | from decryption operations.             |
|     daemons, etc.          |                                         |
|     necessary for          |                                         |
|     performing and/or      |                                         |
|     supporting decryption  |                                         |
|     operations must be     |                                         |
|     documented and         |                                         |
|     justified.             |                                         |
|                            |                                         |
| -   Functions not required |                                         |
|     for performing or      |                                         |
|     supporting decryption  |                                         |
|     operations must be     |                                         |
|     disabled or isolated   |                                         |
|     (e.g., using logical   |                                         |
|     partitions) from       |                                         |
|     decryption operations. |                                         |
|                            |                                         |
| ***Note:** Security        |                                         |
| functions (e.g., logging   |                                         |
| and monitoring controls)   |                                         |
| are examples of functions  |                                         |
| supporting decryption      |                                         |
| operations. It is not      |                                         |
| required that supporting   |                                         |
| functions be present in    |                                         |
| the merchant decryption    |                                         |
| environment; these         |                                         |
| functions may be resident  |                                         |
| in the CDE. However, any   |                                         |
| supporting functions that  |                                         |
| are present in the         |                                         |
| decryption environment     |                                         |
| must be wholly dedicated   |                                         |
| to the decryption          |                                         |
| environment.*              |                                         |
+----------------------------+-----------------------------------------+
|                            | **MM-A-1.3.b** Review the documented    |
|                            | record of services, protocols, daemons, |
|                            | etc. that are required by the           |
|                            | decryption systems and verify that each |
|                            | service includes justification.         |
+----------------------------+-----------------------------------------+
| **MM-A-1.4** Systems       | **MM-A-1.4.a** Examine documented       |
| providing logical          | policies and procedures, and interview  |
| authentication services to | responsible personnel to verify that    |
| system components within   | systems providing logical               |
| the decryption environment | authentication services to system       |
| must:                      | components within the decryption        |
|                            | environment reside within the           |
| -   Reside within the      | decryption environment and are          |
|     > decryption           | dedicated to supporting the decryption  |
|     > environment          | environment.                            |
|                            |                                         |
| -   Be dedicated to        |                                         |
|     > supporting the       |                                         |
|     > decryption           |                                         |
|     > environment.         |                                         |
|                            |                                         |
| ***Note:** Logical         |                                         |
| authentication services    |                                         |
| may be internal to the HSM |                                         |
| management system.*        |                                         |
+----------------------------+-----------------------------------------+
|                            | **MM-A-1.4.b** Review system            |
|                            | configurations and observe processes to |
|                            | verify that systems providing           |
|                            | authentication services to system       |
|                            | components within the decryption        |
|                            | environment reside within the           |
|                            | decryption environment and are          |
|                            | dedicated to supporting the decryption  |
|                            | environment.                            |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement MM-A:       |                                         |
| Restrict access between    |                                         |
| the merchant decryption    |                                         |
| environment and all other  |                                         |
| networks/systems***        |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **MM-A-1.5** Logical       | **MM-A-1.5.a** Examine documented       |
| administrative/privileged  | policies and procedures, and interview  |
| access to systems within   | responsible personnel to verify that    |
| the decryption environment | logical administrative/privileged       |
| must be authorized and     | access to the systems within the        |
| must originate from within | decryption environment must be          |
| the merchant decryption    | authorized and originate from within    |
| environment.               | the merchant decryption environment.    |
+----------------------------+-----------------------------------------+
|                            | **MM-A-1.5.b** Examine firewall/router  |
|                            | configurations to verify that logical   |
|                            | administrative/privileged access to     |
|                            | systems within the decryption           |
|                            | environment is authorized and           |
|                            | originates from within the merchant     |
|                            | decryption environment.                 |
+----------------------------+-----------------------------------------+
| **MM-A-1.6** All remote    | **MM-A-1.6** Review system              |
| access features on all     | configurations and observe processes to |
| systems in the merchant    | verify that all remote access features  |
| decryption environment     | on all systems within the merchant      |
| must be permanently        | decryption environment are permanently  |
| disabled and/or otherwise  | disabled and/or otherwise prevented     |
| prevented from being used  | from being used.                        |
+----------------------------+-----------------------------------------+
| **MM-A-1.7** Systems in    | **MM-A-1.7.a** Review configurations of |
| the merchant decryption    | all devices and systems in the merchant |
| environment must not store | decryption environment to confirm none  |
| account data.              | of the systems store account data.      |
+----------------------------+-----------------------------------------+
|                            | **MM-A-1.7.b** Review data flows and    |
|                            | interview personnel to verify that      |
|                            | account data is not stored in the       |
|                            | merchant decryption environment.        |
+----------------------------+-----------------------------------------+
| > **MM-*A-2 ****Restrict   |                                         |
| > access between the       |                                         |
| > merchant decryption      |                                         |
| > environment and all      |                                         |
| > other networks/systems.* |                                         |
+----------------------------+-----------------------------------------+
| **MM-A-2.1** Firewalls     | **MM-A-2.1** Review documentation and   |
| must be in place to        | observe network configurations to       |
| restrict connections       | verify that firewalls are in place      |
| between the merchant       | between the merchant decryption         |
| decryption environment and | environment and all other networks.     |
| all other networks.        |                                         |
|                            |                                         |
| Firewalls must be          |                                         |
| configured to restrict     |                                         |
| traffic as follows:        |                                         |
+----------------------------+-----------------------------------------+
| > **MM-A-2.1.1** Inbound   | > **MM-A-2.1.1** Examine firewall and   |
| > and outbound traffic     | > router configurations to verify that  |
| > to/from the decryption   | > inbound and outbound traffic to/from  |
| > environment must be      | > the decryption environment is limited |
| > restricted to only IP    | > to only IP addresses within the CDE.  |
| > addresses within the     |                                         |
| > CDE.                     |                                         |
+----------------------------+-----------------------------------------+
| > **MM-A-2.1.2** Inbound   | > **MM-A-2.1.2.a** Review firewall      |
| > and outbound traffic     | > configuration standards to verify     |
| > between the decryption   | > that inbound and outbound traffic     |
| > environment and any CDE  | > necessary for performing and/or       |
| > must be restricted to    | > supporting decryption operations is   |
| > only that which is       | > identified and documented.            |
| > necessary for performing |                                         |
| > and/or supporting        |                                         |
| > decryption operations,   |                                         |
| > with all other traffic   |                                         |
| > specifically denied      |                                         |
| > (e.g., by using an       |                                         |
| > explicit "deny all" or   |                                         |
| > an implicit deny after   |                                         |
| > an allow statement).     |                                         |
+----------------------------+-----------------------------------------+
|                            | > **MM-A-2.1.2.b** Examine firewall     |
|                            | > configurations to verify that inbound |
|                            | > and outbound traffic between the      |
|                            | > decryption environment and any CDE is |
|                            | > limited to only that which is         |
|                            | > necessary for performing and/or       |
|                            | > supporting decryption operations, and |
|                            | > all other traffic is specifically     |
|                            | > denied (e.g., by using an explicit    |
|                            | > "deny all" or an implicit deny after  |
|                            | > an allow statement).                  |
+----------------------------+-----------------------------------------+

+----------------------------+-----------------------------------------+
| ***Requirement MM-A:       |                                         |
| Restrict access between    |                                         |
| the merchant decryption    |                                         |
| environment and all other  |                                         |
| networks/systems***        |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| **MM-A-2.2** Inbound and   | **MM-A-2.2** Examine network and system |
| outbound traffic between   | configurations to verify that inbound   |
| the merchant CDE and the   | and outbound traffic between the        |
| encryption environment     | merchant CDE and the encryption         |
| must be restricted to      | environment is restricted to approved   |
| approved POI devices       | POI devices located within the          |
| located within the         | encryption environment.                 |
| encryption environment.    |                                         |
+----------------------------+-----------------------------------------+
| **MM-A-2.3** Processes     | **MM-A-2.3.a** Review document policies |
| must be implemented to     | and procedures to verify that wireless  |
| prevent unauthorized       | connections to the decryption           |
| physical connections       | environment are prohibited**.**         |
| (e.g., wireless access) to |                                         |
| the decryption environment |                                         |
| as follows:                |                                         |
|                            |                                         |
| -   Wireless connections   |                                         |
|     > to the decryption    |                                         |
|     > environment are      |                                         |
|     > prohibited.          |                                         |
|                            |                                         |
| -   Processes are          |                                         |
|     > implemented to       |                                         |
|     > detect and           |                                         |
|     > immediately (as soon |                                         |
|     > as possible) respond |                                         |
|     > to physical          |                                         |
|     > connections (e.g.,   |                                         |
|     > wireless             |                                         |
|     > connections) to the  |                                         |
|     > decryption           |                                         |
|     > environment.         |                                         |
+----------------------------+-----------------------------------------+
|                            | **MM-A-2.3.b** Observe processes and    |
|                            | interview personnel to verify a         |
|                            | methodology is implemented to           |
|                            | immediately (e.g., ASAP) detect,        |
|                            | identify, and eliminate any             |
|                            | unauthorized physical connections       |
|                            | (e.g., wireless access points) that     |
|                            | connect to the decryption environment.  |
+----------------------------+-----------------------------------------+
|                            | **MM-A-2.3.c** Examine firewall/router  |
|                            | configurations to confirm that all      |
|                            | wireless networks are prevented from    |
|                            | connecting to the decryption            |
|                            | environment.                            |
+----------------------------+-----------------------------------------+

+---------------------------+------------------------------------------+
| []{#_bookmark74           |                                          |
| .anchor}***Requirement    |                                          |
| MM-B: Restrict traffic    |                                          |
| between the encryption    |                                          |
| environment and any other |                                          |
| CDE***                    |                                          |
+===========================+==========================================+
| > **Domain 4              | > **Testing Procedures**                 |
| > Requirements**          |                                          |
+---------------------------+------------------------------------------+
| ***MM-B-1** Traffic       |                                          |
| between the encryption    |                                          |
| environment and any other |                                          |
| CDE is restricted*        |                                          |
+---------------------------+------------------------------------------+
| **MM-B-1.1** Traffic      | **MM-B-1.1.a** Review documentation to   |
| between the encryption    | verify that inbound and outbound traffic |
| environment and any other | necessary for transaction processing     |
| CDE must be limited as    | and/or terminal management purposes is   |
| follows:                  | identified and documented.               |
|                           |                                          |
| -   Only those systems    |                                          |
|     > (e.g., POI devices) |                                          |
|     > directly related to |                                          |
|     > supporting P2PE     |                                          |
|     > transactions, and   |                                          |
|                           |                                          |
| -   Only traffic that is  |                                          |
|     > necessary for       |                                          |
|     > transaction         |                                          |
|     > processing and/or   |                                          |
|     > terminal management |                                          |
|     > purposes            |                                          |
|                           |                                          |
| All other traffic between |                                          |
| the encryption            |                                          |
| environment and any other |                                          |
| CDE must be specifically  |                                          |
| denied.                   |                                          |
+---------------------------+------------------------------------------+
|                           | **MM-B-1.1.b** Examine firewall          |
|                           | configurations to verify that any        |
|                           | traffic between the encryption           |
|                           | environment and any other CDE is limited |
|                           | as follows:                              |
|                           |                                          |
|                           | -   Only those systems (e.g., POI        |
|                           |     > devices) directly related to       |
|                           |     > supporting P2PE transactions, and  |
|                           |                                          |
|                           | -   Only traffic that is necessary for   |
|                           |     > transaction processing and/or      |
|                           |     > terminal management purposes       |
|                           |                                          |
|                           | > Verify all other traffic between those |
|                           | > two networks is specifically denied    |
|                           | > (e.g., by using an explicit "deny all" |
|                           | > or an implicit deny after an allow     |
|                           | > statement).                            |
+---------------------------+------------------------------------------+
|                           | **MM-B-1.1.c** Observe traffic between   |
|                           | the encryption environment and any other |
|                           | CDE to verify the traffic is limited to  |
|                           | systems directly related to supporting   |
|                           | P2PE transactions, transaction           |
|                           | processing, and/or terminal-management   |
|                           | functions.                               |
+---------------------------+------------------------------------------+
| **MM-B-1.2** Processes    | **MM-B-1.2.a** Review documented         |
| must be implemented to    | policies and procedures for the CDE to   |
| prevent clear-text        | verify that the transmission of          |
| account data from being   | clear-text account data from the CDE     |
| transmitted from the CDE  | back to the encryption environment is    |
| back to the encryption    | prohibited.                              |
| environment.              |                                          |
+---------------------------+------------------------------------------+
|                           | **MM-B-1.2.b** Observe processes and     |
|                           | interview personnel to verify clear-text |
|                           | account data is prevented from being     |
|                           | transmitted from the CDE back to the     |
|                           | encryption environment.                  |
+---------------------------+------------------------------------------+
|                           | **MM-B-1.2.c** Using forensic            |
|                           | techniques, observe traffic between the  |
|                           | encryption environment and the CDE to    |
|                           | verify clear-text account data is not    |
|                           | transmitted from the CDE back to the     |
|                           | encryption environment.                  |
+---------------------------+------------------------------------------+

+----------------------------+-----------------------------------------+
| > []{#_bookmark75          |                                         |
| > .anchor}***Requirement   |                                         |
| > MM-C: Restrict personnel |                                         |
| > access between           |                                         |
| > encryption environment   |                                         |
| > and decryption           |                                         |
| > environment***           |                                         |
+============================+=========================================+
| > **Domain 4               | > **Testing Procedures**                |
| > Requirements**           |                                         |
+----------------------------+-----------------------------------------+
| > ***MM-C-1** Merchant     |                                         |
| > in-store (encryption     |                                         |
| > environment) personnel   |                                         |
| > do not have logical      |                                         |
| > access to the decryption |                                         |
| > environment, any CDEs,   |                                         |
| > or account- data         |                                         |
| > decryption keys.*        |                                         |
+----------------------------+-----------------------------------------+
| > **MM-C-1.1** Separation  | > **MM-C-1.1.a** Examine documented     |
| > of duties must exist     | > policies and procedures, and          |
| > such that encryption     | > interview responsible personnel to    |
| > environment personnel    | > verify that encryption environment    |
| > are prohibited from      | > personnel are prohibited from         |
| > accessing any system     | > accessing any system components in    |
| > components in the        | > the decryption environment or the     |
| > decryption environment   | > CDE.                                  |
| > or any CDE.              |                                         |
| > Access-control           |                                         |
| > mechanisms must include  |                                         |
| > both physical and        |                                         |
| > logical controls.        |                                         |
| >                          |                                         |
| > ***Note:** Access        |                                         |
| > restrictions between the |                                         |
| > encryption and           |                                         |
| > decryption environment   |                                         |
| > are not intended to      |                                         |
| > prohibit employees who   |                                         |
| > work in the decryption   |                                         |
| > environment or CDE from  |                                         |
| > shopping in the stores.  |                                         |
| > This requirement is      |                                         |
| > focused on logical       |                                         |
| > access controls, not     |                                         |
| > physical.*               |                                         |
+----------------------------+-----------------------------------------+
|                            | > **MM-C-1.1.b** For a sample of system |
|                            | > components in the CDE and the         |
|                            | > decryption environment, review system |
|                            | > configurations and access-control     |
|                            | > lists to verify that encryption       |
|                            | > environment personnel do not have     |
|                            | > access to any system components in    |
|                            | > the decryption environment or the     |
|                            | > CDE.                                  |
+----------------------------+-----------------------------------------+
