> ![A picture containing graphical user interface Description
> automatically
> generated](vertopal_8b603ec7f0864480ba737f7a624e8186/media/image1.png){width="2.2377373140857393in"
> height="0.6718744531933508in"}
>
> **Payment Card Industry (PCI)**

Software Security Framework

> **Secure Software Requirements and Assessment Procedures**

## Version 1.2.1

> May 2023
>
> **Document Changes**

+----------+------+---------------------------------------------------+
| >        | >    | > **Description**                                 |
| **Date** |  **V |                                                   |
|          | ersi |                                                   |
|          | on** |                                                   |
+==========+======+===================================================+
| >        | >    | Initial release                                   |
|  January |  1.0 |                                                   |
| > 2019   |      |                                                   |
+----------+------+---------------------------------------------------+
| > April  | >    | Update from v1.0. See *PCI Software Security      |
| > 2021   |  1.1 | Framework -- Summary of Changes from Secure       |
|          |      | Software Requirements and Assessment Procedures   |
|          |      | Version 1.0 to 1.1* for details of changes.       |
+----------+------+---------------------------------------------------+
| >        | >    | Update from v1.1. See *PCI Software Security      |
|  October |  1.2 | Framework -- Summary of Changes from Secure       |
| > 2022   |      | Software Requirements and Assessment Procedures   |
|          |      | Version 1.1 to 1.2* for details of changes.       |
+----------+------+---------------------------------------------------+
| > May    | > 1  | Update from v1.2 to address errata.               |
| > 2023   | .2.1 |                                                   |
+----------+------+---------------------------------------------------+

> **Table of Contents**

[Introduction 6](#introduction)

[Terminology 6](#terminology)

[Related Publications 7](#related-publications)

[Stakeholder Roles and Responsibilities
8](#stakeholder-roles-and-responsibilities)

[Overview of PCI Secure Standard
10](#overview-of-pci-secure-software-standard)

[Scope of Security Requirements 10](#scope-of-security-requirements)

[Requirement Modules 11](#requirement-modules)

[Requirement Module Applicability 11](#requirement-module-applicability)

[Objective-Based Approach to Requirements
12](#objective-based-approach-to-requirements)

[Requirement Frequency and Rigor 12](#requirement-frequency-and-rigor)

[Requirement Structure 12](#requirement-structure)

[Testing Methods 13](#testing-methods)

[Reliance on Third-Party Testing 14](#reliance-on-third-party-testing)

[Use of Sampling 14](#use-of-sampling)

[Use of a Test Platform 15](#use-of-a-test-platform)

[Core Requirements 16](#core-requirements)

[Minimizing the Attack Surface 16](#minimizing-the-attack-surface)

[Control Objective 1: Critical Asset Identification 16](#_bookmark17)

[Control Objective 2: Secure Defaults 19](#_bookmark18)

[Control Objective 3: Sensitive Data Retention 25](#_bookmark19)

[Software Protection Mechanisms 32](#software-protection-mechanisms)

[Control Objective 4: Critical Asset Protection 32](#_bookmark21)

[Control Objective 5: Authentication and Access Control
35](#_bookmark22)

[Control Objective 6: Sensitive Data Protection 39](#_bookmark23)

[Control Objective 7: Use of Cryptography 42](#_bookmark24)

[Secure Software Operations 49](#secure-software-operations)

[Control Objective 8: Activity Tracking 49](#_bookmark26)

[Control Objective 9: Attack Detection 53](#_bookmark27)

[Secure Software Lifecycle Management
55](#secure-software-lifecycle-management)

[Control Objective 10: Threat and Vulnerability Management
55](#_bookmark29)

[Control Objective 11: Secure Software Updates 57](#_bookmark30)

[Control Objective 12: Software Vendor Implementation Guidance
59](#_bookmark31)

[Module A -- Account Data Protection Requirements
61](#module-a-account-data-protection-requirements)

[Purpose and Scope 61](#purpose-and-scope)

[Security Requirements 63](#security-requirements)

[Control Objective A.1: Sensitive Authentication Data 63](#_bookmark35)

[Control Objective A.2: Cardholder Data Protection 64](#_bookmark36)

[Module B -- Terminal Software Requirements
67](#module-b-terminal-software-requirements)

[Purpose and Scope 67](#purpose-and-scope-1)

[Background 67](#background)

[Considerations 68](#considerations)

[Security Requirements 69](#security-requirements-1)

[Control Objective B.1: Terminal Software Documentation
69](#_bookmark42)

[Control Objective B.2: Terminal Software Design 71](#_bookmark43)

[Control Objective B.3: Terminal Software Attack Mitigation
79](#_bookmark44)

[Control Objective B.4: Terminal Software Security Testing
83](#_bookmark45)

[Control Objective B.5: Terminal Software Implementation Guidance
85](#_bookmark46)

[Module C -- Web Software Requirements
87](#module-c-web-software-requirements)

[Purpose and Scope 87](#purpose-and-scope-2)

[Considerations 87](#considerations-1)

[Security Requirements 88](#security-requirements-2)

[Control Objective C.1: Web Software Components & Services
88](#_bookmark51)

[Control Objective C.2: Web Software Access Controls 93](#_bookmark52)

[Control Objective C.3: Web Software Attack Mitigation
100](#_bookmark53)

[Control Objective C.4: Web Software Communications 109](#_bookmark54)

# Introduction

> To ensure reliable and accurate electronic payment transactions, the
> systems and software used as part of the payment transaction flow must
> be designed, developed, and maintained in a manner that protects the
> integrity of payment transactions and the confidentiality of all
> sensitive data stored, processed, or transmitted in association with
> payment transactions. This document, the *Payment Card Industry (PCI)
> Secure Software Requirements and Assessment Procedures* (hereafter
> referred to as the "PCI Secure Software Standard" or "this standard")
> provides a baseline of security requirements with corresponding
> assessment procedures and guidance for building secure payment
> software.
>
> The *PCI Secure Software Standard* is intended for use as part of the
> PCI Software Security Framework (SSF). Entities wishing to have their
> payment software validated under the PCI SSF would do so to this
> standard.

## Terminology

> A list of applicable terms and definitions is provided in the *PCI
> Software Security Framework Glossary of Terms, Abbreviations, and
> Acronyms,*
>
> available in the PCI SSC Document Library:
> [https://www.pcisecuritystandards.org/document_library/.](https://www.pcisecuritystandards.org/document_library/)
>
> Additionally, definitions for general PCI terminology is provided in
> the PCI Glossary on the PCI SSC website at:
> [https://www.pcisecuritystandards.org/pci_security/glossary/.](https://www.pcisecuritystandards.org/pci_security/glossary/)

## Related Publications

> In addition to the security requirements and assessment procedures for
> payment software defined in this standard, there are additional
> documents available to support the use of this standard. For more
> information, refer to the latest versions of (or successor documents
> to) the following PCI SSC publications in the PCI SSC Document
> Library:

+-----------------------------------+-----------------------------------+
| > **Document Name**               | > **Description**                 |
+===================================+===================================+
| > *PCI Software Security          | Technical Frequently Asked        |
| > Framework -- Technical FAQs for | Questions (FAQs) provide a        |
| > Secure Software Standard*       | mechanism to address questions    |
| > ("Secure Software Technical     | related to the interpretation and |
| > FAQs")                          | application of the associated PCI |
|                                   | Standard and Program. Technical   |
|                                   | FAQs are considered               |
|                                   |                                   |
|                                   | 'normative,' and they must be     |
|                                   | fully considered within the scope |
|                                   | of assessment activity for the    |
|                                   | associated Standard.              |
+-----------------------------------+-----------------------------------+
| > *PCI Software Security          | Additional security requirements  |
| > Framework -- PCI Secure         | for software development          |
| > Software Lifecycle Standard*    | organizations to ensure they      |
| >                                 | develop and maintain software     |
| > ("Secure SLC Standard")         | securely throughout the entire    |
|                                   | software lifecycle.               |
+-----------------------------------+-----------------------------------+
| > *PCI Software Security          | Describes important terms,        |
| > Framework -- Glossary of Terms, | abbreviations, and acronyms used  |
| > Abbreviations, and Acronyms*    | throughout the Secure Software    |
| > ("SSF Glossary")                | Standard and supporting           |
|                                   | documentation.                    |
+-----------------------------------+-----------------------------------+
| > *PCI Software Security          | Describes the program             |
| > Framework -- Secure Software    | requirements for entities to      |
| > Program Guide*                  | validate their payment software   |
| >                                 | for compliance to the Secure      |
| > ("Secure Software Program       | Software Standard and have their  |
| > Guide")                         | software listed and maintained on |
|                                   | the PCI SSC's List of Validated   |
|                                   | Payment Software.                 |
+-----------------------------------+-----------------------------------+
| > *PCI Software Security          | The mandatory template that       |
| > Framework -- Secure Software    | qualified SSF Assessors must use  |
| > Template for Report on          | to document the results of a      |
| > Validation* ("Secure Software   | Secure Software Assessment and    |
| > ROV Reporting Template")        | report those results to PCI SSC.  |
+-----------------------------------+-----------------------------------+
| > *PCI Software Security          | A template document provided by   |
| > Framework -- Secure Software    | PCI SSC that Secure Software      |
| > Attestation of Validation*      | Assessor Companies and Vendors    |
| >                                 | must use to attest to the results |
| > ("Secure Software AOV")         | of a Secure Software Assessment.  |
+-----------------------------------+-----------------------------------+
| > *PCI Software Security          | Describes the minimum capability  |
| > Framework -- Qualification      | and related documentation         |
| > Requirements for Assessors*     | requirements that SSF Assessor    |
| >                                 | Companies and their               |
| > ("SSF Qualification             | Assessor-Employees must satisfy   |
| > Requirements")                  | to be qualified to perform Secure |
|                                   | Software Assessments.             |
+-----------------------------------+-----------------------------------+
| > *PCI PIN Transaction Security   | Security requirements that must   |
| > (PTS) Point-of-Interaction      | be met for payment acceptance     |
| > (POI) Modular Security          | devices to obtain Payment Card    |
| > Requirements* ("PCI PTS POI     | Industry (PCI) PIN Transaction    |
| > Standard\")                     | Security (PTS) Point of           |
|                                   | Interaction (POI) device          |
|                                   | approval.                         |
+-----------------------------------+-----------------------------------+

+-----------------------------------+-----------------------------------+
| > **Document Name**               | > **Description**                 |
+===================================+===================================+
| > *Vendor Release Agreement*      | Establishes the terms and         |
| > ("VRA")                         | conditions that Vendors of        |
|                                   | Validated Payment Software must   |
|                                   | meet to participate in PCI        |
|                                   | Programs.                         |
+-----------------------------------+-----------------------------------+

## Stakeholder Roles and Responsibilities

> There are numerous stakeholders involved in maintaining and managing
> PCI standards. The following describes the high-level roles and
> responsibilities of these stakeholders as they relate to the PCI
> Software Security Framework:
>
> **PCI SSC** -- Responsible for maintaining the standards, supporting
> programs, and related documentation associated with the PCI Software
> Security Framework including, but not limited to:

-   Maintaining the PCI Secure Software Standard (this document).

-   Maintaining all supporting documentation including reporting
    templates, attestation forms, frequently asked questions (FAQs), and
    guidance to assist entities implementing and assessing to this
    standard.

-   Providing instructions and guidance for SSF Assessors in accordance
    with the requirements and assessment procedures in this standard.

-   Maintaining a list of all SSF Assessors qualified to perform
    assessments to this standard (on the [PCI SSC
    Website](https://www.pcisecuritystandards.org/)).

-   Maintaining a quality assurance program for SSF Assessors.

> **Participating Payment Brands** -- Responsible for developing and
> enforcing their respective compliance programs related to PCI
> standards including, but not limited to:

-   Defining and enforcing requirements, mandates, and deadlines for
    compliance to the PCI Secure Software Standard (this document).

-   Determining the entities that are required to comply with this
    standard.

-   Specifying the validation methods and frequency.

-   Identifying and enforcing any fines or penalties for non-compliance.

> **SSF Assessor Companies** -- Responsible for maintaining the required
> knowledge, expertise, and equipment necessary to execute all
> assessment activities, adhering to all SSF Assessor Qualification
> Requirements, performing assessments to this standard, and generating
> the assessment report documenting the results. Note that not all SSF
> Assessor Companies are qualified to perform assessments to this
> standard. For more information on assessment activities and assessor
> qualification requirements, refer to the *PCI Secure Software Program
> Guide* and *Qualification Requirements for SSF Assessors*,
> respectively.
>
> **Payment Software Vendors / Providers / Developers** -- Responsible
> for developing, distributing, maintaining, and operating (where
> applicable) payment software, and ensuring that their payment software
> meets all applicable security requirements defined in this standard.

# Overview of PCI Secure Software Standard

> The security requirements defined within the *PCI Secure Software
> Standard* ensure that payment software is designed, engineered,
> developed, and maintained in a manner that protects payment
> transactions and data, minimizes vulnerabilities, and defends against
> attacks.

## Scope of Security Requirements

> The security requirements defined in this standard describe the
> security characteristics, controls, features, and capabilities that
> payment software must possess to protect the integrity of payment
> functions and the confidentiality of sensitive payment data. The
> payment software features that are in scope for these requirements
> include, but are not limited to:

-   All end-to-end payment software functionality, including:

    -   All payment functions.

    -   Inputs and outputs.

    -   Handling of error conditions.

    -   Interfaces and connections to other files, systems, and/or
        > software.

    -   Data flows.

    -   Security mechanisms, controls, and countermeasures, such as
        > authentication, authorization, validation, parameterization,
        > segmentation, logging, and so on.

-   Processes used by the software vendor, provider, or developer to
    identify and support software security controls.

-   Guidance that the software vendor, provider, or developer is
    expected to provide to stakeholders that describes:

    -   How to implement and operate the payment software securely.

    -   All configuration options available that can impact the security
        > of payment software, including those of the execution
        > environment and related system components.

    -   How to implement security updates.

    -   How and where to report security issues to the software vendor,
        > provider, and/or developer.

> *Note that the software vendor, provider, or developer may be expected
> to provide such guidance even when the specific settings:*

-   Cannot be controlled by the payment software vendor, provider, or
    > developer after the software is installed in a production
    > environment.

-   Are the responsibility of the implementing entity and not the
    > software vendor, provider, or developer.

```{=html}
<!-- -->
```
-   Any other software, software functionality, or services necessary
    for a full implementation of the payment software, including but not
    limited to:

    -   Third-party and open-source software functions, libraries,
        > packages, components, services, and dependencies embedded in
        > or relied upon by the payment software to provide its intended
        > function.

    -   Features and functions of a supported platform or the execution
        > environment relied upon by the payment software for security
        > purposes.

    -   Third-party or custom tools and functions relied upon by the
        > payment software to satisfy security requirements in this
        > standard.

## Requirement Modules

> The PCI Secure Software Standard includes the concept of requirement
> "modules," which are distinct groups of requirements relating to a
> specific topic or type of software. Modules are intended to clarify
> how and when specific requirements apply to a given payment
> application or function.
>
> The requirements in this standard are organized into the following
> four requirement modules:

-   **Core Requirements ("Core Module")**: General security requirements
    that apply to all types of payment software regardless of software
    function, design, or underlying technology.

-   **Module A -- Account Data Protection Requirements ("Account Data
    Protection Module")**: Additional security requirements for payment
    software that store, process, or transmit account data.

-   **Module B -- Terminal Software Requirements ("Terminal Software
    Module")**: Additional security requirements for payment software
    specifically designed for deployment and operation on PCI-approved
    POI devices.

-   **Module C -- Web Software Requirements ("Web Software Module")**:
    Additional security requirements for payment software that uses
    Internet technologies, protocols, and languages to initiate or
    support electronic payment transactions.

### Requirement Module Applicability

> Each requirement module includes its own applicability criteria. It is
> expected that software assessed to this standard will include
> assessment to all applicable modules. At a minimum, payment software
> must be assessed to the Core Module. Additional modules are included
> in the assessment when the software meets the applicability criteria
> for those additional modules. Refer to the "Purpose and Scope" section
> within each additional module for more information on module
> applicability criteria.
>
> Be aware that some requirements defined within individual modules are
> extensions of Core Module requirements. Where such relationships are
> noted, the requirements in modules should be assessed in conjunction
> with their associated "Core" requirements.
>
> Also note that there may be certain requirements defined within a
> module that are similar to requirements in other modules or that may
> have broader applicability beyond the module(s) where they are
> defined. Unless otherwise noted, such requirements are required to be
> assessed only in the context of that module. With that said, such
> requirements are likely to be consolidated and/or applied more broadly
> in future updates to this standard. Entities are encouraged to
> identify and apply requirements that may be applicable to an entity's
> payment software regardless of whether the entity is required to
> assess to the module where such requirements are defined.

## Objective-Based Approach to Requirements

> The PCI Software Security Framework has adopted an "objective-based"
> approach to defining the security requirements in this standard. The
> PCI SSC acknowledges that there is no "one size fits all" approach to
> software security and that software vendors need flexibility to
> determine the software security controls and features most appropriate
> to address their specific business needs and risks.
>
> An "objective-based" approach is one that states security requirements
> as a desired security goal or outcome without necessarily specifying
> the method(s) to be used to achieve the desired goal. This approach
> enables entities to implement software security controls based on the
> risks identified by the software vendor for a given software
> application. For this approach to be successful, software vendors must
> possess a robust risk-management practice as an integral part of their
> software development lifecycle (SDLC) and be able to demonstrate how
> the implemented security controls are supported by the results of
> their risk identification and management practices. Without a robust
> risk-management practice in place and evidence available to support
> risk-based decision making, adherence to the requirements defined in
> this standard may be difficult to validate.

### Requirement Frequency and Rigor

> Given the nature of PCI SSC's objective-based approach to security
> requirements, many security requirements do not specify the level of
> rigor or frequency for periodic or recurring activities, such as the
> maximum period in which a security update must be provided to fix
> known vulnerabilities. In such cases, the software vendor may define
> the level of rigor or frequency appropriate for its business needs.
> The level of rigor or frequency chosen, however, must be supported by
> documented risk assessments and the resultant risk management
> decisions. Additionally, the software vendor must demonstrate that its
> implementation provides ongoing assurance that the software security
> controls and activities are effective and satisfy all relevant control
> objectives.

## Requirement Structure

> The security requirements defined in this standard are as follows:

-   **Control Objectives** -- The high-level security objectives that
    must be met. Control objectives are broadly stated to provide
    software vendors the flexibility to determine the best method(s) to
    achieve the stated objective. Regardless of the method(s) chosen, it
    is expected that the software vendor be able to produce clear and
    unambiguous evidence to demonstrate that the chosen method(s) is/are
    appropriate, sufficient, and properly implemented to satisfy the
    objective.

-   **Test Requirements** -- The expected assessment activities to be
    performed by an assessor to determine whether a specific control
    objective has been met. Test requirements are intended to provide
    both the software vendor and assessor with a common understanding of
    the tasks expected to be carried out by the assessor during testing.
    The specific method(s) used, the item(s) examined, and the personnel
    interviewed must be appropriate for the control objective being
    validated and for the software being assessed.

-   **Guidance** -- Additional information to help payment software
    vendors and assessors understand the intent of each control
    objective. The guidance may also include best practices that should
    be considered and examples of controls or methods that may be used
    to satisfy the control objective. Guidance is not intended to
    preclude other methods that a software vendor may use to meet a
    control objective, nor does it replace or amend the control
    objective to which it refers.

## Testing Methods

> To support the validation of their software to the requirements in
> this standard, software vendors are expected to produce evidence that
> they have satisfied the stated control objectives. The test
> requirements identified for each control objective describe the
> activities to be performed by the assessor to confirm that the
> software and/or software vendor have met the control objective(s).
> Test requirements include the following testing activities:

-   **Examine**: The assessor critically evaluates data evidence. Common
    examples include software design and architecture documents
    (electronic or physical), source code, configuration and metadata
    files, bug tracking data and other output from software development
    systems, and security-testing results. The choice of evidence that
    may be used to meet an "examination" requirement is deliberately
    left open for the tester to determine. However, it is a requirement
    of this standard that the software source code be made available for
    review as part of the assessment. It is not acceptable for an
    assessment report to be provided where no source code was examined
    or used in the process of performing the testing.

-   **Interview**: The assessor converses with individual personnel. The
    purposes of interviews include determining how an activity is
    performed, whether an activity is performed as defined, and whether
    personnel have particular knowledge or understanding of applicable
    policies, processes, responsibilities, or concepts.

-   **Test:** The assessor evaluates the software operation to analyze
    its characteristics and behavior in various scenarios. Unless
    otherwise stated, software "testing" must include functional testing
    using forensic tools and techniques. Examples of such tools and
    techniques include the use of automated static analysis security
    testing (SAST), dynamic analysis security testing (DAST),
    interactive application security testing (IAST), and software
    composition analysis (SCA) tools. Where adversarial testing is
    explicitly referenced, fuzzing and other penetration testing tools
    and techniques must be used to try and bypass software security
    controls or to cause the software to behave in unintended ways.

> The specific items or processes to be examined or tested, and the
> personnel to be interviewed should be appropriate for the control
> objective being validated and for each entity's organizational
> structure, culture, business practices, and software products. It is
> at the discretion of the assessor to determine the suitability or
> adequacy of the evidence provided by the entity to support each test
> requirement. Where bullets are specified in a control objective or
> test requirement, each bullet is expected to be validated as part of
> the assessment.
>
> When documenting the assessment results, the assessor identifies the
> testing activities performed and the result of each activity. While it
> is expected that an assessor performs all test requirements defined
> for each control objective, it may also be possible for a control
> objective to be validated using different or additional testing
> methods. In such cases, the assessor is expected to document why
> alternative testing methods were used and how those methods provide at
> least the same level of assurance as the stated test requirements.
> Where terms such as "periodic," "appropriate," and "reasonable" are
> used in the test requirement, it is the software providers
> responsibility to define and defend its decisions regarding the
> frequency, robustness, and maturity of the implemented controls or
> processes.

### Reliance on Third-Party Testing

> All test requirements are expected to be performed by the assessor. An
> assessor may choose, however, to rely on testing performed by a third-
> party to satisfy a test requirement, including the software provider.
> The assessor retains full responsibility for the testing activities
> and results, regardless of whether the testing is performed by the
> assessor, by the software provider, or by a third-party. Where
> third-party testing is relied upon by the assessor, the assessor must
> document and justify the following:

-   How the evidence provided by the third-party supports the same level
    of rigor as testing performed by the assessor, and

-   How the assessor verified that the third-party testing relied upon
    by the assessor is appropriate.

> Where an assessed entity's testing is to be used for the purposes of
> satisfying test requirements, the assessor must first verify the
> software vendor is Secure SLC-qualified^1^ before software vendor
> testing can be relied upon.

### Use of Sampling

> Where appropriate, the assessor may utilize sampling as part of the
> testing process in accordance with a documented sampling methodology.
> The assessor's sampling methodology must detail how samples are chosen
> and must be provided to PCI SSC upon submission of the Report on
> Validation (ROV).
>
> Sample selection must include a representative sample of all people,
> processes, and technologies in scope for the PCI Secure Software
> assessment. Sample sizes must be sufficiently large to demonstrate
> that the sample accurately reflects the characteristics of the larger
> population.
>
> In instances where the assessor's findings are based on a
> representative sample rather than the complete set of applicable
> items, the assessor must explicitly note this fact in the ROV, detail
> the items chosen as samples for the testing, and provide references to
> the applicable sections of the assessor's sampling methodology
> provided with the ROV. Where the assessor selects samples that do not
> align with the assessor's documented sampling methodology, the
> assessor must provide justification in the ROV for each instance where
> such samples are used.
>
> ^1^ Refer to the PCI Secure SLC Standard and its associated Program
> Guide for more information on Secure SLC qualification.

### Use of a Test Platform

> To ensure that software testing complies with this standard, it may be
> necessary for the software vendor to provide a test platform. A test
> platform is special test functionality that is either separate or
> absent from production-level code. The test platform must rely on as
> much of the intended production-level functionality as possible. The
> test platform serves only to provide a test framework that allows for
> software functionality to be exercised outside of a production-level
> deployment environment to verify the software's compliance to this
> standard. For example, elevated privileges or access capabilities may
> need to be granted for the purpose of providing run-time visibility
> into various facets of the software operation. Other examples include
> providing a test function to initiate a test transaction or to perform
> authentication functions. It is at the assessor's discretion to
> request any test functionality deemed necessary to verify the
> software's compliance with applicable requirements in this standard.

# Core Requirements

### Minimizing the Attack Surface

> ***The attack surface of the software is minimized. Confidentiality
> and integrity of all software critical assets are protected, and all
> unnecessary features and functions are removed or disabled.***

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark17 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective 1: |                            |                       |
| > Critical     |                            |                       |
| > Asset        |                            |                       |
| > Id           |                            |                       |
| entification** |                            |                       |
| >              |                            |                       |
| > All software |                            |                       |
| > critical     |                            |                       |
| > assets are   |                            |                       |
| > identified   |                            |                       |
| > and          |                            |                       |
| > classified.  |                            |                       |
+----------------+----------------------------+-----------------------+
| > **1.1** All  | **1.1.a** The assessor     | Software security     |
| > sensitive    | shall examine evidence to  | controls are designed |
| > data stored, | confirm that information   | and implemented to    |
| > processed,   | is maintained that details | protect the           |
| > or           | all sensitive data that is | confidentiality       |
| > transmitted  | stored, processed, and/or  | and/or integrity of   |
| > by the       | transmitted by the         | critical assets. To   |
| > software is  | software. At a minimum,    | make sure these       |
| > identified.  | this shall include all     | controls are          |
|                | payment data;              | effective and         |
|                | authentication             | appropriate, the      |
|                | credentials; cryptographic | software vendor       |
|                | keys and related data      | should identify all   |
|                | (such as IVs and seed data | sensitive data the    |
|                | for random number          | software collects,    |
|                | generators); and system    | stores, processes, or |
|                | configuration data (such   | transmits, as well as |
|                | as registry entries,       | all sensitive         |
|                | platform environment       | functions and         |
|                | variables, prompts for     | resources it either   |
|                | plaintext data in software | provides or uses.     |
|                | allowing for the entry of  |                       |
|                | PIN data, or configuration |                       |
|                | scripts).                  |                       |
+----------------+----------------------------+-----------------------+
|                | **1.1.b** The assessor     |                       |
|                | shall examine evidence to  |                       |
|                | confirm that information   |                       |
|                | is maintained that         |                       |
|                | describes where sensitive  |                       |
|                | data is stored. This       |                       |
|                | includes the storage of    |                       |
|                | sensitive data in          |                       |
|                | temporary storage (such as |                       |
|                | volatile memory),          |                       |
|                | semi-permanent storage     |                       |
|                | (such as RAM disks),       |                       |
|                | non-volatile storage (such |                       |
|                | as magnetic and flash      |                       |
|                | storage media), or in      |                       |
|                | specific locations or form |                       |
|                | factors (such as with an   |                       |
|                | embedded system that is    |                       |
|                | only capable of local      |                       |
|                | storage).                  |                       |
+----------------+----------------------------+-----------------------+
|                | **1.1.c** The assessor     |                       |
|                | shall examine evidence to  |                       |
|                | confirm that information   |                       |
|                | is maintained that         |                       |
|                | describes the security     |                       |
|                | controls that are          |                       |
|                | implemented to protect     |                       |
|                | sensitive data.            |                       |
+----------------+----------------------------+-----------------------+
|                | **1.1.d** The assessor     |                       |
|                | shall test the software to |                       |
|                | validate the evidence      |                       |
|                | obtained in Test           |                       |
|                | Requirements 1.1.a through |                       |
|                | 1.1.c.                     |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **1.1.e** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | identify the transaction   |                       |
|                | types and/or card data     |                       |
|                | elements that are          |                       |
|                | supported by the software, |                       |
|                | and to confirm that the    |                       |
|                | data for all of these is   |                       |
|                | supported by the evidence  |                       |
|                | examined in Test           |                       |
|                | Requirements 1.1.a through |                       |
|                | 1.1.c.                     |                       |
+----------------+----------------------------+-----------------------+
|                | **1.1.f** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | identify the cryptographic |                       |
|                | implementations that are   |                       |
|                | supported by the software  |                       |
|                | (including cryptography    |                       |
|                | used for storage,          |                       |
|                | transport, and             |                       |
|                | authentication), and to    |                       |
|                | confirm that the           |                       |
|                | cryptographic data for all |                       |
|                | of these implementations   |                       |
|                | is supported by the        |                       |
|                | evidence examined in Test  |                       |
|                | Requirements 1.1.a through |                       |
|                | 1.1.c, and that the        |                       |
|                | evidence describes whether |                       |
|                | these are implemented by   |                       |
|                | the software itself,       |                       |
|                | through third-party        |                       |
|                | software, or as functions  |                       |
|                | of the execution           |                       |
|                | environment.               |                       |
+----------------+----------------------------+-----------------------+
|                | **1.1.g** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | identify the accounts and  |                       |
|                | authentication credentials |                       |
|                | supported by the software  |                       |
|                | (including both default    |                       |
|                | and user- created          |                       |
|                | accounts) and to confirm   |                       |
|                | that these accounts and    |                       |
|                | credentials are supported  |                       |
|                | by the evidence examined   |                       |
|                | in Test Requirements 1.1.a |                       |
|                | through 1.1.c.             |                       |
+----------------+----------------------------+-----------------------+
|                | **1.1.h** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | identify the configuration |                       |
|                | options provided by the    |                       |
|                | software that can impact   |                       |
|                | sensitive data (including  |                       |
|                | those provided through     |                       |
|                | separate files or scripts, |                       |
|                | internal functions, or     |                       |
|                | menus and options), and to |                       |
|                | confirm that these are     |                       |
|                | supported by the evidence  |                       |
|                | examined in Test           |                       |
|                | Requirements 1.1.a through |                       |
|                | 1.1.c.                     |                       |
+----------------+----------------------------+-----------------------+
| > **1.2** All  | **1.2.a** The assessor     |                       |
| > sensitive    | shall examine evidence to  |                       |
| > functions    | confirm that information   |                       |
| > and          | is maintained that details |                       |
| > sensitive    | all sensitive functions    |                       |
| > resources    | and sensitive resources    |                       |
| > provided or  | provided or used by the    |                       |
| > used by the  | software. At a minimum,    |                       |
| > software are | this shall include all     |                       |
| > identified.  | functions that are         |                       |
|                | designed to store,         |                       |
|                | process, or transmit       |                       |
|                | sensitive data and those   |                       |
|                | services, configuration    |                       |
|                | files, or other            |                       |
|                | information necessary for  |                       |
|                | the normal and secure      |                       |
|                | operation of those         |                       |
|                | functions.                 |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    |                            |                       |
| > Objectives   |                            |                       |
| > Test         |                            |                       |
| > Requirements |                            |                       |
| > Guidance**   |                            |                       |
+================+============================+=======================+
|                | **1.2.b** The assessor     |                       |
|                | shall examine evidence to  |                       |
|                | confirm that information   |                       |
|                | is maintained that clearly |                       |
|                | describes how and where    |                       |
|                | the sensitive data         |                       |
|                | associated with these      |                       |
|                | functions and resources is |                       |
|                | stored. This includes the  |                       |
|                | storage of sensitive data  |                       |
|                | in temporary storage (such |                       |
|                | as volatile memory), semi- |                       |
|                | permanent storage (such as |                       |
|                | RAM disks), and            |                       |
|                | non-volatile storage (such |                       |
|                | as magnetic and flash      |                       |
|                | storage media). The        |                       |
|                | assessor shall confirm     |                       |
|                | that this information is   |                       |
|                | supported by the evidence  |                       |
|                | examined in Test           |                       |
|                | Requirement 1.1.a through  |                       |
|                | 1.1.c.                     |                       |
+----------------+----------------------------+-----------------------+
|                | **1.2.c** Where the        |                       |
|                | sensitive functions or     |                       |
|                | sensitive resources are    |                       |
|                | provided by third-party    |                       |
|                | software or systems, the   |                       |
|                | assessor shall examine     |                       |
|                | evidence and test the      |                       |
|                | software to confirm that   |                       |
|                | the software correctly     |                       |
|                | follows available guidance |                       |
|                | for the third-party        |                       |
|                | software.                  |                       |
|                |                            |                       |
|                | ***Note:** For example, by |                       |
|                | reviewing the security     |                       |
|                | policy of a PTS or         |                       |
|                | FIPS140-2 or 140-3         |                       |
|                | approved cryptographic     |                       |
|                | system.*                   |                       |
+----------------+----------------------------+-----------------------+
| > **1.3**      | **1.3** The assessor shall | Critical assets       |
| > Critical     | examine evidence to        | represent the         |
| > assets are   | confirm that:              | sensitive data,       |
| > classified.  |                            | functions, and        |
|                | -   The software vendor    | resources that have   |
|                |     > defines criteria for | business value and    |
|                |     > classifying critical | require               |
|                |     > assets in accordance | confidentiality,      |
|                |     > with the             | integrity, or         |
|                |     > confidentiality,     | resiliency            |
|                |     > integrity, and       | protection.           |
|                |     > resiliency           |                       |
|                |     > requirements for     | There are numerous    |
|                |     > each critical asset. | analysis techniques   |
|                |                            | that can be used to   |
|                | -   An inventory of all    | identify critical     |
|                |     > critical assets with | assets, including     |
|                |     > appropriate          | Mission Impact        |
|                |     > classifications is   | Analysis (MIA),       |
|                |     > maintained.          | Functional Dependency |
|                |                            | Network Analysis      |
|                |                            | (FDNA), and Mission   |
|                |                            | Threat Analysis.      |
|                |                            | Additional            |
|                |                            | information and       |
|                |                            | techniques can be     |
|                |                            | found in publications |
|                |                            | such as the           |
|                |                            | appendices of *NIST   |
|                |                            | Special Publication   |
|                |                            | 800-160* or in other  |
|                |                            | publications from     |
|                |                            | industry standards    |
|                |                            | bodies such as EMVCo, |
|                |                            | ISO or ANSI.          |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark18 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 2: |                            |                        |
| > Secure       |                            |                        |
| > Defaults**   |                            |                        |
| >              |                            |                        |
| > Default      |                            |                        |
| > privileges,  |                            |                        |
| > features,    |                            |                        |
| > and          |                            |                        |
| > functions    |                            |                        |
| > are          |                            |                        |
| > restricted   |                            |                        |
| > to only      |                            |                        |
| > those        |                            |                        |
| > necessary to |                            |                        |
| > provide a    |                            |                        |
| > secure       |                            |                        |
| > default      |                            |                        |
| >              |                            |                        |
| configuration. |                            |                        |
+----------------+----------------------------+------------------------+
| > **2.1** All  | **2.1.a** The assessor     | Software often         |
| > functions    | shall examine evidence and | contains functionality |
| > exposed by   | test the software to       | (for example, web      |
| > the software | identify any software APIs | services,              |
| > are enabled  | or other interfaces that   | administrative         |
| > by default   | are provided or exposed by | interface, application |
| > only when    | default upon installation, | heartbeat, etc.) that  |
| > and where it | initialization, or first   | is optional and is     |
| > is a         | use. For each of these     | generally unused by    |
| > documented   | interfaces, the assessor   | many users. This       |
| > and          | shall confirm that the     | functionality          |
| > justified    | vendor has documented and  | typically does not     |
| > part of the  | justified its use as part  | receive the same       |
| > software     | of the software            | attention as standard  |
| >              | architecture. Testing      | or essential software  |
|  architecture. | shall include methods to   | functions and          |
|                | reveal any exposed         | services, and often    |
|                | interfaces or other        | contains security      |
|                | software functionality     | weaknesses that can be |
|                | (such as scanning for      | exploited by malicious |
|                | listening services where   | users to bypass        |
|                | applicable).               | security controls.     |
|                |                            |                        |
|                | ***Note:** This includes   | To ensure a secure     |
|                | functions that are         | software deployment,   |
|                | auto-enabled as required   | the software's default |
|                | during operation of the    | configuration should   |
|                | software.*                 | only expose            |
|                |                            | functionality that has |
|                |                            | been reviewed,         |
|                |                            | justified, and         |
|                |                            | approved. This should  |
|                |                            | include the default    |
|                |                            | configuration for all  |
|                |                            | software APIs,         |
|                |                            | protocols, daemons,    |
|                |                            | listeners, components, |
|                |                            | etc.                   |
|                |                            |                        |
|                |                            | Any unnecessary        |
|                |                            | services, protocols,   |
|                |                            | or ports should be     |
|                |                            | disabled or removed.   |
|                |                            |                        |
|                |                            | For guidance on        |
|                |                            | services, protocols,   |
|                |                            | or ports considered to |
|                |                            | be insecure, refer to  |
|                |                            | industry standards and |
|                |                            | guidance (for example, |
|                |                            | NIST, ENISA, etc.).    |
+----------------+----------------------------+------------------------+
|                | **2.1.b** The assessor     |                        |
|                | shall test the software to |                        |
|                | determine whether any of   |                        |
|                | the interfaces identified  |                        |
|                | in Test Requirement 2.1.a  |                        |
|                | rely on external resources |                        |
|                | for authentication. Where  |                        |
|                | such resources are relied  |                        |
|                | upon, the assessor shall   |                        |
|                | examine evidence to        |                        |
|                | confirm that methods are   |                        |
|                | implemented to ensure that |                        |
|                | proper authentication      |                        |
|                | remains in place and that  |                        |
|                | these methods are included |                        |
|                | in the assessment of other |                        |
|                | applicable requirements in |                        |
|                | this standard.             |                        |
+----------------+----------------------------+------------------------+
|                | **2.1.c** The assessor     |                        |
|                | shall test the software to |                        |
|                | determine whether any of   |                        |
|                | the interfaces identified  |                        |
|                | in Test Requirement 2.1.a  |                        |
|                | rely on external resources |                        |
|                | for the protection of      |                        |
|                | sensitive data during      |                        |
|                | transmission. Where such   |                        |
|                | resources are relied upon, |                        |
|                | the assessor shall examine |                        |
|                | evidence to confirm that   |                        |
|                | methods are implemented to |                        |
|                | ensure proper protection   |                        |
|                | remains in place and that  |                        |
|                | these methods are included |                        |
|                | in the assessment of other |                        |
|                | applicable requirements in |                        |
|                | this standard.             |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **2.1.d** The assessor     |                       |
|                | shall test the software to |                       |
|                | determine whether any of   |                       |
|                | the interfaces identified  |                       |
|                | in Test Requirement 2.1.a  |                       |
|                | expose functions or        |                       |
|                | services that have         |                       |
|                | publicly disclosed         |                       |
|                | vulnerabilities by         |                       |
|                | conducting a search on the |                       |
|                | exposed protocols,         |                       |
|                | methods, or services in    |                       |
|                | public vulnerability       |                       |
|                | repositories such as that  |                       |
|                | maintained within the      |                       |
|                | National Vulnerability     |                       |
|                | Database.                  |                       |
+----------------+----------------------------+-----------------------+
|                | **2.1.e** Where known      |                       |
|                | vulnerabilities in exposed |                       |
|                | interfaces exist, the      |                       |
|                | assessor shall examine     |                       |
|                | evidence and test the      |                       |
|                | software to confirm the    |                       |
|                | following:                 |                       |
|                |                            |                       |
|                | -   Methods are            |                       |
|                |     > implemented to       |                       |
|                |     > mitigate the         |                       |
|                |     > exploitation of      |                       |
|                |     > these weaknesses.    |                       |
|                |                            |                       |
|                | -   The risks posed by the |                       |
|                |     > use of known         |                       |
|                |     > vulnerable           |                       |
|                |     > protocols,           |                       |
|                |     > functions, or ports  |                       |
|                |     > are documented.      |                       |
|                |                            |                       |
|                | -   Clear and sufficient   |                       |
|                |     > guidance on how to   |                       |
|                |     > correctly implement  |                       |
|                |     > sufficient security  |                       |
|                |     > to meet applicable   |                       |
|                |     > control objectives   |                       |
|                |     > in this standard is  |                       |
|                |     > provided to          |                       |
|                |     > stakeholders in      |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 12.1.                |                       |
|                |                            |                       |
|                | ***Note:** The assessor    |                       |
|                | should reference the       |                       |
|                | vendor threat information  |                       |
|                | defined in Control         |                       |
|                | Objective 4.1 for this     |                       |
|                | item.*                     |                       |
+----------------+----------------------------+-----------------------+
|                | **2.1.f** The assessor     |                       |
|                | shall examine evidence to  |                       |
|                | identify any third- party  |                       |
|                | modules used by the        |                       |
|                | software and to confirm    |                       |
|                | that any such functions    |                       |
|                | exposed by each module are |                       |
|                | disabled, unable to be     |                       |
|                | accessed through           |                       |
|                | mitigation methods         |                       |
|                | implemented by the         |                       |
|                | software, or formally      |                       |
|                | documented and justified   |                       |
|                | by the software vendor.    |                       |
|                |                            |                       |
|                | Where access to            |                       |
|                | third-party functions is   |                       |
|                | prevented through          |                       |
|                | implemented protection     |                       |
|                | methods, the assessor      |                       |
|                | shall test the software to |                       |
|                | confirm that it does not   |                       |
|                | rely on a lack of          |                       |
|                | knowledge of such          |                       |
|                | functions as a security    |                       |
|                | mitigation method by       |                       |
|                | simply not documenting an  |                       |
|                | otherwise accessible API   |                       |
|                | interface, and to confirm  |                       |
|                | that the protection        |                       |
|                | methods are effective at   |                       |
|                | preventing the insecure    |                       |
|                | use of such third-party    |                       |
|                | functions.                 |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **2.2** All  | **2.2.a** The assessor     | As previously noted   |
| > software     | shall examine evidence and | earlier in guidance,  |
| > security     | test the software to       | software security     |
| > controls,    | identify all software      | controls are designed |
| > features,    | security controls,         | and implemented to    |
| > and          | features and functions     | protect the           |
| > functions    | relied upon by the         | confidentiality and   |
| > are enabled  | software for the           | integrity of critical |
| > upon         | protection of critical     | assets. Examples of   |
| > software     | assets and to confirm that | such software         |
| >              | all are enabled upon       | security controls     |
|  installation, | installation,              | include               |
| > i            | initialization, or first   | authentication and    |
| nitialization, | use of the software.       | authorization         |
| > or first     |                            | mechanisms,           |
| > use.         |                            | cryptographic         |
| >              |                            | controls, and         |
| > ***Note:**   |                            | controls to prevent   |
| > Specific     |                            | leakage of sensitive  |
| > software     |                            | data.                 |
| > security     |                            |                       |
| > controls     |                            | Default software      |
| > required to  |                            | settings should       |
| > protect the  |                            | result in a secure    |
| > integrity    |                            | software              |
| > and          |                            | configuration and     |
| > c            |                            | should not rely on    |
| onfidentiality |                            | the end-user being a  |
| > of sensitive |                            | subject-matter expert |
| > data,        |                            | to ensure a secure    |
| > sensitive    |                            | configuration. To     |
| > functions,   |                            | that effect, all      |
| > and          |                            | available software    |
| > sensitive    |                            | security controls     |
| > resources    |                            | should be active upon |
| > are captured |                            | software              |
| > in the       |                            | installation,         |
| > [Software    |                            | initialization, or    |
| > Pr           |                            | first use, depending  |
| otection](#sof |                            | upon how the software |
| tware-protecti |                            | is deployed.          |
| on-mechanisms) |                            |                       |
| > [Me          |                            |                       |
| chanisms](#sof |                            |                       |
| tware-protecti |                            |                       |
| on-mechanisms) |                            |                       |
| > section.*    |                            |                       |
+----------------+----------------------------+-----------------------+
|                | **2.2.b** Where any        |                       |
|                | software security          |                       |
|                | controls, features and     |                       |
|                | functions are enabled only |                       |
|                | upon initialization or     |                       |
|                | first use, the assessor    |                       |
|                | shall test the software to |                       |
|                | confirm that sensitive     |                       |
|                | data is processed only     |                       |
|                | after this initialization  |                       |
|                | process is complete.       |                       |
+----------------+----------------------------+-----------------------+
|                | **2.2.c** Where user input |                       |
|                | or interaction is required |                       |
|                | to enable software         |                       |
|                | security controls,         |                       |
|                | features, or functions     |                       |
|                | (such as the installation  |                       |
|                | of certificates), the      |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that   |                       |
|                | clear and sufficient       |                       |
|                | guidance on configuring    |                       |
|                | these options is provided  |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1.            |                       |
+----------------+----------------------------+-----------------------+
| > **2.3**      | **2.3.a** The assessor     | To protect against    |
| > Default      | shall examine evidence to  | unauthorized access,  |
| >              | identify the default       | payment software      |
| authentication | credentials, keys,         | should prevent the    |
| > credentials  | certificates, and other    | use of built-in       |
| > or keys for  | critical assets used for   | accounts until the    |
| > built-in     | authentication by the      | default               |
| > accounts are | software.                  | authentication        |
| > not used     |                            | credentials can be    |
| > after        | ***Note:** The assessor    | changed.              |
| >              | should refer to evidence   |                       |
|  installation, | obtained in the testing of | > *(continued on next |
| > i            | Control Objectives 1, 5,   | > page)*              |
| nitialization, | and 7 to determine the     |                       |
| > or first     | authentication and access  |                       |
| > use.         | control mechanisms, keys,  |                       |
|                | and other critical assets  |                       |
|                | used for authentication.*  |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **2.3.b** The assessor     | Built-in accounts     |
|                | shall test the software to | with known            |
|                | confirm that all default   | credentials such as   |
|                | credentials, keys,         | default or empty      |
|                | certificates, and other    | passwords, or default |
|                | critical assets used for   | keys are often        |
|                | authentication by the      | overlooked during     |
|                | software are supported by  | installation, initial |
|                | the evidence examined.     | configuration, or     |
|                |                            | use, and can be used  |
|                | ***Note:** It is expected  | by a malicious user   |
|                | that this analysis will    | to bypass access      |
|                | include, but not           | controls. Therefore,  |
|                | necessarily be limited to, | the software should   |
|                | the use of entropy         | not use or rely on    |
|                | analysis tools to look for | the default           |
|                | hardcoded cryptographic    | credentials for its   |
|                | keys, searches for common  | operation upon        |
|                | cryptographic function     | installation,         |
|                | call and structures such   | initialization, or    |
|                | as S-Boxes and big-number  | first use.            |
|                | library functions (and     |                       |
|                | tracing these functions    |                       |
|                | backwards to search for    |                       |
|                | hardcoded keys), as well   |                       |
|                | as checking for strings    |                       |
|                | containing common user     |                       |
|                | account names or password  |                       |
|                | values.*                   |                       |
+----------------+----------------------------+-----------------------+
|                | **2.3.c** Where user input |                       |
|                | or interaction is required |                       |
|                | to disable or change any   |                       |
|                | authentication credentials |                       |
|                | or keys for built-in       |                       |
|                | accounts, the assessor     |                       |
|                | shall examine evidence to  |                       |
|                | confirm that guidance on   |                       |
|                | configuring these options  |                       |
|                | is provided to             |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1.                      |                       |
+----------------+----------------------------+-----------------------+
|                | **2.3.d** The assessor     |                       |
|                | shall test the software to |                       |
|                | confirm that default       |                       |
|                | authentication credentials |                       |
|                | or keys for built-in       |                       |
|                | accounts are not used by   |                       |
|                | the authentication and     |                       |
|                | access control mechanisms  |                       |
|                | implemented by the         |                       |
|                | software after software    |                       |
|                | installation,              |                       |
|                | initialization, or first   |                       |
|                | use.                       |                       |
|                |                            |                       |
|                | ***Note:** The assessor    |                       |
|                | should refer to evidence   |                       |
|                | obtained in the testing of |                       |
|                | Control Objective 5 to     |                       |
|                | determine the              |                       |
|                | authentication and access  |                       |
|                | control mechanisms         |                       |
|                | implemented by the         |                       |
|                | software.*                 |                       |
+----------------+----------------------------+-----------------------+
|                | **2.3.e** The assessor     |                       |
|                | shall test the software to |                       |
|                | confirm that cryptographic |                       |
|                | keys used for              |                       |
|                | authentication are not     |                       |
|                | used for other purposes,   |                       |
|                | such as protecting         |                       |
|                | sensitive data during      |                       |
|                | storage and transmission.  |                       |
|                |                            |                       |
|                | ***Note:** The assessor    |                       |
|                | should refer to evidence   |                       |
|                | obtained in the testing of |                       |
|                | Control Objective 6 to     |                       |
|                | determine the software     |                       |
|                | security controls          |                       |
|                | implemented to protect     |                       |
|                | sensitive data.*           |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    |                            |                       |
| > Objectives   |                            |                       |
| > Test         |                            |                       |
| > Requirements |                            |                       |
| > Guidance**   |                            |                       |
+================+============================+=======================+
| > **2.4** The  | **2.4.a** The assessor     | In many attacks on    |
| > privileges   | shall examine evidence to  | software or           |
| > and          | identify the privileges    | underlying systems,   |
| > resources    | and resources required by  | the software is often |
| > requested by | the software and to        | used to execute       |
| > the software | confirm that information   | functions on the      |
| > from its     | is maintained that         | underlying operating  |
| > execution    | describes and reasonably   | systems or to abuse   |
| > environment  | justifies all privileges   | accessible external   |
| > are limited  | and resources required,    | resources. When the   |
| > to those     | including explicit         | software requires     |
| > necessary    | permissions for access to  | excessive             |
| > for the      | resources, such as         | permissions, such     |
| > operation of | cameras, contacts, etc.    | permissions may be    |
| > the          |                            | exploited by a        |
| > software.    |                            | malicious user.       |
|                |                            |                       |
|                |                            | To minimize the       |
|                |                            | software's attack     |
|                |                            | surface, the software |
|                |                            | should only request   |
|                |                            | and be granted the    |
|                |                            | minimum required      |
|                |                            | privileges for its    |
|                |                            | intended operation.   |
|                |                            | For example, system   |
|                |                            | service accounts that |
|                |                            | the software uses to  |
|                |                            | operate, or accounts  |
|                |                            | used by the software  |
|                |                            | to access underlying  |
|                |                            | components such as a  |
|                |                            | database or invoke    |
|                |                            | web-services calls    |
|                |                            | should not require    |
|                |                            | permissions that      |
|                |                            | exceed the minimum    |
|                |                            | necessary for the     |
|                |                            | software to perform   |
|                |                            | its operations.       |
|                |                            |                       |
|                |                            | The same concept      |
|                |                            | applies to resources  |
|                |                            | used by the software. |
|                |                            | The software should   |
|                |                            | be granted access to  |
|                |                            | only the minimum      |
|                |                            | required resources    |
|                |                            | for its expected      |
|                |                            | operation. For        |
|                |                            | example, mobile       |
|                |                            | applications that do  |
|                |                            | not require access to |
|                |                            | the camera or         |
|                |                            | photographs should    |
|                |                            | not request such      |
|                |                            | access unless they    |
|                |                            | are a necessary part  |
|                |                            | of the software       |
|                |                            | architecture.         |
|                |                            | Similarly, software   |
|                |                            | should not have       |
|                |                            | access to sensitive   |
|                |                            | files (for example,   |
|                |                            |                       |
|                |                            | /etc/passwd) unless   |
|                |                            | there is a legitimate |
|                |                            | need for the software |
|                |                            | to access those       |
|                |                            | files.                |
+----------------+----------------------------+-----------------------+
|                | **2.4.b** Where limiting   |                       |
|                | access is not possible due |                       |
|                | to the architecture of the |                       |
|                | solution or the execution  |                       |
|                | environment in which the   |                       |
|                | software is executed, the  |                       |
|                | assessor shall examine     |                       |
|                | evidence to identify all   |                       |
|                | mechanisms implemented by  |                       |
|                | the software to prevent    |                       |
|                | unauthorized access,       |                       |
|                | exposure, or modification  |                       |
|                | of critical assets, and to |                       |
|                | confirm that guidance on   |                       |
|                | properly implementing and  |                       |
|                | configuring these          |                       |
|                | mechanisms is provided to  |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1.                      |                       |
+----------------+----------------------------+-----------------------+
|                | **2.4.c** The assessor     |                       |
|                | shall test the software to |                       |
|                | confirm that access        |                       |
|                | permissions and privileges |                       |
|                | are assigned according to  |                       |
|                | the evidence examined in   |                       |
|                | Test Requirement 2.4.a.    |                       |
|                | The assessor shall, where  |                       |
|                | possible, use suitable     |                       |
|                | tools for the platform on  |                       |
|                | which the software is      |                       |
|                | installed to review the    |                       |
|                | permissions and privileges |                       |
|                | of the software itself, as |                       |
|                | well as the permissions    |                       |
|                | and privileges of any      |                       |
|                | resources, files, or       |                       |
|                | additional elements        |                       |
|                | generated or loaded by the |                       |
|                | software during use.       |                       |
|                |                            |                       |
|                | ***Note:** Where the above |                       |
|                | testing is not possible,   |                       |
|                | the assessor shall justify |                       |
|                | why this is the case and   |                       |
|                | that the testing that has  |                       |
|                | been performed is          |                       |
|                | sufficient.*               |                       |
+----------------+----------------------------+-----------------------+
|                | **2.4.d** Where the        |                       |
|                | software execution         |                       |
|                | environment provides       |                       |
|                | legacy features for use by |                       |
|                | older versions of the      |                       |
|                | software, the assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that these are not |                       |
|                | used, and that only recent |                       |
|                | and secured functionality  |                       |
|                | is implemented. For        |                       |
|                | example, software should   |                       |
|                | "target" the latest        |                       |
|                | versions of APIs provided  |                       |
|                | by the environment on      |                       |
|                | which they run, where      |                       |
|                | available.                 |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **2.5**      | **2.5.a** The assessor     | > In support of the   |
| > Default      | shall examine the evidence | > principle of "least |
| > privileges   | to identify all default    | > privilege,"         |
| > for built-in | accounts provided by the   | > built-in accounts   |
| > accounts are | software and to confirm    | > should only have    |
| > limited to   | that the privileges        | > the privileges      |
| > those        | assigned to these accounts | > required for the    |
| > necessary    | are justified and          | > intended function   |
| > for their    | reasonable.                | > of the account,     |
| > intended     |                            | > including access to |
| > purpose and  |                            | > sensitive data and  |
| > function.    |                            | > resources as well   |
|                |                            | > as the ability to   |
|                |                            | > execute sensitive   |
|                |                            | > functions. For      |
|                |                            | > example, a built-in |
|                |                            | > administrator       |
|                |                            | > account may require |
|                |                            | > the ability to      |
|                |                            | > configure the       |
|                |                            | > software and        |
|                |                            | > associated user     |
|                |                            | > accounts, but not   |
|                |                            | > the ability to      |
|                |                            | > access areas        |
|                |                            | > containing          |
|                |                            | > sensitive data.     |
|                |                            | >                     |
|                |                            | > Applying the        |
|                |                            | > principle of least  |
|                |                            | > privilege to user   |
|                |                            | > accounts helps      |
|                |                            | > prevent users       |
|                |                            | > without sufficient  |
|                |                            | > knowledge about the |
|                |                            | > software from       |
|                |                            | > incorrectly or      |
|                |                            | > accidentally        |
|                |                            | > changing the        |
|                |                            | > software            |
|                |                            | > configuration or    |
|                |                            | > its security        |
|                |                            | > settings. Enforcing |
|                |                            | > least privilege     |
|                |                            | > also helps to       |
|                |                            | > minimize the        |
|                |                            | > effects of          |
|                |                            | > unauthorized access |
|                |                            | > to software user    |
|                |                            | > accounts.           |
|                |                            | >                     |
|                |                            | > To limit access to  |
|                |                            | > sensitive data,     |
|                |                            | > functions, and      |
|                |                            | > resources to only   |
|                |                            | > those accounts that |
|                |                            | > require such        |
|                |                            | > access, the level   |
|                |                            | > of privilege and    |
|                |                            | > access required     |
|                |                            | > should be defined   |
|                |                            | > and documented for  |
|                |                            | > each built-in       |
|                |                            | > account in an       |
|                |                            | > access matrix, such |
|                |                            | > that its assigned   |
|                |                            | > functions may be    |
|                |                            | > performed, but no   |
|                |                            | > additional or       |
|                |                            | > unnecessary access  |
|                |                            | > or privileges are   |
|                |                            | > granted.            |
+----------------+----------------------------+-----------------------+
|                | **2.5.b** The assessor     |                       |
|                | shall test the software to |                       |
|                | confirm that all default   |                       |
|                | accounts provided or used  |                       |
|                | by the software are        |                       |
|                | supported by the evidence  |                       |
|                | examined in Test           |                       |
|                | Requirement 2.5.a.         |                       |
+----------------+----------------------------+-----------------------+
|                | **2.5.c** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that exposed       |                       |
|                | interfaces, such as APIs,  |                       |
|                | are protected from         |                       |
|                | attempts by unauthorized   |                       |
|                | users to modify account    |                       |
|                | privileges and elevate     |                       |
|                | user access rights.        |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark19 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 3: |                            |                        |
| > Sensitive    |                            |                        |
| > Data         |                            |                        |
| > Retention**  |                            |                        |
| >              |                            |                        |
| > Retention of |                            |                        |
| > sensitive    |                            |                        |
| > data is      |                            |                        |
| > minimized.   |                            |                        |
+----------------+----------------------------+------------------------+
| > **3.1** The  | **3.1.a** The assessor     | To prevent the         |
| > software     | shall examine evidence to  | unauthorized           |
| > only retains | identify the sensitive     | disclosure of          |
| > the          | data that is collected by  | sensitive data to      |
| > sensitive    | the software for use       | unauthorized parties,  |
| > data         | beyond any one             | the software should    |
| > absolutely   | transaction, the default   | retain sensitive data  |
| > necessary    | time period for which it   | only for the duration  |
| > for the      | is retained, and whether   | necessary to perform   |
| > software to  | the retention period is    | the specific operation |
| > provide its  | user-configurable, and to  | for which sensitive    |
| > intended     | confirm that the purpose   | data is collected.     |
| >              | for retaining the          | Retaining sensitive    |
| functionality. | sensitive data in this     | data longer than       |
|                | manner is justified and    | required presents      |
|                | reasonable.                | opportunity for the    |
|                |                            | data to be mishandled, |
|                | ***Note:** The assessor    | misused, or            |
|                | should refer to evidence   | accidentally           |
|                | obtained in the testing of | disclosed.             |
|                | Control Objective 1.1 to   |                        |
|                | determine the sensitive    | This control objective |
|                | data retained by the       | differentiates between |
|                | software.*                 | transient sensitive    |
|                |                            | data retained          |
|                |                            | temporarily and        |
|                |                            | persistent sensitive   |
|                |                            | data that is retained  |
|                |                            | on a more permanent    |
|                |                            | basis. Examples of     |
|                |                            | transient sensitive    |
|                |                            | data include the       |
|                |                            | retention account data |
|                |                            | in memory until        |
|                |                            | payment authorization  |
|                |                            | is received. Examples  |
|                |                            | of persistent          |
|                |                            | sensitive data include |
|                |                            | the storage of account |
|                |                            | data on disk to        |
|                |                            | support recurrent      |
|                |                            | payment transactions.  |
+----------------+----------------------------+------------------------+
|                | **3.1.b** The assessor     |                        |
|                | shall test the software to |                        |
|                | confirm that all available |                        |
|                | functions or services      |                        |
|                | designed for the retention |                        |
|                | of sensitive data are      |                        |
|                | supported by the evidence  |                        |
|                | examined in Test           |                        |
|                | Requirement 3.1.a.         |                        |
|                |                            |                        |
|                | ***Note:** The assessor    |                        |
|                | should refer to evidence   |                        |
|                | obtained in the testing of |                        |
|                | Control Objective 1.2 to   |                        |
|                | determine the sensitive    |                        |
|                | functions and services     |                        |
|                | provided or used by the    |                        |
|                | software.*                 |                        |
+----------------+----------------------------+------------------------+
|                | **3.1.c** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | determine whether the      |                        |
|                | software facilitates the   |                        |
|                | storage of persistent      |                        |
|                | sensitive data for the     |                        |
|                | purposes of debugging,     |                        |
|                | error finding or testing   |                        |
|                | of systems, and to confirm |                        |
|                | that such data is          |                        |
|                | protected during storage   |                        |
|                | in accordance with Control |                        |
|                | Objective 6.1. Any         |                        |
|                | function that allows for   |                        |
|                | the storage of sensitive   |                        |
|                | data for these purposes    |                        |
|                | must be explicitly enabled |                        |
|                | through an interface that  |                        |
|                | requires interaction and   |                        |
|                | authorization by the user  |                        |
|                | and retains the data only  |                        |
|                | for the duration necessary |                        |
|                | in accordance with         |                        |
|                | reasonable vendor          |                        |
|                | criteria. Closure of the   |                        |
|                | software must result in    |                        |
|                | termination of this        |                        |
|                | debugging state, such that |                        |
|                | it requires explicit       |                        |
|                | re-enablement when the     |                        |
|                | software is next executed, |                        |
|                | and any sensitive data is  |                        |
|                | securely deleted per       |                        |
|                | Control Objective 3.4.     |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **3.1**.**d** Where user   |                       |
|                | input or interaction is    |                       |
|                | required to configure the  |                       |
|                | retention period of        |                       |
|                | sensitive data, the        |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that   |                       |
|                | guidance on configuring    |                       |
|                | these options is provided  |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1.            |                       |
+----------------+----------------------------+-----------------------+
| > **3.2**      | **3.2.a** Using            | Sensitive data        |
| > Transient    | information obtained in    | elements collected in |
| > sensitive    | Test Requirement 1.1.a,    | conjunction with      |
| > data is      | the assessor shall examine | software operations   |
| > retained     | evidence to identify all   | should only be        |
| > only for the | sensitive data that is     | retained for as long  |
| > duration     | retained by the software   | as required to        |
| > necessary to | for transient use, what    | complete that         |
| > fulfill a    | triggers the secure        | operation or related  |
| > legitimate   | deletion of this data, and | transaction.          |
| > business     | to confirm that the        |                       |
| > purpose.     | purposes for retaining the | After payment         |
|                | data are justified and     | processing is         |
|                | reasonable. This includes  | complete, all         |
|                | data that is stored only   | transient sensitive   |
|                | in memory during the       | data should be        |
|                | operation of the software. | securely deleted from |
|                |                            | all locations where   |
|                |                            | it has been retained  |
|                |                            | such that any         |
|                |                            | subsequent process,   |
|                |                            | component, function,  |
|                |                            | application, or user  |
|                |                            | within the            |
|                |                            | environment may not   |
|                |                            | access or capture the |
|                |                            | sensitive data.       |
|                |                            |                       |
|                |                            | Software vendors      |
|                |                            | should also be aware  |
|                |                            | of and account for    |
|                |                            | how other aspects of  |
|                |                            | the software          |
|                |                            | architecture (such as |
|                |                            | the                   |
|                |                            | software-development  |
|                |                            | language and          |
|                |                            | operating             |
|                |                            | environment) may      |
|                |                            | affect how and where  |
|                |                            | transient sensitive   |
|                |                            | data is retained. For |
|                |                            | example,              |
|                |                            | operating-system      |
|                |                            | usage of swap         |
|                |                            | partitions or virtual |
|                |                            | memory files can      |
|                |                            | cause information     |
|                |                            | that should have been |
|                |                            | transient to persist  |
|                |                            | longer than intended. |
|                |                            |                       |
|                |                            | If any sensitive data |
|                |                            | must be used for      |
|                |                            | debugging or          |
|                |                            | troubleshooting       |
|                |                            | purposes, the         |
|                |                            | software should only  |
|                |                            | capture the minimum   |
|                |                            | amount of data        |
|                |                            | necessary and store   |
|                |                            | it securely in a      |
|                |                            | known location.       |
+----------------+----------------------------+-----------------------+
|                | **3.2.b** Using            |                       |
|                | information obtained in    |                       |
|                | Test Requirement 1.2.a,    |                       |
|                | the assessor shall test    |                       |
|                | the software to confirm    |                       |
|                | that all available         |                       |
|                | functions or services that |                       |
|                | retain transient sensitive |                       |
|                | data are supported by      |                       |
|                | evidence examined in Test  |                       |
|                | Requirement 3.2.a and do   |                       |
|                | not use immutable objects. |                       |
+----------------+----------------------------+-----------------------+
|                | **3.2.c** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | determine whether the      |                       |
|                | software facilitates the   |                       |
|                | storage of transient       |                       |
|                | sensitive data for the     |                       |
|                | purposes of debugging,     |                       |
|                | error finding or testing   |                       |
|                | of systems, and to confirm |                       |
|                | that such data is          |                       |
|                | protected in accordance    |                       |
|                | with Control Objective     |                       |
|                |                            |                       |
|                | 6.1. Any function that     |                       |
|                | allows for the storage of  |                       |
|                | transient sensitive data   |                       |
|                | for these purposes must be |                       |
|                | explicitly enabled through |                       |
|                | an interface that requires |                       |
|                | interaction and            |                       |
|                | authorization by the user. |                       |
|                | Closure of the software    |                       |
|                | must result in the         |                       |
|                | termination of this        |                       |
|                | debugging state, such that |                       |
|                | it requires explicit       |                       |
|                | re-enablement when the     |                       |
|                | software is next executed, |                       |
|                | and any transient          |                       |
|                | sensitive data is securely |                       |
|                | deleted in accordance with |                       |
|                | Control Objective 3.5.     |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **3.2.d** Where the        |                       |
|                | retention of transient     |                       |
|                | sensitive data requires    |                       |
|                | user input or interaction, |                       |
|                | the assessor shall examine |                       |
|                | evidence to confirm that   |                       |
|                | guidance on configuring    |                       |
|                | these options is provided  |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1.            |                       |
+----------------+----------------------------+-----------------------+
| > **3.3** The  | **3.3.a** The assessor     | The software should   |
| > software     | shall examine the evidence | maintain security     |
| > protects the | to identify the methods    | controls and          |
| > c            | implemented to protect     | mechanisms to protect |
| onfidentiality | sensitive data during      | all sensitive data    |
| > and          | storage.                   | while it is retained  |
| > integrity of |                            | by the software.      |
| > sensitive    |                            | Examples of software  |
| > data (both   |                            | security controls     |
| > transient    |                            | include writing to a  |
| > and          |                            | secure memory         |
| > persistent)  |                            | location or using     |
| > during       |                            | cryptography to       |
| > retention.   |                            | render the data       |
| >              |                            | unreadable.           |
| > ***Note:**   |                            |                       |
| > The          |                            |                       |
| > [Software    |                            |                       |
| > Pr           |                            |                       |
| otection](#sof |                            |                       |
| tware-protecti |                            |                       |
| on-mechanisms) |                            |                       |
| > [Me          |                            |                       |
| chanisms](#sof |                            |                       |
| tware-protecti |                            |                       |
| on-mechanisms) |                            |                       |
| > section      |                            |                       |
| > includes     |                            |                       |
| > several      |                            |                       |
| > specific     |                            |                       |
| > software     |                            |                       |
| > security     |                            |                       |
| > controls     |                            |                       |
| > that are     |                            |                       |
| > required to  |                            |                       |
| > be           |                            |                       |
| > implemented  |                            |                       |
| > to protect   |                            |                       |
| > sensitive    |                            |                       |
| > data during  |                            |                       |
| > storage,     |                            |                       |
| > processing,  |                            |                       |
| > or           |                            |                       |
| >              |                            |                       |
|  transmission. |                            |                       |
| > Those        |                            |                       |
| > software     |                            |                       |
| > security     |                            |                       |
| > controls     |                            |                       |
| > should be    |                            |                       |
| > analyzed to  |                            |                       |
| > determine    |                            |                       |
| > their        |                            |                       |
| >              |                            |                       |
|  applicability |                            |                       |
| > to the types |                            |                       |
| > of sensitive |                            |                       |
| > data         |                            |                       |
| > retained by  |                            |                       |
| > the          |                            |                       |
| > software.*   |                            |                       |
+----------------+----------------------------+-----------------------+
|                | **3.3.b** Where sensitive  |                       |
|                | data is stored outside of  |                       |
|                | temporary variables within |                       |
|                | the code itself, the       |                       |
|                | assessor shall test the    |                       |
|                | software to confirm that   |                       |
|                | sensitive data is          |                       |
|                | protected using either     |                       |
|                | strong cryptography or     |                       |
|                | other methods that provide |                       |
|                | an equivalent level of     |                       |
|                | security.                  |                       |
+----------------+----------------------------+-----------------------+
|                | **3.3.c** Where protection |                       |
|                | methods use cryptography,  |                       |
|                | the assessor shall examine |                       |
|                | evidence and test the      |                       |
|                | software to confirm that   |                       |
|                | the cryptographic          |                       |
|                | implementation complies    |                       |
|                | with Control Objective 7   |                       |
|                | of this standard.          |                       |
+----------------+----------------------------+-----------------------+
|                | **3.3.d** Where sensitive  |                       |
|                | data is protected using    |                       |
|                | methods other than strong  |                       |
|                | cryptography, the assessor |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that the           |                       |
|                | protections are present in |                       |
|                | all environments where the |                       |
|                | software is designed to be |                       |
|                | executed and are           |                       |
|                | implemented correctly.     |                       |
+----------------+----------------------------+-----------------------+
|                | **3.3.e** Where user input |                       |
|                | or interaction is required |                       |
|                | to configure protection    |                       |
|                | methods, the assessor      |                       |
|                | shall examine evidence to  |                       |
|                | confirm that guidance on   |                       |
|                | configuring these options  |                       |
|                | is provided to             |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1.                      |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    |                            |                       |
| > Objectives   |                            |                       |
| > Test         |                            |                       |
| > Requirements |                            |                       |
| > Guidance**   |                            |                       |
+================+============================+=======================+
| > **3.4** The  | **3.4.a** The assessor     | Secure deletion is    |
| > software     | shall examine evidence to  | the process of        |
| > securely     | identify the methods       | rendering data        |
| > deletes      | implemented to render      | irretrievable to      |
| > persistent   | persistent sensitive data  | other people,         |
| > sensitive    | irretrievable and to       | processes, or         |
| > data when it | confirm that sensitive     | systems.              |
| > is no longer | data is rendered           |                       |
| > required.    | unrecoverable after the    | Secure deletion may   |
|                | process is complete.       | be required at the    |
|                |                            | end of a              |
|                |                            | software-specific     |
|                |                            | operation or upon     |
|                |                            | completion of         |
|                |                            | user-specified        |
|                |                            | retention             |
|                |                            | requirements. In the  |
|                |                            | latter case, the      |
|                |                            | software should be    |
|                |                            | able to securely      |
|                |                            | delete the sensitive  |
|                |                            | data after expiry of  |
|                |                            | the user-specified    |
|                |                            | retention period.     |
|                |                            |                       |
|                |                            | Only in circumstances |
|                |                            | where the retention   |
|                |                            | of sensitive data is  |
|                |                            | explicitly permitted  |
|                |                            | should the data be    |
|                |                            | retained after        |
|                |                            | transaction           |
|                |                            | processing is         |
|                |                            | complete.             |
+----------------+----------------------------+-----------------------+
|                | **3.4.b** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | identify any platform or   |                       |
|                | implementation level       |                       |
|                | issues that complicate the |                       |
|                | secure deletion of         |                       |
|                | non-transient sensitive    |                       |
|                | data and to confirm that   |                       |
|                | any non-transient          |                       |
|                | sensitive data is securely |                       |
|                | deleted using a method     |                       |
|                | that ensures that the data |                       |
|                | is rendered unrecoverable. |                       |
|                | Methods may include (but   |                       |
|                | are not necessarily        |                       |
|                | limited to) overwriting    |                       |
|                | the data, deletion of      |                       |
|                | cryptographic keys (of     |                       |
|                | sufficient strength) that  |                       |
|                | have been used to encrypt  |                       |
|                | the data, or               |                       |
|                | platform-specific          |                       |
|                | functions that provide for |                       |
|                | secure deletion. Methods   |                       |
|                | must accommodate for       |                       |
|                | platform- specific issues, |                       |
|                | such as flash              |                       |
|                | wear-levelling algorithms  |                       |
|                | or SSD over-provisioning,  |                       |
|                | which may complicate       |                       |
|                | simple over-writing        |                       |
|                | methods.                   |                       |
+----------------+----------------------------+-----------------------+
|                | **3.4.c** The assessor     |                       |
|                | shall test the software    |                       |
|                | using forensic tools to    |                       |
|                | identify any non-transient |                       |
|                | sensitive data residue in  |                       |
|                | the execution environment, |                       |
|                | and to confirm that the    |                       |
|                | methods attested by the    |                       |
|                | software vendor are        |                       |
|                | correctly implemented and  |                       |
|                | applied to all sensitive   |                       |
|                | data. This analysis should |                       |
|                | accommodate for the data   |                       |
|                | structures and methods     |                       |
|                | used to store the          |                       |
|                | sensitive data (for        |                       |
|                | example, by examining file |                       |
|                | systems at the allocation  |                       |
|                | level and translating data |                       |
|                | formats to identify        |                       |
|                | sensitive data elements)   |                       |
|                | and cover all              |                       |
|                | non-transient sensitive    |                       |
|                | data types.                |                       |
|                |                            |                       |
|                | ***Note:** Where forensic  |                       |
|                | testing of some or all     |                       |
|                | aspects of the platform is |                       |
|                | not possible, the assessor |                       |
|                | should examine additional  |                       |
|                | evidence to confirm secure |                       |
|                | deletion of sensitive      |                       |
|                | data. Such evidence may    |                       |
|                | include (but is not        |                       |
|                | necessarily limited to)    |                       |
|                | memory and storage dumps   |                       |
|                | from development systems,  |                       |
|                | evidence from memory       |                       |
|                | traces from emulated       |                       |
|                | systems, or evidence from  |                       |
|                | physical extraction of     |                       |
|                | data performed on-site by  |                       |
|                | the software vendor.*      |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    |                            |                       |
| > Objectives   |                            |                       |
| > Test         |                            |                       |
| > Requirements |                            |                       |
| > Guidance**   |                            |                       |
+================+============================+=======================+
| > **3.5**      | **3.5.a** The assessor     | Where sensitive data  |
| > Transient    | shall examine evidence to  | is only retained      |
| > sensitive    | identify the methods       | temporarily to        |
| > data is      | implemented to render      | perform a specific    |
| > securely     | transient sensitive data   | function (such as a   |
| > deleted from | irretrievable and to       | payment transaction), |
| > temporary    | confirm that sensitive     | mechanisms are        |
| > storage      | data is unrecoverable      | required to securely  |
| > facilities   | after the process is       | delete the sensitive  |
| >              | complete.                  | data once the         |
|  automatically |                            | specific function has |
| > by the       | ***Note:** This includes   | completed.            |
| > software     | data which may be stored   |                       |
| > once the     | only temporarily*          | Transient sensitive   |
| > purpose for  |                            | data is often erased  |
| > which it is  | *in program memory /       | from temporary        |
| > retained is  | variables during operation | storage locations     |
| > satisfied.   | of the software.*          | after processing is   |
|                |                            | complete. However,    |
|                |                            | that data may remain  |
|                |                            | resident in volatile  |
|                |                            | memory (RAM) or in    |
|                |                            | other storage         |
|                |                            | locations for longer  |
|                |                            | periods than          |
|                |                            | anticipated (such as  |
|                |                            | in swap               |
|                |                            | files/partitions or   |
|                |                            | log files).           |
|                |                            |                       |
|                |                            | Software vendors      |
|                |                            | should account for    |
|                |                            | all locations where   |
|                |                            | sensitive data is     |
|                |                            | stored, regardless of |
|                |                            | the intended duration |
|                |                            | of storage, and       |
|                |                            | ensure that such data |
|                |                            | is securely deleted   |
|                |                            | once the purpose for  |
|                |                            | which the software    |
|                |                            | collected the data    |
|                |                            | has been satisfied.   |
+----------------+----------------------------+-----------------------+
|                | **3.5.b** The assessor     |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | identify any platform or   |                       |
|                | implementation level       |                       |
|                | issues that complicate the |                       |
|                | erasure of such transient  |                       |
|                | sensitive                  |                       |
|                |                            |                       |
|                | data, such as abstraction  |                       |
|                | layers between the code    |                       |
|                | and the hardware execution |                       |
|                | environment, and to        |                       |
|                | confirm that methods have  |                       |
|                | been implemented to        |                       |
|                | minimize the risk posed by |                       |
|                | these complications.       |                       |
+----------------+----------------------------+-----------------------+
|                | **3.5.c** The assessor     |                       |
|                | shall test the software to |                       |
|                | identify any sensitive     |                       |
|                | data residue in the        |                       |
|                | execution environment and  |                       |
|                | to confirm that the        |                       |
|                | methods implemented are    |                       |
|                | implemented correctly and  |                       |
|                | enforced for all transient |                       |
|                | sensitive data. This       |                       |
|                | analysis should            |                       |
|                | accommodate for the data   |                       |
|                | structures and methods     |                       |
|                | used to store the          |                       |
|                | sensitive data (for        |                       |
|                | example, by examining file |                       |
|                | systems at the allocation  |                       |
|                | level and translating data |                       |
|                | formats to identify        |                       |
|                | sensitive data elements)   |                       |
|                | and cover all              |                       |
|                | non-transient sensitive    |                       |
|                | data types.                |                       |
|                |                            |                       |
|                | ***Note:** Where forensic  |                       |
|                | testing of some or all     |                       |
|                | aspects of the platform is |                       |
|                | not possible, the assessor |                       |
|                | should examine additional  |                       |
|                | evidence to confirm secure |                       |
|                | deletion of sensitive      |                       |
|                | data. Such evidence may    |                       |
|                | include (but is not        |                       |
|                | necessarily limited to)    |                       |
|                | memory and storage dumps   |                       |
|                | from development systems,  |                       |
|                | evidence from memory       |                       |
|                | traces from emulated       |                       |
|                | systems, or evidence from  |                       |
|                | physical extraction of     |                       |
|                | data performed on-site by  |                       |
|                | the software vendor.*      |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **3.6** The  | **3.6.a** The assessor     | > Proactive measures  |
| > software     | shall examine evidence to  | > to ensure that      |
| > does not     | confirm the software       | > sensitive data is   |
| > disclose     | vendor has performed a     | > not inadvertently   |
| > sensitive    | thorough analysis to       | > "leaked" should be  |
| > data through | account for all sensitive  | > implemented by the  |
| > unintended   | data disclosure attack     | > software vendor or  |
| > channels.    | vectors including, but not | > within the          |
|                | limited to:                | > software.           |
|                |                            | >                     |
|                | -   Error messages, error  | > Disclosure of       |
|                |     > logs, or memory      | > sensitive data to   |
|                |     > dumps.               | > unauthorized        |
|                |                            | > parties often       |
|                | -   Execution environments | > occurs through      |
|                |     > that may be          | > unknown or          |
|                |     > vulnerable to remote | > unintended outputs  |
|                |     > side-channel attacks | > or channels. For    |
|                |     > to expose sensitive  | > example: sensitive  |
|                |     > data, such as        | > data could be       |
|                |     > attacks that exploit | > unintentionally     |
|                |     > cache timing or      | > disclosed through   |
|                |     > branch prediction    | > error- or           |
|                |     > within the platform  | > exception- handling |
|                |     > processor.           | > routines, logging   |
|                |                            | > or debugging        |
|                | -   Automatic storage or   | > channels,           |
|                |     > exposure of          | > third-party         |
|                |     > sensitive data by    | > services and/or     |
|                |     > the underlying       | > components, or      |
|                |     > execution            | > through the use of  |
|                |     > environment, such as | > shared resources    |
|                |     > through swap- files, | > such as memory,     |
|                |     > system error         | > disk, files,        |
|                |     > logging, keyboard    | > keyboards,          |
|                |     > spelling, and auto-  | > displays, and       |
|                |     > correct features.    | > functions.          |
|                |                            | >                     |
|                | -   Sensors or services    | > Protective          |
|                |     > provided by the      | > mechanisms, whether |
|                |     > execution            | > process or          |
|                |     > environment that may | > programmatic in     |
|                |     > be used to extract   | > nature, should be   |
|                |     > or leak sensitive    | > implemented to      |
|                |     > data, such as        | > ensure that         |
|                |     > through use of an    | > sensitive data is   |
|                |     > accelerometer to     | > not accidentally    |
|                |     > capture input of a   | > disclosed through   |
|                |     > passphrase to be     | > such means.         |
|                |     > used as a seed for a |                       |
|                |     > cryptographic key,   |                       |
|                |     > or through capture   |                       |
|                |     > of sensitive data    |                       |
|                |     > through use of       |                       |
|                |     > cameras or           |                       |
|                |     > near-field           |                       |
|                |     > communication (NFC)  |                       |
|                |     > interfaces.          |                       |
+----------------+----------------------------+-----------------------+
|                | **3.6.b** The assessor     |                       |
|                | shall examine evidence,    |                       |
|                | including the results of   |                       |
|                | the analysis described in  |                       |
|                | Test Requirement 3.6.a,    |                       |
|                | and test the software to   |                       |
|                | confirm that methods are   |                       |
|                | implemented to protect     |                       |
|                | against unintended         |                       |
|                | disclosure of sensitive    |                       |
|                | data. Such methods may     |                       |
|                | include usage of           |                       |
|                | cryptography to protect    |                       |
|                | the data, or the use of    |                       |
|                | blinding or masking of     |                       |
|                | cryptographic operations   |                       |
|                | (where supported by the    |                       |
|                | execution environment).    |                       |
+----------------+----------------------------+-----------------------+
|                | **3.6.c** Where protection |                       |
|                | methods require user input |                       |
|                | or interaction, the        |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that   |                       |
|                | guidance on the proper     |                       |
|                | configuration and use of   |                       |
|                | such methods is provided   |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1.            |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **3.6.d** The assessor     |                       |
|                | shall test the software to |                       |
|                | identify any sensitive     |                       |
|                | data residue in the        |                       |
|                | execution environment, and |                       |
|                | to confirm that protection |                       |
|                | methods are implemented    |                       |
|                | correctly and the software |                       |
|                | does not expose or         |                       |
|                | otherwise reveal sensitive |                       |
|                | data to unauthorized       |                       |
|                | users.                     |                       |
+----------------+----------------------------+-----------------------+

### Software Protection Mechanisms

> ***Software security controls are implemented to protect the integrity
> and confidentiality of critical assets.***

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark21 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 4: |                            |                        |
| > Critical     |                            |                        |
| > Asset        |                            |                        |
| > Protection** |                            |                        |
| >              |                            |                        |
| > Critical     |                            |                        |
| > assets are   |                            |                        |
| > protected    |                            |                        |
| > from attack  |                            |                        |
| > scenarios.   |                            |                        |
+----------------+----------------------------+------------------------+
| > **4.1**      | **4.1.a** The assessor     | Software vendors       |
| > Attack       | shall examine evidence to  | should evaluate the    |
| > scenarios    | confirm that the software  | design of their        |
| > applicable   | vendor has identified and  | payment software to    |
| > to the       | documented relevant attack | identify attack        |
| > software are | scenarios for the          | scenarios applicable   |
| > identified.  | software.                  | to the software and    |
| >              |                            | should document the    |
| > ***Note:**   |                            | results of that        |
| > This control |                            | analysis.              |
| > objective is |                            | Documentation should   |
| > an extension |                            | describe the various   |
| > of Control   |                            | aspects of the code    |
| > Objective    |                            | that could be attacked |
| > 10.1.        |                            | (including tasks or    |
| > Validation   |                            | actions that           |
| > of both      |                            | frameworks and         |
| > control      |                            | libraries do on the    |
| > objectives   |                            | software's behalf),    |
| > should be    |                            | the difficulty in      |
| > performed at |                            | mounting a successful  |
| > the same     |                            | attack, the mitigation |
| > time.*       |                            | techniques used to     |
|                |                            | protect against such   |
|                |                            | attacks, and the       |
|                |                            | methodology used for   |
|                |                            | measuring the          |
|                |                            | likelihood and impact  |
|                |                            | of each potential      |
|                |                            | attack method.         |
|                |                            |                        |
|                |                            | When the software      |
|                |                            | relies on execution    |
|                |                            | environment security   |
|                |                            | controls, the software |
|                |                            | vendor should review   |
|                |                            | and reference the      |
|                |                            | implementation         |
|                |                            | documentation for the  |
|                |                            | platform (such as      |
|                |                            | Security Policies for  |
|                |                            | PCI- approved POI      |
|                |                            | devices or FIPS140-2   |
|                |                            | or 140-3 approved      |
|                |                            | cryptographic modules) |
|                |                            | and should confirm     |
|                |                            | that the software and  |
|                |                            | its associated         |
|                |                            | documentation          |
|                |                            | correctly and          |
|                |                            | completely accommodate |
|                |                            | the guidance in these  |
|                |                            | documents.             |
+----------------+----------------------------+------------------------+
|                | **4.1.b** The assessor     |                        |
|                | shall examine evidence to  |                        |
|                | determine whether any      |                        |
|                | specific industry-standard |                        |
|                | methods or guidelines were |                        |
|                | used to identify relevant  |                        |
|                | attack scenarios.          |                        |
|                |                            |                        |
|                | Where such industry        |                        |
|                | standards are not used,    |                        |
|                | the assessor shall confirm |                        |
|                | that the methodology used  |                        |
|                | provides equivalent        |                        |
|                | coverage for the attack    |                        |
|                | scenarios applicable to    |                        |
|                | the software under         |                        |
|                | evaluation.                |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **4.1.c** The assessor     |                        |
|                | shall examine evidence to  |                        |
|                | confirm the following:     |                        |
|                |                            |                        |
|                | -   A formal owner of the  |                        |
|                |     > software is          |                        |
|                |     > assigned. This may   |                        |
|                |     > be a role for a      |                        |
|                |     > specific individual  |                        |
|                |     > or a specific name,  |                        |
|                |     > but evidence must    |                        |
|                |     > clearly show an      |                        |
|                |     > individual who is    |                        |
|                |     > accountable for the  |                        |
|                |     > security of the      |                        |
|                |     > software.            |                        |
|                |                            |                        |
|                | -   A methodology is       |                        |
|                |     > defined for          |                        |
|                |     > measuring the        |                        |
|                |     > likelihood and       |                        |
|                |     > impact for any       |                        |
|                |     > exploit of the       |                        |
|                |     > system.              |                        |
|                |                            |                        |
|                | -   Generic threat methods |                        |
|                |     > and types that may   |                        |
|                |     > be applicable to the |                        |
|                |     > software are         |                        |
|                |     > documented.          |                        |
|                |                            |                        |
|                | -   All critical assets    |                        |
|                |     > managed, and all     |                        |
|                |     > sensitive resources  |                        |
|                |     > used by the system   |                        |
|                |     > are documented.      |                        |
|                |                            |                        |
|                | -   All entry and egress   |                        |
|                |     > points for sensitive |                        |
|                |     > data, as well as the |                        |
|                |     > authentication and   |                        |
|                |     > trust model applied  |                        |
|                |     > to each of these     |                        |
|                |     > entry/egress points, |                        |
|                |     > are documented.      |                        |
|                |                            |                        |
|                | -   All data flows,        |                        |
|                |     > network segments,    |                        |
|                |     > and                  |                        |
|                |                            |                        |
|                | > authentication/privilege |                        |
|                |     > boundaries are       |                        |
|                |     > documented.          |                        |
|                |                            |                        |
|                | -   All static IPs,        |                        |
|                |     > domains, URLs, or    |                        |
|                |     > ports required by    |                        |
|                |     > the software for     |                        |
|                |     > operation are        |                        |
|                |     > documented.          |                        |
|                |                            |                        |
|                | -   Considerations for     |                        |
|                |     > cryptography         |                        |
|                |     > elements like cipher |                        |
|                |     > modes, and           |                        |
|                |     > protecting against   |                        |
|                |     > relevant attacks     |                        |
|                |     > such as timing       |                        |
|                |     > attacks, padded      |                        |
|                |     > oracles, brute       |                        |
|                |     > force, "rainbow      |                        |
|                |     > table" attacks, and  |                        |
|                |     > dictionary attacks   |                        |
|                |     > against the input    |                        |
|                |     > domain are           |                        |
|                |     > documented.          |                        |
|                |                            |                        |
|                | -   Execution environment  |                        |
|                |     > implementation       |                        |
|                |     > specifics or         |                        |
|                |     > assumptions, such as |                        |
|                |     > network              |                        |
|                |     > configurations and   |                        |
|                |     > operating system     |                        |
|                |     > security             |                        |
|                |     > configurations, are  |                        |
|                |     > documented.          |                        |
|                |                            |                        |
|                | -   Considerations for the |                        |
|                |     > software execution   |                        |
|                |     > environment, the     |                        |
|                |     > size of the install  |                        |
|                |     > base, and the attack |                        |
|                |     > surfaces that must   |                        |
|                |     > be mitigated are     |                        |
|                |     > documented. Examples |                        |
|                |     > of such attack       |                        |
|                |     > surfaces may include |                        |
|                |     > insecure user        |                        |
|                |     > prompts or protocol  |                        |
|                |     > stacks, or the       |                        |
|                |     > storage of sensitive |                        |
|                |     > data post            |                        |
|                |     > authorization or     |                        |
|                |     > using insecure       |                        |
|                |     > methods.             |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > **4.2**      | **4.2.a** The assessor     | Once attack scenarios  |
| > Software     | shall examine evidence to  | are identified, the    |
| > security     | confirm that one or more   | risk of their          |
| > controls are | mitigation methods are     | occurrence should be   |
| > implemented  | defined for each of the    | mitigated. Software    |
| > to mitigate  | threats identified in Test | vendors should define  |
| > software     | Requirement 4.1.a or that  | and implement          |
| > attacks.     | justification for the lack | mechanisms to protect  |
|                | of mitigations is          | the software from      |
|                | provided.                  | attacks and reduce the |
|                |                            | likelihood and impact  |
|                |                            | of successful          |
|                |                            | execution. Any attack  |
|                |                            | scenarios left         |
|                |                            | unmitigated or         |
|                |                            | insufficiently         |
|                |                            | mitigated should be    |
|                |                            | reasonably justified.  |
|                |                            |                        |
|                |                            | The exact nature of    |
|                |                            | the protection         |
|                |                            | mechanism(s) will      |
|                |                            | depend on the attack   |
|                |                            | scenarios, the         |
|                |                            | development platform,  |
|                |                            | and the                |
|                |                            | software-development   |
|                |                            | languages, frameworks, |
|                |                            | libraries, and APIs    |
|                |                            | used by the software,  |
|                |                            | as well as the         |
|                |                            | execution environment  |
|                |                            | where the software is  |
|                |                            | intended to be         |
|                |                            | deployed.              |
|                |                            |                        |
|                |                            | To minimize the        |
|                |                            | software attack        |
|                |                            | surface, the software  |
|                |                            | should be developed    |
|                |                            | using secure design    |
|                |                            | principles such as     |
|                |                            | layered defense,       |
|                |                            | application            |
|                |                            | segmentation and       |
|                |                            | isolation (logical),   |
|                |                            | and adaptive response. |
|                |                            |                        |
|                |                            | Examples of software   |
|                |                            | security controls      |
|                |                            | include input and      |
|                |                            | output validation,     |
|                |                            | authentication,        |
|                |                            | parameterization,      |
|                |                            | escaping,              |
|                |                            | segmentation, logging, |
|                |                            | etc. For guidance on   |
|                |                            | implementing cyber     |
|                |                            | resiliency techniques  |
|                |                            | and approaches, refer  |
|                |                            | to industry standards  |
|                |                            | and guidance such as   |
|                |                            | the current version of |
|                |                            | *NIST Special          |
|                |                            | Publication 800-160*.  |
+----------------+----------------------------+------------------------+
|                | **4.2.b** Where any        |                        |
|                | mitigations rely on        |                        |
|                | settings within the        |                        |
|                | software, the assessor     |                        |
|                | shall test the software to |                        |
|                | confirm that such settings |                        |
|                | are applied by default     |                        |
|                | upon installation,         |                        |
|                | initialization, or first   |                        |
|                | use of the software.       |                        |
+----------------+----------------------------+------------------------+
|                | **4.2.c** Where user input |                        |
|                | or interaction can         |                        |
|                | disable, remove, or bypass |                        |
|                | any such mitigations, the  |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | such action requires       |                        |
|                | authentication and         |                        |
|                | authorization and that     |                        |
|                | guidance on the risk of    |                        |
|                | such actions is provided   |                        |
|                | to stakeholders in         |                        |
|                | accordance with Control    |                        |
|                | Objective 12.1.            |                        |
+----------------+----------------------------+------------------------+
|                | **4.2.d** When any         |                        |
|                | mitigations rely on        |                        |
|                | features of the execution  |                        |
|                | environment, the assessor  |                        |
|                | shall examine evidence to  |                        |
|                | confirm that guidance is   |                        |
|                | provided to stakeholders   |                        |
|                | on how to enable such      |                        |
|                | settings in accordance     |                        |
|                | with Control Objective     |                        |
|                | 12.1.                      |                        |
+----------------+----------------------------+------------------------+
|                | **4.2.e** Where the        |                        |
|                | execution environment      |                        |
|                | provides APIs to query the |                        |
|                | status of mitigation       |                        |
|                | controls, the assessor     |                        |
|                | shall test the software to |                        |
|                | confirm that software      |                        |
|                | checks for these           |                        |
|                | mitigations are in place   |                        |
|                | and active prior to being  |                        |
|                | launched and periodically  |                        |
|                | throughout execution.      |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark22 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 5: |                            |                        |
| >              |                            |                        |
| Authentication |                            |                        |
| > and Access   |                            |                        |
| > Control**    |                            |                        |
| >              |                            |                        |
| > The software |                            |                        |
| > implements   |                            |                        |
| > robust       |                            |                        |
| >              |                            |                        |
| authentication |                            |                        |
| > and access   |                            |                        |
| > control      |                            |                        |
| > methods to   |                            |                        |
| > protect the  |                            |                        |
| > co           |                            |                        |
| nfidentiality, |                            |                        |
| > integrity,   |                            |                        |
| > and          |                            |                        |
| > resiliency   |                            |                        |
| > of critical  |                            |                        |
| > assets.      |                            |                        |
+----------------+----------------------------+------------------------+
| > **5.1**      | **5.1.a** The assessor     | Secure authentication  |
| > Access to    | shall examine evidence to  | ensures individual     |
| > critical     | confirm that               | responsibility for     |
| > assets is    | authentication             | actions and allows the |
| >              | requirements are defined   | software to maintain   |
| authenticated. | (i.e., type and number of  | an effective audit     |
|                | factors) for all roles     | trail of user          |
|                | based on critical asset    | activity. This         |
|                | classification, the type   | expedites issue        |
|                | of access (e.g., local,    | resolution and         |
|                | non-console, remote) and   | containment when the   |
|                | level of privilege.        | software is misused    |
|                |                            | for malicious          |
|                | ***Note:** The assessor    | purposes.              |
|                | should refer to evidence   |                        |
|                | obtained in the testing of | Authentication         |
|                | Control Objective 1.3 to   | mechanisms should      |
|                | determine the              | cover all non- public  |
|                | classifications for all    | resources managed by   |
|                | critical assets.*          | or accessible through  |
|                |                            | the software, as well  |
|                |                            | as sensitive functions |
|                |                            | that can alter the     |
|                |                            | software operation or  |
|                |                            | impact the security of |
|                |                            | sensitive data and     |
|                |                            | sensitive resources.   |
|                |                            | Examples of            |
|                |                            | authentication methods |
|                |                            | include:               |
|                |                            |                        |
|                |                            | -   Something you      |
|                |                            |     > know, such as a  |
|                |                            |     > password or      |
|                |                            |     > passphrase.      |
|                |                            |                        |
|                |                            | -   Something you      |
|                |                            |     > have, such as a  |
|                |                            |     > token device or  |
|                |                            |     > smart card.      |
|                |                            |                        |
|                |                            | -   Something you are, |
|                |                            |     > such as a        |
|                |                            |     > biometric.       |
|                |                            |                        |
|                |                            | To ensure that the     |
|                |                            | implemented            |
|                |                            | authentication         |
|                |                            | mechanisms are         |
|                |                            | adequate to address    |
|                |                            | the risk of            |
|                |                            | unauthorized access to |
|                |                            | sensitive data or      |
|                |                            | sensitive resources,   |
|                |                            | or misuse of a         |
|                |                            | sensitive function,    |
|                |                            | the vendor should      |
|                |                            | analyze threats and    |
|                |                            | identify the required  |
|                |                            | level of               |
|                |                            | authentication for all |
|                |                            | types of users and     |
|                |                            | roles.                 |
|                |                            |                        |
|                |                            | For example, a user    |
|                |                            | with limited access to |
|                |                            | sensitive data and     |
|                |                            | sensitive resources    |
|                |                            | could be required to   |
|                |                            | perform authentication |
|                |                            | using a single         |
|                |                            | authentication factor  |
|                |                            | (for example, a        |
|                |                            | password or a          |
|                |                            | passphrase) while a    |
|                |                            | user that is able to   |
|                |                            | export the entire      |
|                |                            | database might be      |
|                |                            | required to perform    |
|                |                            | multi-factor           |
|                |                            | authentication.        |
|                |                            |                        |
|                |                            | > *(continued on next  |
|                |                            | > page)*               |
+----------------+----------------------------+------------------------+
|                | **5.1.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that access to     |                        |
|                | critical assets is         |                        |
|                | authenticated and          |                        |
|                | authentication mechanisms  |                        |
|                | are implemented correctly. |                        |
+----------------+----------------------------+------------------------+
|                | **5.1.c** Where the        |                        |
|                | software recommends,       |                        |
|                | suggests, relies on, or    |                        |
|                | otherwise supports the use |                        |
|                | of external mechanisms     |                        |
|                | (such as third-party VPNs, |                        |
|                | remote desktop features,   |                        |
|                | etc.) to provide secure    |                        |
|                | non-console access to the  |                        |
|                | system on which the        |                        |
|                | software is executed or    |                        |
|                | directly to the software   |                        |
|                | itself, the assessor shall |                        |
|                | examine evidence to        |                        |
|                | confirm that guidance on   |                        |
|                | how to configure           |                        |
|                | authentication mechanisms  |                        |
|                | correctly is provided to   |                        |
|                | stakeholders in accordance |                        |
|                | with Control Objective     |                        |
|                | 12.1.                      |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **5.1.d** The assessor     | Other factors such as  |
|                | shall examine evidence to  | the type of access     |
|                | confirm that sensitive     | (for example, local,   |
|                | data associated with       | non-console, or remote |
|                | authentication             | access) and the level  |
|                | credentials, including     | of privilege (for      |
|                | public keys, is identified | example, the ability   |
|                | as a critical asset.       | to invoke sensitive    |
|                |                            | functions such as      |
|                |                            | pause logging or       |
|                |                            | change access          |
|                |                            | privileges) may        |
|                |                            | influence the level of |
|                |                            | authentication that    |
|                |                            | should be required.    |
+----------------+----------------------------+------------------------+
| > **5.2**      | **5.2.a** The assessor     | The software should    |
| > Access to    | shall examine evidence and | not require the use of |
| > critical     | test the software to       | any group, shared, or  |
| > assets       | confirm that all           | generic accounts. The  |
| > requires     | implemented authentication | use of group or shared |
| > unique       | methods require unique     | accounts makes it more |
| > i            | identification.            | difficult to determine |
| dentification. |                            | which individuals      |
|                |                            | execute specific       |
|                |                            | actions since a given  |
|                |                            | action could have been |
|                |                            | performed by anyone    |
|                |                            | that has knowledge of  |
|                |                            | the group or shared    |
|                |                            | accounts'              |
|                |                            | authentication         |
|                |                            | credentials.           |
+----------------+----------------------------+------------------------+
|                | **5.2.b** Where            |                        |
|                | interfaces, such as APIs,  |                        |
|                | allow for automated access |                        |
|                | to critical assets, the    |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | unique identification of   |                        |
|                | different programs or      |                        |
|                | systems accessing the      |                        |
|                | critical assets is         |                        |
|                | required (for example,     |                        |
|                | through use of multiple    |                        |
|                | public keys) and that      |                        |
|                | guidance on configuring a  |                        |
|                | unique credential for each |                        |
|                | program or system is       |                        |
|                | provided to stakeholders   |                        |
|                | in accordance with Control |                        |
|                | Objective 12.1.            |                        |
+----------------+----------------------------+------------------------+
|                | **5.2.c** Where            |                        |
|                | identification is supplied |                        |
|                | across a non-console       |                        |
|                | interface, the assessor    |                        |
|                | shall test the software to |                        |
|                | confirm that               |                        |
|                | authentication credentials |                        |
|                | are protected from attacks |                        |
|                | that attempt to intercept  |                        |
|                | them in transit.           |                        |
+----------------+----------------------------+------------------------+
|                | **5.2.d** The assessor     |                        |
|                | shall examine evidence to  |                        |
|                | confirm that the guidance  |                        |
|                | provided to stakeholders   |                        |
|                | per Control Objective 12.1 |                        |
|                | specifically notes that    |                        |
|                | identification and         |                        |
|                | authentication parameters  |                        |
|                | must not be shared between |                        |
|                | individuals, programs, or  |                        |
|                | in any way that prevents   |                        |
|                | the unique identification  |                        |
|                | of each access to a        |                        |
|                | critical asset.            |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    |                            |                        |
| > Objectives   |                            |                        |
| > Test         |                            |                        |
| > Requirements |                            |                        |
| > Guidance**   |                            |                        |
+================+============================+========================+
| > **5.3**      | **5.3.a** Using            | The software vendor    |
| >              | information obtained in    | must evaluate,         |
| Authentication | Test Requirement 4.1.a,    | document, and justify  |
| > methods      | the assessor shall examine | the usage of           |
| > (including   | evidence to confirm that   | implemented            |
| > session      | authentication methods     | authentication methods |
| > credentials) | implemented by the         | to demonstrate that    |
| > are          | software are evaluated to  | they are sufficiently  |
| > sufficiently | identify known             | strong to protect      |
| > strong and   | vulnerabilities or attack  | authentication         |
| > robust to    | methods involving the      | credentials in the     |
| > protect      | authentication method and  | software's intended    |
| >              | how the implementation of  | specific use case or   |
| authentication | these methods mitigates    | deployment scenario.   |
| > credentials  | against such attacks. The  |                        |
| > from being   | assessor shall also        | For example, if the    |
| > forged,      | confirm that the evidence  | software uses          |
| > spoofed,     | examined demonstrates the  | biometric              |
| > leaked,      | implementation used in the | authentication, the    |
| > guessed, or  | software was considered.   | vendor may want to     |
| >              | For example, a fingerprint | identify all points at |
|  circumvented. | may be uniquely            | which a malicious user |
|                | identifiable to an         | may attack the         |
|                | individual, but the        | authenticator and      |
|                | ability to spoof or        | implement mitigations  |
|                | otherwise bypass such      | to address those       |
|                | technology can be highly   | risks. The             |
|                | dependent on the way the   | authentication         |
|                | solution is implemented.   | mechanism implemented  |
|                |                            | in the software could  |
|                |                            | rely on additional     |
|                |                            | sensors to ensure the  |
|                |                            | provided biometric     |
|                |                            | sample is from a       |
|                |                            | living human and not a |
|                |                            | forged or spoofed      |
|                |                            | sample.                |
|                |                            |                        |
|                |                            | In some use cases or   |
|                |                            | deployment scenarios,  |
|                |                            | an authentication      |
|                |                            | mechanism that relies  |
|                |                            | on a single            |
|                |                            | authentication method  |
|                |                            | may not be sufficient. |
|                |                            | In such circumstances, |
|                |                            | the software vendor    |
|                |                            | may want to implement  |
|                |                            | additional mitigation  |
|                |                            | strategies (for        |
|                |                            | example, multi-factor  |
|                |                            | authentication         |
|                |                            | mechanism).            |
|                |                            |                        |
|                |                            | To support a claim     |
|                |                            | that the implemented   |
|                |                            | authentication         |
|                |                            | mechanism is           |
|                |                            | sufficiently strong    |
|                |                            | and robust, a vendor   |
|                |                            | should adopt an        |
|                |                            | industry-accepted      |
|                |                            | methodology for        |
|                |                            | assigning assurance    |
|                |                            | levels (for example,   |
|                |                            | *NIST SP800-63-3* and  |
|                |                            | *NIST SP800-63B*).     |
+----------------+----------------------------+------------------------+
|                | **5.3.b** The assessor     |                        |
|                | shall examine evidence to  |                        |
|                | confirm that the           |                        |
|                | implemented authentication |                        |
|                | methods are robust and the |                        |
|                | robustness of the          |                        |
|                | authentication methods was |                        |
|                | evaluated using            |                        |
|                | industry-accepted methods. |                        |
|                |                            |                        |
|                | ***Note:** The vendor      |                        |
|                | assessment and robustness  |                        |
|                | justification include      |                        |
|                | consideration of the full  |                        |
|                | path of the user           |                        |
|                | credentials, from any      |                        |
|                | input source (such as a    |                        |
|                | Human Machine Interface or |                        |
|                | other program), through    |                        |
|                | transition to the          |                        |
|                | execution environment of   |                        |
|                | the software (including    |                        |
|                | any switched/network       |                        |
|                | transmissions and          |                        |
|                | traversal through the      |                        |
|                | execution environment's    |                        |
|                | software stack before      |                        |
|                | being processed by the     |                        |
|                | software itself).*         |                        |
+----------------+----------------------------+------------------------+
|                | **5.3.c** The assessor     |                        |
|                | shall test the software to |                        |
|                | confirm that the           |                        |
|                | authentication methods are |                        |
|                | implemented correctly and  |                        |
|                | do not expose              |                        |
|                | vulnerabilities.           |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > **5.4** By   | **5.4.a** The assessor     | To ensure the software |
| > default, all | shall examine evidence to  | protects the           |
| > access to    | confirm that information   | confidentiality and    |
| > critical     | is maintained that         | integrity of critical  |
| > assets is    | identifies and justifies   | assets, access         |
| > restricted   | the required access for    | privileges to those    |
| > to only      | all critical assets.       | critical assets should |
| > those        |                            | be restricted based on |
| > accounts and |                            | vendor- defined access |
| > services     |                            | requirements. There    |
| > that require |                            | are various approaches |
| > such access. |                            | to implementing        |
|                |                            | privilege restriction, |
|                |                            | such as trust-based    |
|                |                            | privilege management,  |
|                |                            | attribute-based usage  |
|                |                            | restriction, and       |
|                |                            | dynamic privileges. To |
|                |                            | reduce the attack      |
|                |                            | surface of the         |
|                |                            | software, the software |
|                |                            | authorization          |
|                |                            | mechanisms might limit |
|                |                            | access to critical     |
|                |                            | assets to only those   |
|                |                            | accounts that need     |
|                |                            | such access            |
|                |                            |                        |
|                |                            | (the principle of      |
|                |                            | "least privilege").    |
|                |                            | Other techniques       |
|                |                            | include implementation |
|                |                            | of Role-Based Access   |
|                |                            | Control (RBAC),        |
|                |                            | Attribute-Based Access |
|                |                            | Control (ABAC),        |
|                |                            | time-based adjustment  |
|                |                            | to privilege, and      |
|                |                            | dynamic revocation of  |
|                |                            | access authorization.  |
+----------------+----------------------------+------------------------+
|                | **5.4.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | identify the level of      |                        |
|                | access that is provided to |                        |
|                | critical assets and to     |                        |
|                | confirm that such access   |                        |
|                | correlates with the        |                        |
|                | evidence examined in Test  |                        |
|                | Requirement 5.4.a. Testing |                        |
|                | to confirm access to       |                        |
|                | critical assets is         |                        |
|                | properly restricted should |                        |
|                | include attempts to access |                        |
|                | critical assets through    |                        |
|                | user accounts, roles, or   |                        |
|                | services which should not  |                        |
|                | have the required          |                        |
|                | privileges.                |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark23 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 6: |                            |                        |
| > Sensitive    |                            |                        |
| > Data         |                            |                        |
| > Protection** |                            |                        |
| >              |                            |                        |
| > Sensitive    |                            |                        |
| > data is      |                            |                        |
| > protected at |                            |                        |
| > rest and in  |                            |                        |
| > transit.     |                            |                        |
+----------------+----------------------------+------------------------+
| > **6.1**      | **6.1.a** The assessor     | Sensitive data must be |
| > Sensitive    | shall examine evidence to  | protected wherever it  |
| > data is      | confirm that protection    | is stored. In some     |
| > secured      | requirements for all       | cases, the integrity   |
| > anywhere it  | sensitive data are         | may be the primary     |
| > is stored.   | defined, including         | concern. In other      |
|                | requirements for rendering | cases, it may be the   |
|                | sensitive data with        | confidentiality of the |
|                | confidentiality            | sensitive data that    |
|                | considerations unreadable  | must be protected.     |
|                | anywhere it is stored      | Sometimes, both the    |
|                | persistently.              | integrity and          |
|                |                            | confidentiality must   |
|                |                            | be secured. The type   |
|                |                            | of data and the        |
|                |                            | purpose for which it   |
|                |                            | is generated will      |
|                |                            | often determine the    |
|                |                            | need for integrity or  |
|                |                            | confidentiality        |
|                |                            | protection. In all     |
|                |                            | cases, those           |
|                |                            | protection             |
|                |                            | requirements must be   |
|                |                            | clearly defined.       |
|                |                            |                        |
|                |                            | In cases where the     |
|                |                            | confidentiality of     |
|                |                            | sensitive data is a    |
|                |                            | concern, it is         |
|                |                            | imperative to know     |
|                |                            | where and for how long |
|                |                            | the data is retained.  |
|                |                            | The vendor must have   |
|                |                            | details of all         |
|                |                            | locations where the    |
|                |                            | software may store     |
|                |                            | sensitive data,        |
|                |                            | including in any       |
|                |                            | underlying software or |
|                |                            | systems, and           |
|                |                            | documentation          |
|                |                            | detailing the security |
|                |                            | controls used to       |
|                |                            | protect the data.      |
|                |                            |                        |
|                |                            | Sensitive data         |
|                |                            | requiring              |
|                |                            | confidentiality        |
|                |                            | protection, when       |
|                |                            | stored persistently,   |
|                |                            | must be protected to   |
|                |                            | prevent malicious or   |
|                |                            | accidental access.     |
|                |                            | Examples of methods to |
|                |                            | render sensitive data  |
|                |                            | unreadable include     |
|                |                            | usage of a one-way     |
|                |                            | hash or the use of     |
|                |                            | strong cryptography    |
|                |                            | with associated        |
|                |                            | key-management         |
|                |                            | processes.             |
|                |                            |                        |
|                |                            | > *(continued on next  |
|                |                            | > page)*               |
+----------------+----------------------------+------------------------+
|                | **6.1.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that security      |                        |
|                | controls are implemented   |                        |
|                | to protect sensitive data  |                        |
|                | during storage and that    |                        |
|                | they address all defined   |                        |
|                | protection requirements    |                        |
|                | and identified attack      |                        |
|                | scenarios.                 |                        |
|                |                            |                        |
|                | ***Note:** The assessor    |                        |
|                | should refer to evidence   |                        |
|                | obtained in the testing of |                        |
|                | Control Objective 1.1 to   |                        |
|                | determine all sensitive    |                        |
|                | data retained by the       |                        |
|                | software, and Control      |                        |
|                | Objective 4.1 to identify  |                        |
|                | all attack scenarios       |                        |
|                | applicable to the          |                        |
|                | software.*                 |                        |
+----------------+----------------------------+------------------------+
|                | **6.1.c** Where            |                        |
|                | cryptography is used for   |                        |
|                | securing sensitive data,   |                        |
|                | the assessor shall examine |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | methods implementing       |                        |
|                | cryptography for securing  |                        |
|                | sensitive data comply with |                        |
|                | Control Objective 7.       |                        |
+----------------+----------------------------+------------------------+
|                | **6.1.d** Where index      |                        |
|                | tokens are used for        |                        |
|                | securing sensitive data,   |                        |
|                | the assessor shall examine |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | these are generated in a   |                        |
|                | way that ensures there is  |                        |
|                | no correlation between the |                        |
|                | value and the sensitive    |                        |
|                | data that is being         |                        |
|                | referenced (without access |                        |
|                | to the software to perform |                        |
|                | the correlation as part of |                        |
|                | a formally defined and     |                        |
|                | assessed feature of that   |                        |
|                | software, such as          |                        |
|                | "de-tokenization").        |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    |                            |                        |
| > Objectives   |                            |                        |
| > Test         |                            |                        |
| > Requirements |                            |                        |
| > Guidance**   |                            |                        |
+================+============================+========================+
|                | **6.1.e** Where protection | Where the integrity of |
|                | methods rely on the        | sensitive data is a    |
|                | security properties of the | concern, strong        |
|                | execution environment, the | cryptography with      |
|                | assessor shall examine     | appropriate            |
|                | evidence and test the      | key-management         |
|                | software to confirm that   | practices is one       |
|                | these security properties  | method that could be   |
|                | are valid for all          | used to satisfy        |
|                | platforms where the        | integrity protection   |
|                | software is intended to be | requirements during    |
|                | deployed.                  | storage.               |
+----------------+----------------------------+------------------------+
|                | **6.1.f** Where protection |                        |
|                | methods rely on the        |                        |
|                | security properties of     |                        |
|                | third-party software, the  |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | there are no unmitigated   |                        |
|                | vulnerabilities or issues  |                        |
|                | with the software          |                        |
|                | providing the security     |                        |
|                | properties.                |                        |
+----------------+----------------------------+------------------------+
| > **6.2**      | **6.2.a** The assessor     | To prevent malicious   |
| > Sensitive    | shall examine evidence to  | individuals from       |
| > data is      | identify the locations     | intercepting or        |
| > secured      | within the software where  | diverting sensitive    |
| > during       | sensitive data is          | data while in transit, |
| >              | transmitted outside of the | it must be protected   |
|  transmission. | physical execution         | during transmission.   |
|                | environment and to confirm |                        |
|                | protection requirements    | One method to protect  |
|                | for the transmission of    | sensitive data in      |
|                | all sensitive data are     | transit is to encrypt  |
|                | defined.                   | it using strong        |
|                |                            | cryptography prior to  |
|                |                            | transmission.          |
|                |                            |                        |
|                |                            | Alternatively, the     |
|                |                            | software could         |
|                |                            | establish an           |
|                |                            | authenticated and      |
|                |                            | encrypted channel      |
|                |                            | using only trusted     |
|                |                            | keys and certificates  |
|                |                            | (for authentication)   |
|                |                            | and appropriate        |
|                |                            | encryption strength    |
|                |                            | for the selected       |
|                |                            | protocols.             |
+----------------+----------------------------+------------------------+
|                | **6.2.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that for each of   |                        |
|                | the ingress and egress     |                        |
|                | methods that allow for     |                        |
|                | transmission of sensitive  |                        |
|                | data outside of the        |                        |
|                | physical execution         |                        |
|                | environment, the data is   |                        |
|                | encrypted with strong      |                        |
|                | cryptography prior to      |                        |
|                | transmission or is         |                        |
|                | transmitted over an        |                        |
|                | encrypted channel using    |                        |
|                | strong cryptography.       |                        |
|                |                            |                        |
|                | ***Note:** The assessor    |                        |
|                | should refer to evidence   |                        |
|                | obtained in the testing of |                        |
|                | Control Objective 1.1 to   |                        |
|                | determine the sensitive    |                        |
|                | data stored, processed, or |                        |
|                | transmitted by the         |                        |
|                | software.*                 |                        |
+----------------+----------------------------+------------------------+
|                | **6.2.c** Where            |                        |
|                | third-party or             |                        |
|                | execution-environment      |                        |
|                | features are relied upon   |                        |
|                | for the security of the    |                        |
|                | transmitted data, the      |                        |
|                | assessor shall examine     |                        |
|                | evidence to confirm that   |                        |
|                | guidance on how to         |                        |
|                | configure such features is |                        |
|                | provided to stakeholders   |                        |
|                | in accordance with Control |                        |
|                | Objective 12.1.            |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    |                            |                        |
| > Objectives   |                            |                        |
| > Test         |                            |                        |
| > Requirements |                            |                        |
| > Guidance**   |                            |                        |
+================+============================+========================+
|                | **6.2.d** Where transport  |                        |
|                | layer encryption is used   |                        |
|                | to secure the transmission |                        |
|                | of sensitive data, the     |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | all ingress and egress     |                        |
|                | methods enforce a secure   |                        |
|                | version of the protocol    |                        |
|                | with end-point             |                        |
|                | authentication prior to    |                        |
|                | transmission.              |                        |
+----------------+----------------------------+------------------------+
|                | **6.2.e** Where the        |                        |
|                | methods implemented for    |                        |
|                | encrypting sensitive data  |                        |
|                | allow for the use of       |                        |
|                | different types of         |                        |
|                | cryptography or different  |                        |
|                | levels of security, the    |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software, including        |                        |
|                | capturing software         |                        |
|                | transmissions, to confirm  |                        |
|                | the software enforces the  |                        |
|                | use of strong cryptography |                        |
|                | at all times during        |                        |
|                | transmission.              |                        |
+----------------+----------------------------+------------------------+
| > **6.3** Use  | **6.3.a** Where            | Wherever cryptography  |
| > of           | cryptography is relied     | is used to meet        |
| > cryptography | upon (in whole or in part) | software security      |
| > meets all    | for the security of        | requirements in this   |
| > applicable   | critical assets, the       | standard, it must be   |
| > cryptography | assessor shall examine     | done in accordance     |
| > requirements | evidence and test the      | with the specific      |
| > within this  | software to confirm that   | security requirements  |
| > standard.    | the use of cryptography is | related to the use of  |
|                | compliant to Control       | cryptography           |
|                | Objective 7.               | (including those in    |
|                |                            | Control Objective 7).  |
|                | ***Note:** The assessor    |                        |
|                | should refer to Control    | For example, storing a |
|                | Objective 7 to identify    | cryptographic key used |
|                | all requirements for       | for protecting         |
|                | appropriate and correct    | sensitive data in a    |
|                | implementation of          | plaintext file would   |
|                | cryptography.*             | not be considered      |
|                |                            | sufficient security    |
|                |                            | unless additional      |
|                |                            | controls are           |
|                |                            | implemented to prevent |
|                |                            | the file containing    |
|                |                            | the cryptographic key  |
|                |                            | from being accessed or |
|                |                            | modified by, or        |
|                |                            | exposed to             |
|                |                            | unauthorized parties.  |
|                |                            |                        |
|                |                            | Further guidance on    |
|                |                            | appropriate uses of    |
|                |                            | cryptographic          |
|                |                            | algorithms can be      |
|                |                            | found in current       |
|                |                            | versions of *NIST SP   |
|                |                            | 800-175* or in other   |
|                |                            | related industry       |
|                |                            | guidance from ISO or   |
|                |                            | ANSI.                  |
+----------------+----------------------------+------------------------+
|                | **6.3.b** Where            |                        |
|                | cryptographic methods      |                        |
|                | provided by third-party    |                        |
|                | software or aspects of the |                        |
|                | execution environment or   |                        |
|                | platform on which the      |                        |
|                | application is run are     |                        |
|                | relied upon for the        |                        |
|                | protection of sensitive    |                        |
|                | data, the assessor shall   |                        |
|                | examine evidence and test  |                        |
|                | the software to confirm    |                        |
|                | that guidance on           |                        |
|                | configuring these methods  |                        |
|                | during the installation,   |                        |
|                | initialization, or first   |                        |
|                | use of the software is     |                        |
|                | provided to stakeholders   |                        |
|                | in accordance with Control |                        |
|                | Objective 12.1.            |                        |
+----------------+----------------------------+------------------------+
|                | **6.3.c** Where asymmetric |                        |
|                | cryptography such as RSA   |                        |
|                | or ECC is used for         |                        |
|                | protecting the             |                        |
|                | confidentiality of         |                        |
|                | sensitive data, the        |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | private keys are not used  |                        |
|                | for providing              |                        |
|                | confidentiality protection |                        |
|                | to the data.               |                        |
+----------------+----------------------------+------------------------+

+---+---------------+----------------------------+------------------------+
| > |               | > **Test Requirements**    | > **Guidance**         |
|   |               |                            |                        |
| * |               |                            |                        |
| * |               |                            |                        |
| C |               |                            |                        |
| o |               |                            |                        |
| n |               |                            |                        |
| t |               |                            |                        |
| r |               |                            |                        |
| o |               |                            |                        |
| l |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| O |               |                            |                        |
| b |               |                            |                        |
| j |               |                            |                        |
| e |               |                            |                        |
| c |               |                            |                        |
| t |               |                            |                        |
| i |               |                            |                        |
| v |               |                            |                        |
| e |               |                            |                        |
| s |               |                            |                        |
| * |               |                            |                        |
| * |               |                            |                        |
+===+===============+============================+========================+
|   | > []          |                            |                        |
|   | {#_bookmark24 |                            |                        |
|   | > .anc        |                            |                        |
|   | hor}**Control |                            |                        |
|   | > Objective   |                            |                        |
|   | > 7: Use of   |                            |                        |
|   | > C           |                            |                        |
|   | ryptography** |                            |                        |
|   | >             |                            |                        |
|   | >             |                            |                        |
|   |  Cryptography |                            |                        |
|   | > is used     |                            |                        |
|   | >             |                            |                        |
|   | appropriately |                            |                        |
|   | > and         |                            |                        |
|   | > correctly.  |                            |                        |
+---+---------------+----------------------------+------------------------+
| > |               | **7.1.a** The assessor     | Not all cryptographic  |
|   |               | shall examine evidence to  | algorithms are         |
| * |               | determine how cryptography | sufficient to protect  |
| * |               | is used for the protection | sensitive data. It is  |
| 7 |               | of critical assets and to  | a well-established     |
| . |               | confirm that:              | principle in software  |
| 1 |               |                            | security to utilize    |
| * |               | -   Industry-standard      | only recognized        |
| * |               |     > cryptographic        | cryptographic          |
| > |               |     > algorithms and modes | implementations based  |
|   |               |     > of operation are     | on current,            |
| I |               |     > used.                | industry-accepted      |
| n |               |                            | standards such as      |
| d |               | -   The use of any other   | those from industry    |
| u |               |     > algorithms is in     | bodies like NIST,      |
| s |               |     > conjunction with     | ANSI, ISO, and EMVCo.  |
| t |               |     > industry-standard    |                        |
| r |               |     > algorithms.          | The use of proprietary |
| y |               |                            | cryptographic          |
| - |               | -   The implementation of  | implementations may    |
| s |               |     > non-standard         | increase the risk of   |
| t |               |     > algorithms does not  | data compromise as     |
| a |               |     > reduce the           | proprietary            |
| n |               |     > equivalent           | implementations are    |
| d |               |     > cryptographic key    | often not subjected to |
| a |               |     > strength provided by | the same level of      |
| r |               |     > the                  | testing that           |
| d |               |     > industry-standard    | industry-accepted      |
| > |               |     > algorithms.          | implementations have   |
|   |               |                            | undergone. Only those  |
| c |               |                            | implementations that   |
| r |               |                            | have been subjected to |
| y |               |                            | sufficient testing     |
| p |               |                            | (for example, by NIST, |
| t |               |                            | ANSI, or other         |
| o |               |                            | recognized industry    |
| g |               |                            | bodies) should be      |
| r |               |                            | used.                  |
| a |               |                            |                        |
| p |               |                            |                        |
| h |               |                            |                        |
| i |               |                            |                        |
| c |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| l |               |                            |                        |
| g |               |                            |                        |
| o |               |                            |                        |
| r |               |                            |                        |
| i |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| m |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| m |               |                            |                        |
| e |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| o |               |                            |                        |
| d |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| u |               |                            |                        |
| s |               |                            |                        |
| e |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| f |               |                            |                        |
| o |               |                            |                        |
| r |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| s |               |                            |                        |
| e |               |                            |                        |
| c |               |                            |                        |
| u |               |                            |                        |
| r |               |                            |                        |
| i |               |                            |                        |
| n |               |                            |                        |
| g |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| c |               |                            |                        |
| r |               |                            |                        |
| i |               |                            |                        |
| t |               |                            |                        |
| i |               |                            |                        |
| c |               |                            |                        |
| a |               |                            |                        |
| l |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| s |               |                            |                        |
| s |               |                            |                        |
| e |               |                            |                        |
| t |               |                            |                        |
| s |               |                            |                        |
| . |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| I |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| u |               |                            |                        |
| s |               |                            |                        |
| t |               |                            |                        |
| r |               |                            |                        |
| y |               |                            |                        |
| - |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| s |               |                            |                        |
| t |               |                            |                        |
| a |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| c |               |                            |                        |
| r |               |                            |                        |
| y |               |                            |                        |
| p |               |                            |                        |
| t |               |                            |                        |
| o |               |                            |                        |
| g |               |                            |                        |
| r |               |                            |                        |
| a |               |                            |                        |
| p |               |                            |                        |
| h |               |                            |                        |
| i |               |                            |                        |
| c |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| l |               |                            |                        |
| g |               |                            |                        |
| o |               |                            |                        |
| r |               |                            |                        |
| i |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| m |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| m |               |                            |                        |
| e |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| o |               |                            |                        |
| d |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| o |               |                            |                        |
| s |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| r |               |                            |                        |
| e |               |                            |                        |
| c |               |                            |                        |
| o |               |                            |                        |
| g |               |                            |                        |
| n |               |                            |                        |
| i |               |                            |                        |
| z |               |                            |                        |
| e |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| b |               |                            |                        |
| y |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| i |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| u |               |                            |                        |
| s |               |                            |                        |
| t |               |                            |                        |
| r |               |                            |                        |
| y |               |                            |                        |
| - |               |                            |                        |
| a |               |                            |                        |
| c |               |                            |                        |
| c |               |                            |                        |
| e |               |                            |                        |
| p |               |                            |                        |
| t |               |                            |                        |
| e |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| s |               |                            |                        |
| t |               |                            |                        |
| a |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| d |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| b |               |                            |                        |
| o |               |                            |                        |
| d |               |                            |                        |
| i |               |                            |                        |
| e |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| s |               |                            |                        |
| u |               |                            |                        |
| c |               |                            |                        |
| h |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| N |               |                            |                        |
| I |               |                            |                        |
| S |               |                            |                        |
| T |               |                            |                        |
| , |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| A |               |                            |                        |
| N |               |                            |                        |
| S |               |                            |                        |
| I |               |                            |                        |
| , |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| I |               |                            |                        |
| S |               |                            |                        |
| O |               |                            |                        |
| , |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| E |               |                            |                        |
| M |               |                            |                        |
| V |               |                            |                        |
| C |               |                            |                        |
| o |               |                            |                        |
| . |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| C |               |                            |                        |
| r |               |                            |                        |
| y |               |                            |                        |
| p |               |                            |                        |
| t |               |                            |                        |
| o |               |                            |                        |
| g |               |                            |                        |
| r |               |                            |                        |
| a |               |                            |                        |
| p |               |                            |                        |
| h |               |                            |                        |
| i |               |                            |                        |
| c |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| l |               |                            |                        |
| g |               |                            |                        |
| o |               |                            |                        |
| r |               |                            |                        |
| i |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| m |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| n |               |                            |                        |
| d |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| p |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| a |               |                            |                        |
| m |               |                            |                        |
| e |               |                            |                        |
| t |               |                            |                        |
| e |               |                            |                        |
| r |               |                            |                        |
| s |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| t |               |                            |                        |
| h |               |                            |                        |
| a |               |                            |                        |
| t |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| k |               |                            |                        |
| n |               |                            |                        |
| o |               |                            |                        |
| w |               |                            |                        |
| n |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| t |               |                            |                        |
| o |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| b |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| v |               |                            |                        |
| u |               |                            |                        |
| l |               |                            |                        |
| n |               |                            |                        |
| e |               |                            |                        |
| r |               |                            |                        |
| a |               |                            |                        |
| b |               |                            |                        |
| l |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| a |               |                            |                        |
| r |               |                            |                        |
| e |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| n |               |                            |                        |
| o |               |                            |                        |
| t |               |                            |                        |
| > |               |                            |                        |
|   |               |                            |                        |
| u |               |                            |                        |
| s |               |                            |                        |
| e |               |                            |                        |
| d |               |                            |                        |
| . |               |                            |                        |
+---+---------------+----------------------------+------------------------+
|   |               | **7.1.b** The assessor     |                        |
|   |               | shall examine evidence,    |                        |
|   |               | including the vendor       |                        |
|   |               | threat information         |                        |
|   |               | obtained in Test           |                        |
|   |               | Requirement 4.1.a, and     |                        |
|   |               | test the software to       |                        |
|   |               | confirm that:              |                        |
|   |               |                            |                        |
|   |               | -   Only documented        |                        |
|   |               |     > cryptographic        |                        |
|   |               |     > algorithms and modes |                        |
|   |               |     > of operation are     |                        |
|   |               |     > used in the          |                        |
|   |               |     > software, and        |                        |
|   |               |                            |                        |
|   |               | -   Protection methods are |                        |
|   |               |     > implemented to       |                        |
|   |               |     > mitigate common      |                        |
|   |               |     > attacks on           |                        |
|   |               |     > cryptographic        |                        |
|   |               |     > implementations (for |                        |
|   |               |     > example, the use of  |                        |
|   |               |     > the software as a    |                        |
|   |               |     > decryption oracle,   |                        |
|   |               |     > brute-force or       |                        |
|   |               |     > dictionary attacks   |                        |
|   |               |     > against the input    |                        |
|   |               |     > domain of the        |                        |
|   |               |     > sensitive data, the  |                        |
|   |               |     > re-use of security   |                        |
|   |               |     > parameters such as   |                        |
|   |               |     > IVs, or the          |                        |
|   |               |     > re-encryption of     |                        |
|   |               |     > multiple datasets    |                        |
|   |               |     > using linearly       |                        |
|   |               |     > applied key values,  |                        |
|   |               |     > such as XOR'd key    |                        |
|   |               |     > values in stream     |                        |
|   |               |     > ciphers or           |                        |
|   |               |                            |                        |
|   |               | > one-time pads).          |                        |
+---+---------------+----------------------------+------------------------+
|   |               | **7.1.c** Where            |                        |
|   |               | cryptographic              |                        |
|   |               | implementations require a  |                        |
|   |               | unique value per           |                        |
|   |               | encryption operation or    |                        |
|   |               | session, the assessor      |                        |
|   |               | shall examine evidence and |                        |
|   |               | test the software to       |                        |
|   |               | confirm that the           |                        |
|   |               | cryptographic              |                        |
|   |               | implementations do not     |                        |
|   |               | expose vulnerabilities.    |                        |
|   |               | For example, this may      |                        |
|   |               | include the use of a       |                        |
|   |               | unique IV for a stream     |                        |
|   |               | cipher mode of operation   |                        |
|   |               | or a unique and random "k" |                        |
|   |               | value for a digital        |                        |
|   |               | signature.                 |                        |
+---+---------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **7.1.d** Where padding is |                        |
|                | used prior to or during    |                        |
|                | encryption, the assessor   |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that the           |                        |
|                | encryption operation       |                        |
|                | always incorporates an     |                        |
|                | industry-accepted standard |                        |
|                | padding method.            |                        |
+----------------+----------------------------+------------------------+
|                | **7.1.e** Where hash       |                        |
|                | functions are used to      |                        |
|                | protect sensitive data,    |                        |
|                | the assessor shall examine |                        |
|                | evidence and test the      |                        |
|                | software to confirm that:  |                        |
|                |                            |                        |
|                | -   Only approved,         |                        |
|                |     > collision-resistant  |                        |
|                |     > hash algorithms and  |                        |
|                |     > methods are used for |                        |
|                |     > this purpose, and    |                        |
|                |                            |                        |
|                | -   A salt value of        |                        |
|                |     > appropriate strength |                        |
|                |     > that is generated    |                        |
|                |     > using a secure       |                        |
|                |     > random number        |                        |
|                |     > generator is used to |                        |
|                |     > ensure the resultant |                        |
|                |     > hash has sufficient  |                        |
|                |     > entropy.             |                        |
|                |                            |                        |
|                | ***Note:** The assessor    |                        |
|                | should refer to Control    |                        |
|                | Objective 7.3 for more     |                        |
|                | information on secure      |                        |
|                | random number generators.* |                        |
+----------------+----------------------------+------------------------+
| > **7.2** The  | **7.2.a** The assessor     | Whether implemented    |
| > software     | shall examine evidence to  | within or outside the  |
| > supports     | confirm that information   | software, the manner   |
| > industry-    | is maintained that         | in which cryptographic |
| > standard key | describes the following    | keys are managed is a  |
| > management   | for each key specified in  | critical part of the   |
| > processes    | the inventory:             | continued security of  |
| > and          |                            | payment software and   |
| > procedures.  | -   Key label or name      | the sensitive data it  |
| > Industry-    |                            | handles.               |
| > standard key | -   Key location           |                        |
| > management   |                            | While cryptographic    |
| > processes    | -   Effective date         | key management         |
| > and          |                            | processes are often    |
| > procedures   | -   Expiration date        | implemented as         |
| > are those    |                            | operational            |
| > recognized   | -   Key purpose/type       | procedures, the        |
| > by industry  |                            | software should        |
| > standards    | -   Key generation         | support secure         |
| > bodies, such |     > method/algorithm     | key-management         |
| > as NIST,     |     > used                 | practices based on     |
| > ANSI, and    |                            | industry standards or  |
| > ISO.         | -   Key length             | best practices.        |
|                |                            |                        |
|                |                            | > *(continued on next  |
|                |                            | > page)*               |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **7.2.b** The assessor     | Industry-standard key  |
|                | shall examine evidence and | management practices   |
|                | test the software to       | should be applied to   |
|                | validate the evidence      | the following:         |
|                | examined in Test           |                        |
|                | Requirement                | -   The generation of  |
|                |                            |     > strong           |
|                | 7.2.a and to confirm that: |     > cryptographic    |
|                |                            |     > keys.            |
|                | -   All cryptographic keys |                        |
|                |     > that are used for    | -   Secure             |
|                |     > providing security   |     > cryptographic    |
|                |     > to critical assets   |     > key              |
|                |     > (confidentiality,    |     > distribution.    |
|                |     > integrity, and       |                        |
|                |     > authenticity) and    | -   Secure             |
|                |     > other security       |     > cryptographic    |
|                |     > services to the      |     > key storage.     |
|                |     > software have a      |                        |
|                |     > unique purpose, and  | -   Cryptographic key  |
|                |     > that no key is used  |     > changes for keys |
|                |     > for both encryption  |     > that have        |
|                |     > and authentication   |     > reached the end  |
|                |     > operations.          |     > of their         |
|                |                            |     > cryptoperiod.    |
|                | -   All keys have defined  |                        |
|                |     > generation methods,  | -   The retirement or  |
|                |     > and no secret or     |     > replacement of   |
|                |     > private              |     > keys.            |
|                |     > cryptographic keys   |                        |
|                |     > relied upon for      | -   The enforcement of |
|                |     > security of critical |     > split knowledge  |
|                |     > assets are shared    |     > and dual control |
|                |     > between software     |     > (when the        |
|                |     > instances, except    |     > software         |
|                |     > when a common secret |     > supports manual  |
|                |     > or private key is    |     > clear-text       |
|                |     > used for securing    |     > cryptographic    |
|                |     > the storage of other |     > key-management   |
|                |     > cryptographic keys   |     > operations).     |
|                |     > that are generated   |                        |
|                |     > during the           | -   The prevention of  |
|                |     > installation,        |     > unauthorized     |
|                |     > initialization, or   |     > substitution of  |
|                |     > first use of the     |     > cryptographic    |
|                |     > software (for        |     > keys.            |
|                |     > example, white-box   |                        |
|                |     > cryptography).       | -   The implementation |
|                |                            |     > of a mechanism   |
|                | -   All cryptographic keys |     > to render        |
|                |     > have an equivalent   |     > irretrievable    |
|                |     > bit strength of at   |     > any              |
|                |     > least 128 bits in    |     > cryptographic    |
|                |     > accordance with      |     > key material or  |
|                |     > industry standards.  |     > cryptogram       |
|                |                            |     > stored by the    |
|                | -   All keys have a        |     > payment          |
|                |     > defined cryptoperiod |     > software.        |
|                |     > aligned with         |                        |
|                |     > industry standards,  | This requirement       |
|                |     > and methods are      | applies to keys used   |
|                |     > implemented to       | to encrypt sensitive   |
|                |     > retire and/or update | data and any           |
|                |     > each key at the end  | respective             |
|                |     > of the defined       | key-encrypting keys.   |
|                |     > cryptoperiod.        |                        |
|                |                            |                        |
|                | -   The integrity and      |                        |
|                |     > confidentiality of   |                        |
|                |     > all secret and       |                        |
|                |     > private              |                        |
|                |     > cryptographic keys   |                        |
|                |     > managed by the       |                        |
|                |     > software are         |                        |
|                |     > protected when       |                        |
|                |     > stored (for example, |                        |
|                |     > encrypted with a     |                        |
|                |     > key-encrypting key   |                        |
|                |     > that is at least as  |                        |
|                |     > strong as the        |                        |
|                |     > data-encrypting key  |                        |
|                |     > and is stored        |                        |
|                |     > separately from the  |                        |
|                |     > data-encrypting key, |                        |
|                |     > or as at least two   |                        |
|                |     > full-length key      |                        |
|                |     > components or key    |                        |
|                |     > shares, in           |                        |
|                |     > accordance with an   |                        |
|                |     > industry-accepted    |                        |
|                |     > method).             |                        |
|                |                            |                        |
|                | -   All keys have a        |                        |
|                |     > defined generation   |                        |
|                |     > or injection         |                        |
|                |     > process, and this    |                        |
|                |     > process ensures      |                        |
|                |     > sufficient entropy   |                        |
|                |     > for the key.         |                        |
|                |                            |                        |
|                | -   All key-generation     |                        |
|                |     > functions must       |                        |
|                |     > implement one-way    |                        |
|                |     > functions or other   |                        |
|                |     > irreversible         |                        |
|                |     > key-generation       |                        |
|                |     > processes, and no    |                        |
|                |     > reversible key       |                        |
|                |     > calculation modes    |                        |
|                |     > (such as key         |                        |
|                |     > variants) are used   |                        |
|                |     > to directly create   |                        |
|                |     > new keys from an     |                        |
|                |     > existing key.        |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **7.2.c** Where            |                        |
|                | cryptography is used to    |                        |
|                | protect a key, the         |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | security is not provided   |                        |
|                | to any key by a key of     |                        |
|                | lesser strength (for       |                        |
|                | example, by encrypting a   |                        |
|                | 256-bit AES key with a     |                        |
|                | 128-bit AES key).          |                        |
+----------------+----------------------------+------------------------+
|                | **7.2.d** Where public     |                        |
|                | keys are used by the       |                        |
|                | system, the assessor shall |                        |
|                | examine evidence and test  |                        |
|                | the software to confirm    |                        |
|                | that the authenticity of   |                        |
|                | all public keys is         |                        |
|                | preserved.                 |                        |
+----------------+----------------------------+------------------------+
|                | **7.2.e** Where public or  |                        |
|                | white-box keys are not     |                        |
|                | unique per software        |                        |
|                | instantiation the assessor |                        |
|                | shall examine evidence to  |                        |
|                | confirm that methods and   |                        |
|                | procedures to revoke       |                        |
|                | and/or replace such keys   |                        |
|                | (or key pairs) exist.      |                        |
+----------------+----------------------------+------------------------+
|                | **7.2.f** Where the        |                        |
|                | software relies upon       |                        |
|                | external files or other    |                        |
|                | data elements for key      |                        |
|                | material, such as for      |                        |
|                | public TLS certificates,   |                        |
|                | the assessor shall examine |                        |
|                | evidence to confirm that   |                        |
|                | guidance on how to install |                        |
|                | such key material,         |                        |
|                | including details noting   |                        |
|                | any security requirements  |                        |
|                | for such key material, is  |                        |
|                | provided to stakeholders   |                        |
|                | in accordance with Control |                        |
|                | Objective 12.1.            |                        |
+----------------+----------------------------+------------------------+
|                | **7.2.g** Where public     |                        |
|                | keys are manually loaded   |                        |
|                | or used as root keys, the  |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | the keys are installed and |                        |
|                | stored in a way that       |                        |
|                | provides dual control (to  |                        |
|                | a level that is feasible   |                        |
|                | for the execution          |                        |
|                | environment), preventing a |                        |
|                | single user from replacing |                        |
|                | a key to enable a          |                        |
|                | man-in-the-middle attack   |                        |
|                | or the allow for           |                        |
|                | unauthorized decryption of |                        |
|                | stored data. Where         |                        |
|                | complete dual control is   |                        |
|                | not feasible (for example, |                        |
|                | due to a limitation of the |                        |
|                | execution environment),    |                        |
|                | the assessor shall confirm |                        |
|                | that the methods           |                        |
|                | implemented are            |                        |
|                | appropriate to protect the |                        |
|                | public keys.               |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **7.2.h** The assessor     |                        |
|                | shall examine evidence to  |                        |
|                | confirm that secret and/or |                        |
|                | private keys are managed   |                        |
|                | in a way that ensures      |                        |
|                | split knowledge over the   |                        |
|                | key to a level that is     |                        |
|                | feasible given the         |                        |
|                | platform on which the      |                        |
|                | software is executed.      |                        |
|                | Where absolute split       |                        |
|                | knowledge is not feasible, |                        |
|                | the assessor shall confirm |                        |
|                | that the methods           |                        |
|                | implemented are reasonable |                        |
|                | to protect secrets and/or  |                        |
|                | private keys.              |                        |
+----------------+----------------------------+------------------------+
| > **7.3** All  | **7.3.a** The assessor     | Random numbers are     |
| > random       | shall examine evidence and | often used with        |
| > numbers used | test the software to       | cryptography to        |
| > by the       | identify all random number | protect sensitive      |
| > software are | generators used by the     | information.           |
| > generated    | software and to confirm    | Encryption keys and    |
| > using only   | that all random number     | initialization values  |
| > ind          | generation methods:        | (seeds) are examples   |
| ustry-standard |                            | of implementations in  |
| > random       | -   Use at least 128 bits  | which random numbers   |
| > number       |     > of entropy prior to  | are required.          |
| > generation   |     > the output of any    |                        |
| > (RNG)        |     > random numbers.      | It is not a trivial    |
| > algorithms   |                            | endeavor to design and |
| > or           | -   Ensure it is not       | implement a secure     |
| > libraries.   |     > possible for the     | random number          |
| > Ind          |     > system to provide or | generator. Software    |
| ustry-standard |     > produce reduced      | vendors are required   |
| > RNG          |     > entropy upon         | to use only approved   |
| > algorithms   |     > start-up or entry of | random number          |
| > or libraries |     > other predictable    | generation algorithms  |
| > are those    |     > states of the        | and libraries or       |
| > that meet    |     > system.              | provide evidence to    |
| > industry     |                            | illustrate how the     |
| > standards    |                            | random number          |
| > for          |                            | generation algorithms  |
| > sufficient   |                            | and libraries were     |
| > un           |                            | tested to confirm that |
| predictability |                            | random numbers         |
| > (for         |                            | generated are          |
| > example,     |                            | sufficiently           |
| > *NIST        |                            | unpredictable.         |
| > Special      |                            |                        |
| > Publication  |                            | The implementation may |
| > 800-22*).    |                            | rely on either a       |
|                |                            | validated              |
|                |                            | cryptographic library  |
|                |                            | or module. The         |
|                |                            | software vendor should |
|                |                            | have a good            |
|                |                            | understanding of the   |
|                |                            | installation,          |
|                |                            | initialization,        |
|                |                            | configuration, and     |
|                |                            | usage (for example,    |
|                |                            | initial seeding of the |
|                |                            | random function) of    |
|                |                            | the RNG mechanisms to  |
|                |                            | ensure that the        |
|                |                            | implementation can     |
|                |                            | meet the effective     |
|                |                            | security strength      |
|                |                            | required for the       |
|                |                            | intended use.          |
+----------------+----------------------------+------------------------+
|                | **7.3.b** Where            |                        |
|                | third-party software,      |                        |
|                | platforms, or libraries    |                        |
|                | are used for all or part   |                        |
|                | of the random number       |                        |
|                | generation process, the    |                        |
|                | assessor shall examine     |                        |
|                | evidence (such as current  |                        |
|                | publicly available         |                        |
|                | literature) to confirm     |                        |
|                | that the third-party       |                        |
|                | software does not expose   |                        |
|                | any vulnerabilities that   |                        |
|                | may compromise its use for |                        |
|                | generating random values.  |                        |
+----------------+----------------------------+------------------------+
|                | **7.3.c** Where the        |                        |
|                | software vendor relies on  |                        |
|                | a previous assessment of   |                        |
|                | the random number          |                        |
|                | generator or source of     |                        |
|                | initial entropy, the       |                        |
|                | assessor shall examine     |                        |
|                | evidence (such as the      |                        |
|                | approval records of the    |                        |
|                | previous assessment) to    |                        |
|                | confirm that this scheme   |                        |
|                | and specific approval      |                        |
|                | include the correct areas  |                        |
|                | of the software in the     |                        |
|                | scope of its assessment,   |                        |
|                | and that the vendor claims |                        |
|                | do not exceed the scope of |                        |
|                | the evaluation or approval |                        |
|                | of that software. For      |                        |
|                | example, some              |                        |
|                | cryptographic              |                        |
|                | implementations approved   |                        |
|                | under FIPS 140-2 or 140-3  |                        |
|                | require seeding from an    |                        |
|                | external entropy source to |                        |
|                | correctly output random    |                        |
|                | data.                      |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **7.3.d** Where the        |                        |
|                | software vendor does not   |                        |
|                | rely on a previous         |                        |
|                | assessment of the random   |                        |
|                | number generator or source |                        |
|                | of initial entropy, the    |                        |
|                | assessor shall test the    |                        |
|                | software to obtain 128MB   |                        |
|                | of data output from each   |                        |
|                | random number generator    |                        |
|                | implemented in the system  |                        |
|                | to confirm the lack of     |                        |
|                | statistical correlation in |                        |
|                | the output. This data may  |                        |
|                | be generated by the        |                        |
|                | assessor directly, or      |                        |
|                | supplied by the vendor,    |                        |
|                | but the assessor must      |                        |
|                | confirm that the           |                        |
|                | generation method          |                        |
|                | implemented ensures that   |                        |
|                | the data is produced as it |                        |
|                | would be produced by the   |                        |
|                | software during normal     |                        |
|                | operation.                 |                        |
|                |                            |                        |
|                | ***Note:** The assessor    |                        |
|                | can use the NIST           |                        |
|                | Statistical Test Suite to  |                        |
|                | identify statistical       |                        |
|                | correlation in the random  |                        |
|                | number generation          |                        |
|                | implementation.*           |                        |
+----------------+----------------------------+------------------------+
| > **7.4**      | **7.4.a** The assessor     | Entropy is the degree  |
| > Random       | shall examine evidence and | of randomness of a     |
| > values have  | test the software to       | random value           |
| > entropy that | confirm that the methods   | generator. The higher  |
| > meets the    | used for the generation of | the entropy, the less  |
| > minimum      | all cryptographic keys and | predictable the next   |
| > effective    | other material (such as    | value in a random      |
| > strength     | IVs, "k" values for        | number generator is    |
| > requirements | digital signatures, and so | likely to be.          |
| > of the       | on) have entropy that      |                        |
| >              | meets the minimum          | > *(continued on next  |
|  cryptographic | effective strength         | > page)*               |
| > primitives   | requirements of the        |                        |
| > and keys     | cryptographic primitives   |                        |
| > that rely on | and keys.                  |                        |
| > them.        |                            |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **7.4.b** Where            | Note that a            |
|                | cryptographic keys are     | non-deterministic      |
|                | generated through          | random number          |
|                | processes which require    | generator (NDRG) may   |
|                | direct user interaction,   | produce an output      |
|                | such as through the entry  | string that contains   |
|                | of a passphrase or the use | less entropy than      |
|                | of "random" user           | implied by the length  |
|                | interaction with the       | of the output. A       |
|                | software, the assessor     | deterministic random   |
|                | shall examine evidence and | number generator       |
|                | test the software to       | (DRNG) is dependent on |
|                | confirm that these         | the entropy of its     |
|                | processes are implemented  | seed value.            |
|                | in such a way that they    |                        |
|                | provide sufficient         |                        |
|                | entropy. Specifically, the |                        |
|                | assessor shall confirm     |                        |
|                | that:                      |                        |
|                |                            |                        |
|                | -   Methods used for       |                        |
|                |     > generating keys      |                        |
|                |     > directly from a      |                        |
|                |     > password/passphrase  |                        |
|                |     > enforce an input     |                        |
|                |     > domain that is able  |                        |
|                |     > to provide           |                        |
|                |     > sufficient entropy,  |                        |
|                |     > such that the total  |                        |
|                |     > possible inputs are  |                        |
|                |     > at least equal to    |                        |
|                |     > that of the          |                        |
|                |     > equivalent bit       |                        |
|                |     > strength of the key  |                        |
|                |     > being generated (for |                        |
|                |     > example, a 32-       |                        |
|                |     > hex-digit input      |                        |
|                |     > field for an AES128  |                        |
|                |     > key).                |                        |
|                |                            |                        |
|                | -   Passphrases are passed |                        |
|                |     > through an           |                        |
|                |     > industry-standard    |                        |
|                |     > key- derivation      |                        |
|                |     > function, such as    |                        |
|                |     > PBKDF2 or bcrypt,    |                        |
|                |     > which extends the    |                        |
|                |     > work factor for any  |                        |
|                |     > attempt to           |                        |
|                |     > brute-force a        |                        |
|                |     > passphrase value.    |                        |
|                |     > The assessor shall   |                        |
|                |     > confirm that a work  |                        |
|                |     > factor of at least   |                        |
|                |     > 10,000 is applied to |                        |
|                |     > any such             |                        |
|                |     > implementation.      |                        |
|                |                            |                        |
|                | -   Guidance is provided   |                        |
|                |     > to stakeholders in   |                        |
|                |     > accordance with      |                        |
|                |     > Control Objective    |                        |
|                |     > 12.1 that includes   |                        |
|                |     > instructions that    |                        |
|                |     > any passphrase used  |                        |
|                |     > must:                |                        |
|                |                            |                        |
|                |     -   Be randomly        |                        |
|                |         > generated itself |                        |
|                |         > using a valid    |                        |
|                |         > and secure       |                        |
|                |         > random process,  |                        |
|                |         > and that an      |                        |
|                |         > online random    |                        |
|                |         > number generator |                        |
|                |         > must not be used |                        |
|                |         > for this         |                        |
|                |         > purpose.         |                        |
|                |                            |                        |
|                |     -   Not be implemented |                        |
|                |         > by a single      |                        |
|                |         > person, such     |                        |
|                |         > that one person  |                        |
|                |         > has an advantage |                        |
|                |         > in recovering    |                        |
|                |         > the clear key    |                        |
|                |         > value, violating |                        |
|                |         > the requirements |                        |
|                |         > for split        |                        |
|                |         > knowledge.       |                        |
+----------------+----------------------------+------------------------+

### Secure Software Operations

> ***The software provides mechanisms to detect and alert on anomalous
> activity and to ensure user accountability.***

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark26 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 8: |                            |                        |
| > Activity     |                            |                        |
| > Tracking**   |                            |                        |
| >              |                            |                        |
| > All software |                            |                        |
| > activities   |                            |                        |
| > involving    |                            |                        |
| > critical     |                            |                        |
| > assets are   |                            |                        |
| > tracked.     |                            |                        |
+----------------+----------------------------+------------------------+
| > **8.1** All  | **8.1** The assessor shall | To ensure user         |
| > access       | examine evidence and test  | accountability and to  |
| > attempts and | the software to confirm    | support post- incident |
| > usage of     | that all access attempts   | forensic               |
| > critical     | and usage of critical      | investigation, payment |
| > assets are   | assets are tracked and     | software should        |
| > tracked and  | traceable to a unique      | capture and maintain   |
| > traceable to | individual, system, or     | historical records of  |
| > a unique     | entity.                    | all software           |
| > user.        |                            | activities involving   |
| >              |                            | critical assets and    |
| > ***Note:**   |                            | ensure that all such   |
| > This Secure  |                            | activities are         |
| > Software     |                            | traceable to a unique  |
| > Standard     |                            | user (for example, a   |
| > recognizes   |                            | person, system, or     |
| > that some    |                            | other entity).         |
| > execution    |                            |                        |
| > environments |                            | Examples of activities |
| > cannot       |                            | that the software      |
| > support the  |                            | should record include: |
| > detailed     |                            |                        |
| > logging      |                            | -   All individual     |
| > requirements |                            |     > user attempts to |
| > in other PCI |                            |     > access sensitive |
| > standards.   |                            |     > data or          |
| > Therefore,   |                            |     > resources.       |
| > the term*    |                            |                        |
| >              |                            | -   Usage of or        |
| > *"activity   |                            |     > changes to       |
| > tracking" is |                            |     > sensitive        |
| > used here to |                            |     > functions, such  |
| >              |                            |     > as the           |
|  differentiate |                            |     > software's       |
| > the          |                            |     > identification   |
| > expectations |                            |     > and              |
| > of this      |                            |     > authentication   |
| > standard     |                            |     > mechanisms or    |
| > with regards |                            |     > activity         |
| > to logging   |                            |     > tracking         |
| > from similar |                            |     > mechanisms.      |
| > requirements |                            |                        |
| > in other PCI |                            | -   Initialization,    |
| > standards.*  |                            |     > stopping, or     |
|                |                            |     > pausing of       |
|                |                            |     > sensitive        |
|                |                            |     > functions.       |
|                |                            |                        |
|                |                            | This control objective |
|                |                            | does not mandate the   |
|                |                            | logging of each        |
|                |                            | encryption operation   |
|                |                            | or function processing |
|                |                            | sensitive data, but it |
|                |                            | does require that      |
|                |                            | access is tracked and  |
|                |                            | any methods that may   |
|                |                            | expose sensitive data  |
|                |                            | are also tracked.      |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > **8.2** All  | **8.2.a** The assessor     | By recording the       |
| > activity is  | shall examine evidence and | details in this        |
| > captured in  | test the software to       | requirement for all    |
| > sufficient   | confirm that the tracking  | attempts to access or  |
| > and          | method(s) implemented      | use critical assets,   |
| > necessary    | capture specific activity  | malicious activity or  |
| > detail to    | performed, including:      | potential software or  |
| > accurately   |                            | data compromise can be |
| > describe the | -   Enablement of any      | quickly identified and |
| > specific     |     > privileged modes of  | with sufficient detail |
| > activities   |     > operation.           | to know who performed  |
| > that were    |                            | the activity, whether  |
| > performed,   | -   Disabling of           | the attempt was        |
| > who          |     > encryption of        | successful, when the   |
| > performed    |     > sensitive data.      | activity occurred,     |
| > them, the    |                            | what critical assets   |
| > time they    | -   Decryption of          | were affected, and the |
| > were         |     > sensitive data.      | origination of the     |
| > performed,   |                            | event.                 |
| > and the      | -   Exporting of sensitive |                        |
| > critical     |     > data to other        |                        |
| > assets that  |     > systems or           |                        |
| > were         |     > processes.           |                        |
| > affected.    |                            |                        |
|                | -   Failed authentication  |                        |
|                |     > attempts.            |                        |
|                |                            |                        |
|                | -   Disabling or deleting  |                        |
|                |     > a security control   |                        |
|                |     > or altering security |                        |
|                |     > functions.           |                        |
+----------------+----------------------------+------------------------+
|                | **8.2.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that the tracking  |                        |
|                | method(s) implemented      |                        |
|                | provide the following:     |                        |
|                |                            |                        |
|                | -   A unique               |                        |
|                |     > identification for   |                        |
|                |     > the individual,      |                        |
|                |     > system, or entity    |                        |
|                |     > accessing or using   |                        |
|                |     > critical assets.     |                        |
|                |                            |                        |
|                | -   A timestamp for each   |                        |
|                |     > tracked event.       |                        |
|                |                            |                        |
|                | -   Details on what        |                        |
|                |     > critical asset has   |                        |
|                |     > been accessed.       |                        |
+----------------+----------------------------+------------------------+
|                | **8.2.c** The assessor     |                        |
|                | shall test the software to |                        |
|                | confirm that confidential  |                        |
|                | data is not directly       |                        |
|                | recorded in the tracking   |                        |
|                | data.                      |                        |
+----------------+----------------------------+------------------------+
| > **8.3** The  | **8.3.a** Where the        | In order to identify   |
| > software     | activity records are       | anomalous behavior and |
| > supports     | managed by the software,   | to enable forensic     |
| > secure       | including only temporarily | investigation upon     |
| > retention of | before being passed to     | suspicion of potential |
| > detailed     | other systems, the         | software or data       |
| > activity     | assessor shall examine     | compromise, the        |
| > records.     | evidence and test the      | software must provide  |
|                | software to confirm that   | for the retention of   |
|                | the protection methods are | detailed activity      |
|                | implemented to protect     | records either through |
|                | completeness, accuracy,    | native means (within   |
|                | and integrity of the       | the software itself)   |
|                | activity records.          | or support integration |
|                |                            | with other solutions   |
|                |                            | such as centralized    |
|                |                            | log servers,           |
|                |                            | cloud-based logging    |
|                |                            | solutions, or back-end |
|                |                            | monitoring solutions.  |
|                |                            |                        |
|                |                            | > *(continued on next  |
|                |                            | > page)*               |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **8.3.b** Where the        | Without adequate       |
|                | software utilizes external | protection of activity |
|                | or third-party systems for | records, their         |
|                | the maintenance of         | completeness,          |
|                | tracking data, such as a   | accuracy, and          |
|                | log server, the assessor   | integrity cannot be    |
|                | shall examine evidence to  | guaranteed and any     |
|                | confirm that guidance on   | reliance that would    |
|                | the correct and complete   | otherwise be placed on |
|                | setup and/or integration   | them (such as during a |
|                | of the software with the   | forensic               |
|                | external or third-party    | investigation) would   |
|                | system(s) is provided to   | be negated.            |
|                | stakeholders in accordance |                        |
|                | with Control Objective     | When activity records  |
|                | 12.1.                      | are managed by the     |
|                |                            | software, the records  |
|                |                            | must be protected in   |
|                |                            | accordance with all    |
|                |                            | applicable             |
|                |                            | requirements for the   |
|                |                            | protection of          |
|                |                            | sensitive data.        |
+----------------+----------------------------+------------------------+
|                | **8.3.c** The assessor     |                        |
|                | shall test the software to |                        |
|                | confirm methods are        |                        |
|                | implemented to secure the  |                        |
|                | authenticity of the        |                        |
|                | tracking data during       |                        |
|                | transmission to the log    |                        |
|                | storage system, and to     |                        |
|                | confirm that this          |                        |
|                | protection meets the       |                        |
|                | requirements of this       |                        |
|                | standard (for example,     |                        |
|                | authenticity parameters    |                        |
|                | must be applied using      |                        |
|                | strong cryptography) and   |                        |
|                | any account or             |                        |
|                | authentication parameters  |                        |
|                | used for access to an      |                        |
|                | external logging system    |                        |
|                | are protected.             |                        |
+----------------+----------------------------+------------------------+
| > **8.4** The  | **8.4.a** The assessor     | Software security      |
| > software     | shall examine evidence and | controls should be     |
| > handles      | test the software to       | implemented to ensure  |
| > failures in  | confirm that the failure   | that when              |
| > act          | of the activity-tracking   | activity-tracking      |
| ivity-tracking | mechanism(s) does not      | mechanism(s) fail,     |
| > mechanisms   | violate the integrity of   | those failures are     |
| > such that    | existing records by        | handled in a way that  |
| > the          | confirming that:           | maintains the          |
| > integrity of |                            | integrity of the       |
| > existing     | -   The software does not  | records. Otherwise,    |
| > activity     |     > overwrite existing   | attackers may          |
| > records is   |     > tracking data upon a | intentionally target   |
| > preserved.   |     > restart of the       | activity-tracking      |
|                |     > software. Each new   | mechanisms and cause   |
|                |     > start shall only     | failures that would    |
|                |     > append to existing   | allow the attackers to |
|                |     > datasets or shall    | conceal or overwrite   |
|                |     > create a new         | evidence of their      |
|                |     > tracking dataset.    | activities.            |
|                |                            |                        |
|                | -   Where unique dataset   |                        |
|                |     > names are relied     |                        |
|                |     > upon for maintaining |                        |
|                |     > integrity between    |                        |
|                |     > execution instances, |                        |
|                |     > the implementation   |                        |
|                |     > ensures that other   |                        |
|                |     > software (including  |                        |
|                |     > another instance of  |                        |
|                |     > the same software)   |                        |
|                |     > cannot overwrite or  |                        |
|                |     > render invalid       |                        |
|                |     > existing datasets.   |                        |
|                |                            |                        |
|                | > *(continued on next      |                        |
|                | > page)*                   |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **8.4.a**                  |                        |
|                |                            |                        |
|                | -   The software applies,  |                        |
|                |     > where possible,      |                        |
|                |     > suitable file        |                        |
|                |     > privileges to assist |                        |
|                |     > with maintaining the |                        |
|                |     > integrity of the     |                        |
|                |     > tracking dataset     |                        |
|                |     > (such as applying an |                        |
|                |     > append-only access   |                        |
|                |     > control to a dataset |                        |
|                |     > once created). Where |                        |
|                |     > the software does    |                        |
|                |     > not apply such       |                        |
|                |     > controls, the        |                        |
|                |     > assessor shall       |                        |
|                |     > confirm reasonable   |                        |
|                |     > justification exists |                        |
|                |     > describing why this  |                        |
|                |     > is the case, why the |                        |
|                |     > behavior is          |                        |
|                |     > sufficient, and what |                        |
|                |     > additional           |                        |
|                |     > mitigations are      |                        |
|                |     > applied to maintain  |                        |
|                |     > the integrity of the |                        |
|                |     > tracking data.       |                        |
+----------------+----------------------------+------------------------+
|                | **8.4.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that the integrity |                        |
|                | of activity tracking       |                        |
|                | records is maintained by:  |                        |
|                |                            |                        |
|                | -   Performing actions     |                        |
|                |     > that should be       |                        |
|                |     > tracked,             |                        |
|                |     > force-closing and    |                        |
|                |     > then restarting the  |                        |
|                |     > software, and        |                        |
|                |     > performing other     |                        |
|                |     > tracked actions.     |                        |
|                |                            |                        |
|                | -   Performing actions     |                        |
|                |     > that should be       |                        |
|                |     > tracked,             |                        |
|                |     > power-cycling the    |                        |
|                |     > platform on which    |                        |
|                |     > the software is      |                        |
|                |     > executing, and then  |                        |
|                |     > restarting the       |                        |
|                |     > software and         |                        |
|                |     > performing other     |                        |
|                |     > tracked actions.     |                        |
|                |                            |                        |
|                | -   Locking access to the  |                        |
|                |     > tracking dataset and |                        |
|                |     > confirming that the  |                        |
|                |     > software handles the |                        |
|                |     > inability to access  |                        |
|                |     > this dataset in a    |                        |
|                |     > secure way, such as  |                        |
|                |     > by creating a new    |                        |
|                |     > dataset or           |                        |
|                |     > preventing further   |                        |
|                |     > use of the software. |                        |
|                |                            |                        |
|                | -   Preventing the         |                        |
|                |     > creation of new      |                        |
|                |     > dataset entries by   |                        |
|                |     > preventing further   |                        |
|                |     > writing to the media |                        |
|                |     > on which the dataset |                        |
|                |     > is located (for      |                        |
|                |     > example, by using    |                        |
|                |     > media that has       |                        |
|                |     > insufficient         |                        |
|                |     > available space).    |                        |
|                |                            |                        |
|                | Where any of the tests     |                        |
|                | above are not possible,    |                        |
|                | the assessor shall         |                        |
|                | interview personnel to     |                        |
|                | confirm reasonable         |                        |
|                | justification exists to    |                        |
|                | describe why this is the   |                        |
|                | case and shall confirm     |                        |
|                | protections are in place   |                        |
|                | to prevent such scenarios  |                        |
|                | from affecting the         |                        |
|                | integrity of the tracking  |                        |
|                | records.                   |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark27 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective 9: |                            |                        |
| > Attack       |                            |                        |
| > Detection**  |                            |                        |
| >              |                            |                        |
| > Attacks are  |                            |                        |
| > detected,    |                            |                        |
| > and the      |                            |                        |
| > i            |                            |                        |
| mpacts/effects |                            |                        |
| > of attacks   |                            |                        |
| > are          |                            |                        |
| > minimized.   |                            |                        |
+----------------+----------------------------+------------------------+
| > **9.1** The  | **9.1.a** The assessor     | Software should        |
| > software     | shall examine evidence and | possess basic          |
| > detects and  | test the software to       | functionality to       |
| > alerts upon  | confirm that methods are   | differentiate between  |
| > detection of | implemented to validate    | normal and anomalous   |
| > anomalous    | the integrity of software  | user behavior.         |
| > behavior,    | executables and any        | Examples of anomalous  |
| > such as      | configuration options,     | behavior that should   |
| > changes in   | files, and datasets that   | be automatically       |
| > post-        | the software relies upon   | detected by the        |
| > deployment   | for operation such that    | software include       |
| >              | unauthorized               | changes in             |
| configurations | post-deployment changes    | post-deployment (or    |
| > or obvious   | are detected.              | post-initialization)   |
| > attack       |                            | configurations or      |
| > behavior.    | Where the execution        | obvious                |
|                | environment prevents this, | automated-attack       |
|                | the assessor shall examine | behaviors, such as     |
|                | evidence (including        | repeated               |
|                | publicly available         | authentication         |
|                | literature on the platform | attempts at a          |
|                | and associated             | frequency that is      |
|                | technologies) to confirm   | infeasible for a human |
|                | that there are indeed no   | user.                  |
|                | methods for validating     |                        |
|                | authenticity, and that     | In some cases, it may  |
|                | additional security        | be impractical to      |
|                | controls are implemented   | implement these        |
|                | to minimize the associated | capabilities directly  |
|                | risk.                      | into payment software, |
|                |                            | and third-party tools  |
|                |                            | or services may be     |
|                |                            | required. Where such   |
|                |                            | tools or services are  |
|                |                            | relied upon, the       |
|                |                            | software vendor must   |
|                |                            | provide guidance (or   |
|                |                            | direction on where     |
|                |                            | appropriate guidance   |
|                |                            | may be obtained) that  |
|                |                            | describes how and to   |
|                |                            | what extent            |
|                |                            | third-party tools and  |
|                |                            | services should be     |
|                |                            | configured to satisfy  |
|                |                            | the control objective  |
|                |                            | and associated test    |
|                |                            | requirements.          |
+----------------+----------------------------+------------------------+
|                | **9.1.b** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that integrity     |                        |
|                | values used by the         |                        |
|                | software and dataset(s)    |                        |
|                | upon which it relies for   |                        |
|                | secure operation are       |                        |
|                | checked upon software      |                        |
|                | execution, and at least    |                        |
|                | every 36 hours thereafter  |                        |
|                | (if the software continues |                        |
|                | execution during that time |                        |
|                | period).                   |                        |
+----------------+----------------------------+------------------------+
|                | **9.1.c** Where            |                        |
|                | cryptographic primitives   |                        |
|                | are used by any anomaly-   |                        |
|                | detection methods, the     |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | the cryptographic          |                        |
|                | primitives are protected.  |                        |
+----------------+----------------------------+------------------------+
|                | **9.1.d** Where stored     |                        |
|                | values are used by any     |                        |
|                | anomaly detection methods, |                        |
|                | the assessor shall examine |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | these values are           |                        |
|                | considered sensitive data  |                        |
|                | and are protected          |                        |
|                | accordingly.               |                        |
+----------------+----------------------------+------------------------+
|                | **9.1.e** Where            |                        |
|                | configuration or other     |                        |
|                | dataset values can be      |                        |
|                | modified by the software   |                        |
|                | during execution, the      |                        |
|                | assessor shall examine     |                        |
|                | evidence and test the      |                        |
|                | software to confirm that   |                        |
|                | integrity protections are  |                        |
|                | implemented to allow for   |                        |
|                | this update while still    |                        |
|                | ensuring dataset integrity |                        |
|                | can be validated after the |                        |
|                | update.                    |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
|                | **9.1.f** The assessor     |                        |
|                | shall examine evidence and |                        |
|                | test the software to       |                        |
|                | confirm that the software  |                        |
|                | implements controls to     |                        |
|                | prevent brute-force        |                        |
|                | attacks on account,        |                        |
|                | password, or               |                        |
|                | cryptographic-key input    |                        |
|                | fields (for example, input |                        |
|                | rate limiting).            |                        |
+----------------+----------------------------+------------------------+
|                | **9.1.g** Where            |                        |
|                | third-party tools or       |                        |
|                | services are relied upon   |                        |
|                | by the software to provide |                        |
|                | attack detection           |                        |
|                | capabilities, the assessor |                        |
|                | shall examine evidence to  |                        |
|                | confirm that guidance on   |                        |
|                | how to configure such      |                        |
|                | tools and services to      |                        |
|                | support this control       |                        |
|                | objective is provided to   |                        |
|                | stakeholders in accordance |                        |
|                | with Control Objective     |                        |
|                | 12.1.                      |                        |
+----------------+----------------------------+------------------------+

### Secure Software Lifecycle Management

> ***The software is maintained using secure software lifecycle
> management practices.***

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark29 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective    |                            |                        |
| > 10: Threat   |                            |                        |
| > and          |                            |                        |
| >              |                            |                        |
|  Vulnerability |                            |                        |
| > Management** |                            |                        |
| >              |                            |                        |
| > Payment      |                            |                        |
| > software     |                            |                        |
| > threats and  |                            |                        |
| > v            |                            |                        |
| ulnerabilities |                            |                        |
| > are          |                            |                        |
| > identified,  |                            |                        |
| > assessed,    |                            |                        |
| > and managed  |                            |                        |
| >              |                            |                        |
| appropriately. |                            |                        |
+----------------+----------------------------+------------------------+
| > **10.1**     | **10.1.a** Using           | Determining how to     |
| > Software     | information obtained in    | effectively secure and |
| > threats and  | Test Requirement 4.1.a,    | defend the software    |
| > v            | the assessor shall examine | against attacks        |
| ulnerabilities | evidence to confirm that   | requires a thorough    |
| > are          | common attack methods      | understanding of the   |
| > identified,  | against the software are   | specific threats and   |
| > assessed,    | identified. This may       | potential              |
| > and          | include platform-level,    | vulnerabilities        |
| > addressed.   | protocol-level, and/or     | applicable to the      |
|                | language-level attacks.    | vendor's software.     |
|                |                            |                        |
|                |                            | This typically         |
|                |                            | involves understanding |
|                |                            | the following:         |
|                |                            |                        |
|                |                            | -   The types of       |
|                |                            |     > information      |
|                |                            |     > collected,       |
|                |                            |     > stored,          |
|                |                            |     > processed, or    |
|                |                            |     > transmitted by   |
|                |                            |     > the software.    |
|                |                            |                        |
|                |                            | -   The motivations an |
|                |                            |     > attacker may     |
|                |                            |     > have for         |
|                |                            |     > attacking the    |
|                |                            |     > software.        |
|                |                            |                        |
|                |                            | -   The methods an     |
|                |                            |     > attacker might   |
|                |                            |     > utilize or the   |
|                |                            |     > vulnerabilities  |
|                |                            |     > an attacker      |
|                |                            |     > might try to     |
|                |                            |     > exploit during   |
|                |                            |     > an attack.       |
|                |                            |                        |
|                |                            | -   The exploitability |
|                |                            |     > of any           |
|                |                            |     > identified       |
|                |                            |     > vulnerabilities. |
|                |                            |                        |
|                |                            | -   The impact a       |
|                |                            |     > successful       |
|                |                            |     > attack.          |
|                |                            |                        |
|                |                            | The identified threats |
|                |                            | and vulnerabilities    |
|                |                            | should be tracked,     |
|                |                            | assigned to            |
|                |                            | responsible personnel, |
|                |                            | and fixed or mitigated |
|                |                            | prior to payment       |
|                |                            | software release.      |
|                |                            |                        |
|                |                            | For guidance on threat |
|                |                            | analysis and           |
|                |                            | cyber-resiliency       |
|                |                            | design principles,     |
|                |                            | refer to industry      |
|                |                            | standards and          |
|                |                            | guidance, such as the  |
|                |                            | current version of     |
|                |                            | *NIST Special          |
|                |                            | Publication 800-160*.  |
+----------------+----------------------------+------------------------+
|                | **10.1.b** The assessor    |                        |
|                | shall examine evidence to  |                        |
|                | confirm that the           |                        |
|                | identified attacks are     |                        |
|                | valid for the software and |                        |
|                | shall note where this does |                        |
|                | not include common attack  |                        |
|                | methods detailed in        |                        |
|                | industry-standard          |                        |
|                | references such as OWASP   |                        |
|                | and CWE lists.             |                        |
+----------------+----------------------------+------------------------+
|                | **10.1.c** The assessor    |                        |
|                | shall examine evidence to  |                        |
|                | confirm that mitigations   |                        |
|                | against each identified    |                        |
|                | attack are implemented,    |                        |
|                | and that the software      |                        |
|                | release process includes   |                        |
|                | ongoing validation of the  |                        |
|                | existence of these         |                        |
|                | mitigations.               |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **10.2**     | **10.2.a** The assessor    | Most software         |
| > V            | shall examine evidence to  | vulnerabilities are   |
| ulnerabilities | confirm that robust        | introduced as a       |
| > in the       | testing processes are used | result of coding      |
| > software and | throughout the software    | errors, bad design,   |
| > third-party  | lifecycle to manage        | improper              |
| > components   | vulnerabilities in         | implementation, or    |
| > are tested   | software and to verify     | the use of vulnerable |
| > for and      | that the mitigations used  | components.           |
| > fixed prior  | to secure the software     |                       |
| > to release.  | against attacks remain in  | Software should be    |
|                | place and are effective.   | developed and tested  |
|                |                            | in a manner that      |
|                |                            | minimizes the         |
|                |                            | existence of any      |
|                |                            | vulnerabilities and   |
|                |                            | detects those that    |
|                |                            | emerge over time,     |
|                |                            | such that the         |
|                |                            | vulnerabilities may   |
|                |                            | be addressed before   |
|                |                            | the software is       |
|                |                            | released or updated.  |
|                |                            |                       |
|                |                            | Techniques to avoid   |
|                |                            | the introduction of   |
|                |                            | vulnerabilities       |
|                |                            | during development    |
|                |                            | include the use of    |
|                |                            | security coding       |
|                |                            | practices, testing    |
|                |                            | code during each      |
|                |                            | phase of the          |
|                |                            | development lifecycle |
|                |                            | using automated tools |
|                |                            | (such as              |
|                |                            | static/dynamic        |
|                |                            | analysis tools and    |
|                |                            | interactive security  |
|                |                            | testing tools), and   |
|                |                            | the use of known      |
|                |                            | secure components     |
|                |                            | (for example, common  |
|                |                            | code that has already |
|                |                            | undergone significant |
|                |                            | security vetting).    |
|                |                            |                       |
|                |                            | To minimize the       |
|                |                            | introduction of       |
|                |                            | software              |
|                |                            | vulnerabilities from  |
|                |                            | third-party           |
|                |                            | components, those     |
|                |                            | components must also  |
|                |                            | be evaluated.         |
|                |                            | Ideally, they should  |
|                |                            | be subject to the     |
|                |                            | same secure           |
|                |                            | development and       |
|                |                            | testing processes as  |
|                |                            | the software created  |
|                |                            | by the vendor.        |
|                |                            |                       |
|                |                            | Security testing      |
|                |                            | should be performed   |
|                |                            | by appropriately      |
|                |                            | skilled vendor        |
|                |                            | personnel or third    |
|                |                            | parties. In addition, |
|                |                            | security testing      |
|                |                            | personnel should be   |
|                |                            | able to conduct tests |
|                |                            | in an objective       |
|                |                            | manner and be         |
|                |                            | authorized to         |
|                |                            | escalate any          |
|                |                            | identified            |
|                |                            | vulnerabilities to    |
|                |                            | appropriate           |
|                |                            | management or         |
|                |                            | development           |
|                |                            | personnel, so they    |
|                |                            | can be properly       |
|                |                            | addressed.            |
+----------------+----------------------------+-----------------------+
|                | **10.2.b** The assessor    |                       |
|                | shall examine evidence     |                       |
|                | including documented       |                       |
|                | testing processes and      |                       |
|                | output of several          |                       |
|                | instances of the testing   |                       |
|                | to confirm that the        |                       |
|                | testing process:           |                       |
|                |                            |                       |
|                | -   Includes, at a         |                       |
|                |     > minimum, the use of  |                       |
|                |     > automated tools      |                       |
|                |     > capable of detecting |                       |
|                |     > vulnerabilities both |                       |
|                |     > in software code and |                       |
|                |     > during software      |                       |
|                |     > execution.           |                       |
|                |                            |                       |
|                | -   Includes the use of    |                       |
|                |     > security testing     |                       |
|                |     > tools that are       |                       |
|                |     > suitable for the     |                       |
|                |     > software             |                       |
|                |     > architecture,        |                       |
|                |     > development          |                       |
|                |     > languages, and       |                       |
|                |     > frameworks used in   |                       |
|                |     > the development of   |                       |
|                |     > the software.        |                       |
|                |                            |                       |
|                | -   Accounts for the       |                       |
|                |     > entire code base and |                       |
|                |     > detects              |                       |
|                |     > vulnerabilities in   |                       |
|                |     > third-party,         |                       |
|                |     > open-source, or      |                       |
|                |     > shared components    |                       |
|                |     > and libraries.       |                       |
|                |                            |                       |
|                | -   Accounts for common    |                       |
|                |     > vulnerabilities and  |                       |
|                |     > attack methods.      |                       |
|                |                            |                       |
|                | -   Demonstrates a history |                       |
|                |     > of finding software  |                       |
|                |     > vulnerabilities and  |                       |
|                |     > remediating them     |                       |
|                |     > prior to software    |                       |
|                |     > release.             |                       |
+----------------+----------------------------+-----------------------+
|                | **10.2.c** Where evidence  |                       |
|                | examined in Test           |                       |
|                | Requirement 10.2.b shows   |                       |
|                | the release of software    |                       |
|                | with known                 |                       |
|                | vulnerabilities, the       |                       |
|                | assessor shall examine     |                       |
|                | further evidence to        |                       |
|                | confirm that:              |                       |
|                |                            |                       |
|                | -   An industry-standard   |                       |
|                |                            |                       |
|                |    > vulnerability-ranking |                       |
|                |     > system (such as      |                       |
|                |     > CVSS) is used to     |                       |
|                |     > classify/categorize  |                       |
|                |     > vulnerabilities.     |                       |
|                |                            |                       |
|                | -   A remediation plan is  |                       |
|                |     > maintained for all   |                       |
|                |     > detected             |                       |
|                |     > vulnerabilities that |                       |
|                |     > ensures              |                       |
|                |     > vulnerabilities do   |                       |
|                |     > not remain           |                       |
|                |     > unmitigated for an   |                       |
|                |     > indefinite period.   |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+------------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**         |
| > Objectives** |                            |                        |
+================+============================+========================+
| > [            |                            |                        |
| ]{#_bookmark30 |                            |                        |
| > .an          |                            |                        |
| chor}**Control |                            |                        |
| > Objective    |                            |                        |
| > 11: Secure   |                            |                        |
| > Software     |                            |                        |
| > Updates**    |                            |                        |
| >              |                            |                        |
| > Software     |                            |                        |
| > releases and |                            |                        |
| > updates to   |                            |                        |
| > address      |                            |                        |
| > v            |                            |                        |
| ulnerabilities |                            |                        |
| > are provided |                            |                        |
| > in a secure  |                            |                        |
| > and timely   |                            |                        |
| > manner.      |                            |                        |
+----------------+----------------------------+------------------------+
| > **11.1**     | **11.1.a** The assessor    | Vulnerabilities in     |
| > Software     | shall examine evidence to  | software should be     |
| > updates to   | confirm that:              | fixed as soon as       |
| > fix known    |                            | possible to enable     |
| > v            | -   Reasonable criteria    | software users and     |
| ulnerabilities |     > are defined for      | other stakeholders to  |
| > are made     |     > releasing software   | address any risks      |
| > available to |     > updates to fix       | before vulnerabilities |
| > stakeholders |     > security             | in their payment       |
| > in a timely  |     > vulnerabilities.     | systems and software   |
| > manner.      |                            | can be exploited by    |
|                | -   Security updates are   | attackers.             |
|                |     > made available to    |                        |
|                |     > stakeholders in      | Vulnerabilities should |
|                |     > accordance with the  | be addressed in a      |
|                |     > defined criteria.    | manner that is         |
|                |                            | commensurate with the  |
|                |                            | risk they pose to      |
|                |                            | software users or      |
|                |                            | other stakeholders.    |
|                |                            | The most critical or   |
|                |                            | severe vulnerabilities |
|                |                            | (those with the        |
|                |                            | highest exploitability |
|                |                            | and the greatest       |
|                |                            | potential impact to    |
|                |                            | stakeholders) should   |
|                |                            | be patched             |
|                |                            | immediately, followed  |
|                |                            | by those with          |
|                |                            | moderate-to-low        |
|                |                            | exploitability or      |
|                |                            | potential impact. The  |
|                |                            | criteria for           |
|                |                            | determining how and    |
|                |                            | when to make patches   |
|                |                            | available to           |
|                |                            | stakeholders should be |
|                |                            | defined and followed.  |
+----------------+----------------------------+------------------------+
|                | **11.1.b** The assessor    |                        |
|                | shall examine evidence,    |                        |
|                | including update- specific |                        |
|                | security-testing results   |                        |
|                | and details, to confirm    |                        |
|                | that security updates are  |                        |
|                | made available to          |                        |
|                | stakeholders in accordance |                        |
|                | with the defined criteria. |                        |
|                | Where updates are not      |                        |
|                | provided in accordance     |                        |
|                | with the defined criteria, |                        |
|                | the assessor shall confirm |                        |
|                | that such instances are    |                        |
|                | justified and reasonable.  |                        |
+----------------+----------------------------+------------------------+
| > **11.2**     | **11.2.a** The assessor    | Security updates       |
| > Software     | shall examine evidence to  | should include a       |
| > releases and | confirm that the method(s) | mechanism within the   |
| > updates are  | by which the vendor        | update process to      |
| > delivered in | releases software updates  | verify the update code |
| > a secure     | maintain the integrity of  | has not been replaced  |
| > manner that  | the software code during   | or tampered with.      |
| > ensures the  | transmission and           | Examples of integrity  |
| > integrity of | installation.              | checks include, but    |
| > the software |                            | are not limited to,    |
| > code.        |                            | checksums and          |
|                |                            | digitally signed       |
|                |                            | certificates (where    |
|                |                            | implemented            |
|                |                            | correctly).            |
|                |                            | Verification could be  |
|                |                            | implemented within the |
|                |                            | software itself or     |
|                |                            | through guidance that  |
|                |                            | is provided to         |
|                |                            | stakeholders to direct |
|                |                            | them on the manual     |
|                |                            | verification of        |
|                |                            | software updates.      |
|                |                            |                        |
|                |                            | In addition, the       |
|                |                            | process of             |
|                |                            | distributing updates   |
|                |                            | and patches should     |
|                |                            | prevent malicious      |
|                |                            | individuals from       |
|                |                            | intercepting the       |
|                |                            | updates in transit,    |
|                |                            | modifying them, and    |
|                |                            | then redistributing    |
|                |                            | them to unsuspecting   |
|                |                            | stakeholders.          |
+----------------+----------------------------+------------------------+
|                | **11.2.b** Where user      |                        |
|                | input or interaction is    |                        |
|                | required to validate the   |                        |
|                | integrity of the software  |                        |
|                | code, the assessor shall   |                        |
|                | examine evidence to        |                        |
|                | confirm that guidance on   |                        |
|                | this process is provided   |                        |
|                | to stakeholders in         |                        |
|                | accordance with Control    |                        |
|                | Objective 12.1.            |                        |
+----------------+----------------------------+------------------------+
|                | **11.2.c** Where the       |                        |
|                | integrity method           |                        |
|                | implemented is not         |                        |
|                | cryptographically secure,  |                        |
|                | the assessor shall examine |                        |
|                | evidence to confirm that   |                        |
|                | the software distribution  |                        |
|                | method provides a chain of |                        |
|                | trust, such as through use |                        |
|                | of a TLS connection that   |                        |
|                | provides compliant         |                        |
|                | cipher-suite               |                        |
|                | implementations.           |                        |
+----------------+----------------------------+------------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **11.2.d** The assessor    |                       |
|                | shall examine vendor       |                       |
|                | evidence to confirm that   |                       |
|                | stakeholders are notified  |                       |
|                | of software updates, and   |                       |
|                | that guidance on how they  |                       |
|                | may be obtained and        |                       |
|                | installed is provided to   |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1.                      |                       |
+----------------+----------------------------+-----------------------+
|                | **11.2.e** The assessor    |                       |
|                | shall examine evidence to  |                       |
|                | confirm that stakeholders  |                       |
|                | are notified when known    |                       |
|                | vulnerabilities are        |                       |
|                | detected in software that  |                       |
|                | has not yet been updated   |                       |
|                | with a fix. This includes  |                       |
|                | vulnerabilities that may   |                       |
|                | exist in third-party       |                       |
|                | software and libraries     |                       |
|                | used by the software. The  |                       |
|                | assessor shall confirm     |                       |
|                | that this process includes |                       |
|                | providing the stakeholders |                       |
|                | with suggested mitigations |                       |
|                | for any such               |                       |
|                | vulnerabilities.           |                       |
+----------------+----------------------------+-----------------------+
|                | **11.2.f** The assessor    |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | update mechanisms cover    |                       |
|                | all software,              |                       |
|                | configuration files, and   |                       |
|                | other metadata that may be |                       |
|                | used by the software for   |                       |
|                | security purposes or which |                       |
|                | may in some way affect the |                       |
|                | security of the software.  |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark31 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > 12: Software |                            |                       |
| > Vendor       |                            |                       |
| >              |                            |                       |
| Implementation |                            |                       |
| > Guidance**   |                            |                       |
| >              |                            |                       |
| > The software |                            |                       |
| > vendor       |                            |                       |
| > provides     |                            |                       |
| > stakeholders |                            |                       |
| > with clear   |                            |                       |
| > and thorough |                            |                       |
| > guidance on  |                            |                       |
| > the secure   |                            |                       |
| > i            |                            |                       |
| mplementation, |                            |                       |
| >              |                            |                       |
| configuration, |                            |                       |
| > and          |                            |                       |
| > operation of |                            |                       |
| > the          |                            |                       |
| > software.    |                            |                       |
+----------------+----------------------------+-----------------------+
| > **12.1** The | **12.1.a** The assessor    | When followed, the    |
| > software     | shall examine evidence to  | software vendor\'s    |
| > vendor       | confirm that the vendor    | implementation        |
| > provides     | creates and provides       | guidance provides     |
| > stakeholders | stakeholders, clear and    | assurance that the    |
| > with clear   | sufficient guidance to     | software and patches  |
| > and thorough | allow for the secure       | can be securely       |
| > guidance on  | installation,              | installed,            |
| > the secure   | configuration, and use of  | configured, and       |
| > i            | the software.              | maintained in a       |
| mplementation, |                            | customer environment, |
| >              |                            | and that all desired  |
| configuration, |                            | security functions    |
| > and          |                            | are active and        |
| > operation of |                            | working as intended.  |
| > its payment  |                            | The guidance should   |
| > software.    |                            | cover all options and |
|                |                            | functions available   |
|                |                            | to software users     |
|                |                            | that could affect the |
|                |                            | security of the       |
|                |                            | software or the data  |
|                |                            | it interacts with.    |
|                |                            | The guidance should   |
|                |                            | also include secure   |
|                |                            | configuration options |
|                |                            | for any components    |
|                |                            | provided with or      |
|                |                            | supported by the      |
|                |                            | software, such as     |
|                |                            | external software and |
|                |                            | underlying platforms. |
|                |                            |                       |
|                |                            | Examples of           |
|                |                            | configurable options  |
|                |                            | include:              |
|                |                            |                       |
|                |                            | -   Changing default  |
|                |                            |     > credentials and |
|                |                            |     > passwords.      |
|                |                            |                       |
|                |                            | -   Enabling and      |
|                |                            |     > disabling       |
|                |                            |     > software        |
|                |                            |     > accounts,       |
|                |                            |     > services, and   |
|                |                            |     > features.       |
|                |                            |                       |
|                |                            | -   Changes in        |
|                |                            |     > resource access |
|                |                            |     > permissions.    |
|                |                            |                       |
|                |                            | -   Integration with  |
|                |                            |     > third-party     |
|                |                            |     > cryptographic   |
|                |                            |     > libraries,      |
|                |                            |     > random number   |
|                |                            |     > generators, and |
|                |                            |     > so on.          |
|                |                            |                       |
|                |                            | The provided guidance |
|                |                            | should result in a    |
|                |                            | secure configuration  |
|                |                            | across all supported  |
|                |                            | platforms and all     |
|                |                            | configurable options. |
+----------------+----------------------------+-----------------------+
|                | **12.1.b** The assessor    |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the guidance: |                       |
|                |                            |                       |
|                | -   Includes details on    |                       |
|                |     > how to securely and  |                       |
|                |     > correctly install    |                       |
|                |     > any third-party      |                       |
|                |     > software that is     |                       |
|                |     > required for the     |                       |
|                |     > operation of the     |                       |
|                |     > vendor software.     |                       |
|                |                            |                       |
|                | -   Provides instructions  |                       |
|                |     > on the correct       |                       |
|                |     > configuration of the |                       |
|                |     > platform(s) on which |                       |
|                |     > the software is to   |                       |
|                |     > be executed,         |                       |
|                |     > including setting    |                       |
|                |     > security parameters  |                       |
|                |     > and installation of  |                       |
|                |     > any data elements    |                       |
|                |     > (such as             |                       |
|                |     > certificates).       |                       |
|                |                            |                       |
|                | -   Includes instructions  |                       |
|                |     > for key management   |                       |
|                |     > (for example, the    |                       |
|                |     > use of keys and how  |                       |
|                |     > they are             |                       |
|                |     > distributed, loaded, |                       |
|                |     > removed, changed,    |                       |
|                |     > and destroyed.)      |                       |
|                |                            |                       |
|                | -   Does not instruct the  |                       |
|                |     > user to disable      |                       |
|                |     > security settings or |                       |
|                |     > parameters within    |                       |
|                |     > the installed        |                       |
|                |     > environment, such as |                       |
|                |     > anti- malware        |                       |
|                |     > software or firewall |                       |
|                |     > or other             |                       |
|                |     > network-level        |                       |
|                |     > protection systems.  |                       |
|                |                            |                       |
|                | -   Does not instruct the  |                       |
|                |     > user to execute the  |                       |
|                |     > software in a        |                       |
|                |     > privileged mode      |                       |
|                |     > higher than what is  |                       |
|                |     > required by the      |                       |
|                |     > software.            |                       |
|                |                            |                       |
|                | -   Provides details on    |                       |
|                |     > how to validate the  |                       |
|                |     > version of the       |                       |
|                |     > software and clearly |                       |
|                |     > indicates for which  |                       |
|                |     > version(s) of the    |                       |
|                |     > software the         |                       |
|                |     > guidance is written. |                       |
|                |                            |                       |
|                | > *(continued on next      |                       |
|                | > page)*                   |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **12.1.b**                 |                       |
|                |                            |                       |
|                | -   Provides justification |                       |
|                |     > for any requirements |                       |
|                |     > in this standard     |                       |
|                |     > that are to be       |                       |
|                |     > assessed as not      |                       |
|                |     > applicable. For each |                       |
|                |     > of these, the        |                       |
|                |     > assessor shall       |                       |
|                |     > confirm              |                       |
|                |     > justification exists |                       |
|                |     > for why this is the  |                       |
|                |     > case and shall       |                       |
|                |     > confirm that it      |                       |
|                |     > agrees with their    |                       |
|                |     > understanding and    |                       |
|                |     > the results of their |                       |
|                |     > software testing.    |                       |
+----------------+----------------------------+-----------------------+

# Module A -- Account Data Protection Requirements

+------------+-------------------------+------------------------------+
| > **Module | > **Overview**          | > **Control Objectives**     |
| > Name**   |                         |                              |
+============+=========================+==============================+
| > **Module | Security requirements   | **A.1**: Sensitive           |
| > A --     | for software that       | Authentication Data          |
| > Account  | stores, processes, or   |                              |
| > Data     | transmits account data. | **A.2**: Cardholder Data     |
| >          |                         | Protection                   |
| Protection |                         |                              |
| > Requ     |                         |                              |
| irements** |                         |                              |
+------------+-------------------------+------------------------------+

## Purpose and Scope

> This section (hereinafter referred to as the "Account Data Protection
> Module") defines security requirements and assessment procedures for
> software that stores, processes, or transmits Account Data. For the
> purposes of this module, account data is defined as follows:

+-----------------------------------+----------------------------------+
| > **Account Data**                |                                  |
+===================================+==================================+
| > **Cardholder Data includes:**   | > **Sensitive Authentication     |
|                                   | > Data includes:**               |
+-----------------------------------+----------------------------------+
| -   Primary Account Number (PAN)  | -   Full track data              |
|                                   |     > (magnetic-stripe data or   |
| -   Cardholder Name               |     > equivalent on a chip)      |
|                                   |                                  |
| -   Expiration Date               | -   CAV2/CVC2/CVV2/CID           |
|                                   |                                  |
| -   Service Code                  | -   PINs/PIN blocks              |
+-----------------------------------+----------------------------------+

> ***The primary account number (PAN) is the defining factor for
> cardholder data*.** If PAN is stored, processed, or transmitted or is
> otherwise present, the requirements in this module apply in addition
> to the Secure Software Core Requirements.
>
> The table on the following page illustrates commonly used elements of
> cardholder data and sensitive authentication data, whether storage of
> that data is permitted or prohibited, and whether this data needs to
> be protected. This table is not meant to be exhaustive, but it is
> presented to illustrate the different types of requirements that apply
> to each data element.

+---+-------+----------------+---------+-----------------------------+
|   |       | > **Data       | > **    | > **Render Stored Data      |
|   |       | > Element**    | Storage | > Unreadable per Control    |
|   |       |                | > Perm  | > Objective A.2.3**         |
|   |       |                | itted** |                             |
+===+=======+================+=========+=============================+
| > | > **  | > Primary      | > Yes   | > Yes                       |
|   | Cardh | > Account      |         |                             |
| * | older | > Number (PAN) |         |                             |
| * | > D   |                |         |                             |
| A | ata** |                |         |                             |
| c |       |                |         |                             |
| c |       |                |         |                             |
| o |       |                |         |                             |
| u |       |                |         |                             |
| n |       |                |         |                             |
| t |       |                |         |                             |
| > |       |                |         |                             |
|   |       |                |         |                             |
| D |       |                |         |                             |
| a |       |                |         |                             |
| t |       |                |         |                             |
| a |       |                |         |                             |
| * |       |                |         |                             |
| * |       |                |         |                             |
+---+-------+----------------+---------+-----------------------------+
|   |       | > Cardholder   | > Yes   | > No                        |
|   |       | > Name         |         |                             |
+---+-------+----------------+---------+-----------------------------+
|   |       | > Service Code | > Yes   | > No                        |
+---+-------+----------------+---------+-----------------------------+
|   |       | > Expiration   | > Yes   | > No                        |
|   |       | > Date         |         |                             |
+---+-------+----------------+---------+-----------------------------+
|   | *     | > Full Track   | > No    | > Cannot store per Control  |
|   | *Sens | > Data ^3^     |         | > Objective A.1.1           |
|   | itive |                |         |                             |
|   | Auth  |                |         |                             |
|   | entic |                |         |                             |
|   | ation |                |         |                             |
|   | Da    |                |         |                             |
|   | ta**2 |                |         |                             |
+---+-------+----------------+---------+-----------------------------+
|   |       | > CAV2/        | > No    | > Cannot store per Control  |
|   |       | CVC2/CVV2/CID4 |         | > Objective A.1.1           |
+---+-------+----------------+---------+-----------------------------+
|   |       | > PIN/PIN      | > No    | > Cannot store per Control  |
|   |       | > Block5       |         | > Objective A.1.1           |
+---+-------+----------------+---------+-----------------------------+

> Control Objectives A.2.2 and A.2.3 apply only to PAN. If PAN is stored
> with other elements of cardholder data, only the PAN must be rendered
> unreadable according to Control Objective A.2.3. Sensitive
> authentication data must not be stored after authorization, even if
> encrypted, unless the software is intended only for use by issuers or
> organizations that support issuing services. Only in those cases can
> sensitive authentication data be stored post-authorization.
>
> 2 *Sensitive authentication data must not be stored after
> authorization (even if encrypted).*
>
> 3 *Full track data from the magnetic stripe, equivalent data on the
> chip, or elsewhere.*
>
> 4 *The three- or four-digit value printed on the front or back of a
> payment card.*
>
> 5 *Personal identification number entered by cardholder during a
> card-present transaction, and/or encrypted PIN block present within
> the transaction message.*

## Security Requirements

+-----------------+---------------------------+------------------------+
| > **Control     | > **Test Requirements**   | > **Guidance**         |
| > Objectives**  |                           |                        |
+=================+===========================+========================+
| >               |                           |                        |
| []{#_bookmark35 |                           |                        |
| > .a            |                           |                        |
| nchor}**Control |                           |                        |
| > Objective     |                           |                        |
| > A.1:          |                           |                        |
| > Sensitive     |                           |                        |
| >               |                           |                        |
|  Authentication |                           |                        |
| > Data**        |                           |                        |
| >               |                           |                        |
| > Sensitive     |                           |                        |
| >               |                           |                        |
|  Authentication |                           |                        |
| > Data (SAD) is |                           |                        |
| > not retained  |                           |                        |
| > after         |                           |                        |
| >               |                           |                        |
|  authorization. |                           |                        |
+-----------------+---------------------------+------------------------+
| > **A.1.1** The | **A.1.1** Using           | Sensitive              |
| > software does | information obtained in   | authentication data    |
| > not store     | Test Requirement 1.1.a in | consists of full track |
| > sensitive     | the Core Requirements     | data, card validation  |
| >               | section, the assessor     | code or value, and PIN |
|  authentication | shall examine evidence    | data. Storage of       |
| > data after    | and test the software to  | sensitive              |
| > authorization | identify all potential    | authentication data    |
| > (even if      | storage locations for     | after authorization is |
| >               | Sensitive Authentication  | prohibited. This data  |
| > encrypted)    | Data, and to confirm that | is valuable to         |
| > unless the    | the software does not     | malicious individuals  |
| > software is   | store such data after     | as it allows them to   |
| > intended only | transaction authorization | generate counterfeit   |
| > for use by    | is complete. This         | payment cards and      |
| > issuers or    | includes storage of SAD   | create fraudulent      |
| > organizations | in temporary storage      | transactions.          |
| > that support  | (such as volatile         |                        |
| > issuing       | memory), semi-permanent   | Testing should include |
| > services.     | storage (such as RAM      | at least the following |
|                 | disks), and non-volatile  | types of files, as     |
|                 | storage (such as magnetic | well as any other      |
|                 | and flash storage media). | output generated by    |
|                 |                           | the payment software:  |
|                 | Where Sensitive           |                        |
|                 | Authentication Data is    | -   Incoming           |
|                 | stored after              |     > transaction data |
|                 | authorization, the        |                        |
|                 | assessor shall examine    | -   All logs (for      |
|                 | evidence to confirm that  |     > example,         |
|                 | the software is designed  |     > transaction,     |
|                 | explicitly for issuing    |     > history,         |
|                 | purposes or for use by    |     > debugging,       |
|                 | issuers or organizations  |     > error)           |
|                 | that support issuing      |                        |
|                 | services.                 | -   History files      |
|                 |                           |                        |
|                 |                           | -   Trace files        |
|                 |                           |                        |
|                 |                           | -   Audio and image    |
|                 |                           |     > files (for       |
|                 |                           |     > example, digital |
|                 |                           |     > voice and        |
|                 |                           |     > biometrics)      |
|                 |                           |                        |
|                 |                           | -   Non-volatile       |
|                 |                           |     > memory           |
|                 |                           |     > (including       |
|                 |                           |     > non-volatile     |
|                 |                           |     > cache)           |
|                 |                           |                        |
|                 |                           | -   Database schemas   |
|                 |                           |                        |
|                 |                           | -   Database contents  |
+-----------------+---------------------------+------------------------+

+-----------------+---------------------------+------------------------+
| > **Control     | > **Test Requirements**   | > **Guidance**         |
| > Objectives**  |                           |                        |
+=================+===========================+========================+
| >               |                           |                        |
| []{#_bookmark36 |                           |                        |
| > .a            |                           |                        |
| nchor}**Control |                           |                        |
| > Objective     |                           |                        |
| > A.2:          |                           |                        |
| > Cardholder    |                           |                        |
| > Data          |                           |                        |
| > Protection**  |                           |                        |
| >               |                           |                        |
| > Stored        |                           |                        |
| > cardholder    |                           |                        |
| > data is       |                           |                        |
| > protected.    |                           |                        |
+-----------------+---------------------------+------------------------+
| 1.  The         | 1.  The assessor shall    | The software vendor    |
|     > software  |     examine evidence to   | must provide details   |
|     > vendor    |     confirm that guidance | of all locations where |
|     > provides  |     is provided to        | the software may store |
|     > guidance  |     stakeholders in       | cardholder data,       |
|     > to        |     accordance with       | including in any       |
|                 |     Control Objective     | underlying software or |
|  > stakeholders |     12.1 that details:    | systems (such as OS,   |
|     > regarding |                           | databases, and so on), |
|     > secure    |     -   All locations     | as well as             |
|     > deletion  |         > where the       | instructions for       |
|     > of        |         > software stores | securely deleting the  |
|                 |         > cardholder      | data from these        |
|    > cardholder |         > data.           | locations once the     |
|     > data      |                           | data has exceeded any  |
|     > after     |     -   How to securely   | defined retention      |
|                 |         > delete          | period(s).             |
|    > expiration |         > cardholder data |                        |
|     > of        |         > stored by the   | Stakeholders must also |
|     > defined   |         > payment         | be provided with       |
|     > retention |         > software,       | configuration details  |
|                 |         > including       | for the underlying     |
|    > period(s). |         > cardholder data | systems that the       |
|                 |         > stored on       | software runs on to    |
|                 |         > underlying      | ensure these           |
|                 |         > software or     | underlying systems are |
|                 |         > systems (such   | not capturing          |
|                 |         > as in OS files  | cardholder data        |
|                 |         > or in           | without the            |
|                 |         > databases).     | stakeholder's          |
|                 |                           | knowledge.             |
|                 |     -   How to configure  |                        |
|                 |         > the underlying  | Stakeholders need to   |
|                 |         > software or     | know how underlying    |
|                 |         > systems to      | systems could be       |
|                 |         > prevent the     | capturing data from    |
|                 |         > inadvertent     | the software so they   |
|                 |         > capture or      | can either prevent it  |
|                 |         > retention of    | from being captured or |
|                 |         > cardholder data | ensure the data is     |
|                 |         > (for example,   | properly protected.    |
|                 |         > by system       |                        |
|                 |         > backup or       |                        |
|                 |         > restore         |                        |
|                 |         > points).        |                        |
+-----------------+---------------------------+------------------------+
| > **A.2.2** The | **A.2.2.a** The assessor  | The display of full    |
| > software      | shall examine evidence to | PAN on items such as   |
| > provides      | confirm that the software | computer screens,      |
| > features to   | provides features that    | payment card receipts, |
| > restrict or   | enable responsible        | logs, faxes, or paper  |
| > otherwise     | parties to restrict or    | reports can result in  |
| > mask all      | otherwise mask the        | this data being        |
| > displays of   | display of PAN to the     | obtained by            |
| > PAN to the    | minimum number of digits  | unauthorized           |
| > minimum       | required to meet a        | individuals and used   |
| > number of     | defined business need.    | fraudulently.          |
| > digits        |                           |                        |
| > required.     |                           | The masking approach   |
|                 |                           | should always ensure   |
|                 |                           | that only the minimum  |
|                 |                           | number of digits is    |
|                 |                           | displayed as necessary |
|                 |                           | to perform a specific  |
|                 |                           | business function. For |
|                 |                           | example, if only the   |
|                 |                           | last four digits are   |
|                 |                           | needed to perform a    |
|                 |                           | business function, the |
|                 |                           | software should        |
|                 |                           | provide features to    |
|                 |                           | mask the PAN so that   |
|                 |                           | individuals performing |
|                 |                           | that function can view |
|                 |                           | only the last four     |
|                 |                           | digits.                |
+-----------------+---------------------------+------------------------+
|                 | **A.2.2.b** The assessor  |                        |
|                 | shall examine evidence to |                        |
|                 | confirm that all displays |                        |
|                 | of PAN are completely     |                        |
|                 | masked by default, and    |                        |
|                 | that explicit             |                        |
|                 | authorization is required |                        |
|                 | to display any digits of  |                        |
|                 | the PAN.                  |                        |
+-----------------+---------------------------+------------------------+

+-----------------+---------------------------+------------------------+
| > **Control     | > **Test Requirements**   | > **Guidance**         |
| > Objectives**  |                           |                        |
+=================+===========================+========================+
|                 | **A.2.2.c** Where user    |                        |
|                 | input or interaction is   |                        |
|                 | required to configure PAN |                        |
|                 | masking features and      |                        |
|                 | options, the assessor     |                        |
|                 | shall examine evidence to |                        |
|                 | confirm that guidance on  |                        |
|                 | how to configure these    |                        |
|                 | features/options is       |                        |
|                 | provided to stakeholders  |                        |
|                 | in accordance with        |                        |
|                 | Control Objective 12.1.   |                        |
+-----------------+---------------------------+------------------------+
|                 | **A.2.2.d** The assessor  |                        |
|                 | shall test the software   |                        |
|                 | to confirm that all       |                        |
|                 | displays of PAN are       |                        |
|                 | completely masked by      |                        |
|                 | default, and that         |                        |
|                 | explicit authorization is |                        |
|                 | required to display any   |                        |
|                 | element of the PAN.       |                        |
+-----------------+---------------------------+------------------------+
| > **A.2.3** PAN | **A.2.3.a** The assessor  | Lack of protection of  |
| > is rendered   | shall examine evidence    | PANs can allow         |
| > unreadable    | and test the software to  | malicious individuals  |
| > anywhere it   | confirm that methods are  | to view or download    |
| > is stored     | implemented to render PAN | this data. The intent  |
| > (including    | unreadable anywhere it is | of truncation is that  |
| > data on       | stored using the          | only a portion (not to |
| > portable      | following methods:        | exceed the first six   |
| > digital       |                           | and last four digits)  |
| > media, backup | -   Truncation.           | of the PAN is stored.  |
| > media, and in |                           |                        |
| > logs) by      | -   Index tokens and      | The intent of strong   |
| > using any of  |     > pads, with the pads | cryptography is that   |
| > the following |     > being securely      | the encryption be      |
| > approaches:   |     > stored.             | based on an            |
|                 |                           | industry-tested and    |
| -   Truncation  | -   Strong cryptography,  | accepted algorithm     |
|     > (hashing  |     > with associated     | (not a proprietary or  |
|     > cannot be |     > key-management      | \"home-grown\"         |
|     > used to   |     > processes and       | algorithm) with strong |
|     > replace   |     > procedures.         | cryptographic keys.    |
|     > the       |                           |                        |
|     > truncated | ***Note**: The assessor   |                        |
|     > segment   | should examine several    |                        |
|     > of PAN).  | tables, files, log files, |                        |
|                 | and any other resources   |                        |
| -   Index       | created or generated by   |                        |
|     > tokens    | the software to verify    |                        |
|     > and pads  | the PAN is rendered       |                        |
|     > (pads     | unreadable.*              |                        |
|     > must be   |                           |                        |
|     > securely  |                           |                        |
|     > stored).  |                           |                        |
|                 |                           |                        |
| -   Strong      |                           |                        |
|                 |                           |                        |
|  > cryptography |                           |                        |
|     > with      |                           |                        |
|                 |                           |                        |
|    > associated |                           |                        |
|     >           |                           |                        |
|  key-management |                           |                        |
|     > processes |                           |                        |
|     > and       |                           |                        |
|                 |                           |                        |
|   > procedures. |                           |                        |
+-----------------+---------------------------+------------------------+
|                 | **A.2.3.b** Where user    |                        |
|                 | input or interaction is   |                        |
|                 | required to configure     |                        |
|                 | methods to render PAN     |                        |
|                 | unreadable when stored,   |                        |
|                 | the assessor shall        |                        |
|                 | examine evidence to       |                        |
|                 | confirm that guidance on  |                        |
|                 | configuring these options |                        |
|                 | is provided to            |                        |
|                 | stakeholders in           |                        |
|                 | accordance with Control   |                        |
|                 | Objective 12.1 and that   |                        |
|                 | the guidance includes the |                        |
|                 | following:                |                        |
|                 |                           |                        |
|                 | -   Details of any        |                        |
|                 |     > configurable        |                        |
|                 |     > options for each    |                        |
|                 |     > method used to      |                        |
|                 |     > render cardholder   |                        |
|                 |     > data unreadable,    |                        |
|                 |     > and instructions on |                        |
|                 |     > how to configure    |                        |
|                 |     > each method for all |                        |
|                 |     > locations where     |                        |
|                 |     > cardholder data is  |                        |
|                 |     > stored.             |                        |
|                 |                           |                        |
|                 | > *(continued on next     |                        |
|                 | > page)*                  |                        |
+-----------------+---------------------------+------------------------+

+-----------------+---------------------------+------------------------+
| > **Control     | > **Test Requirements**   | > **Guidance**         |
| > Objectives**  |                           |                        |
+=================+===========================+========================+
|                 | **A.2.3.b**               |                        |
|                 |                           |                        |
|                 | -   A list of all         |                        |
|                 |     > instances where     |                        |
|                 |     > cardholder data may |                        |
|                 |     > be output for       |                        |
|                 |     > storage outside of  |                        |
|                 |     > the payment         |                        |
|                 |     > application, and    |                        |
|                 |     > instructions that   |                        |
|                 |     > the implementing    |                        |
|                 |     > entity is           |                        |
|                 |     > responsible for     |                        |
|                 |     > rendering the PAN   |                        |
|                 |     > unreadable in all   |                        |
|                 |     > such instances.     |                        |
|                 |                           |                        |
|                 | -   Instruction that if   |                        |
|                 |     > debugging logs are  |                        |
|                 |     > ever enabled (for   |                        |
|                 |     > troubleshooting     |                        |
|                 |     > purposes) and they  |                        |
|                 |     > contain PAN, they   |                        |
|                 |     > must be protected,  |                        |
|                 |     > that debugging must |                        |
|                 |     > be disabled as soon |                        |
|                 |     > as troubleshooting  |                        |
|                 |     > is complete, and    |                        |
|                 |     > that debugging logs |                        |
|                 |     > must be securely    |                        |
|                 |     > deleted when no     |                        |
|                 |     > longer needed.      |                        |
+-----------------+---------------------------+------------------------+
|                 | **A.2.3.c** Where         |                        |
|                 | software creates both     |                        |
|                 | tokenized and truncated   |                        |
|                 | versions of the same PAN, |                        |
|                 | the assessor shall        |                        |
|                 | examine evidence and test |                        |
|                 | the software to confirm   |                        |
|                 | that the tokenized and    |                        |
|                 | truncated versions cannot |                        |
|                 | be correlated to          |                        |
|                 | reconstruct the original  |                        |
|                 | PAN.                      |                        |
+-----------------+---------------------------+------------------------+
|                 | **A.2.3.d** Where         |                        |
|                 | software creates or       |                        |
|                 | generates files for use   |                        |
|                 | outside the software (for |                        |
|                 | example, files generated  |                        |
|                 | for export or backup),    |                        |
|                 | including for storage on  |                        |
|                 | removable media, the      |                        |
|                 | assessor shall examine    |                        |
|                 | evidence and test the     |                        |
|                 | software to confirm that  |                        |
|                 | PAN is rendered           |                        |
|                 | unreadable.               |                        |
+-----------------+---------------------------+------------------------+
|                 | **A.2.3.e** If the        |                        |
|                 | software vendor stores    |                        |
|                 | PAN for any reason (for   |                        |
|                 | example, because log      |                        |
|                 | files, debugging files,   |                        |
|                 | and other data sources    |                        |
|                 | are received from         |                        |
|                 | customers for debugging   |                        |
|                 | or troubleshooting        |                        |
|                 | purposes), the assessor   |                        |
|                 | shall examine evidence    |                        |
|                 | and test the software to  |                        |
|                 | confirm that PAN is       |                        |
|                 | rendered unreadable in    |                        |
|                 | accordance with this      |                        |
|                 | control objective.        |                        |
+-----------------+---------------------------+------------------------+

# Module B -- Terminal Software Requirements

+------------+-------------------------+------------------------------+
| > **Module | > **Overview**          | > **Control Objectives**     |
| > Name**   |                         |                              |
+============+=========================+==============================+
| > **Module | Security requirements   | **B.1**: Terminal Software   |
| > B:       | for software intended   | Documentation                |
| > Terminal | for deployment and      |                              |
| > Software | execution on            | **B.2**: Terminal Software   |
| > Requ     | PCI-approved POI        | Design                       |
| irements** | devices.                |                              |
|            |                         | **B.3**: Terminal Software   |
|            |                         | Attack Mitigation            |
|            |                         |                              |
|            |                         | **B.4**: Terminal Software   |
|            |                         | Security Testing             |
|            |                         |                              |
|            |                         | **B.5**: Terminal Software   |
|            |                         | Implementation Guidance      |
+------------+-------------------------+------------------------------+

## Purpose and Scope

> This section (hereinafter referred to as the "Terminal Software
> Module" or "this module") defines security requirements and assessment
> procedures for payment software and applications that rely on the
> security features of PCI-approved POI devices to protect payment data.
> Software applications that are developed explicitly for deployment and
> execution on PCI-approved POI devices that do not meet the definition
> of Firmware as defined in the *PCI PIN Transaction Security (PTS)
> Point-of-Interaction (POI) Modular Security Requirements* (hereinafter
> referred to as the "PCI PTS POI Standard") are in scope for the
> requirements in this module.

## Background

> PCI-approved POI devices provide a high degree of confidentiality and
> integrity protection for payment data and payment transactions through
> the implementation of strict physical and logical protection
> mechanisms. Software that is deployed and executed on PCI-approved POI
> devices must not degrade or adversely affect the protection mechanisms
> provided by the device. In addition, the software must not provide
> features or functions that could allow those protection mechanisms to
> be circumvented or rendered ineffective.
>
> The requirements and assessment procedures defined in the Terminal
> Software Module have been developed to help ensure that terminal
> software protects payment data and does not introduce features,
> functions, or weaknesses that could enable an attacker to circumvent
> or render ineffective the protection mechanisms provided by the
> underlying PCI-approved POI devices upon which the software is
> intended to be deployed.

## Considerations

> Some assessment procedures in this module require examination of
> documentation describing the security features and functions of the
> underlying payment terminal. The terminal software vendor should work
> with their assessor(s), as well as the respective payment terminal
> vendors for each of the devices to be included as part of the terminal
> software evaluation, to identify and compile all device documentation
> needed for the terminal software evaluation. For more information
> about Secure Software assessment preparation and activities, refer to
> the *Secure Software Program Guide*.

## Security Requirements

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark42 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > B.1:         |                            |                       |
| > Terminal     |                            |                       |
| > Software     |                            |                       |
| > D            |                            |                       |
| ocumentation** |                            |                       |
| >              |                            |                       |
| > The software |                            |                       |
| > architecture |                            |                       |
| > is           |                            |                       |
| > documented   |                            |                       |
| > and includes |                            |                       |
| > diagrams     |                            |                       |
| > that         |                            |                       |
| > describe all |                            |                       |
| > software     |                            |                       |
| > components   |                            |                       |
| > and services |                            |                       |
| > in use and   |                            |                       |
| > how they     |                            |                       |
| > interact.    |                            |                       |
+----------------+----------------------------+-----------------------+
| 1.  The        | 1.  The assessor shall     | Software vendors      |
|     > software |     examine evidence to    | should also maintain  |
|     > vendor   |     confirm that           | detailed              |
|                |     documentation is       | documentation that    |
|    > maintains |     maintained that        | clearly and           |
|     >          |     describes the          | effectively describes |
|  documentation |     software's overall     | the overall design    |
|     > that     |     design and function    | and function of its   |
|                |     including, but not     | software, including   |
|    > describes |     limited to, the        | all services          |
|     > all      |     following:             | (internal and         |
|     > software |                            | external),            |
|                |     -   All third-party    | components, and       |
|  > components, |         > and open-source  | functions used and    |
|                |         > components,      | provided by the       |
|  > interfaces, |         > external         | software, and how     |
|     > and      |         > services, and    | those services,       |
|     > services |         > Application      | components, and       |
|     > provided |         > Programming      | functions interact.   |
|     > or used  |         > Interfaces       |                       |
|     > by the   |         > (APIs) used by   |                       |
|                |         > the software.    |                       |
|    > software. |                            |                       |
|                |     -   All User           |                       |
|                |         > Interfaces (UI)  |                       |
|                |         > and APIs         |                       |
|                |         > provided or made |                       |
|                |         > accessible by    |                       |
|                |         > the software.    |                       |
+----------------+----------------------------+-----------------------+
| > **B.1.2**    | **B.1.2.a** The assessor   | In addition to        |
| > The software | shall examine evidence to  | identifying the       |
| > vendor       | confirm that documentation | components,           |
| > maintains    | is maintained that         | interfaces, and       |
| >              | describes all sensitive    | services exposed by   |
|  documentation | data flows including, but  | the software, the     |
| > that         | not limited to, the        | software vendor       |
| > describes    | following:                 | should also maintain  |
| > all data     |                            | documentation that    |
| > flows and    | -   All sensitive data     | clearly identifies    |
| > functions    |     > stored, processed,   | and describes the     |
| > that involve |     > or transmitted by    | types of data stored, |
| > sensitive    |     > the software.        | processed, and        |
| > data.        |                            | transmitted by the    |
| >              | -   All locations where    | software; whether and |
| > ***Note:**   |     > sensitive data is    | how that data is      |
| > This control |     > stored, including    | shared between        |
| > objective is |     > both temporary and   | components and        |
| > an extension |     > persistent storage   | functions; and the    |
| > of Control   |     > locations.           | protection mechanisms |
| > Objectives   |                            | implemented or relied |
| > 1.1 and 1.2. | -   How sensitive data is  | upon by the software  |
| > Validation   |     > securely deleted     | to protect that data. |
| > of these     |     > from storage (both   | This type of          |
| > control      |     > temporary and        | documentation         |
| > objectives   |     > persistent) when no  | clarifies how data is |
| > should be    |     > longer needed.       | stored, processed, or |
| > performed at |                            | transmitted by the    |
| > the same     |                            | software, with whom   |
| > time.*       |                            | the data is shared,   |
|                |                            | and how the software  |
|                |                            | may be attacked to    |
|                |                            | gain access to the    |
|                |                            | software's critical   |
|                |                            | assets.               |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.1.2.b** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that documentation |                       |
|                | is maintained that         |                       |
|                | describes all functions    |                       |
|                | that handle sensitive data |                       |
|                | including, but not limited |                       |
|                | to, the following:         |                       |
|                |                            |                       |
|                | -   All inputs, outputs,   |                       |
|                |     > and possible error   |                       |
|                |     > conditions for each  |                       |
|                |     > function that        |                       |
|                |     > handles sensitive    |                       |
|                |     > data.                |                       |
|                |                            |                       |
|                | -   All cryptographic      |                       |
|                |     > algorithms, modes of |                       |
|                |     > operation, and       |                       |
|                |     > associated key       |                       |
|                |     > management practices |                       |
|                |     > for all functions    |                       |
|                |     > that employ          |                       |
|                |     > cryptography for the |                       |
|                |     > protection of        |                       |
|                |     > sensitive data.      |                       |
+----------------+----------------------------+-----------------------+
| > **B.1.3**    | **B.1.3** The assessor     | Software vendors      |
| > The software | shall examine evidence to  | should identify all   |
| > vendor       | confirm that documentation | configurable options  |
| > maintains    | is maintained that         | available within      |
| >              | describes all configurable | their software,       |
|  documentation | options provided or made   | particularly those    |
| > that         | available by the software  | that control security |
| > describes    | that can impact the        | features and          |
| > all          | security of sensitive data | functions.            |
| > configurable | including, but not limited | Configurable features |
| > options that | to, the following:         | must be considered as |
| > can affect   |                            | potential avenues for |
| > the security | -   All configurable       | attacking the         |
| > of sensitive |     > options that could   | software. Where       |
| > data.        |     > allow access to      | configurable options  |
|                |     > sensitive data.      | enable control over   |
|                |                            | security features and |
|                | -   All configurable       | functions, robust     |
|                |     > options that could   | security controls     |
|                |     > enable modification  | should be implemented |
|                |     > of any mechanisms    | to protect the        |
|                |     > used to protect      | configurable security |
|                |     > sensitive data.      | features from being   |
|                |                            | misused.              |
|                | -   All remote access      | Additionally, all     |
|                |     > features, functions, | configurable options  |
|                |     > and parameters       | should be configured  |
|                |     > provided or made     | to their most secure  |
|                |     > available by the     | settings by default   |
|                |     > software.            | in accordance with    |
|                |                            | Control Objective 2.  |
|                | -   All remote update      |                       |
|                |     > features, functions, |                       |
|                |     > and parameters       |                       |
|                |     > provided or made     |                       |
|                |     > available by the     |                       |
|                |     > software.            |                       |
|                |                            |                       |
|                | -   The default settings   |                       |
|                |     > for each             |                       |
|                |     > configurable option. |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark43 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > B.2:         |                            |                       |
| > Terminal     |                            |                       |
| > Software     |                            |                       |
| > Design**     |                            |                       |
| >              |                            |                       |
| > The software |                            |                       |
| > does not     |                            |                       |
| > implement    |                            |                       |
| > any feature  |                            |                       |
| > that enables |                            |                       |
| > the security |                            |                       |
| > features,    |                            |                       |
| > functions,   |                            |                       |
| > and          |                            |                       |
| > c            |                            |                       |
| haracteristics |                            |                       |
| > of the       |                            |                       |
| > payment      |                            |                       |
| > terminal to  |                            |                       |
| > be           |                            |                       |
| > circumvented |                            |                       |
| > or rendered  |                            |                       |
| > ineffective. |                            |                       |
+----------------+----------------------------+-----------------------+
| 1.  The        | 1.  The assessor shall     | Payment terminals     |
|     > software |     examine evidence to    | provide a high degree |
|     > is       |     determine the payment  | of confidentiality    |
|     > intended |     terminals upon which   | and integrity         |
|     > for      |     the software is to be  | protection for        |
|                |     deployed. For each of  | payment data and      |
|   > deployment |     the payment terminals  | payment transactions  |
|     > and      |     identified and         | through the           |
|                |     included in the        | implementation of     |
|    > operation |     software assessment,   | strict physical and   |
|     > on       |     the assessor shall     | logical protection    |
|     > payment  |     examine the payment    | mechanisms. Software  |
|                |     terminal's device      | that is deployed and  |
|    > terminals |     characteristics and    | executed on these     |
|     >          |     compare them with the  | payment terminals     |
|  (PCI-approved |     following              | should use the        |
|     > POI      |     characteristics        | approved features and |
|                |     specified in the *PCI  | functions provided by |
|    > devices). |     SSC's List of Approved | the payment terminal  |
|                |     PTS Devices* to        | rather than           |
|                |     confirm they match:    | implementing its own  |
|                |                            | equivalent features   |
|                |     -   Model name/number  | or functions, to      |
|                |                            | avoid exposing        |
|                |     -   PTS approval       | vulnerabilities or    |
|                |         > number           | other weaknesses that |
|                |                            | could allow an        |
|                |     -   Hardware version   | attacker to           |
|                |         > number           | circumvent or render  |
|                |                            | ineffective the       |
|                |     -   Firmware version   | security features of  |
|                |         > number(s)        | the payment terminal. |
+----------------+----------------------------+-----------------------+
| > **B.2.2**    | **B.2.2.a** The assessor   | To ensure software    |
| > The software | shall examine evidence     | does not degrade or   |
| > uses only    | (including source code) to | defeat the security   |
| > the external | determine whether the      | mechanisms provided   |
| >              | software supports external | by the underlying     |
|  communication | communications.            | payment terminal, the |
| > methods      |                            | software must use the |
| > included in  |                            | device- provided      |
| > the payment  |                            | security features and |
| > terminal's   |                            | functions in          |
| > PTS device   |                            | accordance with the   |
| > evaluation.  |                            | payment terminal      |
| >              |                            | vendor's security     |
| > ***Note:**   |                            | guidance/policy. This |
| > The payment  |                            | is particularly true  |
| > terminal may |                            | for external          |
| > provide an   |                            | communication         |
| > IP stack     |                            | methods. Under no     |
| > approved per |                            | circumstances should  |
| > the PTS Open |                            | the software provide  |
| > Protocols    |                            | its own communication |
| > module, or   |                            | methods (for example, |
| > the device   |                            | VMs, IP stack,        |
| > may provide  |                            | scripting languages,  |
| > serial ports |                            | and so on) to control |
| > or modems    |                            | device-level          |
| > approved by  |                            | interfaces. The       |
| > the PTS      |                            | introduction of any   |
| > evaluation   |                            | such function by the  |
| > to           |                            | software could        |
| > communicate  |                            | introduce new         |
| > transaction  |                            | vulnerabilities or    |
| > data         |                            | weaknesses that would |
| > encrypted by |                            | allow malicious       |
| > its PCI PTS  |                            | entities to           |
| > SRED         |                            | circumvent the        |
| > functions.   |                            | security protections  |
| > Using any    |                            | provided by the       |
| > external     |                            | payment terminal and  |
| >              |                            | degrade the overall   |
|  communication |                            | security              |
| > methods not  |                            | characteristics of    |
| > included in  |                            | both the software and |
| > the          |                            | the underlying        |
| > PCI-approved |                            | device.               |
| > POI device   |                            |                       |
| > evaluation   |                            |                       |
| > invalidates  |                            |                       |
| > the PTS      |                            |                       |
| > approval,    |                            |                       |
| > and such use |                            |                       |
| > is           |                            |                       |
| > prohibited   |                            |                       |
| > for terminal |                            |                       |
| > software.*   |                            |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.2.b** Where the      |                       |
|                | software supports external |                       |
|                | communications, the        |                       |
|                | assessor shall examine all |                       |
|                | relevant payment terminal  |                       |
|                | documentation (including   |                       |
|                | the payment terminal       |                       |
|                | vendor's security          |                       |
|                | guidance/policy) to        |                       |
|                | determine which external   |                       |
|                | communication              |                       |
|                |                            |                       |
|                | methods were included in   |                       |
|                | the payment terminal's PTS |                       |
|                | device evaluation.         |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.2.c** The assessor   |                       |
|                | shall examine evidence     |                       |
|                | (including source code) to |                       |
|                | confirm that the software  |                       |
|                | uses only the external     |                       |
|                | communication methods      |                       |
|                | included in the payment    |                       |
|                | terminal's PTS device      |                       |
|                | evaluation and does not    |                       |
|                | implement its own external |                       |
|                | communication methods or   |                       |
|                | IP stack.                  |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **B.2.2.1**  | > **B.2.2.1** The assessor | Payment terminal      |
| > Where the    | > shall examine all        | vendor security       |
| > software     | > relevant payment         | guidance/policy is    |
| > relies on    | > terminal documentation   | intended for          |
| > the Open     | > (including the payment   | application           |
| > Protocols    | > terminal vendor's        | developers, system    |
| > feature of   | > security                 | integrators, and      |
| > the payment  | > guidance/policy) and all | end-users of the      |
| > terminal,    | > relevant software vendor | platform to meet the  |
| > the software | > process documentation    | PCI PTS POI Open      |
| > is developed | > and software design      | Protocol (as well as  |
| > in           | > documentation to confirm | other PTS)            |
| > accordance   | > that the software is     | requirements as part  |
| > with the     | > developed in accordance  | of a PCI-approved POI |
| > payment      | > with the payment         | device evaluation.    |
| > terminal     | > terminal vendor's        |                       |
| > vendor's     | > security                 |                       |
| > security     | > guidance/policy.         |                       |
| > gu           |                            |                       |
| idance/policy. |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.2.2.2**  | > **B.2.2.2** The assessor | The Open Protocol     |
| > The software | > shall examine evidence   | requirements in the   |
| > does not     | > (including source code)  | *PCI PTS POI          |
| > circumvent,  | > to confirm that the      | Standard* ensure that |
| > bypass, or   | > software does not        | open protocols and    |
| > add          | > circumvent, bypass, or   | services in payment   |
| > additional   | > add additional services  | terminals do not have |
| > services or  | > or protocols to the Open | vulnerabilities that  |
| > protocols to | > Protocols of the payment | can be remotely       |
| > the Open     | > terminal as approved and | exploited and yield   |
| > Protocols of | > documented in the        | access to sensitive   |
| > the payment  | > payment terminal         | data or sensitive     |
| > terminal as  | > vendor's security        | resources in the      |
| > approved and | > guidance/policy. This    | payment terminal. The |
| > documented   | > includes the use of:     | payment terminal      |
| > in the       |                            | vendor defines what   |
| > payment      | -   Link Layer protocols   | protocols and         |
| > terminal     |                            | services are          |
| > vendor's     | -   IP protocols           | supported by the      |
| > security     |                            | payment terminal and  |
| > gu           | -   Security protocols     | provides guidance to  |
| idance/policy. |                            | their use.            |
| > This         | -   IP Services            |                       |
| > includes the |                            | Adding or enabling    |
| > use of:      |                            | additional services   |
|                |                            | or protocols or       |
| -   Link Layer |                            | failing to follow the |
|                |                            | issued payment        |
|    > protocols |                            | terminal vendor's     |
|                |                            | security              |
| -   IP         |                            | guidance/policy       |
|                |                            | invalidates the       |
|    > protocols |                            | approval status of    |
|                |                            | that device for that  |
| -   Security   |                            | implementation.       |
|                |                            |                       |
|    > protocols |                            |                       |
|                |                            |                       |
| -   IP         |                            |                       |
|     > Services |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.2.3**    | **B.2.3.a** The assessor   | Payment terminals are |
| > The software | shall examine evidence     | designed to provide   |
| > does not     | (including source code) to | robust cryptographic  |
| > bypass or    | determine whether the      | and key management    |
| > render       | software provides          | functions. For        |
| > ineffective  | encryption of sensitive    | example, PCI PTS      |
| > any          | data. Where the software   | POI-approved devices  |
| > encryption   | does provide such a        | are verified to meet  |
| > methods or   | function, the assessor     | stringent             |
| > account data | shall confirm the software | requirements for      |
| > security     | does not bypass or render  | loading, managing,    |
| > methods      | ineffective any encryption | and protecting        |
| > implemented  | methods or account data    | cryptographic keys.   |
| > by the       | security methods           |                       |
| > payment      | implemented by the payment | Software that         |
| > terminal in  | terminal as follows:       | provides its own data |
| > accordance   |                            | encryption methods    |
| > with the     |                            | must not include      |
| > payment      |                            | methods that would    |
| > terminal     |                            | enable an attacker to |
| > vendor's     |                            | bypass or render      |
| > security     |                            | ineffective the       |
| > gu           |                            | encryption methods    |
| idance/policy. |                            | implemented by the    |
|                |                            | payment terminal and  |
|                |                            | required by the       |
|                |                            | payment terminal      |
|                |                            | vendor's security     |
|                |                            | guidance/policy.      |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.2.3.b** The assessor   |                       |
|                | shall examine all relevant |                       |
|                | payment terminal           |                       |
|                | documentation (including   |                       |
|                | payment terminal vendor    |                       |
|                | security                   |                       |
|                | guidance/policy)to         |                       |
|                | determine which encryption |                       |
|                | methods are provided by    |                       |
|                | the payment terminal.      |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.3.c** The assessor   |                       |
|                | shall examine evidence     |                       |
|                | (including source code) to |                       |
|                | confirm that the software  |                       |
|                | does not bypass or render  |                       |
|                | ineffective any encryption |                       |
|                | methods provided by the    |                       |
|                | payment terminal in        |                       |
|                | accordance with the        |                       |
|                | payment terminal vendor's  |                       |
|                | security guidance/policy.  |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.3.d** Where the      |                       |
|                | software provides          |                       |
|                | encryption of sensitive    |                       |
|                | data, but the payment      |                       |
|                | terminal is not required   |                       |
|                | to provide approved        |                       |
|                | encryption methods (per    |                       |
|                | the *PCI PTS POI           |                       |
|                | Standard*), the assessor   |                       |
|                | shall examine evidence     |                       |
|                | (including source code) to |                       |
|                | confirm that the           |                       |
|                | encryption methods used or |                       |
|                | implemented by the         |                       |
|                | software for encrypting    |                       |
|                | sensitive data provide     |                       |
|                | "strong cryptography" and  |                       |
|                | are implemented in         |                       |
|                | accordance with Control    |                       |
|                | Objectives 7.1 and 7.2.    |                       |
+----------------+----------------------------+-----------------------+
| > **B.2.4**    | **B.2.4.a** The assessor   | The unpredictability  |
| > The software | shall examine evidence     | of random numbers is  |
| > uses only    | (including source code) to | of critical           |
| > the random   | determine whether the      | importance to ensure  |
| > number       | software requires random   | the effectiveness of  |
| > generation   | values to be generated for | cryptographic         |
| > function(s)  | any cryptographic          | operations. It is not |
| > included in  | operations involving       | a trivial endeavor to |
| > the payment  | sensitive data or          | design and implement  |
| > terminal's   | sensitive functions.       | a secure random       |
| > PTS device   |                            | number generator. For |
| > evaluation   |                            | this reason, the      |
| > for all      |                            | terminal software     |
| >              |                            | should only use the   |
|  cryptographic |                            | random number         |
| > operations   |                            | generation            |
| > involving    |                            | function(s)           |
| > sensitive    |                            | implemented by the    |
| > data or      |                            | payment terminal for  |
| > sensitive    |                            | all cryptographic     |
| > functions    |                            | operations involving  |
| > where random |                            | sensitive data or     |
| > values are   |                            | sensitive functions   |
| > required and |                            | where random values   |
| > does not     |                            | are required.         |
| > implement    |                            |                       |
| > its own      |                            |                       |
| > random       |                            |                       |
| > number       |                            |                       |
| > generation   |                            |                       |
| > function(s). |                            |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.4.b** Where the      |                       |
|                | software requires random   |                       |
|                | values for cryptographic   |                       |
|                | operations involving       |                       |
|                | sensitive data or          |                       |
|                | sensitive functions, the   |                       |
|                | assessor shall examine all |                       |
|                | relevant payment terminal  |                       |
|                | documentation (including   |                       |
|                | payment terminal vendor    |                       |
|                | security guidance/policy)  |                       |
|                | to determine all of the    |                       |
|                | random number generation   |                       |
|                | functions included in the  |                       |
|                | payment terminal's PTS     |                       |
|                | device evaluation.         |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.2.4.c** The assessor   |                       |
|                | shall examine evidence     |                       |
|                | (including source code) to |                       |
|                | confirm that the software  |                       |
|                | uses only the random       |                       |
|                | number generation          |                       |
|                | function(s) included in    |                       |
|                | the payment terminal's PTS |                       |
|                | device evaluation for all  |                       |
|                | cryptographic functions    |                       |
|                | involving sensitive data   |                       |
|                | or sensitive functions     |                       |
|                | where random values are    |                       |
|                | required and does not      |                       |
|                | implement its own random   |                       |
|                | number generation          |                       |
|                | function(s).               |                       |
+----------------+----------------------------+-----------------------+
| > **B.2.5**    | **B.2.5.a** The assessor   | Many payment          |
| > The software | shall examine evidence     | terminals provide     |
| > does not     | (including source code) to | mechanisms for the    |
| > provide,     | determine all logical      | secure reading and    |
| > through its  | interfaces of the          | exchange of data      |
| > own logical  | software, including:       | (SRED).               |
| >              |                            |                       |
|  interface(s), | -   All logical interfaces | These mechanisms are  |
| > the sharing  |     > and the purpose and  | rigorously tested as  |
| > of           |     > function of each.    | part of the payment   |
| > clear-text   |                            | terminal's PTS device |
| > account data | -   The logical interfaces | evaluation to confirm |
| > directly     |     > intended for sharing | that the              |
| > with other   |     > clear-text account   | confidentially and    |
| > software.    |     > data, such as those  | integrity of clear-   |
| >              |     > used to pass         | text account data is  |
| > ***Note:**   |     > clear-text account   | maintained during     |
| > The software |     > data back to the     | information exchange  |
| > is allowed   |     > approved firmware of | with the payment      |
| > to share     |     > the payment          | terminal's firmware.  |
| > clear-text   |     > terminal.            |                       |
| > account data |                            | Software that         |
| > directly     | -   The logical interfaces | provides its own      |
| > with the     |     > not intended for     | mechanisms for        |
| > payment      |     > sharing of           | sharing clear-text    |
| > terminal's   |     > clear-text account   | account data directly |
| > firmware.*   |     > data, such as those  | with other software   |
|                |     > for communication    | is more likely to be  |
|                |     > with other software. | prone to attacks and  |
|                |                            | the unintended or     |
|                |                            | unauthorized          |
|                |                            | disclosure of         |
|                |                            | clear-text account    |
|                |                            | data than software    |
|                |                            | that uses the payment |
|                |                            | terminal-provided     |
|                |                            | SRED (or similar)     |
|                |                            | functions.            |
+----------------+----------------------------+-----------------------+
|                | **B.2.5.b** The assessor   |                       |
|                | shall examine evidence     |                       |
|                | (including source code) to |                       |
|                | confirm that the software  |                       |
|                | does not allow sharing of  |                       |
|                | clear-text account data    |                       |
|                | directly with other        |                       |
|                | software through its own   |                       |
|                | logical interfaces.        |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.5.c** The assessor   |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall test the software    |                       |
|                | using all software         |                       |
|                | functions that handle      |                       |
|                | account data to confirm    |                       |
|                | that the software does not |                       |
|                | allow the sharing of       |                       |
|                | clear-text account data    |                       |
|                | directly with other        |                       |
|                | software through its own   |                       |
|                | logical interfaces.        |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **B.2.6**    | **B.2.6.a** The assessor   | > Where the software  |
| > The software | shall examine evidence     | > uses or integrates  |
| > uses and/or  | (including source code) to | > shared resources    |
| > integrates   | determine whether and how  | > provided by the     |
| > all shared   | the software connects to   | > payment terminal,   |
| > resources    | and/or uses any shared     | > the software must   |
| > securely and | resources provided by the  | > use or integrate    |
| > in           | payment terminal, and to   | > resources in        |
| > accordance   | confirm that:              | > accordance with the |
| > with the     |                            | > payment terminal    |
| > payment      | -   The guidance required  | > vendor's            |
| > terminal     |     > in Control           | > guidance/policy.    |
| > vendor's     |     > Objectives 12.1 and  | > Failure to use such |
| > security     |                            | > shared resources in |
| > gu           | > B.5.1 includes detailed  | > accordance with     |
| idance/policy. | > instructions for how to  | > payment terminal    |
|                | > configure the software   | > guidance puts any   |
|                | > to ensure secure         | > sensitive data      |
|                | > integration with shared  | > shared with such    |
|                | > resources.               | > resources at        |
|                |                            | > greater risk of     |
|                | -   The required guidance  | > unauthorized        |
|                |     > for secure           | > disclosure.         |
|                |     > integration with     |                       |
|                |     > shared resources is  |                       |
|                |     > in accordance with   |                       |
|                |     > the payment terminal |                       |
|                |     > vendor's security    |                       |
|                |     > guidance/policy.     |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.6.b** The assessor   |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall test the software    |                       |
|                | using all software         |                       |
|                | functions that use or      |                       |
|                | integrate shared resources |                       |
|                | to confirm that any        |                       |
|                | connections to or use of   |                       |
|                | shared resources are       |                       |
|                | handled securely.          |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **B.2.7**    | **B.2.7.a** The assessor   | Many payment          |
| > The software | shall examine all relevant | terminals enforce     |
| > does not     | payment terminal           | logical separation    |
| > bypass or    | documentation (including   | between software      |
| > render       | the payment terminal       | applications. In the  |
| > ineffective  | vendor's security          | context of this       |
| > any          | guidance/policy) to        | module, software      |
| > application  | determine whether and how  | applications are      |
| > segregation  | application segregation is | logical entities that |
| > enforced by  | enforced by the payment    | do not meet the PTS   |
| > the payment  | terminal.                  | definition of         |
| > terminal.    |                            | "firmware."           |
|                |                            |                       |
|                |                            | Logical application   |
|                |                            | segmentation controls |
|                |                            | are intended to       |
|                |                            | prevent one           |
|                |                            | application on the    |
|                |                            | payment terminal from |
|                |                            | interfering or        |
|                |                            | tampering with other  |
|                |                            | applications.         |
|                |                            | However, these        |
|                |                            | logical segregation   |
|                |                            | controls are not      |
|                |                            | intended to prevent   |
|                |                            | applications from     |
|                |                            | sharing data. They    |
|                |                            | are mainly intended   |
|                |                            | to prevent            |
|                |                            | applications from     |
|                |                            | modifying the         |
|                |                            | structure or function |
|                |                            | of other applications |
|                |                            | or the payment        |
|                |                            | terminal's firmware.  |
|                |                            |                       |
|                |                            | To preserve the       |
|                |                            | integrity of payment  |
|                |                            | terminal              |
|                |                            | ap                    |
|                |                            | plication-segregation |
|                |                            | controls, all         |
|                |                            | terminal software     |
|                |                            | should adhere to      |
|                |                            | those segregation     |
|                |                            | controls and not      |
|                |                            | include or introduce  |
|                |                            | any function(s) that  |
|                |                            | would allow the       |
|                |                            | software to be used   |
|                |                            | (intentionally or     |
|                |                            | unintentionally) to   |
|                |                            | bypass or defeat      |
|                |                            | device-level          |
|                |                            | application           |
|                |                            | segregation.          |
+----------------+----------------------------+-----------------------+
|                | **B.2.7.b** The assessor   |                       |
|                | shall examine evidence     |                       |
|                | (including source code) to |                       |
|                | confirm that the software  |                       |
|                | does not introduce any     |                       |
|                | function(s) that would     |                       |
|                | allow it to bypass or      |                       |
|                | defeat any device- level   |                       |
|                | application segregation    |                       |
|                | controls.                  |                       |
+----------------+----------------------------+-----------------------+
| > **B.2.8**    | **B.2.8.a** The assessor   | To support            |
| > All software | shall examine the guidance | cryptographic         |
| > files are    | required in Control        | authentication of     |
| > cry          | Objectives 12.1 and B.5.1  | software files by the |
| ptographically | to confirm that it         | payment terminal,     |
| > signed to    | includes detailed          | software vendors must |
| > enable       | instructions for how to    | cryptographically     |
| >              | cryptographically sign the | "sign" all of the     |
|  cryptographic | software files in a manner | software files        |
| >              | that enables the           | (including all        |
| authentication | cryptographic              | binaries, libraries,  |
| > of the       | authentication of all such | and configuration     |
| > software     | files by the payment       | files) using digital  |
| > files by the | terminal.                  | certificates where    |
| > payment      |                            | the payment terminal  |
| > terminal     |                            | vendor is included in |
| > firmware.    |                            | the certificate       |
|                |                            | chain.                |
|                |                            |                       |
|                |                            | Additionally, the     |
|                |                            | cryptographic signing |
|                |                            | process should        |
|                |                            | incorporate the use   |
|                |                            | of a secure           |
|                |                            | cryptographic device  |
|                |                            | (SCD), typically      |
|                |                            | provided by the       |
|                |                            | payment terminal      |
|                |                            | vendor. Cryptographic |
|                |                            | signing should also   |
|                |                            | be performed under    |
|                |                            | dual control to       |
|                |                            | protect the integrity |
|                |                            | of all cryptographic  |
|                |                            | keys, software files, |
|                |                            | and the cryptographic |
|                |                            | signing process in    |
|                |                            | general.              |
+----------------+----------------------------+-----------------------+
|                | **B.2.8.b** The assessor   |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall confirm that all     |                       |
|                | software files are         |                       |
|                | cryptographically signed   |                       |
|                | in a manner that enables   |                       |
|                | the cryptographic          |                       |
|                | authentication of all      |                       |
|                | software files.            |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.2.8.c** Where the      |                       |
|                | software supports the      |                       |
|                | loading of files outside   |                       |
|                | of the base software       |                       |
|                | package(s), the assessor   |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | determine whether each of  |                       |
|                | those files is             |                       |
|                | cryptographically signed   |                       |
|                | in a manner that enables   |                       |
|                | the cryptographic          |                       |
|                | authentication of those    |                       |
|                | files by the payment       |                       |
|                | terminal. For any files    |                       |
|                | that cannot be             |                       |
|                | cryptographically signed,  |                       |
|                | the assessor shall justify |                       |
|                | why the inability to       |                       |
|                | cryptographically sign     |                       |
|                | such files does not        |                       |
|                | adversely affect the       |                       |
|                | security of the software   |                       |
|                | or the underlying payment  |                       |
|                | terminal.                  |                       |
+----------------+----------------------------+-----------------------+
|                | **B.2.8.d** The assessor   | Where terminal        |
|                | shall examine evidence     | software supports EMV |
|                | (including source code) to | payment transactions, |
|                | determine whether and how  | the EMV Certificate   |
|                | the software supports EMV | Authority public keys |
|                | payment transactions.      | should also be signed |
|                | Where EMV payment          | and cryptographically |
|                | transactions are supported | authenticated using   |
|                | by the software, the       | the same methods and  |
|                | assessor shall install and | procedures as the     |
|                | configure the software in  | terminal software     |
|                | accordance with the        | files.                |
|                | guidance required in       |                       |
|                | Control Objectives 12.1    |                       |
|                | and B.5.1. Using an        |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall confirm that all EMV |                       |
|                | Certification Authority    |                       |
|                | Public Keys are            |                       |
|                | cryptographically signed   |                       |
|                | in a manner that enables   |                       |
|                | the cryptographic          |                       |
|                | authentication of those    |                       |
|                | files by the payment       |                       |
|                | terminal.                  |                       |
+----------------+----------------------------+-----------------------+
| > **B.2.9**    | **B.2.9.a** The assessor   | Sensitive data        |
| > The          | shall examine evidence     | (including PIN and    |
| > integrity of | (including source code) to | other account data)   |
| > software     | determine whether the      | captured and handled  |
| > prompt files | software supports the use  | by the software and   |
| > is protected | of data entry prompts      | underlying payment    |
| > in           | and/or prompt files. Where | terminal is often     |
| > accordance   | the software supports such | controlled using      |
| > with Control | features, the assessor     | prompt files.         |
| > Objective    | shall confirm the software |                       |
| > B.2.8.       | protects the integrity of  | Prompt files are      |
|                | those prompts as defined   | configuration files   |
|                | in Test Requirements       | that control software |
|                | B.2.9.b through B.2.9.c.   | display prompts. To   |
|                |                            | preserve the          |
|                |                            | integrity of the      |
|                |                            | prompts, prompt files |
|                |                            | should be stored and  |
|                |                            | managed securely.     |
|                |                            | Anywhere clear-text   |
|                |                            | data entry is allowed |
|                |                            | by the software,      |
|                |                            | prompt controls       |
|                |                            | should be             |
|                |                            | implemented.          |
|                |                            |                       |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.2.9.b** The assessor   | Many prompt files are |
|                | shall examine the guidance | stored within a       |
|                | required in Control        | secure boundary of    |
|                | Objectives 12.1 and B.5.1  | the device, such as a |
|                | to confirm that it         | Secure Chip or Secure |
|                | includes detailed          | Element or within a   |
|                | instructions for           | Trusted Execution     |
|                | stakeholders to            | Environment. When     |
|                | cryptographically sign all | prompt files are to   |
|                | prompt files in a manner   | be maintained in      |
|                | that enables the           | shared storage        |
|                | cryptographic              | locations, the files  |
|                | authentication of all such | should be             |
|                | files in accordance with   | cryptographically     |
|                | B.2.8.                     | signed and            |
|                |                            | authenticated by the  |
|                |                            | payment terminal      |
|                |                            | prior to installation |
|                |                            | or execution.         |
+----------------+----------------------------+-----------------------+
|                | **B.2.9.c** The assessor   |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall confirm that all     |                       |
|                | prompt files are           |                       |
|                | cryptographically signed   |                       |
|                | in a manner that enables   |                       |
|                | the cryptographic          |                       |
|                | authentication of those    |                       |
|                | files by the payment       |                       |
|                | terminal in accordance     |                       |
|                | with B.2.8.                |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark44 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > B.3:         |                            |                       |
| > Terminal     |                            |                       |
| > Software     |                            |                       |
| > Attack       |                            |                       |
| > Mitigation** |                            |                       |
| >              |                            |                       |
| > Software     |                            |                       |
| > security     |                            |                       |
| > controls are |                            |                       |
| > implemented  |                            |                       |
| > to mitigate  |                            |                       |
| > software     |                            |                       |
| > attacks.     |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.3.1**    | **B.3.1.a** The assessor   | Any terminal software |
| > The software | shall examine evidence     | functions that accept |
| > validates    | (including source code) to | externally supplied   |
| > all user and | identify all locations     | data (directly or     |
| > other        | where the software accepts | indirectly) is a      |
| > external     | input data from untrusted  | potential attack      |
| > inputs.      | sources. For each          | vector, particularly  |
| >              | instance, the assessor     | when the data is      |
| > ***Note:**   | shall confirm that input   | processed by an       |
| > Control      | data is required to        | interpreter.          |
| > Objectives   | conform to a list of       |                       |
| > B.3.1        | expected characteristics   | Injection attacks are |
| > through      | and that all input that    | common for almost all |
| > B.3.3 are    | does not conform to the    | types of software and |
| > extensions   | list of expected           | are intended to       |
| > of Control   | characteristics is         | manipulate input data |
| > Objective    | rejected by the software   | in a way that causes  |
| > 4.2.         | or otherwise handled       | software to behave    |
| > Validation   | securely.                  | unexpectedly or       |
| > of these     |                            | unintentionally. For  |
| > control      |                            | example, software     |
| > objectives   |                            | that accepts          |
| > should be    |                            | externally supplied   |
| > performed at |                            | information, such as  |
| > the same     |                            | a file name or file   |
| > time.*       |                            | path to construct a   |
|                |                            | search command, can   |
|                |                            | be easily manipulated |
|                |                            | to disclose           |
|                |                            | information about     |
|                |                            | sensitive files and   |
|                |                            | resources that were   |
|                |                            | never intended to be  |
|                |                            | accessed through the  |
|                |                            | software interface.   |
|                |                            | To protect against    |
|                |                            | this and other types  |
|                |                            | of injection attacks, |
|                |                            | all input data should |
|                |                            | be validated,         |
|                |                            | filtered, and/or      |
|                |                            | sanitized before the  |
|                |                            | information is sent   |
|                |                            | to any interpreter.   |
|                |                            |                       |
|                |                            | Inputs for terminal   |
|                |                            | software tend to      |
|                |                            | involve simple        |
|                |                            | commands and data.    |
|                |                            | Therefore, all        |
|                |                            | terminal software     |
|                |                            | input data should be  |
|                |                            | validated against a   |
|                |                            | defined and           |
|                |                            | restricted set of     |
|                |                            | acceptable values     |
|                |                            | before passing the    |
|                |                            | data to any command   |
|                |                            | interpreter. Any data |
|                |                            | that is not           |
|                |                            | explicitly identified |
|                |                            | as an acceptable      |
|                |                            | value or an           |
|                |                            | acceptable range of   |
|                |                            | values should be      |
|                |                            | rejected.             |
+----------------+----------------------------+-----------------------+
|                | **B.3.1.b** The assessor   |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall test the software by |                       |
|                | attempting to supply each  |                       |
|                | user or other external     |                       |
|                | input with invalid or      |                       |
|                | unexpected characteristics |                       |
|                | to confirm that the        |                       |
|                | software validates all     |                       |
|                | inputs and either rejects  |                       |
|                | or securely handles all    |                       |
|                | unexpected                 |                       |
|                | characteristics.           |                       |
+----------------+----------------------------+-----------------------+
| > **B.3.1.1**  | **B.3.1.1.a** The assessor | Externally supplied   |
| > All string   | shall examine evidence     | inputs that can be    |
| > values are   | (including source code) to | interpreted as        |
| > validated by | identify all terminal      | commands are          |
| > the          | software functions where   | particularly          |
| > software.    | string values are passed   | susceptible to        |
|                | as inputs, and to confirm  | injection attacks.    |
|                | that all strings are       | Even if externally    |
|                | checked for text or data   | supplied inputs are   |
|                | that can be erroneously or | processed or          |
|                | maliciously interpreted as | transformed in some   |
|                | a command.                 | way (for example,     |
|                |                            | augmented with        |
|                |                            | additional data or    |
|                |                            | sanitized), they may  |
|                |                            | still be susceptible. |
|                |                            |                       |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.3.1.1.b** The assessor | > Therefore, all      |
|                | shall install and          | > inputs that can be  |
|                | configure the software in  | > interpreted as      |
|                | accordance with the        | > commands must be    |
|                | guidance required in       | > handled securely so |
|                | Control Objectives         | > that the execution  |
|                |                            | > of any constructed  |
|                | 12.1 and B.5.1. Using an   | > commands is         |
|                | appropriate "test          | > controlled, as      |
|                | platform" and suitable     | > opposed to blindly  |
|                | forensic tools and/or      | > executing whatever  |
|                | methods, the assessor      | > commands are        |
|                | shall test the software by | > included in the     |
|                | attempting to supply each  | > string.             |
|                | of the identified          |                       |
|                | functions with data that   |                       |
|                | includes commands to       |                       |
|                | confirm that the software  |                       |
|                | either rejects such inputs |                       |
|                | or otherwise handles such  |                       |
|                | inputs securely.           |                       |
+----------------+----------------------------+-----------------------+
| > **B.3.1.2**  | **B.3.1.2.a** The assessor | > Payment terminals   |
| > The software | shall examine evidence     | > and terminal        |
| > checks       | (including source code) to | > software often      |
| > inputs and   | identify all software      | > leverage low-level  |
| > rejects or   | functions that handle      | > programming         |
| > otherwise    | buffers and process data   | > languages, such as  |
| > securely     | supplied from untrusted    | > C and C++. These    |
| > handles any  | sources. For each of the   | > languages allow the |
| > inputs that  | noted functions, the       | > software to         |
| > violate      | assessor shall confirm     | > directly manipulate |
| > buffer size  | that each of the           | > OS-level or         |
| > or other     | identified functions:      | > hardware-level      |
| > memory       |                            | > features and        |
| > allocation   | -   Uses only unsigned     | > functions. Using    |
| > thresholds.  |     > variables to define  | > low-level           |
|                |     > buffer sizes.        | > programming         |
|                |                            | > languages offers    |
|                | -   Conducts checks to     | > many benefits but   |
|                |     > confirm that buffers | > also has several    |
|                |     > are sized            | > drawbacks.          |
|                |     > appropriately for    | > Low-level           |
|                |     > the data they are    | > programming         |
|                |     > intended to handle,  | > languages are       |
|                |     > including            | > susceptible to      |
|                |     > consideration for    | > attacks that use    |
|                |     > underflows and       | > low-level           |
|                |     > overflows.           | > characteristics to  |
|                |                            | > manipulate the      |
|                | -   Rejects or otherwise   | > software or the     |
|                |     > securely handles any | > underlying          |
|                |     > inputs that violate  | > hardware. Buffer    |
|                |     > buffer size or other | > overflows and       |
|                |     > memory allocation    | > underflows are      |
|                |     > thresholds.          | > examples of these   |
|                |                            | > types of attacks.   |
|                |                            | >                     |
|                |                            | > To protect against  |
|                |                            | > buffer overflow     |
|                |                            | > attacks, all        |
|                |                            | > terminal software   |
|                |                            | > functions that      |
|                |                            | > define or control   |
|                |                            | > buffer sizes should |
|                |                            | > compare the amount  |
|                |                            | > of data intended    |
|                |                            | > for those buffers   |
|                |                            | > with the buffer     |
|                |                            | > size. Data that     |
|                |                            | > violates buffer     |
|                |                            | > size thresholds     |
|                |                            | > (overflows and      |
|                |                            | > underflows) should  |
|                |                            | > be rejected or      |
|                |                            | > otherwise handled   |
|                |                            | > securely.           |
+----------------+----------------------------+-----------------------+
|                | **B.3.1.2.b** The assessor |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall test the software by |                       |
|                | attempting to supply each  |                       |
|                | noted function with inputs |                       |
|                | that violate buffer size   |                       |
|                | thresholds to confirm that |                       |
|                | the software either        |                       |
|                | rejects or securely        |                       |
|                | handles all such attempts. |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **B.3.2**    | **B.3.2.a** Using          | Another common        |
| > Return       | information obtained in    | technique used by     |
| > values are   | Test Requirement 1.2.a,    | attackers to          |
| > checked, and | the assessor shall examine | compromise sensitive  |
| > error        | evidence (including source | data that is stored,  |
| > conditions   | code) to identify all      | processed, or         |
| > are handled  | software functions that    | transmitted by        |
| > securely.    | handle sensitive data. For | software is to        |
|                | each of the noted software | manipulate the        |
|                | functions, the assessor    | software in a way     |
|                | shall confirm that each    | that generates        |
|                | function:                  | unhandled exceptions. |
|                |                            |                       |
|                | -   Checks return values   | Unhandled exceptions  |
|                |     > for the presence of  | are error conditions  |
|                |     > sensitive data.      | that the software     |
|                |                            | vendor has not        |
|                | -   Processes the return   | anticipated and,      |
|                |     > values in a way that | therefore, has not    |
|                |     > does not             | factored into the     |
|                |     > inadvertently "leak" | software design. If   |
|                |     > sensitive data.      | an attacker can       |
|                |                            | manipulate a software |
|                |                            | function that is      |
|                |                            | known to handle       |
|                |                            | sensitive data in a   |
|                |                            | way that generates a  |
|                |                            | condition that the    |
|                |                            | software does not     |
|                |                            | handle properly, it   |
|                |                            | is possible that the  |
|                |                            | software may output   |
|                |                            | an error that         |
|                |                            | includes sensitive    |
|                |                            | data.                 |
|                |                            |                       |
|                |                            | To protect against    |
|                |                            | attacks involving     |
|                |                            | unhandled exceptions, |
|                |                            | all terminal software |
|                |                            | functions handling    |
|                |                            | sensitive data should |
|                |                            | include processes or  |
|                |                            | routines that         |
|                |                            | instruct the software |
|                |                            | how to treat unknown  |
|                |                            | exceptions. These     |
|                |                            | processes should      |
|                |                            | determine what        |
|                |                            | information to        |
|                |                            | include in any error  |
|                |                            | codes or values. The  |
|                |                            | disclosure of         |
|                |                            | sensitive data        |
|                |                            | through error         |
|                |                            | conditions or error   |
|                |                            | reporting, whether    |
|                |                            | intentional or        |
|                |                            | accidental, should be |
|                |                            | avoided.              |
+----------------+----------------------------+-----------------------+
|                | **B.3.2.b** The assessor   |                       |
|                | shall install and          |                       |
|                | configure the software in  |                       |
|                | accordance with the        |                       |
|                | guidance required in       |                       |
|                | Control Objectives         |                       |
|                |                            |                       |
|                | 12.1 and B.5.1. Using an   |                       |
|                | appropriate "test          |                       |
|                | platform" and suitable     |                       |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      |                       |
|                | shall test each software   |                       |
|                | function that handles      |                       |
|                | sensitive data by          |                       |
|                | attempting to manipulate   |                       |
|                | the software in a manner   |                       |
|                | that generates an          |                       |
|                | unhandled exception to     |                       |
|                | confirm that error         |                       |
|                | conditions do not expose   |                       |
|                | sensitive data.            |                       |
+----------------+----------------------------+-----------------------+
| > **B.3.3**    | **B.3.3.a** The assessor   | Race conditions can   |
| > Race         | shall examine evidence     | arise when the        |
| > conditions   | (including source code) to | software requires     |
| > are avoided. | identify all software      | sequential processing |
|                | functions that rely on     | of data to perform    |
|                | synchronous processing.    | some software         |
|                | For each of the noted      | function. For         |
|                | functions, the assessor    | example, a            |
|                | shall confirm that         | "time-of-use,         |
|                | protection mechanisms have | time-of-check race    |
|                | been implemented in the    | condition" exists     |
|                | software to mitigate race  | when a file is        |
|                | conditions.                | checked at one point  |
|                |                            | and used immediately  |
|                |                            | after, with the       |
|                |                            | assumption that the   |
|                |                            | previous check is     |
|                |                            | still valid. This     |
|                |                            | assumption may not be |
|                |                            | correct if the system |
|                |                            | allows the file to be |
|                |                            | modified in between.  |
|                |                            |                       |
|                |                            | If an attacker can    |
|                |                            | identify and          |
|                |                            | manipulate the        |
|                |                            | software to take      |
|                |                            | advantage of a race   |
|                |                            | condition, they may   |
|                |                            | be able to execute    |
|                |                            | arbitrary code or     |
|                |                            | generate other        |
|                |                            | conditions that the   |
|                |                            | attacker could        |
|                |                            | exploit further.      |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.3.3.b** The assessor   | To protect against    |
|                | shall install and          | race conditions,      |
|                | configure the software in  | protection mechanisms |
|                | accordance with the        | should be implemented |
|                | guidance required in       | by the terminal       |
|                | Control Objectives         | software to control   |
|                |                            | sequential processing |
|                | 12.1 and B.5.1. Using an   | more tightly. Using   |
|                | appropriate "test          | the example described |
|                | platform" and suitable     | above, a              |
|                | forensic tools and/or      |                       |
|                | methods, the assessor      | "locking" mechanism   |
|                | shall test each software   | could be used to      |
|                | function that relies on    | prevent updates to    |
|                | synchronous processing by  | the file until the    |
|                | attempting to generate a   | file can be processed |
|                | race condition (such as    | completely.           |
|                | through specially crafted  |                       |
|                | attacks intended to        | Regardless of the     |
|                | exploit the timing of      | methods used, any     |
|                | synchronous events) to     | terminal software     |
|                | confirm that the software  | that requires         |
|                | is resistant to such       | sequential processing |
|                | attacks.                   | of data for its       |
|                |                            | operation should      |
|                |                            | implement protections |
|                |                            | to avoid race         |
|                |                            | conditions.           |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark45 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > B.4:         |                            |                       |
| > Terminal     |                            |                       |
| > Software     |                            |                       |
| > Security     |                            |                       |
| > Testing**    |                            |                       |
| >              |                            |                       |
| > The software |                            |                       |
| > is tested    |                            |                       |
| > rigorously   |                            |                       |
| > for          |                            |                       |
| > v            |                            |                       |
| ulnerabilities |                            |                       |
| > prior to     |                            |                       |
| > each         |                            |                       |
| > release.     |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.4.1** A  | **B.4.1.a** The assessor   | Many software         |
| > documented   | shall examine evidence to  | vulnerabilities are   |
| > process is   | confirm that the software  | the result of the     |
| > maintained   | vendor maintains a         | software vendor's     |
| > and followed | documented process in      | failure to remove     |
| > for testing  | accordance with Control    | test functions or     |
| > software for | Objective 10.2 for testing | data. These lingering |
| > v            | the software for           | functions and data    |
| ulnerabilities | vulnerabilities prior to   | can provide an        |
| > prior to     | each update or release,    | attacker with a path  |
| > each update  | and that the documented    | to compromise the     |
| > or release.  | process includes detailed  | software.             |
| >              | descriptions of how the    |                       |
| > ***Note:**   | vendor tests for the       | Before software is    |
| > This control | following:                 | released to the       |
| > objective is |                            | public, it must be    |
| > an extension | -   The presence or use of | tested to confirm     |
| > of Control   |     > any unnecessary      | that test functions   |
| > Objective    |     > ports and protocols. | and data are not      |
| > 10.2.        |                            | included in the       |
| > Validation   | -   The unintended         | release version.      |
| > of these     |     > storage,             | Examples of such      |
| > control      |     > transmission, or     | functions and data    |
| > objectives   |     > output of any        | that must be          |
| > should be    |     > clear-text account   | explicitly removed    |
| > performed at |     > data.                | prior to release      |
| > the same     |                            | include:              |
| > time.*       | -   The presence of any    |                       |
|                |     > default user         | -   Any communication |
|                |     > accounts with        |     > ports or        |
|                |     > default or static    |     > protocols that  |
|                |     > access credentials.  |     > are not         |
|                |                            |     > absolutely      |
|                | -   The presence of any    |     > required for    |
|                |     > hard-coded           |     > software        |
|                |     > authentication       |     > operation.      |
|                |     > credentials in code  |                       |
|                |     > or in configuration  | -   Any functions     |
|                |     > files.               |     > that allow the  |
|                |                            |     > unintended      |
|                | -   The presence of any    |     > storage,        |
|                |     > test data or test    |     > transmission,   |
|                |     > accounts.            |     > or output of    |
|                |                            |     > any clear- text |
|                | -   The presence of any    |     > account data.   |
|                |     > faulty or            |                       |
|                |     > ineffective software | -   Any hard-coded    |
|                |     > security controls.   |     > authentication  |
|                |                            |     > credentials in  |
|                |                            |     > code or         |
|                |                            |     > configuration   |
|                |                            |     > files.          |
|                |                            |                       |
|                |                            | -   Any test data or  |
|                |                            |     > test user       |
|                |                            |     > accounts.       |
|                |                            |                       |
|                |                            | -   Any faulty or     |
|                |                            |     > ineffective     |
|                |                            |     > software        |
|                |                            |     > security        |
|                |                            |     > controls and    |
|                |                            |     > protection      |
|                |                            |     > mechanisms.     |
+----------------+----------------------------+-----------------------+
|                | **B.4.1.b** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | is tested for              |                       |
|                | vulnerabilities prior to   |                       |
|                | each release and that the  |                       |
|                | testing covers the         |                       |
|                | following:                 |                       |
|                |                            |                       |
|                | -   The presence or use of |                       |
|                |     > any unnecessary      |                       |
|                |     > ports and protocols. |                       |
|                |                            |                       |
|                | -   The unintended         |                       |
|                |     > storage,             |                       |
|                |     > transmission, or     |                       |
|                |     > output of any        |                       |
|                |     > clear-text account   |                       |
|                |     > data.                |                       |
|                |                            |                       |
|                | > *(continued on next      |                       |
|                | > page)*                   |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **B.4.1.b**                |                       |
|                |                            |                       |
|                | -   The presence of any    |                       |
|                |     > default user         |                       |
|                |     > accounts with static |                       |
|                |     > access credentials.  |                       |
|                |                            |                       |
|                | -   The presence of any    |                       |
|                |     > hard-coded           |                       |
|                |     > authentication       |                       |
|                |     > credentials in code  |                       |
|                |     > or in configuration  |                       |
|                |     > files.               |                       |
|                |                            |                       |
|                | -   The presence of any    |                       |
|                |     > test data or test    |                       |
|                |     > accounts.            |                       |
|                |                            |                       |
|                | -   The presence of any    |                       |
|                |     > faulty or            |                       |
|                |     > ineffective software |                       |
|                |     > security controls.   |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark46 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > B.5:         |                            |                       |
| > Terminal     |                            |                       |
| > Software     |                            |                       |
| >              |                            |                       |
| Implementation |                            |                       |
| > Guidance**   |                            |                       |
| >              |                            |                       |
| > The software |                            |                       |
| > vendor       |                            |                       |
| > provides     |                            |                       |
| > stakeholders |                            |                       |
| > with clear   |                            |                       |
| > and thorough |                            |                       |
| > guidance on  |                            |                       |
| > the secure   |                            |                       |
| > i            |                            |                       |
| mplementation, |                            |                       |
| >              |                            |                       |
| configuration, |                            |                       |
| > and          |                            |                       |
| > operation of |                            |                       |
| > the software |                            |                       |
| > on           |                            |                       |
| > applicable   |                            |                       |
| > payment      |                            |                       |
| > terminals.   |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.5.1**    | **B.5.1** The assessor     | Because many security |
| > The software | shall examine evidence to  | features used by      |
| > vendor       | confirm that guidance on   | terminal software are |
| > provides     | how to securely implement  | provided by the       |
| >              | and operate the software   | underlying payment    |
| implementation | for all applicable payment | terminal, the         |
| > guidance on  | terminals is provided to   | terminal software     |
| > how to       | stakeholders in accordance | vendor should include |
| > implement    | with Control Objective     | instructions in its   |
| > and operate  | 12.1.                      | implementation        |
| > the software |                            | guidance on how to    |
| > securely for |                            | configure all the     |
| > the payment  |                            | available security    |
| > terminals on |                            | features of both the  |
| > which it is  |                            | terminal software and |
| > to be        |                            | underlying payment    |
| > deployed.    |                            | terminal where        |
| >              |                            | applicable.           |
| > ***Note**:   |                            |                       |
| > This control |                            |                       |
| > objective is |                            |                       |
| > an extension |                            |                       |
| > of Control   |                            |                       |
| > Objective    |                            |                       |
| > 12.1.        |                            |                       |
| > Validation   |                            |                       |
| > of these     |                            |                       |
| > control      |                            |                       |
| > objectives   |                            |                       |
| > should be    |                            |                       |
| > performed at |                            |                       |
| > the same     |                            |                       |
| > time.*       |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.5.1.1**  | **B.5.1.1** The assessor   |                       |
| >              | shall examine evidence to  |                       |
| Implementation | confirm that the required  |                       |
| > guidance     | guidance includes detailed |                       |
| > includes     | instructions on how to     |                       |
| > detailed     | configure all available    |                       |
| > instructions | security options and       |                       |
| > for how to   | parameters of the software |                       |
| > configure    | in accordance with Control |                       |
| > all          | Objective B.1.3.           |                       |
| > available    |                            |                       |
| > security     |                            |                       |
| > options and  |                            |                       |
| > parameters   |                            |                       |
| > of the       |                            |                       |
| > software.    |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.5.1.2**  | **B.5.1.2** The assessor   |                       |
| >              | shall examine evidence to  |                       |
| Implementation | confirm that the required  |                       |
| > guidance     | guidance includes detailed |                       |
| > includes     | instructions on how to     |                       |
| > detailed     | securely configure the     |                       |
| > instructions | software to use the        |                       |
| > for how to   | security features and      |                       |
| > securely     | functions of the payment   |                       |
| > configure    | terminal where applicable. |                       |
| > the software |                            |                       |
| > to use the   |                            |                       |
| > security     |                            |                       |
| > features and |                            |                       |
| > functions of |                            |                       |
| > the payment  |                            |                       |
| > terminal     |                            |                       |
| > where        |                            |                       |
| > applicable.  |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.5.1.3**  | **B.5.1.3** The assessor   |                       |
| >              | shall examine evidence to  |                       |
| Implementation | confirm that the required  |                       |
| > guidance     | guidance includes detailed |                       |
| > includes     | instructions on how to     |                       |
| > detailed     | configure the software to  |                       |
| > instructions | securely integrate or use  |                       |
| > for how to   | any shared resources       |                       |
| > configure    | provided by the payment    |                       |
| > the software | terminal in accordance     |                       |
| > to securely  | with Control Objective     |                       |
| > integrate or | B.2.6.                     |                       |
| > use any      |                            |                       |
| > shared       |                            |                       |
| > resources    |                            |                       |
| > provided by  |                            |                       |
| > the payment  |                            |                       |
| > terminal.    |                            |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **B.5.1.4**  | **B.5.1.4** The assessor   |                       |
| >              | shall examine evidence to  |                       |
| Implementation | confirm that the required  |                       |
| > guidance     | guidance includes detailed |                       |
| > includes     | instructions on how to     |                       |
| > detailed     | cryptographically sign the |                       |
| > instructions | software files in a manner |                       |
| > on how to    | that enables the           |                       |
| > cry          | cryptographic              |                       |
| ptographically | authentication of all such |                       |
| > sign the     | files by the payment       |                       |
| > software     | terminal in accordance     |                       |
| > files in a   | with Control Objective     |                       |
| > manner that  | B.2.8.                     |                       |
| > enables the  |                            |                       |
| >              |                            |                       |
|  cryptographic |                            |                       |
| >              |                            |                       |
| authentication |                            |                       |
| > of all such  |                            |                       |
| > files by the |                            |                       |
| > payment      |                            |                       |
| > terminal.    |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.5.1.5**  | **B.5.1.5** The assessor   |                       |
| >              | shall examine evidence to  |                       |
| Implementation | confirm that the required  |                       |
| > guidance     | guidance includes detailed |                       |
| > includes     | instructions for           |                       |
| > instructions | stakeholders to            |                       |
| > for          | cryptographically sign all |                       |
| > stakeholders | prompt files in accordance |                       |
| > to           | with Control Objective     |                       |
| > cry          | B.2.9.                     |                       |
| ptographically |                            |                       |
| > sign all     |                            |                       |
| > prompt       |                            |                       |
| > files.       |                            |                       |
+----------------+----------------------------+-----------------------+
| > **B.5.2**    | **B.5.2** The assessor     | > Software            |
| >              | shall examine evidence     | > implementation      |
| Implementation | (including the payment     | > guidance must       |
| > guidance     | terminal vendor's security | > exclude             |
| > adheres to   | guidance/policy and the    | > instructions that   |
| > payment      | guidance required in       | > conflict with the   |
| > terminal     | Control Objective B.5.1)   | > guidance and        |
| > vendor       | to confirm that the        | > recommendations of  |
| > guidance on  | guidance aligns with the   | > the payment         |
| > the secure   | payment terminal vendor's  | > terminal vendor.    |
| >              | security guidance/policy.  | > Software            |
|  configuration |                            | > implementation      |
| > of the       |                            | > guidance must align |
| > payment      |                            | > with the payment    |
| > terminal.    |                            | > terminal vendor's   |
|                |                            | > security            |
|                |                            | > guidance/policy.    |
|                |                            | > Otherwise, software |
|                |                            | > users who rely on   |
|                |                            | > the software vendor |
|                |                            | > for instructions    |
|                |                            | > may unknowingly     |
|                |                            | > configure the       |
|                |                            | > software and/or the |
|                |                            | > underlying payment  |
|                |                            | > terminal            |
|                |                            | > improperly.         |
+----------------+----------------------------+-----------------------+

# Module C -- Web Software Requirements

+------------+-------------------------+------------------------------+
| > **Module | > **Overview**          | > **Control Objectives**     |
| > Name**   |                         |                              |
+============+=========================+==============================+
| > **Module | Additional security     | **C.1**: Web Software        |
| > C: Web   | requirements for        | Components & Services        |
| > Software | payment software that   |                              |
| > Requ     | uses Internet           | **C.2**: Web Software Access |
| irements** | technologies,           | Controls                     |
|            | protocols, and          |                              |
|            | languages to initiate   | **C.3:** Web Software Attack |
|            | or support electronic   | Mitigation                   |
|            | payment transactions.   |                              |
|            |                         | **C.4**: Web Software        |
|            |                         | Communications               |
+------------+-------------------------+------------------------------+

## Purpose and Scope

> This section (hereinafter referred to as the "Web Software Module" or
> "this module") defines security requirements and assessment procedures
> for payment software and applications that use Internet technologies,
> protocols, and languages for the purposes of initiating or supporting
> electronic payment transactions. This includes both traditional
> (monolithic) and cloud-native payment applications, APIs, web
> services, microservices, serverless functions, GRPC, and any other
> methods used to make payment functions accessible or to conduct
> electronic payment transactions over the Internet. Any software-based
> features or functions that handle requests from Internet "clients" and
> generate responses to initiate or support an electronic payment
> transaction are in scope for the requirements in this module.

## Considerations

> Web software architectures can be extremely complex and involve
> features and functions that are provided by different entities and may
> be distributed across different geographic locations. The security
> issues affecting web software can vary significantly. The security
> requirements defined within this web module do not address all risks
> affecting web-based payment software. They are intended as a minimum
> set of security characteristics, controls, features, and capabilities
> that web-based payment software must possess to defend itself from the
> most common attacks on web software.
>
> While many of the control objectives defined in this standard protect
> against new and/or novel attacks beyond the most common techniques,
> attacks will inevitably evolve or emerge that will require new methods
> or approaches to mitigate them. It is ultimately the responsibility of
> payment software vendors, providers, developers, and suppliers to keep
> abreast of evolving attacks techniques and to implement appropriate
> security controls to enable their software to defend against such
> attacks.

## Security Requirements

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark51 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > C.1: Web     |                            |                       |
| > Software     |                            |                       |
| > Components & |                            |                       |
| > Services**   |                            |                       |
| >              |                            |                       |
| > All          |                            |                       |
| > components   |                            |                       |
| > and services |                            |                       |
| > used by the  |                            |                       |
| > software are |                            |                       |
| > identified   |                            |                       |
| > and          |                            |                       |
| > maintained   |                            |                       |
| > in a manner  |                            |                       |
| > that         |                            |                       |
| > minimizes    |                            |                       |
| > the exposure |                            |                       |
| > of           |                            |                       |
| > vu           |                            |                       |
| lnerabilities. |                            |                       |
+----------------+----------------------------+-----------------------+
| 1.  All        | 1.  The assessor shall     | Modern software is    |
|     > software |     examine evidence to    | rarely created        |
|                |     confirm that           | entirely in-house and |
|   > components |     information is         | is typically composed |
|     > and      |     maintained that        | of various bespoke    |
|     > services |     describes all software | code segments         |
|     > are      |     components and         | integrated with       |
|                |     services comprising    | numerous components   |
|   > documented |     the software solution, | such as commercial    |
|     > or       |     including:             | and/or open-source    |
|                |                            | frameworks,           |
|    > otherwise |     -   All proprietary    | libraries, APIs, and  |
|                |         > software         | services. Any part of |
|    > cataloged |         > libraries,       | this code may have or |
|     > in a     |         > packages,        | develop               |
|     > software |         > modules, and/or  | vulnerabilities over  |
|     > bill of  |         > code packaged in | time that will        |
|                |         > a manner that    | require patching or   |
|    > materials |         > enables them to  | mitigation.           |
|     > (SBOM).  |         > be tracked as a  |                       |
|                |         > freestanding     | Knowing all of the    |
|                |         > unit of          | components that       |
|                |         > software.        | comprise a software   |
|                |                            | application or        |
|                |     -   All third-party    | service, where they   |
|                |         > and open-source  | come from, and how    |
|                |         > frameworks,      | they are updated and  |
|                |         > libraries, and   | maintained is         |
|                |         > code embedded in | critical to           |
|                |         > or used by the   | minimizing and        |
|                |         > software during  | managing              |
|                |         > operation.       | vulnerabilities in    |
|                |                            | software              |
|                |     -   All third-party    | applications. Without |
|                |         > software         | this information, it  |
|                |         > dependencies,    | would be extremely    |
|                |         > APIs, and        | difficult to identify |
|                |         > services called  | and track             |
|                |         > by the software  | vulnerabilities in    |
|                |         > during           | software components   |
|                |         > operation.       | that could expose the |
|                |                            | embedding software    |
|                |                            | application to        |
|                |                            | attacks.              |
|                |                            |                       |
|                |                            | A Software Bill of    |
|                |                            | Materials or "SBOM"   |
|                |                            | services this purpose |
|                |                            | by documenting        |
|                |                            | information about the |
|                |                            | software components   |
|                |                            | and versions used to  |
|                |                            | create a software     |
|                |                            | product, their        |
|                |                            | suppliers, and any    |
|                |                            | third-party code that |
|                |                            | may also be embedded  |
|                |                            | in these components.  |
|                |                            | NIST refers to this   |
|                |                            | information as        |
|                |                            |                       |
|                |                            | "provenance data" and |
|                |                            | there are numerous    |
|                |                            | standards and         |
|                |                            | frameworks available, |
|                |                            | such as CycloneDX,    |
|                |                            | SPDX and SWID, that   |
|                |                            | describe how this     |
|                |                            | information should be |
|                |                            | structured. For more  |
|                |                            | information, refer to |
|                |                            | those standards and   |
|                |                            | frameworks.           |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.1.2**    | **C.1.2.a** The assessor   | > Software components |
| > The SBOM     | shall examine evidence to  | > and services may    |
| > describes    | confirm that the SBOM      | > have many nested    |
| > each of the  | describes all primary      | > relationships and   |
| > primary      | (top-level) components and | > dependencies with   |
| > components   | services in use and all of | > other software      |
| > and services | their secondary transitive | > components and      |
| > in use, as   | relationships and          | > services that are   |
| > well as      | dependencies.              | > owned or maintained |
| > their        |                            | > by multiple         |
| > secondary    |                            | > different entities. |
| > transitive   |                            | > Identifying all of  |
| > component    |                            | > these different     |
| >              |                            | > relationships can   |
|  relationships |                            | > be challenging      |
| > and          |                            | > where there are     |
| > dependencies |                            | > many different      |
| > to the       |                            | > third-party         |
| > greatest     |                            | > components nested   |
| > extent       |                            | > in the software     |
| > feasible.    |                            | > code.               |
|                |                            | >                     |
|                |                            | > Fortunately, many   |
|                |                            | > software            |
|                |                            | > development         |
|                |                            | > frameworks and      |
|                |                            | > compilers provide   |
|                |                            | > the capabilities to |
|                |                            | > identify and map    |
|                |                            | > nested and          |
|                |                            | > transient           |
|                |                            | > dependencies. For   |
|                |                            | > the purposes of     |
|                |                            | > this standard, the  |
|                |                            | > SBOM is expected to |
|                |                            | > identify, at a      |
|                |                            | > minimum, the code   |
|                |                            | > obtained from third |
|                |                            | > parties as well as  |
|                |                            | > their secondary     |
|                |                            | > transitive          |
|                |                            | > component           |
|                |                            | > relationships and   |
|                |                            | > dependencies (i.e., |
|                |                            | > code embedded in    |
|                |                            | > third-party code).  |
|                |                            | >                     |
|                |                            | > If circumstances    |
|                |                            | > exist that          |
|                |                            | > complicate or       |
|                |                            | > prevent the         |
|                |                            | > identification of   |
|                |                            | > secondary           |
|                |                            | > transitive          |
|                |                            | > component           |
|                |                            | > relationships and   |
|                |                            | > dependencies, then  |
|                |                            | > such circumstances  |
|                |                            | > should be           |
|                |                            | > documented, and     |
|                |                            | > reasonable          |
|                |                            | > justification       |
|                |                            | > should be           |
|                |                            | > maintained to       |
|                |                            | > explain why these   |
|                |                            | > dependencies are    |
|                |                            | > not accurately      |
|                |                            | > reflected in the    |
|                |                            | > SBOM. Examples of   |
|                |                            | > such circumstances  |
|                |                            | > may include         |
|                |                            | > third-party APIs,   |
|                |                            | > where transparency  |
|                |                            | > into nested         |
|                |                            | > third-party         |
|                |                            | > components called   |
|                |                            | > by or embedded into |
|                |                            | > those APIs is not   |
|                |                            | > provided by the API |
|                |                            | > provider.           |
+----------------+----------------------------+-----------------------+
|                | **C.1.2.b** The assessor   |                       |
|                | shall test the software to |                       |
|                | confirm that the           |                       |
|                | information provided in    |                       |
|                | the SBOM accurately        |                       |
|                | reflects the software      |                       |
|                | components and services in |                       |
|                | use during software        |                       |
|                | operation, including both  |                       |
|                | primary components and     |                       |
|                | services as well as their  |                       |
|                | secondary transitive       |                       |
|                | component relationships    |                       |
|                | and dependencies. Where    |                       |
|                | such dependencies and      |                       |
|                | relationships are not      |                       |
|                | identified and described   |                       |
|                | in the SBOM, the assessor  |                       |
|                | shall confirm that the     |                       |
|                | absence of such            |                       |
|                | information is justified   |                       |
|                | and reasonable.            |                       |
+----------------+----------------------------+-----------------------+
| > **C.1.3**    | **C.1.3.a** The assessor   | > Software that is    |
| > Where the    | shall examine evidence to  | > provided "as a      |
| > software is  | confirm that the SBOM      | > service" often      |
| > provided "as | describes all dependencies | > involves the use of |
| > a service,"  | present in the production  | > components and      |
| > the SBOM     | software execution         | > services resident   |
| > includes     | environment that the       | > in the production   |
| > information  | software relies upon for   | > environment that    |
| > describing   | operation or to satisfy    | > are unique to that  |
| > the software | security requirements in   | > environment. To     |
| > dependencies | this standard.             | > ensure that these   |
| > present in   |                            | > dependencies and    |
| > the          |                            | > relationships are   |
| > production   |                            | > identified and      |
| > software     |                            | > tracked and         |
| > execution    |                            | > vulnerabilities in  |
| > environment  |                            | > these components    |
| > to the       |                            | > and services        |
| > greatest     |                            | > identified and      |
| > extent       |                            | > mitigated, these    |
| > feasible.    |                            | > components and      |
|                |                            | > services must be    |
|                |                            | > also included in    |
|                |                            | > the SBOM.           |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.1.3.b** The assessor   | > Examples of these   |
|                | shall examine evidence and | > types of components |
|                | test the software (to the  | > include, but are    |
|                | extent possible) to        | > not limited to,     |
|                | confirm that the           | > database servers,   |
|                | information provided in    | > web servers,        |
|                | the SBOM accurately        | > application         |
|                | reflects the software      | > servers, runtime    |
|                | dependencies present in    | > platform(s),        |
|                | the production software    | > authentication      |
|                | execution environment.     | > servers/services,   |
|                | Where such dependencies    | > \"plugins\", and    |
|                | are not identified and     | > any other           |
|                | described in the SBOM, the | > components or       |
|                | assessor shall confirm     | > services present in |
|                | that the absence of such   | > the production      |
|                | information is justified   | > environment.        |
|                | and reasonable.            |                       |
+----------------+----------------------------+-----------------------+
| > **C.1.4**    | **C.1.4.a** The assessor   | > The primary purpose |
| > The SBOM     | shall examine evidence to  | > of an SBOM is to    |
| > includes     | confirm that information   | > enable the tracking |
| > sufficient   | is maintained in the SBOM  | > of software         |
| > information  | that describes the         | > components across   |
| > about each   | following for each         | > the software supply |
| > component or | component and service in   | > chain and to map    |
| > service to   | use, including secondary   | > them to             |
| > enable       | component relationships    | > repositories        |
| > tracking     | and dependencies:          | > containing          |
| > each         |                            | > vulnerability       |
| > component or | -   The original           | > information about   |
| > service      |     > source/supplier of   | > these components.   |
| > across the   |     > the component or     | > To facilitate       |
| > software     |     > service.             | > tracking components |
| > supply       |                            | > for these purposes, |
| > chain.       | -   The name of the        | > information must be |
|                |     > component or service | > included in the     |
|                |     > as defined by the    | > SBOM that enables   |
|                |     > original supplier.   | > software            |
|                |                            | > stakeholders to:    |
|                | -   A description of the   |                       |
|                |     > relationship(s)      | -   Uniquely identify |
|                |     > between the          |     > each of the     |
|                |     > component and        |     > components and  |
|                |     > service and other    |     > services used   |
|                |     > components/services  |     > by the          |
|                |     > embedded in or used  |     > software.       |
|                |     > by the software.     |                       |
|                |                            | -   Uniquely identify |
|                | -   The version of the     |     > different       |
|                |     > component or service |     > versions of the |
|                |     > as defined by the    |     > same software   |
|                |     > original supplier to |     > components and  |
|                |     > differentiate it     |     > services that   |
|                |     > from previous or     |     > may be used by  |
|                |     > other versions.      |     > the software,   |
|                |                            |     > and to          |
|                | ```{=html}                 |     > differentiate   |
|                | <!-- -->                   |     > them from other |
|                | ```                        |     > versions of the |
|                | -   The name of the author |     > same software   |
|                |     > who                  |     > components and  |
|                |     > designed/developed   |     > services made   |
|                |     > the component or     |     > available by    |
|                |     > service.             |     > the             |
|                |                            |     > supplier(s).    |
|                | -   Any other identifiers  |                       |
|                |     > provided by the      | -   Locate the        |
|                |     > original supplier to |     > sources of      |
|                |     > uniquely identify    |     > these           |
|                |     > the component or     |     > components and  |
|                |     > service.             |     > services such   |
|                |                            |     > that updated    |
|                |                            |     > versions may be |
|                |                            |     > downloaded,     |
|                |                            |     > installed,      |
|                |                            |     > and/or          |
|                |                            |     > referenced      |
|                |                            |     > where           |
|                |                            |     > applicable.     |
|                |                            |                       |
|                |                            | > Without this basic  |
|                |                            | > information,        |
|                |                            | > tracking            |
|                |                            | > vulnerabilities and |
|                |                            | > available patches   |
|                |                            | > in these components |
|                |                            | > and services may be |
|                |                            | > extremely           |
|                |                            | > difficult, if not   |
|                |                            | > impossible.         |
+----------------+----------------------------+-----------------------+
|                | **C.1.4.b** The assessor   |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that the           |                       |
|                | information provided in    |                       |
|                | the SBOM is an accurate    |                       |
|                | representation of the      |                       |
|                | software components and    |                       |
|                | services present in and/or |                       |
|                | in use by the software.    |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.1.5** A  | **C.1.5** The assessor     | > To enable tracking  |
| > new SBOM is  | shall examine evidence to  | > of vulnerabilities  |
| > created or   | confirm that a new SBOM is | > across different    |
| > generated    | created or otherwise       | > versions of a       |
| > each time    | generated for each new     | > payment software,   |
| > the software | release of the software.   | > it is imperative    |
| > is updated.  |                            | > that each version   |
|                |                            | > of the software has |
|                |                            | > a SBOM generated    |
|                |                            | > that accurately     |
|                |                            | > reflects the        |
|                |                            | > components and      |
|                |                            | > services in use by  |
|                |                            | > that version.       |
|                |                            | >                     |
|                |                            | > Since many          |
|                |                            | > different versions  |
|                |                            | > of a payment        |
|                |                            | > software may be     |
|                |                            | > available (or       |
|                |                            | > active) at any      |
|                |                            | > given time and may  |
|                |                            | > include multiple    |
|                |                            | > versions of         |
|                |                            | > numerous third-     |
|                |                            | > party components    |
|                |                            | > and services, each  |
|                |                            | > version of the      |
|                |                            | > payment software    |
|                |                            | > must be tracked     |
|                |                            | > independently of    |
|                |                            | > other versions.     |
|                |                            | >                     |
|                |                            | > Failure to identify |
|                |                            | > and describe the    |
|                |                            | > components and      |
|                |                            | > services unique to  |
|                |                            | > a given version of  |
|                |                            | > payment software    |
|                |                            | > could enable        |
|                |                            | > vulnerabilities to  |
|                |                            | > be introduced       |
|                |                            | > without the         |
|                |                            | > software provider's |
|                |                            | > knowledge if they   |
|                |                            | > are unaware that a  |
|                |                            | > vulnerable version  |
|                |                            | > of a software       |
|                |                            | > component or        |
|                |                            | > service is in use.  |
+----------------+----------------------------+-----------------------+
| > **C.1.6**    | **C.1.6.a** The assessor   | > Vulnerabilities in  |
| > V            | shall examine evidence to  | > third-party         |
| ulnerabilities | confirm that third-party   | > components and      |
| > in           | components and services    | > services must be    |
| > third-party  | present in and/or in use   | > handled in the same |
| > components   | by the software are        | > manner as           |
| > and services | regularly monitored for    | > vulnerabilities in  |
| > are          | vulnerabilities in         | > vendor-controlled   |
| > monitored    | accordance with Control    | > code. They must be  |
| > and managed  | Objective 10.1.            | > monitored for       |
| > in           |                            | > vulnerabilities     |
| > accordance   |                            | > through testing     |
| > with Control |                            | > and/or the          |
| > Objective    |                            | > monitoring of       |
| > 10.          |                            | > publicly available  |
|                |                            | > vulnerability       |
|                |                            | > disclosure          |
|                |                            | > repositories and    |
|                |                            | > managed such that   |
|                |                            | > any known           |
|                |                            | > vulnerabilities in  |
|                |                            | > those components    |
|                |                            | > and services are    |
|                |                            | > patched, or         |
|                |                            | > otherwise           |
|                |                            | > mitigated, as       |
|                |                            | > quickly as          |
|                |                            | > possible.           |
|                |                            | >                     |
|                |                            | > Failure to patch or |
|                |                            | > mitigate a          |
|                |                            | > vulnerability in    |
|                |                            | > third- party        |
|                |                            | > components or       |
|                |                            | > services can have   |
|                |                            | > the same            |
|                |                            | > ramifications as a  |
|                |                            | > failure to patch or |
|                |                            | > mitigate a          |
|                |                            | > vulnerability in    |
|                |                            | > the payment         |
|                |                            | > software vendor's   |
|                |                            | > own code.           |
+----------------+----------------------------+-----------------------+
|                | **C.1.6.b** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that               |                       |
|                | vulnerabilities in         |                       |
|                | third-party components and |                       |
|                | services are identified    |                       |
|                | and are patched or         |                       |
|                | otherwise mitigated in a   |                       |
|                | timely manner in           |                       |
|                | accordance with Control    |                       |
|                | Objective 10.2.            |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.1.7**    | **C.1.7.a** Where software | > It is a common      |
| > Where        | components and resources   | > architectural       |
| > software     | are fetched from external  | > design technique in |
| > components   | and/or third-party         | > modern web          |
| > and/or       | repositories, the assessor | > applications to     |
| > resources    | shall examine evidence to  | > download or "fetch" |
| > are hosted   | confirm that the           | >                     |
| > or           | authenticity of the        | > third-party         |
| > maintained   | software component is      | > components and      |
| > on           | verified each time the     | > resources (for      |
| > third-party  | component is fetched.      | > example, files,     |
| > systems,     |                            | > scripts,            |
| > such as      |                            | > stylesheets,        |
| > content      |                            | > packages, and       |
| > delivery     |                            | > libraries) that are |
| > networks     |                            | > housed on publicly  |
| > (CDN), the   |                            | > available code      |
| > authenticity |                            | > repositories (such  |
| > of those     |                            | > as public content   |
| > components   |                            | > delivery networks)  |
| > and          |                            | > at the time they    |
| > resources is |                            | > are needed rather   |
| > verified     |                            | > than embedding and  |
| > each time    |                            | > maintaining those   |
| > they are     |                            | > components and      |
| > fetched.     |                            | > resources in local  |
|                |                            | > code repositories.  |
|                |                            | > This technique      |
|                |                            | > provides many       |
|                |                            | > benefits including  |
|                |                            | > the ability to      |
|                |                            | > automatically       |
|                |                            | > deploy updates to   |
|                |                            | > third-party         |
|                |                            | > components and      |
|                |                            | > resources without   |
|                |                            | > necessarily having  |
|                |                            | > to recompile code.  |
|                |                            | >                     |
|                |                            | > Unfortunately,      |
|                |                            | > there are some      |
|                |                            | > significant         |
|                |                            | > drawbacks to this   |
|                |                            | > approach.           |
|                |                            | > Third-party code    |
|                |                            | > repositories are    |
|                |                            | > heavily targeted by |
|                |                            | > attackers because   |
|                |                            | > it enables them to  |
|                |                            | > potentially         |
|                |                            | > compromise numerous |
|                |                            | > applications and    |
|                |                            | > entities by         |
|                |                            | > compromising a      |
|                |                            | > single package,     |
|                |                            | > library, script, or |
|                |                            | > function. For       |
|                |                            | > example, if a       |
|                |                            | > malicious           |
|                |                            | > individual were     |
|                |                            | > able to compromise  |
|                |                            | > these repositories  |
|                |                            | > or otherwise        |
|                |                            | > replace a widely    |
|                |                            | > used JavaScript     |
|                |                            | > library with a      |
|                |                            | > modified version,   |
|                |                            | > then that malicious |
|                |                            | > library could be    |
|                |                            | > automatically       |
|                |                            | > propagated to every |
|                |                            | > user of that        |
|                |                            | > library without     |
|                |                            | > their knowledge.    |
|                |                            | >                     |
|                |                            | > To mitigate the     |
|                |                            | > risk of fetching    |
|                |                            | > malicious versions  |
|                |                            | > of code from        |
|                |                            | > third-party         |
|                |                            | > repositories,       |
|                |                            | > payment software    |
|                |                            | > vendors must        |
|                |                            | > validate the        |
|                |                            | > authenticity of     |
|                |                            | > such components     |
|                |                            | > before they are     |
|                |                            | > fetched (and/or     |
|                |                            | > loaded) by the      |
|                |                            | > calling             |
|                |                            | > application.        |
|                |                            | >                     |
|                |                            | > There are numerous  |
|                |                            | > ways in which this  |
|                |                            | > can be              |
|                |                            | > accomplished, but   |
|                |                            | > the most common     |
|                |                            | > method of verifying |
|                |                            | > a component's       |
|                |                            | > authenticity is     |
|                |                            | > through strong      |
|                |                            | > cryptography and    |
|                |                            | > digital signatures. |
+----------------+----------------------------+-----------------------+
|                | **C.1.7.b** The assessor   |                       |
|                | shall test the software to |                       |
|                | confirm that the           |                       |
|                | authenticity of all        |                       |
|                | software components and    |                       |
|                | resources fetched from     |                       |
|                | third-party systems or     |                       |
|                | repositories is verified   |                       |
|                | each time they are fetched |                       |
|                | by the software.           |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark52 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > C.2: Web     |                            |                       |
| > Software     |                            |                       |
| > Access       |                            |                       |
| > Controls**   |                            |                       |
| >              |                            |                       |
| > Software     |                            |                       |
| > security     |                            |                       |
| > controls are |                            |                       |
| > implemented  |                            |                       |
| > to restrict  |                            |                       |
| > access to    |                            |                       |
| > Inter        |                            |                       |
| net-accessible |                            |                       |
| > interfaces,  |                            |                       |
| > functions,   |                            |                       |
| > and          |                            |                       |
| > resources to |                            |                       |
| > explicitly   |                            |                       |
| > authorized   |                            |                       |
| > users only.  |                            |                       |
+----------------+----------------------------+-----------------------+
| > **C.2.1**    | **C.2.1** Using            | Writing custom        |
| > User access  | information obtained in    | authentication        |
| > to sensitive | Test Requirements 1.2.a    | functions is not a    |
| > functions    | and 2.1.a in the Core      | trivial matter. There |
| > and          | Requirements, the assessor | are numerous issues   |
| > sensitive    | shall examine evidence to  | and considerations    |
| > resources    | identify all sensitive     | that must be factored |
| > exposed      | functions and sensitive    | into the design and   |
| > through      | resources exposed through  | implementation of     |
| > Inter        | Internet-accessible        | such functions        |
| net-accessible | interfaces.                | including, but not    |
| > interfaces   |                            | limited to, the fact  |
| > is           |                            | that they are a       |
| >              |                            | significant target    |
| authenticated. |                            | for attackers.        |
|                |                            | Authentication        |
|                |                            | functions must be     |
|                |                            | free from weaknesses  |
|                |                            | in design and must be |
|                |                            | resistant to targeted |
|                |                            | attacks.              |
|                |                            |                       |
|                |                            | Given the importance  |
|                |                            | of and the heavy      |
|                |                            | reliance on such      |
|                |                            | functions for         |
|                |                            | security purposes     |
|                |                            | (and those of this    |
|                |                            | standard), it is      |
|                |                            | recommended that      |
|                |                            | entities use          |
|                |                            | third-party           |
|                |                            | authentication        |
|                |                            | functions, modules,   |
|                |                            | libraries, services,  |
|                |                            | and so on, that are   |
|                |                            | already widely used   |
|                |                            | within the industry   |
|                |                            | and have been         |
|                |                            | subjected to thorough |
|                |                            | security testing and  |
|                |                            | scrutiny.             |
|                |                            |                       |
|                |                            | Where the use of such |
|                |                            | mechanisms is not     |
|                |                            | feasible, then custom |
|                |                            | methods may be used.  |
|                |                            | However, custom       |
|                |                            | methods must be       |
|                |                            | designed and          |
|                |                            | implemented in strict |
|                |                            | accordance with       |
|                |                            | applicable industry   |
|                |                            | standards or best     |
|                |                            | practices for         |
|                |                            | authentication.       |
|                |                            |                       |
|                |                            | Failure to do so      |
|                |                            | could expose          |
|                |                            | vulnerabilities or    |
|                |                            | design weaknesses in  |
|                |                            | custom authentication |
|                |                            | methods to malicious  |
|                |                            | entities who may      |
|                |                            | exploit those         |
|                |                            | vulnerabilities to    |
|                |                            | manipulate or         |
|                |                            | otherwise bypass      |
|                |                            | custom authentication |
|                |                            | mechanisms.           |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.2.1.1**  | **C.2.1.1.a** The assessor | > Similar to          |
| > The methods  | shall examine evidence to  | > developing one's    |
| > implemented  | identify all methods       | > own authorization   |
| > to           | implemented by the         | > mechanisms,         |
| > authenticate | software to authenticate   | > developing custom   |
| > user access  | access to sensitive        | > authentication      |
| > to sensitive | functions and sensitive    | > mechanisms can be   |
| > functions    | resources.                 | > quite a complex     |
| > and          |                            | > undertaking.        |
| > sensitive    |                            | >                     |
| > resources    |                            | > Much of an          |
| > use          |                            | > application's       |
| > ind          |                            | > security is         |
| ustry-standard |                            | > dependent on the    |
| > mechanisms.  |                            | > strength and        |
|                |                            | > robustness of its   |
|                |                            | > authentication and  |
|                |                            | > authorization       |
|                |                            | > mechanisms. There   |
|                |                            | > are numerous issues |
|                |                            | > and considerations  |
|                |                            | > that must be        |
|                |                            | > factored into the   |
|                |                            | > design and          |
|                |                            | > implementation of   |
|                |                            | > such functions      |
|                |                            | > including but not   |
|                |                            | > limited to, the     |
|                |                            | > fact that they are  |
|                |                            | > a significant       |
|                |                            | > target for          |
|                |                            | > attackers.          |
|                |                            | > Authentication      |
|                |                            | > functions must be   |
|                |                            | > free from           |
|                |                            | > weaknesses and must |
|                |                            | > be able to          |
|                |                            | > withstand targeted  |
|                |                            | > attacks.            |
|                |                            | >                     |
|                |                            | > For this reason,    |
|                |                            | > only well-designed  |
|                |                            | > and well-tested     |
|                |                            | > mechanisms should   |
|                |                            | > be used.            |
|                |                            | > Authentication      |
|                |                            | > mechanisms that are |
|                |                            | > provided by         |
|                |                            | > industry-accepted   |
|                |                            | > suppliers and       |
|                |                            | > widely adopted      |
|                |                            | > within the industry |
|                |                            | > are generally       |
|                |                            | > understood to have  |
|                |                            | > been subjected to   |
|                |                            | > substantial testing |
|                |                            | > and validation      |
|                |                            | > throughout the      |
|                |                            | > course of that      |
|                |                            | > adoption.           |
|                |                            | > Therefore, it is    |
|                |                            | > strongly            |
|                |                            | > recommended that    |
|                |                            | > these mechanisms be |
|                |                            | > used by other       |
|                |                            | > entities instead of |
|                |                            | > writing and         |
|                |                            | > implementing their  |
|                |                            | > own mechanisms.     |
|                |                            | >                     |
|                |                            | > Where the use of    |
|                |                            | > third-party         |
|                |                            | > mechanisms is not   |
|                |                            | > feasible, then      |
|                |                            | > custom methods may  |
|                |                            | > be used.            |
|                |                            | >                     |
|                |                            | > However, custom     |
|                |                            | > methods must be     |
|                |                            | > designed and        |
|                |                            | > implemented in      |
|                |                            | > strict accordance   |
|                |                            | > with applicable     |
|                |                            | > industry standards  |
|                |                            | > or best practices   |
|                |                            | > for authentication. |
|                |                            | > Failure to do so    |
|                |                            | > could expose        |
|                |                            | > vulnerabilities or  |
|                |                            | > design weaknesses   |
|                |                            | > in custom           |
|                |                            | > authentication      |
|                |                            | > methods to          |
|                |                            | > malicious entities  |
|                |                            | > who may exploit     |
|                |                            | > those               |
|                |                            | > vulnerabilities to  |
|                |                            | > manipulate, or      |
|                |                            | > otherwise bypass    |
|                |                            | > the custom          |
|                |                            | > authentication      |
|                |                            | > mechanisms,         |
|                |                            | > rendering all such  |
|                |                            | > functions           |
|                |                            | > effectively         |
|                |                            | > useless.            |
+----------------+----------------------------+-----------------------+
|                | **C.2.1.1.b** The assessor |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the           |                       |
|                | implemented methods use    |                       |
|                | industry-standard          |                       |
|                | mechanisms that are:       |                       |
|                |                            |                       |
|                | -   Provided by well-known |                       |
|                |     > and                  |                       |
|                |     > industry-accepted    |                       |
|                |     > third-party          |                       |
|                |     > suppliers; or        |                       |
|                |                            |                       |
|                | -   Designed and           |                       |
|                |     > implemented in       |                       |
|                |     > accordance with      |                       |
|                |     > applicable industry  |                       |
|                |     > standards or best    |                       |
|                |     > practices.           |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.1.1.c** Where        |                       |
|                | sessions are used to       |                       |
|                | authenticate user access   |                       |
|                | to sensitive functions and |                       |
|                | sensitive resources, the   |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that   |                       |
|                | the sessions are handled   |                       |
|                | in accordance with         |                       |
|                | industry-recognized        |                       |
|                | standards and best         |                       |
|                | practices for secure       |                       |
|                | session management.        |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.1.1.d** Where tokens |                       |
|                | (for example, access       |                       |
|                | tokens and refresh tokens) |                       |
|                | are used to authenticate   |                       |
|                | user access to sensitive   |                       |
|                | functions and sensitive    |                       |
|                | resources, the assessor    |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the tokens    |                       |
|                | are handled in accordance  |                       |
|                | with industry-recognized   |                       |
|                | standards and best         |                       |
|                | practices for secure token |                       |
|                | management.                |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.2.1.2**  | **C.2.1.2** Using          | > Strong and robust   |
| > The methods  | information obtained in    | > authentication      |
| > implemented  | Test Requirement           | > methods are those   |
| > to           | C.2.1.1.a, the assessor    | > that are resistant  |
| > authenticate | shall examine evidence to  | > to common attacks.  |
| > user access  | confirm that the           | > Examples of such    |
| > to sensitive | authentication methods     | > methods include,    |
| > functions    | implemented are            | > but are not limited |
| > and          | sufficiently strong and    | > to, multi- factor   |
| > sensitive    | robust to protect          | > authentication      |
| > resources    | authentication credentials | > and/or              |
| > through      | in accordance with Control | > authentication      |
| > Internet-    | Objective 5.3 in the Core  | > methods that employ |
| > accessible   | Requirements section.      | > strong cryptography |
| > interfaces   |                            | > (such as digital    |
| > are          |                            | > signatures or       |
| > sufficiently |                            | > certificates).      |
| > strong and   |                            |                       |
| > robust to    |                            |                       |
| > protect      |                            |                       |
| >              |                            |                       |
| authentication |                            |                       |
| > credentials  |                            |                       |
| > in           |                            |                       |
| > accordance   |                            |                       |
| > with Control |                            |                       |
| > Objective    |                            |                       |
| > 5.3.         |                            |                       |
+----------------+----------------------------+-----------------------+
| > **C.2.1.3**  | **C.2.1.3.a** The assessor | > Like authorization  |
| >              | shall examine evidence to  | > decisions,          |
| Authentication | identify where within the  | > authentication      |
| > decisions    | software architecture      | > decisions must be   |
| > are enforced | authentication decisions   | > enforced within a   |
| > within a     | are enforced.              | > secure area of the  |
| > secure area  |                            | > software.           |
| > of the       |                            | > Authentication      |
| > software.    |                            | > methods should      |
|                |                            | > never rely solely   |
|                |                            | > on scripts or data  |
|                |                            | > obtained from the   |
|                |                            | > client or browser.  |
|                |                            | > With that said, it  |
|                |                            | > is permissible to   |
|                |                            | > use client-side     |
|                |                            | > scripts and data    |
|                |                            | > when combined with  |
|                |                            | > server-side methods |
|                |                            | > to enhance          |
|                |                            | > authentication      |
|                |                            | > capabilities.       |
+----------------+----------------------------+-----------------------+
|                | **C.2.1.3.b** The assessor |                       |
|                | shall examine evidence to  |                       |
|                | confirm that all           |                       |
|                | authentication decisions   |                       |
|                | are enforced within a      |                       |
|                | secure area of the         |                       |
|                | software architecture.     |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.1.3.c** The assessor |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that client-side   |                       |
|                | or browser-based           |                       |
|                | functions, scripts, and    |                       |
|                | data are never solely      |                       |
|                | relied upon for            |                       |
|                | authentication purposes.   |                       |
+----------------+----------------------------+-----------------------+
| > **C.2.2**    | **C.2.2.a** Using          | > Modern web          |
| > Access to    | information obtained in    | > applications,       |
| > all          | Test Requirement 2.1.a in  | > particularly those  |
| > Internet-    | the Core Requirements      | > that rely heavily   |
| > accessible   | section, the assessor      | > on APIs,            |
| > interfaces   | shall examine evidence to  | > microservices and   |
| > is           | identify all software      | > serverless          |
| > restricted   | interfaces that are        | > environments,       |
| > to           | exposed to the Internet or | > require             |
| > explicitly   | that can be configured in  | > fine-grained access |
| > authorized   | a way that exposes them to | > control             |
| > users only.  | the Internet.              | > capabilities to     |
|                |                            | > handle the          |
|                |                            | > increasingly        |
|                |                            | > complex             |
|                |                            | > relationships       |
|                |                            | > between software    |
|                |                            | > users, interfaces,  |
|                |                            | > functions, and      |
|                |                            | > resources.          |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+
|                | **C.2.2.b** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | identify all methods used  |                       |
|                | to authorize access to     |                       |
|                | Internet-accessible        |                       |
|                | interfaces.                |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.2.2.c** The assessor   | > One key difference  |
|                | shall examine evidence and | > between traditional |
|                | test the software to       | > "monolithic" web    |
|                | confirm that each of these | > applications and    |
|                | methods is:                | > modern web          |
|                |                            | > applications is the |
|                | -   implemented correctly; | > degree to which an  |
|                |                            | > application is      |
|                | -   appropriate for the    | > exposed (or         |
|                |     > types of users       | > potentially         |
|                |     > expected to use the  | > exposed) to the     |
|                |     > interface; and       | > Internet. Where     |
|                |                            | > monolithic web      |
|                | -   does not expose known  | > applications tend   |
|                |     > vulnerabilities.     | > to keep             |
|                |                            | > interactions        |
|                |                            | > between software    |
|                |                            | > components confined |
|                |                            | > to a single         |
|                |                            | > security context    |
|                |                            | > (such as an         |
|                |                            | > internal or         |
|                |                            | > isolated system or  |
|                |                            | > network), modern    |
|                |                            | > web applications    |
|                |                            | > are typically       |
|                |                            | > segmented into many |
|                |                            | > distinct and/or     |
|                |                            | > independent         |
|                |                            | > software functions  |
|                |                            | > that are then       |
|                |                            | > exposed to the      |
|                |                            | > Internet through    |
|                |                            | > APIs so that they   |
|                |                            | > may be accessible   |
|                |                            | > to other            |
|                |                            | > application or      |
|                |                            | > users, regardless   |
|                |                            | > of where they may   |
|                |                            | > reside.             |
|                |                            | >                     |
|                |                            | > Unfortunately, each |
|                |                            | > Internet accessible |
|                |                            | > interface (and the  |
|                |                            | > functions and       |
|                |                            | > resources it        |
|                |                            | > provides) is a      |
|                |                            | > potential attack    |
|                |                            | > vector. To mitigate |
|                |                            | > the risks           |
|                |                            | > associated with     |
|                |                            | > exposing so many    |
|                |                            | > software functions  |
|                |                            | > to the Internet,    |
|                |                            | > each interface must |
|                |                            | > implement access    |
|                |                            | > control mechanisms  |
|                |                            | > to ensure that only |
|                |                            | > authorized systems  |
|                |                            | > and users are able  |
|                |                            | > to access the       |
|                |                            | > interface, and the  |
|                |                            | > functions and       |
|                |                            | > resources exposed   |
|                |                            | > through those       |
|                |                            | > interfaces.         |
+----------------+----------------------------+-----------------------+
|                | **C.2.2.d** Where the      |                       |
|                | methods used to authorize  |                       |
|                | access to                  |                       |
|                | Internet-accessible        |                       |
|                | interfaces is user         |                       |
|                | configurable, or otherwise |                       |
|                | requires user input or     |                       |
|                | interaction, the assessor  |                       |
|                | shall examine evidence to  |                       |
|                | confirm that appropriate   |                       |
|                | guidance is made available |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1 that        |                       |
|                | describes the configurable |                       |
|                | options available and how  |                       |
|                | to configure each method   |                       |
|                | securely.                  |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.2.e** Where the      |                       |
|                | methods used to authorize  |                       |
|                | access to                  |                       |
|                | Internet-accessible        |                       |
|                | interfaces are configured  |                       |
|                | and controlled by the      |                       |
|                | assessed entity, the       |                       |
|                | assessor shall examine     |                       |
|                | evidence to                |                       |
|                |                            |                       |
|                | confirm that access to     |                       |
|                | Internet-accessible        |                       |
|                | interfaces is restricted   |                       |
|                | to an appropriate set of   |                       |
|                | explicitly authorized      |                       |
|                | users (or entities).       |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.2.f** The assessor   |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that access to all |                       |
|                | Internet-accessible        |                       |
|                | interfaces is restricted   |                       |
|                | to explicitly authorized   |                       |
|                | users only.                |                       |
+----------------+----------------------------+-----------------------+
| > **C.2.3**    | **C.2.3** Using            | > In addition to      |
| > Access to    | information obtained in    | > controlling access  |
| > all software | Test Requirement C.2.2.a,  | > at the interface-   |
| > functions    | the assessor shall examine | > level, access to    |
| > and          | evidence to identify all   | > individual          |
| > resources    | software functions and     | > functions and       |
| > exposed      | resources that are         | > resources provided  |
| > through      | exposed, or that can be    | > through each        |
| > Inter        | configured in a way that   | > Internet accessible |
| net-accessible | exposes them, through      | > interface must also |
| > interfaces   | Internet- accessible       | > be controlled.      |
| > is           | interfaces.                | >                     |
| > restricted   |                            | > Access needs to the |
| > to           |                            | > different functions |
| > explicitly   |                            | > and resources       |
| > authorized   |                            | > within a given      |
| > users only.  |                            | > interface can be    |
|                |                            | > quite complex       |
|                |                            | > depending upon the  |
|                |                            | > types of users and  |
|                |                            | > systems that need   |
|                |                            | > to use a given      |
|                |                            | > interface and the   |
|                |                            | > different           |
|                |                            | > capabilities and    |
|                |                            | > data accessible     |
|                |                            | > through those       |
|                |                            | > functions and       |
|                |                            | > resources.          |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.2.3.1**  | **C.2.3.1.a** Using        | > To support the      |
| > The software | information obtained in    | > fine-grained access |
| > ensures the  | Test Requirement C.2.3,    | > control needs of    |
| > enforcement  | the assessor shall examine | > modern web          |
| > of access    | evidence to determine how  | > application         |
| > control      | the software controls      | > architectures and   |
| > rules at     | access to individual       | > to ensure that      |
| > both the     | functions and resources    | > users are only able |
| > function     | exposed (or potentially    | > to access the       |
| > level and    | exposed) through           | > software functions  |
| > resource     | Internet-accessible        | > and resources that  |
| > level with   | interfaces.                | > they are authorized |
| > fine-grained |                            | > to use, the         |
| > access       |                            | > software must       |
| > control      |                            | > support the ability |
| >              |                            | > to define and       |
|  capabilities. |                            | > enforce access      |
|                |                            | > control rules at    |
|                |                            | > varying "levels"    |
|                |                            | > within the          |
|                |                            | > interface's         |
|                |                            | > hierarchy,          |
|                |                            | > including at the    |
|                |                            | > individual function |
|                |                            | > and resource        |
|                |                            | > level(s).           |
|                |                            | >                     |
|                |                            | > Depending upon the  |
|                |                            | > types of functions  |
|                |                            | > and resources       |
|                |                            | > exposed in a given  |
|                |                            | > software interface, |
|                |                            | > the methods used to |
|                |                            | > authorize access at |
|                |                            | > the interface-      |
|                |                            | > level may not be    |
|                |                            | > appropriate to      |
|                |                            | > provide access to   |
|                |                            | > individual          |
|                |                            | > functions and       |
|                |                            | > resources exposed   |
|                |                            | > through such        |
|                |                            | > interfaces.         |
|                |                            | >                     |
|                |                            | > For example, API    |
|                |                            | > keys are often used |
|                |                            | > to authorize access |
|                |                            | > to an API for a     |
|                |                            | > particular entity   |
|                |                            | > (also called        |
|                |                            | > project-level or    |
|                |                            | > entity-level        |
|                |                            | > authorization).     |
|                |                            | > While API keys may  |
|                |                            | > be suitable for     |
|                |                            | > authorizing this    |
|                |                            | > level of access to  |
|                |                            | > an API, it may not  |
|                |                            | > be suitable for     |
|                |                            | > authorizing         |
|                |                            | > individual user     |
|                |                            | > access to specific  |
|                |                            | > functions or        |
|                |                            | > resources exposed   |
|                |                            | > (or potentially     |
|                |                            | > exposed) through    |
|                |                            | > the API.            |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+
|                | **C.2.3.1.b** The assessor |                       |
|                | shall then examine         |                       |
|                | evidence to identify the   |                       |
|                | methods used to restrict   |                       |
|                | access to the functions    |                       |
|                | and resources exposed (or  |                       |
|                | potentially exposed)       |                       |
|                | through Internet-          |                       |
|                | accessible interfaces and  |                       |
|                | to confirm that each of    |                       |
|                | these methods is:          |                       |
|                |                            |                       |
|                | -   implemented correctly; |                       |
|                |                            |                       |
|                | -   appropriate for the    |                       |
|                |     > type of function(s)  |                       |
|                |     > and resource(s)      |                       |
|                |     > provided; and        |                       |
|                |                            |                       |
|                | -   does not expose known  |                       |
|                |     > vulnerabilities.     |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.3.1.c** Where the    |                       |
|                | methods used to authorize  |                       |
|                | access to the functions    |                       |
|                | and resources exposed (or  |                       |
|                | potentially exposed)       |                       |
|                | through                    |                       |
|                | Internet-accessible        |                       |
|                | interfaces are user        |                       |
|                | configurable or otherwise  |                       |
|                | requires user input or     |                       |
|                | interaction, the assessor  |                       |
|                | shall examine evidence to  |                       |
|                | confirm that guidance is   |                       |
|                | made available to          |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1 that describes the    |                       |
|                | mechanisms and             |                       |
|                | configurable options       |                       |
|                | available to restrict      |                       |
|                | access to the functions    |                       |
|                | and resources exposed      |                       |
|                | through these interfaces,  |                       |
|                | and how to configure such  |                       |
|                | mechanisms.                |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.2.3.1.d** Where the    | > Where fined-grained |
|                | methods used to authorize  | > access control is   |
|                | access to the functions    | > necessary, the      |
|                | and resources exposed (or  | > methods implemented |
|                | potentially exposed)       | > to control access   |
|                | through                    | > to all software     |
|                | Internet-accessible        | > functions and       |
|                | interfaces is configured   | > resources exposed   |
|                | and controlled by the      | > through Internet    |
|                | assessed entity, the       | > accessible          |
|                | assessor shall examine     | > interfaces must be  |
|                | evidence to confirm that   | > appropriate for the |
|                | access to the functions    | > types of            |
|                | and resources is           | > authorization(s)    |
|                | restricted to an           | > required (for       |
|                | appropriate set of         | > example, user       |
|                | explicitly authorized      | > versus entity) and  |
|                | users.                     | > the functions and   |
|                |                            | > resources involved  |
|                |                            | > (sensitive versus   |
|                |                            | > non-sensitive       |
|                |                            | > functions and       |
|                |                            | > resources).         |
|                |                            | >                     |
|                |                            | > Wherever end users  |
|                |                            | > are required to     |
|                |                            | > configure the       |
|                |                            | > access control      |
|                |                            | > authorizations and  |
|                |                            | > permissions for     |
|                |                            | > individual          |
|                |                            | > functions and       |
|                |                            | > resources exposed   |
|                |                            | > through Internet    |
|                |                            | > accessible          |
|                |                            | > interfaces, the     |
|                |                            | > software vendor     |
|                |                            | > must provide        |
|                |                            | > guidance (or        |
|                |                            | > otherwise make      |
|                |                            | > guidance            |
|                |                            | > accessible) to      |
|                |                            | > users and other     |
|                |                            | > stakeholders to     |
|                |                            | > explain how to      |
|                |                            | > configure such      |
|                |                            | > permissions and to  |
|                |                            | > alert them to       |
|                |                            | > important security  |
|                |                            | > considerations when |
|                |                            | > configuring         |
|                |                            | > available options   |
|                |                            | > and parameters.     |
+----------------+----------------------------+-----------------------+
|                | **C.2.3.1.e** The assessor |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that the methods   |                       |
|                | used to restrict access to |                       |
|                | the functions and          |                       |
|                | resources exposed (or      |                       |
|                | potentially exposed)       |                       |
|                | through                    |                       |
|                | Internet-accessible        |                       |
|                | interfaces require users   |                       |
|                | to be explicitly           |                       |
|                | authorized prior to being  |                       |
|                | granted such access.       |                       |
+----------------+----------------------------+-----------------------+
| > **C.2.3.2**  | **C.2.3.2.a** Using        | > Most modern web     |
| >              | information obtained in    | > applications,       |
|  Authorization | Test Requirement           | > particularly those  |
| > rules are    | C.2.3.1.a, the assessor    | > that use APIs,      |
| > enforced     | shall examine evidence to  | > microservices and   |
| > upon each    | confirm that authorization | > serverless          |
| > user request | checks are performed each  | > architectures,      |
| > to access    | time users request access  | > operate on a        |
| > software     | to a function or resource  | > request/response    |
| > functions    | exposed (or potentially    | > basis. Each time a  |
| > and          | exposed) through           | > user wants to       |
| > resources    | Internet-accessible        | > perform a function  |
| > through      | interfaces to verify they  | > or access           |
| > Internet-    | are authorized for the     | > application data,   |
| > accessible   | function, resource, and    | > they submit a       |
| > interfaces.  | type of access requested.  | > request to the      |
|                |                            | > application         |
|                |                            | > (usually through an |
|                |                            | > API or similar) to  |
|                |                            | > access a particular |
|                |                            | > function or         |
|                |                            | > resource. The       |
|                |                            | > software then       |
|                |                            | > processes that      |
|                |                            | > request and, if     |
|                |                            | > authorized,         |
|                |                            | > executes the        |
|                |                            | > requested function  |
|                |                            | > and/or returns the  |
|                |                            | > requested data.     |
|                |                            | >                     |
|                |                            | > It is often trivial |
|                |                            | > for attackers to    |
|                |                            | > obtain login        |
|                |                            | > credentials of      |
|                |                            | > authorized users. A |
|                |                            | > defense-in-depth    |
|                |                            | > strategy is         |
|                |                            | > essential to        |
|                |                            | > ensuring that only  |
|                |                            | > authorized users    |
|                |                            | > can access          |
|                |                            | > protected functions |
|                |                            | > and resources. When |
|                |                            | > combined with other |
|                |                            | > security controls,  |
|                |                            | > such as expiring    |
|                |                            | > sessions or tokens  |
|                |                            | > after a relatively  |
|                |                            | > short period of     |
|                |                            | > time, authorization |
|                |                            | > checks can          |
|                |                            | > significantly limit |
|                |                            | > what an attacker    |
|                |                            | > can do if they are  |
|                |                            | > able to compromise  |
|                |                            | > the credentials of  |
|                |                            | > an authorized user. |
+----------------+----------------------------+-----------------------+
|                | **C.2.3.2.b** The assessor |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that access        |                       |
|                | control rules are enforced |                       |
|                | each time a user attempts  |                       |
|                | to access a function or    |                       |
|                | resource exposed (or       |                       |
|                | potentially exposed)       |                       |
|                | through                    |                       |
|                | Internet-accessible        |                       |
|                | interfaces.                |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.2.3.3**  | **C.2.3.3.a** The assessor | > Payment software    |
| > Access       | shall examine evidence to  | > should never rely   |
| > control      | identify where in the      | > on unknown or       |
| > decisions    | software architecture      | > insecure services   |
| > are enforced | authorization and access   | > and features for    |
| > within a     | control decisions are      | > security-related    |
| > secure area  | enforced.                  | > purposes. Secure    |
| > of the       |                            | > areas or systems    |
| > software     |                            | > are those within    |
| >              |                            | > the software        |
|  architecture. |                            | > architecture where  |
|                |                            | > the integrity of    |
|                |                            | > available services  |
|                |                            | > and data is         |
|                |                            | > ensured, and        |
|                |                            | > therefore can be    |
|                |                            | > relied upon by the  |
|                |                            | > software.           |
|                |                            | >                     |
|                |                            | > Historically, web   |
|                |                            | > application         |
|                |                            | > architectures       |
|                |                            | > consisted of        |
|                |                            | > "client-side"       |
|                |                            | > components and      |
|                |                            | > "server-side"       |
|                |                            | > components.         |
|                |                            | > Client-side         |
|                |                            | > functions are those |
|                |                            | > typically performed |
|                |                            | > by a common web     |
|                |                            | > browser.            |
|                |                            | > Server-side         |
|                |                            | > functions are those |
|                |                            | > typically performed |
|                |                            | > by web,             |
|                |                            | > application, and/or |
|                |                            | > database servers.   |
|                |                            | > Given the open      |
|                |                            | > nature and design   |
|                |                            | > of most common web  |
|                |                            | > browsers and the    |
|                |                            | > fact that they are  |
|                |                            | > maintained by end   |
|                |                            | > users, server-side  |
|                |                            | > functions are       |
|                |                            | > typically           |
|                |                            | > considered to be    |
|                |                            | > more secure given a |
|                |                            | > software/service    |
|                |                            | > provider's ability  |
|                |                            | > to control and      |
|                |                            | > secure those        |
|                |                            | > aspects of the      |
|                |                            | > software            |
|                |                            | > architecture.       |
|                |                            | >                     |
|                |                            | > Modern web software |
|                |                            | > architectures,      |
|                |                            | > however, have       |
|                |                            | > become increasingly |
|                |                            | > complex with        |
|                |                            | > software components |
|                |                            | > often deployed      |
|                |                            | > across multiple     |
|                |                            | > geographic          |
|                |                            | > locations and       |
|                |                            | > managed by multiple |
|                |                            | > entities. In these  |
|                |                            | > circumstances, the  |
|                |                            | > distinction between |
|                |                            | > "client-side" or    |
|                |                            | > "server-side"       |
|                |                            | > functions can be    |
|                |                            | > increasingly        |
|                |                            | > ambiguous. The term |
|                |                            | > "secure area" is a  |
|                |                            | > reference to        |
|                |                            | > traditional         |
|                |                            | > "server-side"       |
|                |                            | > functions without   |
|                |                            | > getting into        |
|                |                            | > architectural       |
|                |                            | > specifics. Examples |
|                |                            | > of a secure area    |
|                |                            | > include a secured   |
|                |                            | > server environment, |
|                |                            | > a microservice, or  |
|                |                            | > a serverless API.   |
+----------------+----------------------------+-----------------------+
|                | **C.2.3.3.b** The assessor |                       |
|                | shall examine evidence to  |                       |
|                | confirm that all access    |                       |
|                | control decisions are      |                       |
|                | enforced within a secure   |                       |
|                | area of the software       |                       |
|                | architecture.              |                       |
+----------------+----------------------------+-----------------------+
|                | **C.2.3.3.c** The assessor |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that client-side   |                       |
|                | or browser-based           |                       |
|                | functions, scripts, and    |                       |
|                | data are never solely      |                       |
|                | relied upon for access     |                       |
|                | control purposes.          |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark53 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > C.3: Web     |                            |                       |
| > Software     |                            |                       |
| > Attack       |                            |                       |
| > Mitigation** |                            |                       |
| >              |                            |                       |
| > Software     |                            |                       |
| > security     |                            |                       |
| > controls are |                            |                       |
| > implemented  |                            |                       |
| > to mitigate  |                            |                       |
| > common       |                            |                       |
| > attacks on   |                            |                       |
| > web          |                            |                       |
| >              |                            |                       |
|  applications. |                            |                       |
+----------------+----------------------------+-----------------------+
| > **C.3.1**    | **C.3.1.a** The assessor   | HTTP Security Headers |
| > The software | shall examine evidence to  | are a set of          |
| > enforces or  | confirm the software       | security-related      |
| > otherwise    | supports the use of the    | configuration options |
| > supports the | latest HTTP Security       | available on most     |
| > use of the   | Headers, and to determine  | common web servers.   |
| > latest HTTP  | the options available and  | Examples include the  |
| > Security     | how such settings are      | X-Frame-Options       |
| > Headers to   | configured.                | header, the           |
| > protect      |                            | HTTP-Stri             |
| > Internet     |                            | ct-Transport-Security |
| > accessible   |                            | header, and the       |
| > interfaces   |                            | Co                    |
| > from         |                            | ntent-Security-Policy |
| > attacks.     |                            | header.               |
|                |                            |                       |
|                |                            | The use of these      |
|                |                            | options can protect   |
|                |                            | against a variety of  |
|                |                            | different types of    |
|                |                            | attacks including     |
|                |                            | cross- site           |
|                |                            | scripting,            |
|                |                            | clickjacking, and     |
|                |                            | cross-site request    |
|                |                            | forgery attacks.      |
|                |                            |                       |
|                |                            | While support for     |
|                |                            | specific HTTP         |
|                |                            | Security Headers may  |
|                |                            | differ depending on   |
|                |                            | the underlying        |
|                |                            | platform or software  |
|                |                            | technology, these     |
|                |                            | options are widely    |
|                |                            | available and should  |
|                |                            | be enabled and        |
|                |                            | configured to the     |
|                |                            | most secure           |
|                |                            | configuration         |
|                |                            | feasible for a given  |
|                |                            | implementation.       |
+----------------+----------------------------+-----------------------+
|                | **C.3.1.b** Where HTTP     |                       |
|                | Security Headers are       |                       |
|                | configured and controlled  |                       |
|                | by the software provider,  |                       |
|                | the assessor shall examine |                       |
|                | evidence to confirm that   |                       |
|                | the software is configured |                       |
|                | to use the latest          |                       |
|                | available HTTP Security    |                       |
|                | Headers and that the       |                       |
|                | configuration settings are |                       |
|                | reasonable and justified.  |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.1.c** Where user     |                       |
|                | input or interaction is    |                       |
|                | required to configure HTTP |                       |
|                | Security Headers, the      |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that   |                       |
|                | guidance is made available |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1 that        |                       |
|                | describes the HTTP         |                       |
|                | Security Headers supported |                       |
|                | by the software and how to |                       |
|                | configure such settings.   |                       |
+----------------+----------------------------+-----------------------+
| > **C.3.2**    | **C.3.2.a** Using          | Many vulnerabilities  |
| > Input data   | information obtained in    | in software and       |
| > from         | Test Requirement C.2.1.a,  | systems are exposed   |
| > untrusted    | the assessor shall examine | when input data       |
| > sources is   | evidence to identify all   | supplied by an        |
| > never        | interfaces that accept     | untrusted source is   |
| > trusted and  | data input from untrusted  | inherently trusted by |
| > software     | sources.                   | the software and is   |
| > security     |                            | processed without     |
| > controls are |                            | first ensuring the    |
| > implemented  |                            | data is safe.         |
| > to mitigate  |                            |                       |
| > the          |                            | Untrusted sources are |
| > exploitation |                            | those that reside in  |
| > of           |                            | a different security  |
| > v            |                            | context than the API  |
| ulnerabilities |                            | or system receiving   |
| > through the  |                            | and processing the    |
| > manipulation |                            | input data. Examples  |
| > of input     |                            | of an untrusted       |
| > data.        |                            | source could include  |
|                |                            | a system, API, or     |
|                |                            | microservice residing |
|                |                            | in a different        |
|                |                            | environment, an       |
|                |                            | internal system that  |
|                |                            | resides on the same   |
|                |                            | network but is        |
|                |                            | maintained under a    |
|                |                            | lower security        |
|                |                            | classification, or a  |
|                |                            | user's browser.       |
|                |                            |                       |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+
|                | **C.3.2.b** Where the      |                       |
|                | software accepts input     |                       |
|                | from untrusted sources,    |                       |
|                | the assessor shall examine |                       |
|                | evidence to identify the   |                       |
|                | data format(s) expected by |                       |
|                | the software for each      |                       |
|                | input field and the        |                       |
|                | parsers and interpreters   |                       |
|                | involved in processing the |                       |
|                | input data.                |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.2.c** Using          | > Two of the most     |
|                | information obtained in    | > common types of     |
|                | Test Requirement 4.1.a in  | > attacks, Injection  |
|                | the Core Requirements      | > (SQL, XML, Code,    |
|                | section, the assessor      | > String, and so on)  |
|                | shall examine evidence to  | > and Cross-Site      |
|                | determine whether attacks  | > Scripting (XSS),    |
|                | that target all such       | > exploit the         |
|                | parsers and interpreters   | > software's trust in |
|                | are acknowledged in the    | > input data provided |
|                | threat model.              | > by untrusted        |
|                |                            | > sources to execute  |
|                |                            | > malicious code or   |
|                |                            | > to force the        |
|                |                            | > software to behave  |
|                |                            | > in unintended ways. |
|                |                            | >                     |
|                |                            | > To protect against  |
|                |                            | > these and other     |
|                |                            | > types of related    |
|                |                            | > attacks, input data |
|                |                            | > must never be       |
|                |                            | > trusted, and        |
|                |                            | > software security   |
|                |                            | > controls must be    |
|                |                            | > implemented to      |
|                |                            | > ensure input data   |
|                |                            | > is validated,       |
|                |                            | > rendered safe, or   |
|                |                            | > otherwise handled   |
|                |                            | > in a manner that    |
|                |                            | > mitigates the       |
|                |                            | > likelihood and/or   |
|                |                            | > impacts of          |
|                |                            | > executing malicious |
|                |                            | > input data.         |
+----------------+----------------------------+-----------------------+
|                | **C.3.2.d** Where such     |                       |
|                | attacks are acknowledged   |                       |
|                | and using information      |                       |
|                | obtained in Test           |                       |
|                | Requirement 4.2.a in the   |                       |
|                | Core Requirements section, |                       |
|                | the assessor shall examine |                       |
|                | evidence to confirm that   |                       |
|                | software security controls |                       |
|                | are defined and            |                       |
|                | implemented to mitigate    |                       |
|                | attacks that attempt to    |                       |
|                | exploit vulnerabilities    |                       |
|                | through the manipulation   |                       |
|                | of input data.             |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.2.e** Where the      |                       |
|                | implementation of software |                       |
|                | security controls is       |                       |
|                | configurable or otherwise  |                       |
|                | requires user input or     |                       |
|                | interaction, the assessor  |                       |
|                | shall examine evidence to  |                       |
|                | confirm that guidance is   |                       |
|                | made available to          |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1 that describes how to |                       |
|                | properly configure such    |                       |
|                | security controls.         |                       |
+----------------+----------------------------+-----------------------+
| > **C.3.2.1**  | **C.3.2.1.a** Using        | > There are a variety |
| > Ind          | information obtained in    | > of methods and      |
| ustry-standard | Test Requirement 4.2.a in  | > techniques that may |
| > methods are  | the Core Requirements      | > be used to protect  |
| > used to      | section, the assessor      | > software inputs     |
| > protect      | shall examine evidence to  | > from injection and  |
| > software     | identify all software      | > other similar types |
| > inputs from  | security controls          | > of attacks. The     |
| > attacks that | implemented to mitigate    | > method most often   |
| > attempt to   | attacks that attempt to    | > associated with     |
| > exploit      | exploit vulnerabilities    | > such protections is |
| > v            | through the manipulation   | > "input validation." |
| ulnerabilities | of input data.             | > Input validation,   |
| > through the  |                            | > however, is         |
| > manipulation |                            | > difficult to        |
| > of input     |                            | > implement           |
| > data.        |                            | > correctly,          |
|                |                            | > particularly where  |
|                |                            | > complex input data, |
|                |                            | > such as URLs, XML,  |
|                |                            | > JSON, serialized    |
|                |                            | > objects, and so on, |
|                |                            | > are involved.       |
|                |                            | > Therefore, input    |
|                |                            | > validation is not   |
|                |                            | > appropriate as a    |
|                |                            | > primary defense     |
|                |                            | > against input       |
|                |                            | > manipulation        |
|                |                            | > attacks.            |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.2.1.b** The assessor | > Other methods, such |
|                | shall examine evidence to  | > as parameterization |
|                | confirm that the methods   | > and output          |
|                | implemented to protect     | > escaping, are       |
|                | against such attacks use   | > better suited as    |
|                | industry-standard          | > primary defense     |
|                | mechanisms and/or          | > mechanisms. While   |
|                | techniques that are:       | > the type and        |
|                |                            | > complexity of the   |
|                | -   Provided by well-known | > input data and how  |
|                |     > and                  | > the data is         |
|                |     > industry-accepted    | > expected to be used |
|                |     > third-party          | > often dictate the   |
|                |     > suppliers; or        | > methods that are    |
|                |                            | > most appropriate    |
|                | -   Designed and           | > for a given input,  |
|                |     > implemented in       | > parameterization    |
|                |     > accordance with      | > should be used      |
|                |     > applicable industry  | > where possible.     |
|                |     > standards or best    | > Output escaping can |
|                |     > practices.           | > be used as an       |
|                |                            | > alternative if      |
|                |                            | > parameterization is |
|                |                            | > not feasible. The   |
|                |                            | > use of input        |
|                |                            | > validation may be   |
|                |                            | > used as a secondary |
|                |                            | > defense, where      |
|                |                            | > appropriate, to     |
|                |                            | > provide defense-in- |
|                |                            | > depth.              |
|                |                            | >                     |
|                |                            | > As is the case with |
|                |                            | > other critical      |
|                |                            | > functions such as   |
|                |                            | > authentication and  |
|                |                            | > authorization,      |
|                |                            | > input protection    |
|                |                            | > methods should      |
|                |                            | > leverage            |
|                |                            | > industry-accepted   |
|                |                            | > third- party        |
|                |                            | > mechanisms where    |
|                |                            | > possible. If the    |
|                |                            | > use of such         |
|                |                            | > mechanisms is not   |
|                |                            | > feasible, then      |
|                |                            | > custom methods may  |
|                |                            | > be used if they are |
|                |                            | > designed and        |
|                |                            | > implemented in      |
|                |                            | > accordance with     |
|                |                            | > applicable industry |
|                |                            | > standards or best   |
|                |                            | > practices.          |
+----------------+----------------------------+-----------------------+
|                | **C.3.2.1.c** The assessor |                       |
|                | shall examine evidence and |                       |
|                | test the software to       |                       |
|                | confirm that the           |                       |
|                | implemented methods:       |                       |
|                |                            |                       |
|                | -   Are implemented        |                       |
|                |     > correctly in         |                       |
|                |     > accordance with      |                       |
|                |     > available guidance,  |                       |
|                |     > and                  |                       |
|                |                            |                       |
|                | -   Do not expose any      |                       |
|                |     > vulnerabilities.     |                       |
+----------------+----------------------------+-----------------------+
| > **C.3.2.2**  | **C.3.2.2.a** Using        | > In some cases, it   |
| > Parsers and  | information obtained in    | > may not be feasible |
| > interpreters | Test Requirement C.3.2.b,  | > to isolate          |
| > are          | the assessor shall examine | > (parameterization)  |
| > configured   | evidence to identify the   | > or modify           |
| > with the     | configurations for each    | > (escaping,          |
| > most         | parser or interpreter used | > encoding, etc.)     |
| > restrictive  | to process untrusted input | > input data prior to |
| >              | data.                      | > processing the      |
|  configuration |                            | > data. In such       |
| > feasible.    |                            | > cases, the only     |
|                |                            | > viable method to    |
|                |                            | > protect against     |
|                |                            | > input manipulation  |
|                |                            | > attacks is to use a |
|                |                            | > parser or           |
|                |                            | > interpreter that    |
|                |                            | > has been hardened   |
|                |                            | > to prevent such     |
|                |                            | > attacks.            |
|                |                            | >                     |
|                |                            | > For example, at the |
|                |                            | > time of this        |
|                |                            | > publication the     |
|                |                            | > only viable way to  |
|                |                            | > protect against an  |
|                |                            | > XML External Entity |
|                |                            | > attack is to        |
|                |                            | > configure the XML   |
|                |                            | > parser to disable   |
|                |                            | > the Document Type   |
|                |                            | > Definition (DTD)    |
|                |                            | > feature, otherwise  |
|                |                            | > known as External   |
|                |                            | > Entities feature.   |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.2.2.b** For each of  | > The specific        |
|                | the parsers/interpreters   | > settings that must  |
|                | and the configurations     | > be disabled/enabled |
|                | identified, the assessor   | > to protect against  |
|                | shall examine evidence to  | > certain attacks     |
|                | confirm that parsers and   | > depends on the      |
|                | interpreters are           | > parsers and         |
|                | configured with the most   | > interpreters. For   |
|                | restrictive set of         | > more information,   |
|                | capabilities feasible and  | > refer to available  |
|                | that the settings are      | > security guidance   |
|                | justified and reasonable.  | > on the specific     |
|                |                            | >                     |
|                | Where certain              |  parsers/interpreters |
|                | parser/interpreter         | > in use.             |
|                | features cannot be         | >                     |
|                | configured securely, the   | > Where certain       |
|                | assessor shall examine     | > features of the     |
|                | evidence to confirm that   | > parsers or          |
|                | other methods are          | > interpreters cannot |
|                | implemented to mitigate    | > be configured with  |
|                | the lack of secure         | > the most secure     |
|                | settings and to further    | > settings possible,  |
|                | protect against the        | > then the processing |
|                | execution of malicious     | > of untrusted input  |
|                | commands.                  | > data should use     |
|                |                            | > techniques such as  |
|                |                            | > sandboxing to       |
|                |                            | > prevent (or         |
|                |                            | > otherwise mitigate  |
|                |                            | > the impacts of)     |
|                |                            | > malicious code      |
|                |                            | > execution.          |
+----------------+----------------------------+-----------------------+
| > **C.3.3**    | **C.3.3.a** Using          | > While the goal of   |
| > Software     | information obtained in    | > many attacks is to  |
| > security     | Test Requirements          | > expose sensitive    |
| > controls are |                            | > data and sensitive  |
| > implemented  | C.2.1.a and C.2.2, the     | > functions (directly |
| > to protect   | assessor shall examine     | > or indirectly) to   |
| > software     | evidence to identify all   | > unauthorized users, |
| > interfaces   | Internet accessible        | > other attacks are   |
| > from         | interfaces and the         | > intended to prevent |
| > resource     | functions and resources    | > an application's    |
| > starvation   | exposed (or potentially    | > use of or access to |
| > attacks.     | exposed) through those     | > important computing |
|                | interfaces to identify     | > resources.          |
|                | where such interfaces,     | >                     |
|                | functions, and resources   | > Such attacks aim to |
|                | may be susceptible to      | > overwhelm the       |
|                | resource starvation        | > software/system     |
|                | attacks.                   | > with requests or    |
|                |                            | > fill all available  |
|                |                            | > system resources    |
|                |                            | > such as processing  |
|                |                            | > time or memory,     |
|                |                            | > therefore starving  |
|                |                            | > the software/system |
|                |                            | > of the resources it |
|                |                            | > requires for normal |
|                |                            | > operation and       |
|                |                            | > rendering it        |
|                |                            | > unusable to other   |
|                |                            | > users.              |
|                |                            | >                     |
|                |                            | > In other cases,     |
|                |                            | > these attacks are   |
|                |                            | > intended to force   |
|                |                            | > the software to     |
|                |                            | > behave in           |
|                |                            | > unintended ways     |
|                |                            | > which could, in     |
|                |                            | > turn, enable an     |
|                |                            | > attacker to execute |
|                |                            | > arbitrary code on   |
|                |                            | > the targeted system |
|                |                            | > or expose sensitive |
|                |                            | > data through error  |
|                |                            | > messages.           |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+
|                | **C.3.3.b** Where such     |                       |
|                | interfaces, functions, and |                       |
|                | resources are potentially  |                       |
|                | susceptible to resource    |                       |
|                | starvation attacks, the    |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that:  |                       |
|                |                            |                       |
|                | -   The threat of such     |                       |
|                |     > attacks is           |                       |
|                |     > documented in        |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 4.1, and             |                       |
|                |                            |                       |
|                | -   Software security      |                       |
|                |     > controls to mitigate |                       |
|                |     > such attacks are     |                       |
|                |     > documented and       |                       |
|                |     > implemented in       |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 4.2.                 |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.3.c** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | resource starvation and    |                       |
|                | other similar attacks on   |                       |
|                | Internet accessible        |                       |
|                | interfaces are designed    |                       |
|                | and implemented in         |                       |
|                | accordance with applicable |                       |
|                | industry standards and     |                       |
|                | best practices.            |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.3.d** Where the      | > Examples of methods |
|                | implementation of software | > used to mitigate    |
|                | security controls is user  | > the risk of such    |
|                | configurable or otherwise  | > attacks include     |
|                | requires user input or     | > limiting the rate   |
|                | interaction, the assessor  | > on the number of    |
|                | shall examine evidence to  | > requests that can   |
|                | confirm that guidance is   | > be submitted within |
|                | made available to          | > a given time period |
|                | stakeholders in accordance | > (rate limiting).    |
|                | with Control Objective     | > Additional methods  |
|                | 12.1 that describes how to | > to prevent such     |
|                | configure such mechanisms. | > attacks may include |
|                |                            | > defining other      |
|                |                            | > limits such as the  |
|                |                            | > number of users     |
|                |                            | > and/or systems that |
|                |                            | > can submit          |
|                |                            | > requests, mutually  |
|                |                            | > authenticating      |
|                |                            | > those users and     |
|                |                            | > systems, or using   |
|                |                            | > CAPTCHA or other    |
|                |                            | > anti- automation    |
|                |                            | > techniques that can |
|                |                            | > prevent large       |
|                |                            | > volumes of requests |
|                |                            | > being submitted to  |
|                |                            | > software interfaces |
|                |                            | > within a short time |
|                |                            | > period.             |
|                |                            | >                     |
|                |                            | > For SaaS or other   |
|                |                            | > similar             |
|                |                            | > environments,       |
|                |                            | > appropriate         |
|                |                            | > network-based       |
|                |                            | > controls may also   |
|                |                            | > be used to address  |
|                |                            | > these types of      |
|                |                            | > attacks.            |
+----------------+----------------------------+-----------------------+
| > **C.3.4**    | **C.3.4.a** Using          | > File uploads can be |
| > Software     | information obtained in    | > used to provide     |
| > security     | Test Requirement C.2.1.a,  | > larger datasets to  |
| > controls are | the assessor shall examine | > a piece of          |
| > implemented  | evidence to identify all   | > software. However,  |
| > to protect   | Internet accessible        | > such uploads must   |
| > Internet     | interfaces that accept     | > be managed securely |
| > accessible   | file uploads and the file  | > to prevent the      |
| > interfaces   | types permitted.           | > misuse of this      |
| > from         |                            | > function. Files not |
| > malicious    |                            | > correctly managed   |
| > file         |                            | > may end up being    |
| > content.     |                            | > executable on the   |
|                |                            | > host system or be   |
|                |                            | > used as a vector to |
|                |                            | > infect or subvert   |
|                |                            | > the software or     |
|                |                            | > other systems (for  |
|                |                            | > example, by         |
|                |                            | > creating or         |
|                |                            | > overwriting         |
|                |                            | > malicious           |
|                |                            | > configuration       |
|                |                            | > files). File upload |
|                |                            | > interfaces may also |
|                |                            | > provide unintended  |
|                |                            | > access to the       |
|                |                            | > underlying host     |
|                |                            | > system or software. |
|                |                            | >                     |
|                |                            | > Different file      |
|                |                            | > types may be        |
|                |                            | > provided with       |
|                |                            | > different           |
|                |                            | > permissions or      |
|                |                            | > functions within a  |
|                |                            | > host system, and    |
|                |                            | > any file upload     |
|                |                            | > system should       |
|                |                            | > ensure that only    |
|                |                            | > expected file types |
|                |                            | > are accepted for    |
|                |                            | > upload.             |
|                |                            | >                     |
|                |                            | > However, care must  |
|                |                            | > be taken to ensure  |
|                |                            | > that this added     |
|                |                            | > process does not    |
|                |                            | > itself expose       |
|                |                            | > vulnerabilities     |
|                |                            | > that could be       |
|                |                            | > exploited.          |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.b** Where the      |                       |
|                | software accepts file      |                       |
|                | uploads over Internet      |                       |
|                | accessible interfaces, the |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that:  |                       |
|                |                            |                       |
|                | -   The threat of attacks  |                       |
|                |     > on file upload       |                       |
|                |     > mechanisms is        |                       |
|                |     > documented in        |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 4.1, and             |                       |
|                |                            |                       |
|                | -   Software security      |                       |
|                |     > controls to mitigate |                       |
|                |     > such attacks are     |                       |
|                |     > documented and       |                       |
|                |     > implemented in       |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 4.2.                 |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.c** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | attacks on file upload     |                       |
|                | mechanisms are implemented |                       |
|                | in accordance with         |                       |
|                | applicable industry        |                       |
|                | standards and best         |                       |
|                | practices.                 |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.4.d** The assessor   | > Many file formats   |
|                | shall examine evidence to  | > allow for the       |
|                | confirm that the software  | > embedding of other  |
|                | security controls          | > files or data which |
|                | implemented to mitigate    | > can be 'expanded'   |
|                | attacks on file upload     | > out when parsing    |
|                | mechanisms include methods | > the source file. In |
|                | to restrict the file types | > some scenarios this |
|                | permitted by the file      | > can be used to gain |
|                | upload mechanisms.         | > privileges or       |
|                |                            | > exploit             |
|                |                            | > vulnerabilities on  |
|                |                            | > the host platform   |
|                |                            | > which would not     |
|                |                            | > otherwise be        |
|                |                            | > possible. Uploaded  |
|                |                            | > files need to be    |
|                |                            | > managed in ways     |
|                |                            | > that prevent the    |
|                |                            | > exploitation of     |
|                |                            | > file parsing or     |
|                |                            | > expansion attacks.  |
|                |                            | >                     |
|                |                            | > To prevent the      |
|                |                            | > exploitation of     |
|                |                            | > file upload         |
|                |                            | > systems, any files  |
|                |                            | > that are uploaded   |
|                |                            | > cannot be assigned  |
|                |                            | > writable or         |
|                |                            | > executable          |
|                |                            | > privileges. Files   |
|                |                            | > which are required  |
|                |                            | > to be writable need |
|                |                            | > to be copied across |
|                |                            | > to a separate file  |
|                |                            | > managed only by the |
|                |                            | > software to prevent |
|                |                            | > a malicious user    |
|                |                            | > from exploiting the |
|                |                            | > file between upload |
|                |                            | > and use.            |
|                |                            | >                     |
|                |                            | > For                 |
|                |                            | > defense-in-depth,   |
|                |                            | > some software       |
|                |                            | > development         |
|                |                            | > languages and       |
|                |                            | > frameworks include  |
|                |                            | > the ability to make |
|                |                            | > calls to            |
|                |                            | > anti-malware        |
|                |                            | > systems to scan     |
|                |                            | > these files upon    |
|                |                            | > upload. For more    |
|                |                            | > information, refer  |
|                |                            | > to relevant         |
|                |                            | > third-party         |
|                |                            | > documentation.      |
|                |                            | >                     |
|                |                            | > File and file type  |
|                |                            | > parsers are         |
|                |                            | > notorious sources   |
|                |                            | > of exploits. Such   |
|                |                            | > parsers must not    |
|                |                            | > make security       |
|                |                            | > decisions based on  |
|                |                            | > file names or file  |
|                |                            | > extensions.         |
|                |                            | > Acceptable file     |
|                |                            | > types should have a |
|                |                            | > basic structure     |
|                |                            | > that enables the    |
|                |                            | > software to         |
|                |                            | > determine the file  |
|                |                            | > type without using  |
|                |                            | > file names or file  |
|                |                            | > extensions.         |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.e** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | attacks on file upload     |                       |
|                | mechanisms include methods |                       |
|                | to restrict the maximum    |                       |
|                | number and size of files   |                       |
|                | permitted for upload.      |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.f** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | attacks on file upload     |                       |
|                | mechanisms account for the |                       |
|                | use of complex or          |                       |
|                | compressed file formats    |                       |
|                | that are often used to     |                       |
|                | overwhelm or otherwise     |                       |
|                | exploit file-parsing       |                       |
|                | mechanisms.                |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.g** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | attacks on file upload     |                       |
|                | mechanisms include methods |                       |
|                | that store uploaded files  |                       |
|                | outside of the webroot and |                       |
|                | assign those files         |                       |
|                | read-only permissions.     |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.h** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the use of    |                       |
|                | file-parsing mechanisms    |                       |
|                | does not rely on file      |                       |
|                | names or file extensions   |                       |
|                | for security purposes.     |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.4.i** Where the      |                       |
|                | implementation of software |                       |
|                | security controls is user  |                       |
|                | configurable or otherwise  |                       |
|                | requires user input or     |                       |
|                | interaction, the assessor  |                       |
|                | shall examine evidence to  |                       |
|                | confirm that guidance is   |                       |
|                | made available to          |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1 that describes how to |                       |
|                | configure such mechanisms. |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > **C.3.5**    | **C.3.5.a** Using          | > Some software APIs  |
| > Software     | information obtained in    | > accept serialized   |
| > security     | Test Requirements          | > data objects (for   |
| > controls are |                            | > example, arrays,    |
| > implemented  | C.2.1.a and C.2.2, the     | > cookies, tokens,    |
| > to protect   | assessor shall examine     | > and so on) to be    |
| > Internet     | evidence to identify all   | > passed from other   |
| > accessible   | software functions exposed | > systems. However,   |
| > interfaces   | through Internet           | > without appropriate |
| > from hostile | accessible interfaces that | > methods in place to |
| > object       | accept and process data    | > restrict object     |
| > creation and | objects as inputs.         | > deserialization and |
| > data         |                            | > creation, malicious |
| > tampering.   |                            | > individuals may be  |
|                |                            | > able to use these   |
|                |                            | > APIs to launch      |
|                |                            | > denial-of- service  |
|                |                            | > attacks, compromise |
|                |                            | > access control      |
|                |                            | > mechanisms, or      |
|                |                            | > inject and execute  |
|                |                            | > malicious code on   |
|                |                            | > underlying systems. |
|                |                            | >                     |
|                |                            | > There are numerous  |
|                |                            | > methods to protect  |
|                |                            | > against             |
|                |                            | > serialization (and  |
|                |                            | > deserialization)    |
|                |                            | > attacks. Some       |
|                |                            | > programming         |
|                |                            | > languages,          |
|                |                            | > libraries, and APIs |
|                |                            | > provide features    |
|                |                            | > and functions that  |
|                |                            | > are resistant to    |
|                |                            | > serialization       |
|                |                            | > attacks. Other      |
|                |                            | > methods include     |
|                |                            | > using               |
|                |                            | > deserialization     |
|                |                            | > mechanisms that     |
|                |                            | > only support pure   |
|                |                            | > data formats like   |
|                |                            | > JSON or XML,        |
|                |                            | > limiting data types |
|                |                            | > allowed during      |
|                |                            | > object creation,    |
|                |                            | > encrypting          |
|                |                            | > communications, and |
|                |                            | > authenticating API  |
|                |                            | > clients.            |
|                |                            | >                     |
|                |                            | > Appropriate methods |
|                |                            | > to protect against  |
|                |                            | > serialization       |
|                |                            | > attacks depend on   |
|                |                            | > the API             |
|                |                            | > implementation.     |
|                |                            | > Refer to industry   |
|                |                            | > sources, such as    |
|                |                            | > the Open Web        |
|                |                            | > Application         |
|                |                            | > Security Project    |
|                |                            | > (OWASP) for more    |
|                |                            | > information.        |
|                |                            | >                     |
|                |                            | > For the same        |
|                |                            | > reasons explained   |
|                |                            | > in the last         |
|                |                            | > paragraph of        |
|                |                            | > guidance for        |
|                |                            | > Control Objective   |
|                |                            | > C.3.4, file-parsing |
|                |                            | > mechanisms must not |
|                |                            | > make security       |
|                |                            | > decisions based on  |
|                |                            | > file names or file  |
|                |                            | > extensions.         |
|                |                            | > Acceptable file     |
|                |                            | > types should have a |
|                |                            | > basic structure     |
|                |                            | > that enables the    |
|                |                            | > software to         |
|                |                            | > determine the file  |
|                |                            | > type without using  |
|                |                            | > file names or file  |
|                |                            | > extensions.         |
|                |                            | >                     |
|                |                            | > *(continued on next |
|                |                            | > page)*              |
+----------------+----------------------------+-----------------------+
|                | **C.3.5.b** Where the      |                       |
|                | software accepts and       |                       |
|                | processes data objects as  |                       |
|                | inputs, the assessor shall |                       |
|                | examine evidence to        |                       |
|                | confirm that:              |                       |
|                |                            |                       |
|                | -   The threat of hostile  |                       |
|                |     > object creation and  |                       |
|                |     > data tampering       |                       |
|                |     > attacks is           |                       |
|                |     > documented in        |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 4.1, and             |                       |
|                |                            |                       |
|                | -   Software security      |                       |
|                |     > controls to mitigate |                       |
|                |     > such attacks are     |                       |
|                |     > documented and       |                       |
|                |     > implemented in       |                       |
|                |     > accordance with      |                       |
|                |     > Control Objective    |                       |
|                |     > 4.2.                 |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.5.c** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | hostile object creation    |                       |
|                | and data tampering attacks |                       |
|                | are implemented in         |                       |
|                | accordance with applicable |                       |
|                | industry standards and     |                       |
|                | best practices.            |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.5.d** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the software  |                       |
|                | security controls          |                       |
|                | implemented to mitigate    |                       |
|                | hostile object creation    |                       |
|                | and data tampering attacks |                       |
|                | include methods that       |                       |
|                | restrict the file formats  |                       |
|                | permitted by file-parsing  |                       |
|                | mechanisms.                |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.5.e** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the use of    |                       |
|                | file-parsing mechanisms    |                       |
|                | does not rely on file      |                       |
|                | names or file extensions   |                       |
|                | for security purposes.     |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.5.f** The assessor   |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the use of    |                       |
|                | file-parsing mechanisms    |                       |
|                | does not expose other      |                       |
|                | vulnerabilities.           |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.5.g** Where the      | > Some file-parsing   |
|                | software accepts           | > mechanisms are      |
|                | serialized objects as      | > inherently          |
|                | inputs, the assessor shall | > susceptible to      |
|                | examine evidence to        | > certain             |
|                | confirm that software      | > vulnerabilities.    |
|                | security controls are      | > For example, XML    |
|                | implemented to protect     | > parsers are often   |
|                | against deserialization    | > vulnerable to       |
|                | attacks and that such      | > External Entity     |
|                | security controls adhere   | > attacks. Similarly, |
|                | to applicable industry     | > JSON parsers are    |
|                | standards and best         | > vulnerable to       |
|                | practices.                 | > attacks where       |
|                |                            | > insecure commands,  |
|                |                            | > such as eval(), can |
|                |                            | > enable the          |
|                |                            | > execution of        |
|                |                            | > malicious code.     |
|                |                            | >                     |
|                |                            | > To mitigate attacks |
|                |                            | > that attempt to     |
|                |                            | > exploit             |
|                |                            | > vulnerabilities in  |
|                |                            | > file-parsing        |
|                |                            | > mechanisms, it may  |
|                |                            | > be necessary for    |
|                |                            | > entities to         |
|                |                            | > implement           |
|                |                            | > additional software |
|                |                            | > security controls.  |
|                |                            | > Examples of such    |
|                |                            | > controls include,   |
|                |                            | > but are not limited |
|                |                            | > to, configuring     |
|                |                            | > file-parsing        |
|                |                            | > mechanisms to use   |
|                |                            | > the most            |
|                |                            | > restrictive         |
|                |                            | > configuration       |
|                |                            | > feasible, avoiding  |
|                |                            | > or escaping certain |
|                |                            | > commands that are   |
|                |                            | > known issues for    |
|                |                            | > file-parsing        |
|                |                            | > mechanisms, or      |
|                |                            | > isolating and       |
|                |                            | > executing           |
|                |                            | > file-parsing        |
|                |                            | > commands in a       |
|                |                            | > sandbox. The        |
|                |                            | > methods used to     |
|                |                            | > further mitigate    |
|                |                            | > such attacks should |
|                |                            | > consider the        |
|                |                            | > specific parsers    |
|                |                            | > and interpreters in |
|                |                            | > use and be          |
|                |                            | > implemented in a    |
|                |                            | > manner appropriate  |
|                |                            | > for each parser and |
|                |                            | > interpreter.        |
+----------------+----------------------------+-----------------------+
|                | **C.3.5.h** Where the      |                       |
|                | software security controls |                       |
|                | implemented to protect     |                       |
|                | against hostile object     |                       |
|                | creation and data          |                       |
|                | tampering are user         |                       |
|                | configurable or otherwise  |                       |
|                | require user input or      |                       |
|                | interaction, the assessor  |                       |
|                | shall examine evidence to  |                       |
|                | confirm that guidance is   |                       |
|                | made available to          |                       |
|                | stakeholders in accordance |                       |
|                | with Control Objective     |                       |
|                | 12.1 that describes how to |                       |
|                | configure such mechanisms. |                       |
+----------------+----------------------------+-----------------------+
| > **C.3.6**    | **C.3.6.a** The assessor   | > Software may be     |
| > Software     | shall examine evidence to  | > required to allow   |
| > security     | determine if and/or how    | > access to resources |
| > controls are | the software supports      | > or API interfaces   |
| > implemented  | cross-origin access to     | > from other domains  |
| > to protect   | Internet accessible        | > or Internet         |
| > Internet     | interfaces, and to confirm | > origins. This       |
| > accessible   | that access to software    | > practice may lead   |
| > interfaces   | APIs and resources from    | > to vulnerabilities  |
| > from attacks | browser-based scripts is   | > that expose         |
| > that exploit | disabled by default.       | > sensitive data or   |
| > multi-origin |                            | > sensitive functions |
| > resource     |                            | > to attacks.         |
| > sharing.     |                            | >                     |
|                |                            | > Where not required, |
|                |                            | > cross-origin        |
|                |                            | > resource sharing    |
|                |                            | > should be disabled. |
|                |                            | > Where cross-origin  |
|                |                            | > resource sharing is |
|                |                            | > necessary due to a  |
|                |                            | > legitimate business |
|                |                            | > purpose, such       |
|                |                            | > access must be      |
|                |                            | > enabled only for    |
|                |                            | > the domains and     |
|                |                            | > origins required    |
|                |                            | > for the software to |
|                |                            | > perform its         |
|                |                            | > intended            |
|                |                            | > function(s).        |
|                |                            | >                     |
|                |                            | > Use of permission   |
|                |                            | > lists or other      |
|                |                            | > configurations may  |
|                |                            | > be suitable for     |
|                |                            | > identifying         |
|                |                            | > permitted origins,  |
|                |                            | > but such            |
|                |                            | > configurations must |
|                |                            | > also be protected   |
|                |                            | > against             |
|                |                            | > modification by     |
|                |                            | > malicious parties.  |
+----------------+----------------------------+-----------------------+
|                | **C.3.6.b** Where          |                       |
|                | cross-origin access is     |                       |
|                | enabled, the assessor      |                       |
|                | shall examine evidence to  |                       |
|                | confirm that the reasons   |                       |
|                | for enabling cross-origin  |                       |
|                | access are reasonable and  |                       |
|                | justified, and that access |                       |
|                | is restricted to the       |                       |
|                | minimum number of origins  |                       |
|                | feasible.                  |                       |
+----------------+----------------------------+-----------------------+
|                | **C.3.6.c** The assessor   |                       |
|                | shall test the software to |                       |
|                | confirm that the claims    |                       |
|                | made by the assessed       |                       |
|                | entity regarding           |                       |
|                | cross-origin access are    |                       |
|                | valid. At a minimum,       |                       |
|                | testing is expected to     |                       |
|                | include functional testing |                       |
|                | using forensic             |                       |
|                | tools/techniques.          |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.3.6.d** Where          |                       |
|                | disabling or restricting   |                       |
|                | cross-origin access to     |                       |
|                | software APIs requires     |                       |
|                | user input or interaction, |                       |
|                | the assessor shall examine |                       |
|                | evidence to confirm that   |                       |
|                | appropriate guidance on    |                       |
|                | this process is provided   |                       |
|                | to stakeholders in         |                       |
|                | accordance with Control    |                       |
|                | Objective 12.1.            |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
| > [            |                            |                       |
| ]{#_bookmark54 |                            |                       |
| > .an          |                            |                       |
| chor}**Control |                            |                       |
| > Objective    |                            |                       |
| > C.4: Web     |                            |                       |
| > Software     |                            |                       |
| > Co           |                            |                       |
| mmunications** |                            |                       |
| >              |                            |                       |
| > Sensitive    |                            |                       |
| > data         |                            |                       |
| >              |                            |                       |
|  transmissions |                            |                       |
| > are secured  |                            |                       |
| > in           |                            |                       |
| > accordance   |                            |                       |
| > with Control |                            |                       |
| > Objective 6. |                            |                       |
+----------------+----------------------------+-----------------------+
| > **C.4.1**    | **C.4.1.a** Using          | The types of data     |
| > Sensitive    | information obtained in    | which may be          |
| > data         | Test Requirement 6.2.a,    | considered sensitive  |
| >              | the assessor shall examine | may vary across       |
|  transmissions | evidence to determine how  | different             |
| > are          | communications are handled | implementations. See  |
| > encrypted in | by the software, including | Control Objective 1.1 |
| > accordance   | those between separate     | for more information  |
| > with Control | systems in the overall     | on identifying        |
| > Objectives   | software architecture.     | sensitive data.       |
| > 6.2 and 6.3. |                            |                       |
|                |                            | It is therefore       |
|                |                            | important that any    |
|                |                            | connection that       |
|                |                            | transmits sensitive   |
|                |                            | data is encrypted     |
|                |                            | using strong          |
|                |                            | cryptography. Common  |
|                |                            | methods for achieving |
|                |                            | this will include the |
|                |                            | use of TLS using      |
|                |                            | appropriate cipher    |
|                |                            | suites.               |
|                |                            |                       |
|                |                            | Although connections  |
|                |                            | that do not transmit  |
|                |                            | sensitive data do not |
|                |                            | explicitly require    |
|                |                            | the use of            |
|                |                            | encryption, it is     |
|                |                            | noted that the use of |
|                |                            | strong cryptography   |
|                |                            | to secure all         |
|                |                            | connections is        |
|                |                            | considered a best     |
|                |                            | practice and should   |
|                |                            | be implemented for    |
|                |                            | all communications    |
|                |                            | unless legitimate     |
|                |                            | business or           |
|                |                            | technological         |
|                |                            | constraints exist     |
|                |                            | that render such an   |
|                |                            | approach infeasible.  |
|                |                            | In most cases,        |
|                |                            | however,              |
|                |                            | communications        |
|                |                            | between web           |
|                |                            | application           |
|                |                            | components include    |
|                |                            | the transmission of   |
|                |                            | authentication        |
|                |                            | information (user     |
|                |                            | credentials or        |
|                |                            | session information)  |
|                |                            | which is considered   |
|                |                            | sensitive data by     |
|                |                            | definition and should |
|                |                            | therefore be          |
|                |                            | encrypted using       |
|                |                            | strong cryptography.  |
+----------------+----------------------------+-----------------------+
|                | **C.4.1.b** Where the      |                       |
|                | software allows or         |                       |
|                | otherwise supports the     |                       |
|                | transmission of sensitive  |                       |
|                | data between users and     |                       |
|                | systems in different       |                       |
|                | security contexts, the     |                       |
|                | assessor shall examine     |                       |
|                | evidence to confirm that   |                       |
|                | all such communications    |                       |
|                | are encrypted using strong |                       |
|                | cryptography in accordance |                       |
|                | with Control Objectives    |                       |
|                | 6.2 and 6.3.               |                       |
+----------------+----------------------------+-----------------------+

+----------------+----------------------------+-----------------------+
| > **Control    | > **Test Requirements**    | > **Guidance**        |
| > Objectives** |                            |                       |
+================+============================+=======================+
|                | **C.4.1.c** Where          | Where sensitive data  |
|                | sensitive data is          | is transmitted        |
|                | transmitted using          | between systems       |
|                | server-to- server          | operating within      |
|                | communications (for        | different security    |
|                | example, using APIs), the  | contexts and/or       |
|                | assessor shall examine     | different             |
|                | evidence to confirm that   | environments, it is   |
|                | the software enforces or   | important that such   |
|                | otherwise supports mutual  | communications be     |
|                | authentication between     | restricted to an      |
|                | systems.                   | explicitly approved   |
|                |                            | list of systems, and  |
|                |                            | that the systems      |
|                |                            | involved be mutually  |
|                |                            | authenticated such    |
|                |                            | that attempts to      |
|                |                            | intercept or          |
|                |                            | compromise such       |
|                |                            | communications are    |
|                |                            | appropriately         |
|                |                            | mitigated.            |
|                |                            |                       |
|                |                            | Where the software    |
|                |                            | provider controls the |
|                |                            | configuration of such |
|                |                            | communications,       |
|                |                            | mutual authentication |
|                |                            | must be enforced.     |
|                |                            | Otherwise, the        |
|                |                            | software provider     |
|                |                            | must provide features |
|                |                            | to support the mutual |
|                |                            | authentication of     |
|                |                            | disparate systems so  |
|                |                            | that an implementing  |
|                |                            | entity may configure  |
|                |                            | such features         |
|                |                            | accordingly.          |
+----------------+----------------------------+-----------------------+
|                | **C.4.1.d** Where          | Many organizations    |
|                | internally generated or    | that choose to use    |
|                | self-signed certificates   | internally generated  |
|                | are used for securing      | and/or self-signed    |
|                | sensitive data             | certificates do so    |
|                | transmissions, the         | for the benefits they |
|                | assessor shall examine     | offer without         |
|                | evidence to confirm that:  | considering the       |
|                |                            | additional overhead   |
|                | -   The use of internally  | needed to manage them |
|                |     > generated or         | securely. As a        |
|                |     > self-signed          | result, critical      |
|                |     > certificates is      | security processes    |
|                |     > reasonable and       | such as certificate   |
|                |     > justified.           | revocation and key    |
|                |                            | management are not    |
|                | -   The software is        | implemented or        |
|                |     > configured to accept | maintained properly.  |
|                |     > the minimum feasible | For this reason, the  |
|                |     > number of internally | use of internally     |
|                |     > generated or         | generated and/or      |
|                |     > self-signed          | self- signed          |
|                |     > certificates.        | certificates should   |
|                |                            | be kept to an         |
|                |                            | absolute minimum.     |
|                |                            | Where their use is    |
|                |                            | required, such        |
|                |                            | instances should be   |
|                |                            | documented and        |
|                |                            | justified.            |
+----------------+----------------------------+-----------------------+
